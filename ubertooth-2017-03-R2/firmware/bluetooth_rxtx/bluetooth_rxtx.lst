ARM GAS  /tmp/cckWTbJW.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"bluetooth_rxtx.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.reverse8,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	reverse8:
  24              	.LFB15:
  25              		.file 1 "bluetooth_rxtx.c"
   1:bluetooth_rxtx.c **** /*
   2:bluetooth_rxtx.c ****  * Copyright 2010-2013 Michael Ossmann
   3:bluetooth_rxtx.c ****  * Copyright 2011-2013 Dominic Spill
   4:bluetooth_rxtx.c ****  *
   5:bluetooth_rxtx.c ****  * This file is part of Project Ubertooth.
   6:bluetooth_rxtx.c ****  *
   7:bluetooth_rxtx.c ****  * This program is free software; you can redistribute it and/or modify
   8:bluetooth_rxtx.c ****  * it under the terms of the GNU General Public License as published by
   9:bluetooth_rxtx.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:bluetooth_rxtx.c ****  * any later version.
  11:bluetooth_rxtx.c ****  *
  12:bluetooth_rxtx.c ****  * This program is distributed in the hope that it will be useful,
  13:bluetooth_rxtx.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:bluetooth_rxtx.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:bluetooth_rxtx.c ****  * GNU General Public License for more details.
  16:bluetooth_rxtx.c ****  *
  17:bluetooth_rxtx.c ****  * You should have received a copy of the GNU General Public License
  18:bluetooth_rxtx.c ****  * along with this program; see the file COPYING.  If not, write to
  19:bluetooth_rxtx.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:bluetooth_rxtx.c ****  * Boston, MA 02110-1301, USA.
  21:bluetooth_rxtx.c ****  */
  22:bluetooth_rxtx.c **** 
  23:bluetooth_rxtx.c **** #include <string.h>
  24:bluetooth_rxtx.c **** 
  25:bluetooth_rxtx.c **** #include "ubertooth.h"
  26:bluetooth_rxtx.c **** #include "ubertooth_usb.h"
  27:bluetooth_rxtx.c **** #include "ubertooth_interface.h"
  28:bluetooth_rxtx.c **** #include "ubertooth_rssi.h"
  29:bluetooth_rxtx.c **** #include "ubertooth_cs.h"
  30:bluetooth_rxtx.c **** #include "ubertooth_dma.h"
  31:bluetooth_rxtx.c **** #include "ubertooth_clock.h"
  32:bluetooth_rxtx.c **** #include "bluetooth.h"
  33:bluetooth_rxtx.c **** #include "bluetooth_le.h"
ARM GAS  /tmp/cckWTbJW.s 			page 2


  34:bluetooth_rxtx.c **** #include "cc2400_rangetest.h"
  35:bluetooth_rxtx.c **** #include "ego.h"
  36:bluetooth_rxtx.c **** 
  37:bluetooth_rxtx.c **** #define MIN(x,y)	((x)<(y)?(x):(y))
  38:bluetooth_rxtx.c **** #define MAX(x,y)	((x)>(y)?(x):(y))
  39:bluetooth_rxtx.c **** 
  40:bluetooth_rxtx.c **** /* build info */
  41:bluetooth_rxtx.c **** const char compile_info[] =
  42:bluetooth_rxtx.c **** 	"ubertooth " GIT_REVISION " (" COMPILE_BY "@" COMPILE_HOST ") " TIMESTAMP;
  43:bluetooth_rxtx.c **** 
  44:bluetooth_rxtx.c **** /* hopping stuff */
  45:bluetooth_rxtx.c **** volatile uint8_t  hop_mode = HOP_NONE;
  46:bluetooth_rxtx.c **** volatile uint8_t  do_hop = 0;                  // set by timer interrupt
  47:bluetooth_rxtx.c **** volatile uint16_t channel = 2441;
  48:bluetooth_rxtx.c **** volatile uint16_t hop_direct_channel = 0;      // for hopping directly to a channel
  49:bluetooth_rxtx.c **** volatile uint16_t hop_timeout = 158;
  50:bluetooth_rxtx.c **** volatile uint16_t requested_channel = 0;
  51:bluetooth_rxtx.c **** volatile uint16_t le_adv_channel = 2402;
  52:bluetooth_rxtx.c **** 
  53:bluetooth_rxtx.c **** /* bulk USB stuff */
  54:bluetooth_rxtx.c **** volatile uint8_t  idle_buf_clkn_high = 0;
  55:bluetooth_rxtx.c **** volatile uint32_t idle_buf_clk100ns = 0;
  56:bluetooth_rxtx.c **** volatile uint16_t idle_buf_channel = 0;
  57:bluetooth_rxtx.c **** volatile uint8_t  dma_discard = 0;
  58:bluetooth_rxtx.c **** volatile uint8_t  status = 0;
  59:bluetooth_rxtx.c **** 
  60:bluetooth_rxtx.c **** /* operation mode */
  61:bluetooth_rxtx.c **** volatile uint8_t mode = MODE_IDLE;
  62:bluetooth_rxtx.c **** volatile uint8_t requested_mode = MODE_IDLE;
  63:bluetooth_rxtx.c **** volatile uint8_t jam_mode = JAM_NONE;
  64:bluetooth_rxtx.c **** volatile uint8_t ego_mode = EGO_FOLLOW;
  65:bluetooth_rxtx.c **** 
  66:bluetooth_rxtx.c **** volatile uint8_t modulation = MOD_BT_BASIC_RATE;
  67:bluetooth_rxtx.c **** 
  68:bluetooth_rxtx.c **** /* specan stuff */
  69:bluetooth_rxtx.c **** volatile uint16_t low_freq = 2400;
  70:bluetooth_rxtx.c **** volatile uint16_t high_freq = 2483;
  71:bluetooth_rxtx.c **** volatile int8_t rssi_threshold = -30;  // -54dBm - 30 = -84dBm
  72:bluetooth_rxtx.c **** 
  73:bluetooth_rxtx.c **** /* Generic TX stuff */
  74:bluetooth_rxtx.c **** generic_tx_packet tx_pkt;
  75:bluetooth_rxtx.c **** 
  76:bluetooth_rxtx.c **** /* le stuff */
  77:bluetooth_rxtx.c **** uint8_t slave_mac_address[6] = { 0, };
  78:bluetooth_rxtx.c **** 
  79:bluetooth_rxtx.c **** le_state_t le = {
  80:bluetooth_rxtx.c **** 	.access_address = 0x8e89bed6,           // advertising channel access address
  81:bluetooth_rxtx.c **** 	.synch = 0x6b7d,                        // bit-reversed adv channel AA
  82:bluetooth_rxtx.c **** 	.syncl = 0x9171,
  83:bluetooth_rxtx.c **** 	.crc_init  = 0x555555,                  // advertising channel CRCInit
  84:bluetooth_rxtx.c **** 	.crc_init_reversed = 0xAAAAAA,
  85:bluetooth_rxtx.c **** 	.crc_verify = 0,
  86:bluetooth_rxtx.c **** 
  87:bluetooth_rxtx.c **** 	.link_state = LINK_INACTIVE,
  88:bluetooth_rxtx.c **** 	.conn_epoch = 0,
  89:bluetooth_rxtx.c **** 	.target_set = 0,
  90:bluetooth_rxtx.c **** 	.last_packet = 0,
ARM GAS  /tmp/cckWTbJW.s 			page 3


  91:bluetooth_rxtx.c **** };
  92:bluetooth_rxtx.c **** 
  93:bluetooth_rxtx.c **** typedef struct _le_promisc_active_aa_t {
  94:bluetooth_rxtx.c **** 	u32 aa;
  95:bluetooth_rxtx.c **** 	int count;
  96:bluetooth_rxtx.c **** } le_promisc_active_aa_t;
  97:bluetooth_rxtx.c **** 
  98:bluetooth_rxtx.c **** typedef struct _le_promisc_state_t {
  99:bluetooth_rxtx.c **** 	// LFU cache of recently seen AA's
 100:bluetooth_rxtx.c **** 	le_promisc_active_aa_t active_aa[32];
 101:bluetooth_rxtx.c **** 
 102:bluetooth_rxtx.c **** 	// recovering hop interval
 103:bluetooth_rxtx.c **** 	u32 smallest_hop_interval;
 104:bluetooth_rxtx.c **** 	int consec_intervals;
 105:bluetooth_rxtx.c **** } le_promisc_state_t;
 106:bluetooth_rxtx.c **** le_promisc_state_t le_promisc;
 107:bluetooth_rxtx.c **** #define AA_LIST_SIZE (int)(sizeof(le_promisc.active_aa) / sizeof(le_promisc_active_aa_t))
 108:bluetooth_rxtx.c **** 
 109:bluetooth_rxtx.c **** /* LE jamming */
 110:bluetooth_rxtx.c **** #define JAM_COUNT_DEFAULT 40
 111:bluetooth_rxtx.c **** int le_jam_count = 0;
 112:bluetooth_rxtx.c **** 
 113:bluetooth_rxtx.c **** /* set LE access address */
 114:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa);
 115:bluetooth_rxtx.c **** 
 116:bluetooth_rxtx.c **** typedef int (*data_cb_t)(char *);
 117:bluetooth_rxtx.c **** data_cb_t data_cb = NULL;
 118:bluetooth_rxtx.c **** 
 119:bluetooth_rxtx.c **** typedef void (*packet_cb_t)(u8 *);
 120:bluetooth_rxtx.c **** packet_cb_t packet_cb = NULL;
 121:bluetooth_rxtx.c **** 
 122:bluetooth_rxtx.c **** /* Unpacked symbol buffers (two rxbufs) */
 123:bluetooth_rxtx.c **** char unpacked[DMA_SIZE*8*2];
 124:bluetooth_rxtx.c **** 
 125:bluetooth_rxtx.c **** static int enqueue(uint8_t type, uint8_t* buf)
 126:bluetooth_rxtx.c **** {
 127:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 128:bluetooth_rxtx.c **** 
 129:bluetooth_rxtx.c **** 	/* fail if queue is full */
 130:bluetooth_rxtx.c **** 	if (f == NULL) {
 131:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 132:bluetooth_rxtx.c **** 		return 0;
 133:bluetooth_rxtx.c **** 	}
 134:bluetooth_rxtx.c **** 
 135:bluetooth_rxtx.c **** 	f->pkt_type = type;
 136:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 137:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 138:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 139:bluetooth_rxtx.c **** 	} else {
 140:bluetooth_rxtx.c **** 		f->clkn_high = idle_buf_clkn_high;
 141:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 142:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 143:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 144:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 145:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 146:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 147:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/cckWTbJW.s 			page 4


 148:bluetooth_rxtx.c **** 
 149:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 150:bluetooth_rxtx.c **** 
 151:bluetooth_rxtx.c **** 	f->status = status;
 152:bluetooth_rxtx.c **** 	status = 0;
 153:bluetooth_rxtx.c **** 
 154:bluetooth_rxtx.c **** 	return 1;
 155:bluetooth_rxtx.c **** }
 156:bluetooth_rxtx.c **** 
 157:bluetooth_rxtx.c **** int enqueue_with_ts(uint8_t type, uint8_t* buf, uint32_t ts)
 158:bluetooth_rxtx.c **** {
 159:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 160:bluetooth_rxtx.c **** 
 161:bluetooth_rxtx.c **** 	/* fail if queue is full */
 162:bluetooth_rxtx.c **** 	if (f == NULL) {
 163:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 164:bluetooth_rxtx.c **** 		return 0;
 165:bluetooth_rxtx.c **** 	}
 166:bluetooth_rxtx.c **** 
 167:bluetooth_rxtx.c **** 	f->pkt_type = type;
 168:bluetooth_rxtx.c **** 
 169:bluetooth_rxtx.c **** 	f->clkn_high = 0;
 170:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 171:bluetooth_rxtx.c **** 
 172:bluetooth_rxtx.c **** 	f->channel = (uint8_t)((channel - 2402) & 0xff);
 173:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 174:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 175:bluetooth_rxtx.c **** 
 176:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 177:bluetooth_rxtx.c **** 
 178:bluetooth_rxtx.c **** 	f->status = status;
 179:bluetooth_rxtx.c **** 	status = 0;
 180:bluetooth_rxtx.c **** 
 181:bluetooth_rxtx.c **** 	return 1;
 182:bluetooth_rxtx.c **** }
 183:bluetooth_rxtx.c **** 
 184:bluetooth_rxtx.c **** static int vendor_request_handler(uint8_t request, uint16_t* request_params, uint8_t* data, int* da
 185:bluetooth_rxtx.c **** {
 186:bluetooth_rxtx.c **** 	uint32_t clock;
 187:bluetooth_rxtx.c **** 	size_t length; // string length
 188:bluetooth_rxtx.c **** 	usb_pkt_rx* p = NULL;
 189:bluetooth_rxtx.c **** 	uint16_t reg_val;
 190:bluetooth_rxtx.c **** 	uint8_t i;
 191:bluetooth_rxtx.c **** 
 192:bluetooth_rxtx.c **** 	switch (request) {
 193:bluetooth_rxtx.c **** 
 194:bluetooth_rxtx.c **** 	case UBERTOOTH_PING:
 195:bluetooth_rxtx.c **** 		*data_len = 0;
 196:bluetooth_rxtx.c **** 		break;
 197:bluetooth_rxtx.c **** 
 198:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_SYMBOLS:
 199:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_SYMBOLS;
 200:bluetooth_rxtx.c **** 		*data_len = 0;
 201:bluetooth_rxtx.c **** 		break;
 202:bluetooth_rxtx.c **** 
 203:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_SYMBOLS:
 204:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
ARM GAS  /tmp/cckWTbJW.s 			page 5


 205:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 206:bluetooth_rxtx.c **** 		*data_len = 0;
 207:bluetooth_rxtx.c **** 		break;
 208:bluetooth_rxtx.c **** 
 209:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_USRLED:
 210:bluetooth_rxtx.c **** 		data[0] = (USRLED) ? 1 : 0;
 211:bluetooth_rxtx.c **** 		*data_len = 1;
 212:bluetooth_rxtx.c **** 		break;
 213:bluetooth_rxtx.c **** 
 214:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_USRLED:
 215:bluetooth_rxtx.c **** 		if (request_params[0])
 216:bluetooth_rxtx.c **** 			USRLED_SET;
 217:bluetooth_rxtx.c **** 		else
 218:bluetooth_rxtx.c **** 			USRLED_CLR;
 219:bluetooth_rxtx.c **** 		break;
 220:bluetooth_rxtx.c **** 
 221:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_RXLED:
 222:bluetooth_rxtx.c **** 		data[0] = (RXLED) ? 1 : 0;
 223:bluetooth_rxtx.c **** 		*data_len = 1;
 224:bluetooth_rxtx.c **** 		break;
 225:bluetooth_rxtx.c **** 
 226:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_RXLED:
 227:bluetooth_rxtx.c **** 		if (request_params[0])
 228:bluetooth_rxtx.c **** 			RXLED_SET;
 229:bluetooth_rxtx.c **** 		else
 230:bluetooth_rxtx.c **** 			RXLED_CLR;
 231:bluetooth_rxtx.c **** 		break;
 232:bluetooth_rxtx.c **** 
 233:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_TXLED:
 234:bluetooth_rxtx.c **** 		data[0] = (TXLED) ? 1 : 0;
 235:bluetooth_rxtx.c **** 		*data_len = 1;
 236:bluetooth_rxtx.c **** 		break;
 237:bluetooth_rxtx.c **** 
 238:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_TXLED:
 239:bluetooth_rxtx.c **** 		if (request_params[0])
 240:bluetooth_rxtx.c **** 			TXLED_SET;
 241:bluetooth_rxtx.c **** 		else
 242:bluetooth_rxtx.c **** 			TXLED_CLR;
 243:bluetooth_rxtx.c **** 		break;
 244:bluetooth_rxtx.c **** 
 245:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_1V8:
 246:bluetooth_rxtx.c **** 		data[0] = (CC1V8) ? 1 : 0;
 247:bluetooth_rxtx.c **** 		*data_len = 1;
 248:bluetooth_rxtx.c **** 		break;
 249:bluetooth_rxtx.c **** 
 250:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_1V8:
 251:bluetooth_rxtx.c **** 		if (request_params[0])
 252:bluetooth_rxtx.c **** 			CC1V8_SET;
 253:bluetooth_rxtx.c **** 		else
 254:bluetooth_rxtx.c **** 			CC1V8_CLR;
 255:bluetooth_rxtx.c **** 		break;
 256:bluetooth_rxtx.c **** 
 257:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PARTNUM:
 258:bluetooth_rxtx.c **** 		get_part_num(data, data_len);
 259:bluetooth_rxtx.c **** 		break;
 260:bluetooth_rxtx.c **** 
 261:bluetooth_rxtx.c **** 	case UBERTOOTH_RESET:
ARM GAS  /tmp/cckWTbJW.s 			page 6


 262:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 263:bluetooth_rxtx.c **** 		break;
 264:bluetooth_rxtx.c **** 
 265:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SERIAL:
 266:bluetooth_rxtx.c **** 		get_device_serial(data, data_len);
 267:bluetooth_rxtx.c **** 		break;
 268:bluetooth_rxtx.c **** 
 269:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 270:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PAEN:
 271:bluetooth_rxtx.c **** 		data[0] = (PAEN) ? 1 : 0;
 272:bluetooth_rxtx.c **** 		*data_len = 1;
 273:bluetooth_rxtx.c **** 		break;
 274:bluetooth_rxtx.c **** 
 275:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PAEN:
 276:bluetooth_rxtx.c **** 		if (request_params[0])
 277:bluetooth_rxtx.c **** 			PAEN_SET;
 278:bluetooth_rxtx.c **** 		else
 279:bluetooth_rxtx.c **** 			PAEN_CLR;
 280:bluetooth_rxtx.c **** 		break;
 281:bluetooth_rxtx.c **** 
 282:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_HGM:
 283:bluetooth_rxtx.c **** 		data[0] = (HGM) ? 1 : 0;
 284:bluetooth_rxtx.c **** 		*data_len = 1;
 285:bluetooth_rxtx.c **** 		break;
 286:bluetooth_rxtx.c **** 
 287:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HGM:
 288:bluetooth_rxtx.c **** 		if (request_params[0])
 289:bluetooth_rxtx.c **** 			HGM_SET;
 290:bluetooth_rxtx.c **** 		else
 291:bluetooth_rxtx.c **** 			HGM_CLR;
 292:bluetooth_rxtx.c **** 		break;
 293:bluetooth_rxtx.c **** #endif
 294:bluetooth_rxtx.c **** 
 295:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 296:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_TEST:
 297:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_TEST;
 298:bluetooth_rxtx.c **** 		break;
 299:bluetooth_rxtx.c **** 
 300:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PALEVEL:
 301:bluetooth_rxtx.c **** 		data[0] = cc2400_get(FREND) & 0x7;
 302:bluetooth_rxtx.c **** 		*data_len = 1;
 303:bluetooth_rxtx.c **** 		break;
 304:bluetooth_rxtx.c **** 
 305:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PALEVEL:
 306:bluetooth_rxtx.c **** 		if( request_params[0] < 8 ) {
 307:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 308:bluetooth_rxtx.c **** 		} else {
 309:bluetooth_rxtx.c **** 			return 0;
 310:bluetooth_rxtx.c **** 		}
 311:bluetooth_rxtx.c **** 		break;
 312:bluetooth_rxtx.c **** 
 313:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_TEST:
 314:bluetooth_rxtx.c **** 		requested_mode = MODE_RANGE_TEST;
 315:bluetooth_rxtx.c **** 		break;
 316:bluetooth_rxtx.c **** 
 317:bluetooth_rxtx.c **** 	case UBERTOOTH_REPEATER:
 318:bluetooth_rxtx.c **** 		requested_mode = MODE_REPEATER;
ARM GAS  /tmp/cckWTbJW.s 			page 7


 319:bluetooth_rxtx.c **** 		break;
 320:bluetooth_rxtx.c **** #endif
 321:bluetooth_rxtx.c **** 
 322:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_CHECK:
 323:bluetooth_rxtx.c **** 		data[0] = rr.valid;
 324:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 325:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 326:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 327:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 328:bluetooth_rxtx.c **** 		*data_len = 5;
 329:bluetooth_rxtx.c **** 		break;
 330:bluetooth_rxtx.c **** 
 331:bluetooth_rxtx.c **** 	case UBERTOOTH_STOP:
 332:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 333:bluetooth_rxtx.c **** 		break;
 334:bluetooth_rxtx.c **** 
 335:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_MOD:
 336:bluetooth_rxtx.c **** 		data[0] = modulation;
 337:bluetooth_rxtx.c **** 		*data_len = 1;
 338:bluetooth_rxtx.c **** 		break;
 339:bluetooth_rxtx.c **** 
 340:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_MOD:
 341:bluetooth_rxtx.c **** 		modulation = request_params[0];
 342:bluetooth_rxtx.c **** 		break;
 343:bluetooth_rxtx.c **** 
 344:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CHANNEL:
 345:bluetooth_rxtx.c **** 		data[0] = channel & 0xFF;
 346:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 347:bluetooth_rxtx.c **** 		*data_len = 2;
 348:bluetooth_rxtx.c **** 		break;
 349:bluetooth_rxtx.c **** 
 350:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CHANNEL:
 351:bluetooth_rxtx.c **** 		requested_channel = request_params[0];
 352:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 353:bluetooth_rxtx.c **** 		if (requested_channel > MAX_FREQ) {
 354:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 355:bluetooth_rxtx.c **** 			requested_channel = 2402;
 356:bluetooth_rxtx.c **** 		}
 357:bluetooth_rxtx.c **** 		/* fixed channel mode, can be outside bluetooth band */
 358:bluetooth_rxtx.c **** 		else {
 359:bluetooth_rxtx.c **** 			hop_mode = HOP_NONE;
 360:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 361:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 362:bluetooth_rxtx.c **** 		}
 363:bluetooth_rxtx.c **** 
 364:bluetooth_rxtx.c **** 		le_adv_channel = requested_channel;
 365:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 366:bluetooth_rxtx.c **** 			channel = requested_channel;
 367:bluetooth_rxtx.c **** 			requested_channel = 0;
 368:bluetooth_rxtx.c **** 
 369:bluetooth_rxtx.c **** 			/* CS threshold is mode-dependent. Update it after
 370:bluetooth_rxtx.c **** 			 * possible mode change. TODO - kludgy. */
 371:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 372:bluetooth_rxtx.c **** 		}
 373:bluetooth_rxtx.c **** 		break;
 374:bluetooth_rxtx.c **** 
 375:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ISP:
ARM GAS  /tmp/cckWTbJW.s 			page 8


 376:bluetooth_rxtx.c **** 		set_isp();
 377:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 378:bluetooth_rxtx.c **** 		break;
 379:bluetooth_rxtx.c **** 
 380:bluetooth_rxtx.c **** 	case UBERTOOTH_FLASH:
 381:bluetooth_rxtx.c **** 		bootloader_ctrl = DFU_MODE;
 382:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 383:bluetooth_rxtx.c **** 		break;
 384:bluetooth_rxtx.c **** 
 385:bluetooth_rxtx.c **** 	case UBERTOOTH_SPECAN:
 386:bluetooth_rxtx.c **** 		if (request_params[0] < 2049 || request_params[0] > 3072 ||
 387:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 388:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 389:bluetooth_rxtx.c **** 			return 0;
 390:bluetooth_rxtx.c **** 		low_freq = request_params[0];
 391:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 392:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 393:bluetooth_rxtx.c **** 		*data_len = 0;
 394:bluetooth_rxtx.c **** 		break;
 395:bluetooth_rxtx.c **** 
 396:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_GENERIC:
 397:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_GENERIC;
 398:bluetooth_rxtx.c **** 		*data_len = 0;
 399:bluetooth_rxtx.c **** 		break;
 400:bluetooth_rxtx.c **** 
 401:bluetooth_rxtx.c **** 	case UBERTOOTH_LED_SPECAN:
 402:bluetooth_rxtx.c **** 		if (request_params[0] > 256)
 403:bluetooth_rxtx.c **** 			return 0;
 404:bluetooth_rxtx.c **** 		rssi_threshold = 54 - request_params[0];
 405:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 406:bluetooth_rxtx.c **** 		*data_len = 0;
 407:bluetooth_rxtx.c **** 		break;
 408:bluetooth_rxtx.c **** 
 409:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_REV_NUM:
 410:bluetooth_rxtx.c **** 		data[0] = 0x00;
 411:bluetooth_rxtx.c **** 		data[1] = 0x00;
 412:bluetooth_rxtx.c **** 
 413:bluetooth_rxtx.c **** 		length = (u8)strlen(GIT_REVISION);
 414:bluetooth_rxtx.c **** 		data[2] = length;
 415:bluetooth_rxtx.c **** 
 416:bluetooth_rxtx.c **** 		memcpy(&data[3], GIT_REVISION, length);
 417:bluetooth_rxtx.c **** 
 418:bluetooth_rxtx.c **** 		*data_len = 2 + 1 + length;
 419:bluetooth_rxtx.c **** 		break;
 420:bluetooth_rxtx.c **** 
 421:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_COMPILE_INFO:
 422:bluetooth_rxtx.c **** 		length = (u8)strlen(compile_info);
 423:bluetooth_rxtx.c **** 		data[0] = length;
 424:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 425:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 426:bluetooth_rxtx.c **** 		break;
 427:bluetooth_rxtx.c **** 
 428:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_BOARD_ID:
 429:bluetooth_rxtx.c **** 		data[0] = BOARD_ID;
 430:bluetooth_rxtx.c **** 		*data_len = 1;
 431:bluetooth_rxtx.c **** 		break;
 432:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 9


 433:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_SQUELCH:
 434:bluetooth_rxtx.c **** 		cs_threshold_req = (int8_t)request_params[0];
 435:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 436:bluetooth_rxtx.c **** 		break;
 437:bluetooth_rxtx.c **** 
 438:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SQUELCH:
 439:bluetooth_rxtx.c **** 		data[0] = cs_threshold_req;
 440:bluetooth_rxtx.c **** 		*data_len = 1;
 441:bluetooth_rxtx.c **** 		break;
 442:bluetooth_rxtx.c **** 
 443:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_BDADDR:
 444:bluetooth_rxtx.c **** 		target.address = 0;
 445:bluetooth_rxtx.c **** 		target.syncword = 0;
 446:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 447:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 448:bluetooth_rxtx.c **** 		}
 449:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 450:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 451:bluetooth_rxtx.c **** 		}
 452:bluetooth_rxtx.c **** 		precalc();
 453:bluetooth_rxtx.c **** 		break;
 454:bluetooth_rxtx.c **** 
 455:bluetooth_rxtx.c **** 	case UBERTOOTH_START_HOPPING:
 456:bluetooth_rxtx.c **** 		clkn_offset = 0;
 457:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 458:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 459:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 460:bluetooth_rxtx.c **** 		}
 461:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 462:bluetooth_rxtx.c **** 		dma_discard = 1;
 463:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 464:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 465:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 466:bluetooth_rxtx.c **** 		break;
 467:bluetooth_rxtx.c **** 
 468:bluetooth_rxtx.c **** 	case UBERTOOTH_AFH:
 469:bluetooth_rxtx.c **** 		hop_mode = HOP_AFH;
 470:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 471:bluetooth_rxtx.c **** 
 472:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 473:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 474:bluetooth_rxtx.c **** 		}
 475:bluetooth_rxtx.c **** 		used_channels = 0;
 476:bluetooth_rxtx.c **** 		afh_enabled = 1;
 477:bluetooth_rxtx.c **** 		break;
 478:bluetooth_rxtx.c **** 
 479:bluetooth_rxtx.c **** 	case UBERTOOTH_HOP:
 480:bluetooth_rxtx.c **** 		do_hop = 1;
 481:bluetooth_rxtx.c **** 		break;
 482:bluetooth_rxtx.c **** 
 483:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CLOCK:
 484:bluetooth_rxtx.c **** 		clock = data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24;
 485:bluetooth_rxtx.c **** 		clkn = clock;
 486:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 487:bluetooth_rxtx.c **** 		break;
 488:bluetooth_rxtx.c **** 
 489:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_AFHMAP:
ARM GAS  /tmp/cckWTbJW.s 			page 10


 490:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 491:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 492:bluetooth_rxtx.c **** 		}
 493:bluetooth_rxtx.c **** 		afh_enabled = 1;
 494:bluetooth_rxtx.c **** 		*data_len = 10;
 495:bluetooth_rxtx.c **** 		break;
 496:bluetooth_rxtx.c **** 
 497:bluetooth_rxtx.c **** 	case UBERTOOTH_CLEAR_AFHMAP:
 498:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 499:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 500:bluetooth_rxtx.c **** 		}
 501:bluetooth_rxtx.c **** 		afh_enabled = 0;
 502:bluetooth_rxtx.c **** 		*data_len = 10;
 503:bluetooth_rxtx.c **** 		break;
 504:bluetooth_rxtx.c **** 
 505:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CLOCK:
 506:bluetooth_rxtx.c **** 		clock = clkn;
 507:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 508:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 509:bluetooth_rxtx.c **** 		}
 510:bluetooth_rxtx.c **** 		*data_len = 4;
 511:bluetooth_rxtx.c **** 		break;
 512:bluetooth_rxtx.c **** 
 513:bluetooth_rxtx.c **** 	case UBERTOOTH_TRIM_CLOCK:
 514:bluetooth_rxtx.c **** 		clk100ns_offset = (data[0] << 8) | (data[1] << 0);
 515:bluetooth_rxtx.c **** 		break;
 516:bluetooth_rxtx.c **** 
 517:bluetooth_rxtx.c **** 	case UBERTOOTH_FIX_CLOCK_DRIFT:
 518:bluetooth_rxtx.c **** 		clk_drift_ppm += (int16_t)(data[0] << 8) | (data[1] << 0);
 519:bluetooth_rxtx.c **** 
 520:bluetooth_rxtx.c **** 		// Too slow
 521:bluetooth_rxtx.c **** 		if (clk_drift_ppm < 0) {
 522:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 523:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 524:bluetooth_rxtx.c **** 		}
 525:bluetooth_rxtx.c **** 		// Too fast
 526:bluetooth_rxtx.c **** 		else if (clk_drift_ppm > 0) {
 527:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 528:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 529:bluetooth_rxtx.c **** 		}
 530:bluetooth_rxtx.c **** 		// Don't trim
 531:bluetooth_rxtx.c **** 		else {
 532:bluetooth_rxtx.c **** 			clk_drift_correction = 0;
 533:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 534:bluetooth_rxtx.c **** 		}
 535:bluetooth_rxtx.c **** 
 536:bluetooth_rxtx.c **** 		break;
 537:bluetooth_rxtx.c **** 
 538:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SNIFFING:
 539:bluetooth_rxtx.c **** 		*data_len = 0;
 540:bluetooth_rxtx.c **** 
 541:bluetooth_rxtx.c **** 		do_hop = 0;
 542:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 543:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 544:bluetooth_rxtx.c **** 
 545:bluetooth_rxtx.c **** 		queue_init();
 546:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
ARM GAS  /tmp/cckWTbJW.s 			page 11


 547:bluetooth_rxtx.c **** 		break;
 548:bluetooth_rxtx.c **** 
 549:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_ACCESS_ADDRESS:
 550:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 551:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 552:bluetooth_rxtx.c **** 		}
 553:bluetooth_rxtx.c **** 		*data_len = 4;
 554:bluetooth_rxtx.c **** 		break;
 555:bluetooth_rxtx.c **** 
 556:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ACCESS_ADDRESS:
 557:bluetooth_rxtx.c **** 		le_set_access_address(data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24);
 558:bluetooth_rxtx.c **** 		le.target_set = 1;
 559:bluetooth_rxtx.c **** 		break;
 560:bluetooth_rxtx.c **** 
 561:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING:
 562:bluetooth_rxtx.c **** 		// do something! just don't commit anything here
 563:bluetooth_rxtx.c **** 		break;
 564:bluetooth_rxtx.c **** 
 565:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING_REPLY:
 566:bluetooth_rxtx.c **** 		// after you do something, tell me what you did!
 567:bluetooth_rxtx.c **** 		// don't commit here please
 568:bluetooth_rxtx.c **** 		data[0] = 0x13;
 569:bluetooth_rxtx.c **** 		data[1] = 0x37;
 570:bluetooth_rxtx.c **** 		*data_len = 2;
 571:bluetooth_rxtx.c **** 		break;
 572:bluetooth_rxtx.c **** 
 573:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CRC_VERIFY:
 574:bluetooth_rxtx.c **** 		data[0] = le.crc_verify ? 1 : 0;
 575:bluetooth_rxtx.c **** 		*data_len = 1;
 576:bluetooth_rxtx.c **** 		break;
 577:bluetooth_rxtx.c **** 
 578:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CRC_VERIFY:
 579:bluetooth_rxtx.c **** 		le.crc_verify = request_params[0] ? 1 : 0;
 580:bluetooth_rxtx.c **** 		break;
 581:bluetooth_rxtx.c **** 
 582:bluetooth_rxtx.c **** 	case UBERTOOTH_POLL:
 583:bluetooth_rxtx.c **** 		p = dequeue();
 584:bluetooth_rxtx.c **** 		if (p != NULL) {
 585:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 586:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 587:bluetooth_rxtx.c **** 		} else {
 588:bluetooth_rxtx.c **** 			data[0] = 0;
 589:bluetooth_rxtx.c **** 			*data_len = 1;
 590:bluetooth_rxtx.c **** 		}
 591:bluetooth_rxtx.c **** 		break;
 592:bluetooth_rxtx.c **** 
 593:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_PROMISC:
 594:bluetooth_rxtx.c **** 		*data_len = 0;
 595:bluetooth_rxtx.c **** 
 596:bluetooth_rxtx.c **** 		hop_mode = HOP_NONE;
 597:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 598:bluetooth_rxtx.c **** 
 599:bluetooth_rxtx.c **** 		queue_init();
 600:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 601:bluetooth_rxtx.c **** 		break;
 602:bluetooth_rxtx.c **** 
 603:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_REGISTER:
ARM GAS  /tmp/cckWTbJW.s 			page 12


 604:bluetooth_rxtx.c **** 		reg_val = cc2400_get(request_params[0]);
 605:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 606:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 607:bluetooth_rxtx.c **** 		*data_len = 2;
 608:bluetooth_rxtx.c **** 		break;
 609:bluetooth_rxtx.c **** 
 610:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTER:
 611:bluetooth_rxtx.c **** 		cc2400_set(request_params[0] & 0xff, request_params[1]);
 612:bluetooth_rxtx.c **** 		break;
 613:bluetooth_rxtx.c **** 
 614:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTERS:
 615:bluetooth_rxtx.c **** 		for(i=0; i<request_params[0]; i++) {
 616:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 617:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 618:bluetooth_rxtx.c **** 		}
 619:bluetooth_rxtx.c **** 		break;
 620:bluetooth_rxtx.c **** 
 621:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_ALL_REGISTERS:
 622:bluetooth_rxtx.c **** 		#define MAX_READ_REG 0x2d
 623:bluetooth_rxtx.c **** 		for(i=0; i<=MAX_READ_REG; i++) {
 624:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 625:bluetooth_rxtx.c **** 			data[i*3] = i;
 626:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 627:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 628:bluetooth_rxtx.c **** 		}
 629:bluetooth_rxtx.c **** 		*data_len = MAX_READ_REG*3;
 630:bluetooth_rxtx.c **** 		break;
 631:bluetooth_rxtx.c **** 
 632:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_GENERIC_PACKET:
 633:bluetooth_rxtx.c **** 		i = 7 + data[6];
 634:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 635:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 636:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_GENERIC;
 637:bluetooth_rxtx.c **** 		*data_len = 0;
 638:bluetooth_rxtx.c **** 		break;
 639:bluetooth_rxtx.c **** 
 640:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE:
 641:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 642:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 643:bluetooth_rxtx.c **** 		break;
 644:bluetooth_rxtx.c **** 
 645:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SET_TARGET:
 646:bluetooth_rxtx.c **** 		// Addresses appear in packets in reverse-octet order.
 647:bluetooth_rxtx.c **** 		// Store the target address in reverse order so that we can do a simple memcmp later
 648:bluetooth_rxtx.c **** 		le.target[0] = data[5];
 649:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 650:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 651:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 652:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 653:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 654:bluetooth_rxtx.c **** 		le.target_set = 1;
 655:bluetooth_rxtx.c **** 		break;
 656:bluetooth_rxtx.c **** 
 657:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 658:bluetooth_rxtx.c **** 	case UBERTOOTH_JAM_MODE:
 659:bluetooth_rxtx.c **** 		jam_mode = request_params[0];
 660:bluetooth_rxtx.c **** 		break;
ARM GAS  /tmp/cckWTbJW.s 			page 13


 661:bluetooth_rxtx.c **** #endif
 662:bluetooth_rxtx.c **** 
 663:bluetooth_rxtx.c **** 	case UBERTOOTH_EGO:
 664:bluetooth_rxtx.c **** #ifndef TX_ENABLE
 665:bluetooth_rxtx.c **** 		if (ego_mode == EGO_JAM)
 666:bluetooth_rxtx.c **** 			return 0;
 667:bluetooth_rxtx.c **** #endif
 668:bluetooth_rxtx.c **** 		requested_mode = MODE_EGO;
 669:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 670:bluetooth_rxtx.c **** 		break;
 671:bluetooth_rxtx.c **** 
 672:bluetooth_rxtx.c **** 	default:
 673:bluetooth_rxtx.c **** 		return 0;
 674:bluetooth_rxtx.c **** 	}
 675:bluetooth_rxtx.c **** 	return 1;
 676:bluetooth_rxtx.c **** }
 677:bluetooth_rxtx.c **** 
 678:bluetooth_rxtx.c **** /* Update CLKN. */
 679:bluetooth_rxtx.c **** void TIMER0_IRQHandler()
 680:bluetooth_rxtx.c **** {
 681:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 682:bluetooth_rxtx.c **** 
 683:bluetooth_rxtx.c **** 		clkn += clkn_offset + 1;
 684:bluetooth_rxtx.c **** 		clkn_offset = 0;
 685:bluetooth_rxtx.c **** 
 686:bluetooth_rxtx.c **** 		uint32_t le_clk = (clkn - le.conn_epoch) & 0x03;
 687:bluetooth_rxtx.c **** 
 688:bluetooth_rxtx.c **** 		/* Trigger hop based on mode */
 689:bluetooth_rxtx.c **** 
 690:bluetooth_rxtx.c **** 		/* NONE or SWEEP -> 25 Hz */
 691:bluetooth_rxtx.c **** 		if (hop_mode == HOP_NONE || hop_mode == HOP_SWEEP) {
 692:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 693:bluetooth_rxtx.c **** 				do_hop = 1;
 694:bluetooth_rxtx.c **** 		}
 695:bluetooth_rxtx.c **** 		/* BLUETOOTH -> 1600 Hz */
 696:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BLUETOOTH) {
 697:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 698:bluetooth_rxtx.c **** 				do_hop = 1;
 699:bluetooth_rxtx.c **** 		}
 700:bluetooth_rxtx.c **** 		/* BLUETOOTH Low Energy -> 7.5ms - 4.0s in multiples of 1.25 ms */
 701:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BTLE) {
 702:bluetooth_rxtx.c **** 			// Only hop if connected
 703:bluetooth_rxtx.c **** 			if (le.link_state == LINK_CONNECTED && le_clk == 0) {
 704:bluetooth_rxtx.c **** 				--le.interval_timer;
 705:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 706:bluetooth_rxtx.c **** 					do_hop = 1;
 707:bluetooth_rxtx.c **** 					++le.conn_count;
 708:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 709:bluetooth_rxtx.c **** 				} else {
 710:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 711:bluetooth_rxtx.c **** 				}
 712:bluetooth_rxtx.c **** 			}
 713:bluetooth_rxtx.c **** 		}
 714:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_AFH) {
 715:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 716:bluetooth_rxtx.c **** 				do_hop = 1;
 717:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/cckWTbJW.s 			page 14


 718:bluetooth_rxtx.c **** 		}
 719:bluetooth_rxtx.c **** 
 720:bluetooth_rxtx.c **** 		// Fix linear clock drift deviation
 721:bluetooth_rxtx.c **** 		if(clkn_next_drift_fix != 0 && clk100ns_offset == 0) {
 722:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 723:bluetooth_rxtx.c **** 
 724:bluetooth_rxtx.c **** 				// Too fast
 725:bluetooth_rxtx.c **** 				if(clk_drift_ppm >= 0) {
 726:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 727:bluetooth_rxtx.c **** 				}
 728:bluetooth_rxtx.c **** 
 729:bluetooth_rxtx.c **** 				// Too slow
 730:bluetooth_rxtx.c **** 				else {
 731:bluetooth_rxtx.c **** 					clk100ns_offset = 6249;
 732:bluetooth_rxtx.c **** 				}
 733:bluetooth_rxtx.c **** 				clkn_last_drift_fix = clkn;
 734:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 735:bluetooth_rxtx.c **** 			}
 736:bluetooth_rxtx.c **** 		}
 737:bluetooth_rxtx.c **** 
 738:bluetooth_rxtx.c **** 		// Negative clock correction
 739:bluetooth_rxtx.c **** 		if(clk100ns_offset > 3124)
 740:bluetooth_rxtx.c **** 			clkn += 2;
 741:bluetooth_rxtx.c **** 
 742:bluetooth_rxtx.c **** 		T0MR0 = 3124 + clk100ns_offset;
 743:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 744:bluetooth_rxtx.c **** 
 745:bluetooth_rxtx.c **** 		/* Ack interrupt */
 746:bluetooth_rxtx.c **** 		T0IR = TIR_MR0_Interrupt;
 747:bluetooth_rxtx.c **** 	}
 748:bluetooth_rxtx.c **** }
 749:bluetooth_rxtx.c **** 
 750:bluetooth_rxtx.c **** /* EINT3 handler is also defined in ubertooth.c for TC13BADGE. */
 751:bluetooth_rxtx.c **** #ifndef TC13BADGE
 752:bluetooth_rxtx.c **** void EINT3_IRQHandler()
 753:bluetooth_rxtx.c **** {
 754:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 755:bluetooth_rxtx.c **** 	IO2IntClr   = PIN_GIO6; // clear interrupt
 756:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 757:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 758:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 759:bluetooth_rxtx.c **** 		dma_discard = 0;
 760:bluetooth_rxtx.c **** 
 761:bluetooth_rxtx.c **** }
 762:bluetooth_rxtx.c **** #endif // TC13BADGE
 763:bluetooth_rxtx.c **** 
 764:bluetooth_rxtx.c **** /*
 765:bluetooth_rxtx.c ****  * Sleep (busy wait) for 'millis' milliseconds
 766:bluetooth_rxtx.c ****  * Needs clkn. Be sure to call clkn_init() before using it.
 767:bluetooth_rxtx.c ****  */
 768:bluetooth_rxtx.c **** static void msleep(uint32_t millis)
 769:bluetooth_rxtx.c **** {
 770:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
 771:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 772:bluetooth_rxtx.c **** 
 773:bluetooth_rxtx.c **** 	// handle clkn overflow
 774:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
ARM GAS  /tmp/cckWTbJW.s 			page 15


 775:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
 776:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now || (clkn & 0xffffff) < stop_at);
 777:bluetooth_rxtx.c **** 	} else {
 778:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) < stop_at);
 779:bluetooth_rxtx.c **** 	}
 780:bluetooth_rxtx.c **** }
 781:bluetooth_rxtx.c **** 
 782:bluetooth_rxtx.c **** void DMA_IRQHandler()
 783:bluetooth_rxtx.c **** {
 784:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 785:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 786:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 787:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 788:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 789:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 790:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 791:bluetooth_rxtx.c **** 	{
 792:bluetooth_rxtx.c **** 		/* interrupt on channel 0 */
 793:bluetooth_rxtx.c **** 		if (DMACIntStat & (1 << 0)) {
 794:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 795:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 796:bluetooth_rxtx.c **** 
 797:bluetooth_rxtx.c **** 				if (hop_mode == HOP_BLUETOOTH)
 798:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 799:bluetooth_rxtx.c **** 
 800:bluetooth_rxtx.c **** 				idle_buf_clk100ns  = CLK100NS;
 801:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 802:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 803:bluetooth_rxtx.c **** 
 804:bluetooth_rxtx.c **** 				/* Keep buffer swapping in sync with DMA. */
 805:bluetooth_rxtx.c **** 				volatile uint8_t* tmp = active_rxbuf;
 806:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 807:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 808:bluetooth_rxtx.c **** 
 809:bluetooth_rxtx.c **** 				++rx_tc;
 810:bluetooth_rxtx.c **** 			}
 811:bluetooth_rxtx.c **** 			if (DMACIntErrStat & (1 << 0)) {
 812:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 813:bluetooth_rxtx.c **** 				++rx_err;
 814:bluetooth_rxtx.c **** 			}
 815:bluetooth_rxtx.c **** 		}
 816:bluetooth_rxtx.c **** 	}
 817:bluetooth_rxtx.c **** }
 818:bluetooth_rxtx.c **** 
 819:bluetooth_rxtx.c **** static void cc2400_idle()
 820:bluetooth_rxtx.c **** {
 821:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 822:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 823:bluetooth_rxtx.c **** 
 824:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 825:bluetooth_rxtx.c **** 	PAEN_CLR;
 826:bluetooth_rxtx.c **** 	HGM_CLR;
 827:bluetooth_rxtx.c **** #endif
 828:bluetooth_rxtx.c **** 
 829:bluetooth_rxtx.c **** 	RXLED_CLR;
 830:bluetooth_rxtx.c **** 	TXLED_CLR;
 831:bluetooth_rxtx.c **** 	USRLED_CLR;
ARM GAS  /tmp/cckWTbJW.s 			page 16


 832:bluetooth_rxtx.c **** 
 833:bluetooth_rxtx.c **** 	clkn_stop();
 834:bluetooth_rxtx.c **** 	dio_ssp_stop();
 835:bluetooth_rxtx.c **** 	cs_reset();
 836:bluetooth_rxtx.c **** 	rssi_reset();
 837:bluetooth_rxtx.c **** 
 838:bluetooth_rxtx.c **** 	/* hopping stuff */
 839:bluetooth_rxtx.c **** 	hop_mode = HOP_NONE;
 840:bluetooth_rxtx.c **** 	do_hop = 0;
 841:bluetooth_rxtx.c **** 	channel = 2441;
 842:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 843:bluetooth_rxtx.c **** 	hop_timeout = 158;
 844:bluetooth_rxtx.c **** 	requested_channel = 0;
 845:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 846:bluetooth_rxtx.c **** 
 847:bluetooth_rxtx.c **** 
 848:bluetooth_rxtx.c **** 	/* bulk USB stuff */
 849:bluetooth_rxtx.c **** 	idle_buf_clkn_high = 0;
 850:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 851:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 852:bluetooth_rxtx.c **** 	dma_discard = 0;
 853:bluetooth_rxtx.c **** 	status = 0;
 854:bluetooth_rxtx.c **** 
 855:bluetooth_rxtx.c **** 	/* operation mode */
 856:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 857:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 858:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 859:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 860:bluetooth_rxtx.c **** 
 861:bluetooth_rxtx.c **** 	modulation = MOD_BT_BASIC_RATE;
 862:bluetooth_rxtx.c **** 
 863:bluetooth_rxtx.c **** 	/* specan stuff */
 864:bluetooth_rxtx.c **** 	low_freq = 2400;
 865:bluetooth_rxtx.c **** 	high_freq = 2483;
 866:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 867:bluetooth_rxtx.c **** 
 868:bluetooth_rxtx.c **** 	target.address = 0;
 869:bluetooth_rxtx.c **** 	target.syncword = 0;
 870:bluetooth_rxtx.c **** }
 871:bluetooth_rxtx.c **** 
 872:bluetooth_rxtx.c **** /* start un-buffered rx */
 873:bluetooth_rxtx.c **** static void cc2400_rx()
 874:bluetooth_rxtx.c **** {
 875:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 876:bluetooth_rxtx.c **** 
 877:bluetooth_rxtx.c **** 	if((modulation == MOD_BT_BASIC_RATE) || (modulation == MOD_BT_LOW_ENERGY)) {
 878:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 879:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 880:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 881:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 882:bluetooth_rxtx.c **** 		}
 883:bluetooth_rxtx.c **** 		cc2400_set(MANAND,  0x7fff);
 884:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 885:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 886:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 887:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 888:bluetooth_rxtx.c **** 		//      |  | |   |  +--------> CRC off
ARM GAS  /tmp/cckWTbJW.s 			page 17


 889:bluetooth_rxtx.c **** 		//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
 890:bluetooth_rxtx.c **** 		//      |  | +---------------> 2 preamble bytes of 01010101
 891:bluetooth_rxtx.c **** 		//      |  +-----------------> not packet mode
 892:bluetooth_rxtx.c **** 			//      +--------------------> un-buffered mode
 893:bluetooth_rxtx.c **** 		cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 894:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 895:bluetooth_rxtx.c **** 	}
 896:bluetooth_rxtx.c **** 
 897:bluetooth_rxtx.c **** 	// Set up CS register
 898:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
 899:bluetooth_rxtx.c **** 
 900:bluetooth_rxtx.c **** 	clkn_start();
 901:bluetooth_rxtx.c **** 
 902:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 903:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 904:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 905:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 906:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 907:bluetooth_rxtx.c **** 	PAEN_SET;
 908:bluetooth_rxtx.c **** 	HGM_SET;
 909:bluetooth_rxtx.c **** #endif
 910:bluetooth_rxtx.c **** }
 911:bluetooth_rxtx.c **** 
 912:bluetooth_rxtx.c **** /* start un-buffered rx */
 913:bluetooth_rxtx.c **** static void cc2400_rx_sync(u32 sync)
 914:bluetooth_rxtx.c **** {
 915:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 916:bluetooth_rxtx.c **** 
 917:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
 918:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 919:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 920:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 921:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 922:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 923:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 0 preamble bytes of 01010101
 924:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 925:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 926:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
 927:bluetooth_rxtx.c **** 
 928:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 929:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 930:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 931:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 932:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 933:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 934:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 2 preamble bytes of 01010101
 935:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 936:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 937:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
 938:bluetooth_rxtx.c **** 
 939:bluetooth_rxtx.c **** 	} else {
 940:bluetooth_rxtx.c **** 		/* oops */
 941:bluetooth_rxtx.c **** 		return;
 942:bluetooth_rxtx.c **** 	}
 943:bluetooth_rxtx.c **** 
 944:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
 945:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
ARM GAS  /tmp/cckWTbJW.s 			page 18


 946:bluetooth_rxtx.c **** 
 947:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x124b);
 948:bluetooth_rxtx.c **** 	// 1      2      4b
 949:bluetooth_rxtx.c **** 	// 00 0 1 0 0 10 01001011
 950:bluetooth_rxtx.c **** 	//    | | | | |  +---------> AFC_DELTA = ??
 951:bluetooth_rxtx.c **** 	//    | | | | +------------> AFC settling = 4 pairs (8 bit preamble)
 952:bluetooth_rxtx.c **** 	//    | | | +--------------> no AFC adjust on packet
 953:bluetooth_rxtx.c **** 	//    | | +----------------> do not invert data
 954:bluetooth_rxtx.c **** 	//    | +------------------> TX IF freq 1 0Hz
 955:bluetooth_rxtx.c **** 	//    +--------------------> PRNG off
 956:bluetooth_rxtx.c **** 	//
 957:bluetooth_rxtx.c **** 	// ref: CC2400 datasheet page 67
 958:bluetooth_rxtx.c **** 	// AFC settling explained page 41/42
 959:bluetooth_rxtx.c **** 
 960:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   grmdm);
 961:bluetooth_rxtx.c **** 
 962:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
 963:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 964:bluetooth_rxtx.c **** 
 965:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 966:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 967:bluetooth_rxtx.c **** 
 968:bluetooth_rxtx.c **** 	// Set up CS register
 969:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
 970:bluetooth_rxtx.c **** 
 971:bluetooth_rxtx.c **** 	clkn_start();
 972:bluetooth_rxtx.c **** 
 973:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 974:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 975:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 976:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 977:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 978:bluetooth_rxtx.c **** 	PAEN_SET;
 979:bluetooth_rxtx.c **** 	HGM_SET;
 980:bluetooth_rxtx.c **** #endif
 981:bluetooth_rxtx.c **** }
 982:bluetooth_rxtx.c **** 
 983:bluetooth_rxtx.c **** /* start buffered tx */
 984:bluetooth_rxtx.c **** static void cc2400_tx_sync(uint32_t sync)
 985:bluetooth_rxtx.c **** {
 986:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 987:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
 988:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
 989:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 990:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 991:bluetooth_rxtx.c **** 
 992:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
 993:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 994:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
 995:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
 996:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
 997:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
 998:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
 999:bluetooth_rxtx.c **** 
1000:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1001:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1002:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 19


1003:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1004:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1005:bluetooth_rxtx.c **** 
1006:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
1007:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
1008:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1009:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1010:bluetooth_rxtx.c **** 	} else {
1011:bluetooth_rxtx.c **** 		/* oops */
1012:bluetooth_rxtx.c **** 		return;
1013:bluetooth_rxtx.c **** 	}
1014:bluetooth_rxtx.c **** 
1015:bluetooth_rxtx.c **** 	clkn_start();
1016:bluetooth_rxtx.c **** 
1017:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1018:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1019:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1020:bluetooth_rxtx.c **** 
1021:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1022:bluetooth_rxtx.c **** 	PAEN_SET;
1023:bluetooth_rxtx.c **** #endif
1024:bluetooth_rxtx.c **** 
1025:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1026:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1027:bluetooth_rxtx.c **** 
1028:bluetooth_rxtx.c **** #endif
1029:bluetooth_rxtx.c **** }
1030:bluetooth_rxtx.c **** 
1031:bluetooth_rxtx.c **** /*
1032:bluetooth_rxtx.c ****  * Transmit a BTLE packet with the specified access address.
1033:bluetooth_rxtx.c ****  *
1034:bluetooth_rxtx.c ****  * All modulation parameters are set within this function. The data
1035:bluetooth_rxtx.c ****  * should not be pre-whitened, but the CRC should be calculated and
1036:bluetooth_rxtx.c ****  * included in the data length.
1037:bluetooth_rxtx.c ****  */
1038:bluetooth_rxtx.c **** void le_transmit(u32 aa, u8 len, u8 *data)
1039:bluetooth_rxtx.c **** {
1040:bluetooth_rxtx.c **** 	unsigned i, j;
1041:bluetooth_rxtx.c **** 	int bit;
1042:bluetooth_rxtx.c **** 	u8 txbuf[64];
1043:bluetooth_rxtx.c **** 	u8 tx_len;
1044:bluetooth_rxtx.c **** 	u8 byte;
1045:bluetooth_rxtx.c **** 	u16 gio_save;
1046:bluetooth_rxtx.c **** 
1047:bluetooth_rxtx.c **** 	// first four bytes: AA
1048:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
1049:bluetooth_rxtx.c **** 		byte = aa & 0xff;
1050:bluetooth_rxtx.c **** 		aa >>= 8;
1051:bluetooth_rxtx.c **** 		txbuf[i] = 0;
1052:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1053:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
1054:bluetooth_rxtx.c **** 			byte >>= 1;
1055:bluetooth_rxtx.c **** 		}
1056:bluetooth_rxtx.c **** 	}
1057:bluetooth_rxtx.c **** 
1058:bluetooth_rxtx.c **** 	// whiten the data and copy it into the txbuf
1059:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
ARM GAS  /tmp/cckWTbJW.s 			page 20


1060:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
1061:bluetooth_rxtx.c **** 		byte = data[i];
1062:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
1063:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1064:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
1065:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
1066:bluetooth_rxtx.c **** 			byte >>= 1;
1067:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
1068:bluetooth_rxtx.c **** 		}
1069:bluetooth_rxtx.c **** 	}
1070:bluetooth_rxtx.c **** 
1071:bluetooth_rxtx.c **** 	len += 4; // include the AA in len
1072:bluetooth_rxtx.c **** 
1073:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1074:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1075:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1076:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1077:bluetooth_rxtx.c **** 
1078:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1079:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1080:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1081:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1082:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1083:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1084:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1085:bluetooth_rxtx.c **** 
1086:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1087:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1088:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1089:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1090:bluetooth_rxtx.c **** 
1091:bluetooth_rxtx.c **** 	// sync byte depends on the first transmitted bit of the AA
1092:bluetooth_rxtx.c **** 	if (aa & 1)
1093:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
1094:bluetooth_rxtx.c **** 	else
1095:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0x5555);
1096:bluetooth_rxtx.c **** 
1097:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1098:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1099:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1100:bluetooth_rxtx.c **** 
1101:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1102:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1103:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1104:bluetooth_rxtx.c **** 	TXLED_SET;
1105:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1106:bluetooth_rxtx.c **** 	PAEN_SET;
1107:bluetooth_rxtx.c **** #endif
1108:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1109:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1110:bluetooth_rxtx.c **** 
1111:bluetooth_rxtx.c **** 	// put the packet into the FIFO
1112:bluetooth_rxtx.c **** 	/*
1113:bluetooth_rxtx.c **** 	for (i = 0; i < len; i += 16) {
1114:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
1115:bluetooth_rxtx.c **** 		tx_len = len - i;
1116:bluetooth_rxtx.c **** 		if (tx_len >16)
ARM GAS  /tmp/cckWTbJW.s 			page 21


1117:bluetooth_rxtx.c **** 			tx_len = 16;
1118:bluetooth_rxtx.c **** 		cc2400_fifo_write(tx_len, txbuf + i);
1119:bluetooth_rxtx.c **** 	}*/
1120:bluetooth_rxtx.c **** 
1121:bluetooth_rxtx.c **** 	while (GIO6) ;
1122:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
1123:bluetooth_rxtx.c **** 
1124:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1125:bluetooth_rxtx.c **** 	TXLED_CLR;
1126:bluetooth_rxtx.c **** 
1127:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1128:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
1129:bluetooth_rxtx.c **** 
1130:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1131:bluetooth_rxtx.c **** 	PAEN_CLR;
1132:bluetooth_rxtx.c **** #endif
1133:bluetooth_rxtx.c **** 
1134:bluetooth_rxtx.c **** 	// reset GIO
1135:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1136:bluetooth_rxtx.c **** }
1137:bluetooth_rxtx.c **** 
1138:bluetooth_rxtx.c **** void le_jam(void) {
1139:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1140:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1141:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1142:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
1143:bluetooth_rxtx.c **** 
1144:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1145:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1146:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1147:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1148:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1149:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1150:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1151:bluetooth_rxtx.c **** 
1152:bluetooth_rxtx.c **** 	// cc2400_set(FSDIV,   channel);
1153:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1154:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1155:bluetooth_rxtx.c **** 
1156:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1157:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1158:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1159:bluetooth_rxtx.c **** 	TXLED_SET;
1160:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1161:bluetooth_rxtx.c **** 	PAEN_SET;
1162:bluetooth_rxtx.c **** #endif
1163:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1164:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1165:bluetooth_rxtx.c **** #endif
1166:bluetooth_rxtx.c **** }
1167:bluetooth_rxtx.c **** 
1168:bluetooth_rxtx.c **** /* TODO - return whether hop happened, or should caller have to keep
1169:bluetooth_rxtx.c ****  * track of this? */
1170:bluetooth_rxtx.c **** void hop(void)
1171:bluetooth_rxtx.c **** {
1172:bluetooth_rxtx.c **** 	do_hop = 0;
1173:bluetooth_rxtx.c **** 	last_hop = clkn;
ARM GAS  /tmp/cckWTbJW.s 			page 22


1174:bluetooth_rxtx.c **** 
1175:bluetooth_rxtx.c **** 	// No hopping, if channel is set correctly, do nothing
1176:bluetooth_rxtx.c **** 	if (hop_mode == HOP_NONE) {
1177:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
1178:bluetooth_rxtx.c **** 			return;
1179:bluetooth_rxtx.c **** 	}
1180:bluetooth_rxtx.c **** 	/* Slow sweep (100 hops/sec)
1181:bluetooth_rxtx.c **** 	 * only hop to currently used channels if AFH is enabled
1182:bluetooth_rxtx.c **** 	 */
1183:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_SWEEP) {
1184:bluetooth_rxtx.c **** 		do {
1185:bluetooth_rxtx.c **** 			channel += 32;
1186:bluetooth_rxtx.c **** 			if (channel > 2480)
1187:bluetooth_rxtx.c **** 				channel -= 79;
1188:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
1189:bluetooth_rxtx.c **** 	}
1190:bluetooth_rxtx.c **** 
1191:bluetooth_rxtx.c **** 	/* AFH detection
1192:bluetooth_rxtx.c **** 	 * only hop to currently unused channesl
1193:bluetooth_rxtx.c **** 	 */
1194:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_AFH) {
1195:bluetooth_rxtx.c **** 		do {
1196:bluetooth_rxtx.c **** 			channel += 32;
1197:bluetooth_rxtx.c **** 			if (channel > 2480)
1198:bluetooth_rxtx.c **** 				channel -= 79;
1199:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
1200:bluetooth_rxtx.c **** 	}
1201:bluetooth_rxtx.c **** 
1202:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BLUETOOTH) {
1203:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
1204:bluetooth_rxtx.c **** 	}
1205:bluetooth_rxtx.c **** 
1206:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BTLE) {
1207:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
1208:bluetooth_rxtx.c **** 	}
1209:bluetooth_rxtx.c **** 
1210:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_DIRECT) {
1211:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
1212:bluetooth_rxtx.c **** 	}
1213:bluetooth_rxtx.c **** 	/* IDLE mode, but leave amp on, so don't call cc2400_idle(). */
1214:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1215:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1216:bluetooth_rxtx.c **** 
1217:bluetooth_rxtx.c **** 	/* Retune */
1218:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1219:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
1220:bluetooth_rxtx.c **** 	else
1221:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel - 1);
1222:bluetooth_rxtx.c **** 
1223:bluetooth_rxtx.c **** 	/* Update CS register if hopping.  */
1224:bluetooth_rxtx.c **** 	if (hop_mode > 0) {
1225:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
1226:bluetooth_rxtx.c **** 	}
1227:bluetooth_rxtx.c **** 
1228:bluetooth_rxtx.c **** 	/* Wait for lock */
1229:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1230:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
ARM GAS  /tmp/cckWTbJW.s 			page 23


1231:bluetooth_rxtx.c **** 
1232:bluetooth_rxtx.c **** 	dma_discard = 1;
1233:bluetooth_rxtx.c **** 
1234:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1235:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1236:bluetooth_rxtx.c **** 	else
1237:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
1238:bluetooth_rxtx.c **** }
1239:bluetooth_rxtx.c **** 
1240:bluetooth_rxtx.c **** /* Bluetooth packet monitoring */
1241:bluetooth_rxtx.c **** void bt_stream_rx()
1242:bluetooth_rxtx.c **** {
1243:bluetooth_rxtx.c **** 	int8_t rssi;
1244:bluetooth_rxtx.c **** 	int8_t rssi_at_trigger;
1245:bluetooth_rxtx.c **** 
1246:bluetooth_rxtx.c **** 	RXLED_CLR;
1247:bluetooth_rxtx.c **** 
1248:bluetooth_rxtx.c **** 	queue_init();
1249:bluetooth_rxtx.c **** 	dio_ssp_init();
1250:bluetooth_rxtx.c **** 	dma_init();
1251:bluetooth_rxtx.c **** 	dio_ssp_start();
1252:bluetooth_rxtx.c **** 
1253:bluetooth_rxtx.c **** 	cc2400_rx();
1254:bluetooth_rxtx.c **** 
1255:bluetooth_rxtx.c **** 	cs_trigger_enable();
1256:bluetooth_rxtx.c **** 
1257:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_RX_SYMBOLS || requested_mode == MODE_BT_FOLLOW )
1258:bluetooth_rxtx.c **** 	{
1259:bluetooth_rxtx.c **** 
1260:bluetooth_rxtx.c **** 		RXLED_CLR;
1261:bluetooth_rxtx.c **** 
1262:bluetooth_rxtx.c **** 		/* Wait for DMA transfer. TODO - need more work on
1263:bluetooth_rxtx.c **** 		 * RSSI. Should send RSSI indications to host even
1264:bluetooth_rxtx.c **** 		 * when not transferring data. That would also keep
1265:bluetooth_rxtx.c **** 		 * the USB stream going. This loop runs 50-80 times
1266:bluetooth_rxtx.c **** 		 * while waiting for DMA, but RSSI sampling does not
1267:bluetooth_rxtx.c **** 		 * cover all the symbols in a DMA transfer. Can not do
1268:bluetooth_rxtx.c **** 		 * RSSI sampling in CS interrupt, but could log time
1269:bluetooth_rxtx.c **** 		 * at multiple trigger points there. The MAX() below
1270:bluetooth_rxtx.c **** 		 * helps with statistics in the case that cs_trigger
1271:bluetooth_rxtx.c **** 		 * happened before the loop started. */
1272:bluetooth_rxtx.c **** 		rssi_reset();
1273:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1274:bluetooth_rxtx.c **** 		while (!rx_tc) {
1275:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1276:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1277:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1278:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1279:bluetooth_rxtx.c **** 			}
1280:bluetooth_rxtx.c **** 			rssi_add(rssi);
1281:bluetooth_rxtx.c **** 
1282:bluetooth_rxtx.c **** 			handle_usb(clkn);
1283:bluetooth_rxtx.c **** 
1284:bluetooth_rxtx.c **** 			/* If timer says time to hop, do it. */
1285:bluetooth_rxtx.c **** 			if (do_hop) {
1286:bluetooth_rxtx.c **** 				hop();
1287:bluetooth_rxtx.c **** 			} else {
ARM GAS  /tmp/cckWTbJW.s 			page 24


1288:bluetooth_rxtx.c **** 				TXLED_CLR;
1289:bluetooth_rxtx.c **** 			}
1290:bluetooth_rxtx.c **** 			/* TODO - set per-channel carrier sense threshold.
1291:bluetooth_rxtx.c **** 			 * Set by firmware or host. */
1292:bluetooth_rxtx.c **** 		}
1293:bluetooth_rxtx.c **** 
1294:bluetooth_rxtx.c **** 		RXLED_SET;
1295:bluetooth_rxtx.c **** 
1296:bluetooth_rxtx.c **** 		if (rx_err) {
1297:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1298:bluetooth_rxtx.c **** 		}
1299:bluetooth_rxtx.c **** 
1300:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1301:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1302:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1303:bluetooth_rxtx.c **** 
1304:bluetooth_rxtx.c **** 		if (dma_discard) {
1305:bluetooth_rxtx.c **** 			status |= DISCARD;
1306:bluetooth_rxtx.c **** 			dma_discard = 0;
1307:bluetooth_rxtx.c **** 		}
1308:bluetooth_rxtx.c **** 
1309:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1310:bluetooth_rxtx.c **** 
1311:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1312:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1313:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1314:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1315:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1316:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1317:bluetooth_rxtx.c **** 			cs_trigger = 0;
1318:bluetooth_rxtx.c **** 		}
1319:bluetooth_rxtx.c **** 
1320:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1321:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1322:bluetooth_rxtx.c **** 		}
1323:bluetooth_rxtx.c **** 
1324:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, (uint8_t*)idle_rxbuf);
1325:bluetooth_rxtx.c **** 
1326:bluetooth_rxtx.c **** 		handle_usb(clkn);
1327:bluetooth_rxtx.c **** 		rx_tc = 0;
1328:bluetooth_rxtx.c **** 		rx_err = 0;
1329:bluetooth_rxtx.c **** 	}
1330:bluetooth_rxtx.c **** 
1331:bluetooth_rxtx.c **** 	/* This call is a nop so far. Since bt_rx_stream() starts the
1332:bluetooth_rxtx.c **** 	 * stream, it makes sense that it would stop it. TODO - how
1333:bluetooth_rxtx.c **** 	 * should setup/teardown be handled? Should every new mode be
1334:bluetooth_rxtx.c **** 	 * starting from scratch? */
1335:bluetooth_rxtx.c **** 	dio_ssp_stop();
1336:bluetooth_rxtx.c **** 	cs_trigger_disable();
1337:bluetooth_rxtx.c **** }
1338:bluetooth_rxtx.c **** 
1339:bluetooth_rxtx.c **** static uint8_t reverse8(uint8_t data)
1340:bluetooth_rxtx.c **** {
  26              		.loc 1 1340 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/cckWTbJW.s 			page 25


  30              	.LVL0:
  31 0000 10B5     		push	{r4, lr}
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 4, -8
  34              		.cfi_offset 14, -4
  35              	.LVL1:
  36              	.LBB4:
1341:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
1342:bluetooth_rxtx.c **** 
1343:bluetooth_rxtx.c **** 	for(size_t i=0; i<8; i++)
  37              		.loc 1 1343 0
  38 0002 0023     		movs	r3, #0
  39              	.LBE4:
1341:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
  40              		.loc 1 1341 0
  41 0004 1A46     		mov	r2, r3
  42              	.LVL2:
  43              	.L3:
  44              	.LBB5:
1344:bluetooth_rxtx.c **** 	{
1345:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (7-i);
  45              		.loc 1 1345 0 discriminator 2
  46 0006 40FA03F1 		asr	r1, r0, r3
  47 000a C3F10704 		rsb	r4, r3, #7
  48 000e 01F00101 		and	r1, r1, #1
  49 0012 A140     		lsls	r1, r1, r4
1343:bluetooth_rxtx.c **** 	{
  50              		.loc 1 1343 0 discriminator 2
  51 0014 0133     		adds	r3, r3, #1
  52              	.LVL3:
  53              		.loc 1 1345 0 discriminator 2
  54 0016 0A43     		orrs	r2, r2, r1
  55              	.LVL4:
1343:bluetooth_rxtx.c **** 	{
  56              		.loc 1 1343 0 discriminator 2
  57 0018 082B     		cmp	r3, #8
  58              		.loc 1 1345 0 discriminator 2
  59 001a D2B2     		uxtb	r2, r2
  60              	.LVL5:
1343:bluetooth_rxtx.c **** 	{
  61              		.loc 1 1343 0 discriminator 2
  62 001c F3D1     		bne	.L3
  63              	.LBE5:
1346:bluetooth_rxtx.c **** 	}
1347:bluetooth_rxtx.c **** 
1348:bluetooth_rxtx.c **** 	return reversed;
1349:bluetooth_rxtx.c **** }
  64              		.loc 1 1349 0
  65 001e 1046     		mov	r0, r2
  66              	.LVL6:
  67 0020 10BD     		pop	{r4, pc}
  68              		.cfi_endproc
  69              	.LFE15:
  71              		.section	.text.cc2400_rx,"ax",%progbits
  72              		.align	1
  73              		.thumb
  74              		.thumb_func
ARM GAS  /tmp/cckWTbJW.s 			page 26


  76              	cc2400_rx:
  77              	.LFB8:
 874:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
  78              		.loc 1 874 0
  79              		.cfi_startproc
  80              		@ args = 0, pretend = 0, frame = 0
  81              		@ frame_needed = 0, uses_anonymous_args = 0
  82 0000 38B5     		push	{r3, r4, r5, lr}
  83              		.cfi_def_cfa_offset 16
  84              		.cfi_offset 3, -16
  85              		.cfi_offset 4, -12
  86              		.cfi_offset 5, -8
  87              		.cfi_offset 14, -4
  88              	.LVL7:
 877:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
  89              		.loc 1 877 0
  90 0002 254B     		ldr	r3, .L19
  91 0004 254C     		ldr	r4, .L19+4
  92 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  93 0008 12B1     		cbz	r2, .L7
 877:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
  94              		.loc 1 877 0 is_stmt 0 discriminator 1
  95 000a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  96 000c 012A     		cmp	r2, #1
  97 000e 28D1     		bne	.L8
  98              	.L7:
 878:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
  99              		.loc 1 878 0 is_stmt 1
 100 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 101 0012 33B1     		cbz	r3, .L14
 880:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 102              		.loc 1 880 0
 103 0014 204B     		ldr	r3, .L19
 104 0016 1D78     		ldrb	r5, [r3]	@ zero_extendqisi2
 875:bluetooth_rxtx.c **** 
 105              		.loc 1 875 0
 106 0018 012D     		cmp	r5, #1
 107 001a 0CBF     		ite	eq
 108 001c 4025     		moveq	r5, #64
 109 001e 0025     		movne	r5, #0
 110 0020 00E0     		b	.L9
 111              	.L14:
 879:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 112              		.loc 1 879 0
 113 0022 2925     		movs	r5, #41
 114              	.L9:
 115              	.LVL8:
 883:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 116              		.loc 1 883 0
 117 0024 0D20     		movs	r0, #13
 118 0026 47F6FF71 		movw	r1, #32767
 119 002a FFF7FEFF 		bl	cc2400_set
 120              	.LVL9:
 884:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 121              		.loc 1 884 0
 122 002e 1220     		movs	r0, #18
 123 0030 42F62231 		movw	r1, #11042
ARM GAS  /tmp/cckWTbJW.s 			page 27


 124 0034 FFF7FEFF 		bl	cc2400_set
 125              	.LVL10:
 885:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 126              		.loc 1 885 0
 127 0038 1420     		movs	r0, #20
 128 003a 41F24B31 		movw	r1, #4939
 129 003e FFF7FEFF 		bl	cc2400_set
 130              	.LVL11:
 886:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 131              		.loc 1 886 0
 132 0042 2020     		movs	r0, #32
 133 0044 40F20111 		movw	r1, #257
 134 0048 FFF7FEFF 		bl	cc2400_set
 135              	.LVL12:
 893:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 136              		.loc 1 893 0
 137 004c 2188     		ldrh	r1, [r4]
 138 004e 0220     		movs	r0, #2
 139 0050 89B2     		uxth	r1, r1
 140 0052 0139     		subs	r1, r1, #1
 141 0054 89B2     		uxth	r1, r1
 142 0056 FFF7FEFF 		bl	cc2400_set
 143              	.LVL13:
 894:bluetooth_rxtx.c **** 	}
 144              		.loc 1 894 0
 145 005a 0320     		movs	r0, #3
 146 005c 2946     		mov	r1, r5
 147 005e FFF7FEFF 		bl	cc2400_set
 148              	.LVL14:
 149              	.L8:
 898:bluetooth_rxtx.c **** 
 150              		.loc 1 898 0
 151 0062 2088     		ldrh	r0, [r4]
 152 0064 80B2     		uxth	r0, r0
 153 0066 FFF7FEFF 		bl	cs_threshold_calc_and_set
 154              	.LVL15:
 900:bluetooth_rxtx.c **** 
 155              		.loc 1 900 0
 156 006a FFF7FEFF 		bl	clkn_start
 157              	.LVL16:
 158              	.L11:
 902:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 159              		.loc 1 902 0 discriminator 1
 160 006e FFF7FEFF 		bl	cc2400_status
 161              	.LVL17:
 162 0072 4206     		lsls	r2, r0, #25
 163 0074 FBD5     		bpl	.L11
 903:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 164              		.loc 1 903 0
 165 0076 6120     		movs	r0, #97
 166 0078 FFF7FEFF 		bl	cc2400_strobe
 167              	.LVL18:
 168              	.L13:
 904:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 169              		.loc 1 904 0 discriminator 1
 170 007c FFF7FEFF 		bl	cc2400_status
 171              	.LVL19:
ARM GAS  /tmp/cckWTbJW.s 			page 28


 172 0080 4307     		lsls	r3, r0, #29
 173 0082 FBD5     		bpl	.L13
 905:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 174              		.loc 1 905 0
 175 0084 6220     		movs	r0, #98
 176 0086 FFF7FEFF 		bl	cc2400_strobe
 177              	.LVL20:
 907:bluetooth_rxtx.c **** 	HGM_SET;
 178              		.loc 1 907 0
 179 008a 054B     		ldr	r3, .L19+8
 180 008c 8022     		movs	r2, #128
 181 008e 1A60     		str	r2, [r3]
 908:bluetooth_rxtx.c **** #endif
 182              		.loc 1 908 0
 183 0090 4FF48072 		mov	r2, #256
 184 0094 1A60     		str	r2, [r3]
 185 0096 38BD     		pop	{r3, r4, r5, pc}
 186              	.L20:
 187              		.align	2
 188              	.L19:
 189 0098 00000000 		.word	.LANCHOR0
 190 009c 00000000 		.word	.LANCHOR1
 191 00a0 58C00920 		.word	537509976
 192              		.cfi_endproc
 193              	.LFE8:
 195              		.section	.text.cc2400_rx_sync,"ax",%progbits
 196              		.align	1
 197              		.thumb
 198              		.thumb_func
 200              	cc2400_rx_sync:
 201              	.LFB9:
 914:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 202              		.loc 1 914 0
 203              		.cfi_startproc
 204              		@ args = 0, pretend = 0, frame = 0
 205              		@ frame_needed = 0, uses_anonymous_args = 0
 206              	.LVL21:
 207 0000 70B5     		push	{r4, r5, r6, lr}
 208              		.cfi_def_cfa_offset 16
 209              		.cfi_offset 4, -16
 210              		.cfi_offset 5, -12
 211              		.cfi_offset 6, -8
 212              		.cfi_offset 14, -4
 917:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 213              		.loc 1 917 0
 214 0002 284B     		ldr	r3, .L29
 914:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 215              		.loc 1 914 0
 216 0004 0446     		mov	r4, r0
 917:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 217              		.loc 1 917 0
 218 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 219 0008 32B1     		cbz	r2, .L28
 928:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 220              		.loc 1 928 0
 221 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 222 000c 012B     		cmp	r3, #1
ARM GAS  /tmp/cckWTbJW.s 			page 29


 223 000e 47D1     		bne	.L21
 929:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 224              		.loc 1 929 0
 225 0010 4025     		movs	r5, #64
 930:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 226              		.loc 1 930 0
 227 0012 40F26156 		movw	r6, #1377
 228 0016 02E0     		b	.L22
 229              	.L28:
 918:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 230              		.loc 1 918 0
 231 0018 2925     		movs	r5, #41
 919:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 232              		.loc 1 919 0
 233 001a 40F26146 		movw	r6, #1121
 234              	.L22:
 235              	.LVL22:
 944:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 236              		.loc 1 944 0
 237 001e 0D20     		movs	r0, #13
 238              	.LVL23:
 239 0020 47F6FF71 		movw	r1, #32767
 240 0024 FFF7FEFF 		bl	cc2400_set
 241              	.LVL24:
 945:bluetooth_rxtx.c **** 
 242              		.loc 1 945 0
 243 0028 1220     		movs	r0, #18
 244 002a 42F62231 		movw	r1, #11042
 245 002e FFF7FEFF 		bl	cc2400_set
 246              	.LVL25:
 947:bluetooth_rxtx.c **** 	// 1      2      4b
 247              		.loc 1 947 0
 248 0032 1420     		movs	r0, #20
 249 0034 41F24B21 		movw	r1, #4683
 250 0038 FFF7FEFF 		bl	cc2400_set
 251              	.LVL26:
 960:bluetooth_rxtx.c **** 
 252              		.loc 1 960 0
 253 003c 2020     		movs	r0, #32
 254 003e 3146     		mov	r1, r6
 255 0040 FFF7FEFF 		bl	cc2400_set
 256              	.LVL27:
 962:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 257              		.loc 1 962 0
 258 0044 A1B2     		uxth	r1, r4
 259 0046 2C20     		movs	r0, #44
 260 0048 FFF7FEFF 		bl	cc2400_set
 261              	.LVL28:
 963:bluetooth_rxtx.c **** 
 262              		.loc 1 963 0
 263 004c 210C     		lsrs	r1, r4, #16
 965:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 264              		.loc 1 965 0
 265 004e 164C     		ldr	r4, .L29+4
 266              	.LVL29:
 963:bluetooth_rxtx.c **** 
 267              		.loc 1 963 0
ARM GAS  /tmp/cckWTbJW.s 			page 30


 268 0050 2D20     		movs	r0, #45
 269 0052 FFF7FEFF 		bl	cc2400_set
 270              	.LVL30:
 965:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 271              		.loc 1 965 0
 272 0056 2188     		ldrh	r1, [r4]
 273 0058 0220     		movs	r0, #2
 274 005a 89B2     		uxth	r1, r1
 275 005c 0139     		subs	r1, r1, #1
 276 005e 89B2     		uxth	r1, r1
 277 0060 FFF7FEFF 		bl	cc2400_set
 278              	.LVL31:
 966:bluetooth_rxtx.c **** 
 279              		.loc 1 966 0
 280 0064 0320     		movs	r0, #3
 281 0066 2946     		mov	r1, r5
 282 0068 FFF7FEFF 		bl	cc2400_set
 283              	.LVL32:
 969:bluetooth_rxtx.c **** 
 284              		.loc 1 969 0
 285 006c 2088     		ldrh	r0, [r4]
 286 006e 80B2     		uxth	r0, r0
 287 0070 FFF7FEFF 		bl	cs_threshold_calc_and_set
 288              	.LVL33:
 971:bluetooth_rxtx.c **** 
 289              		.loc 1 971 0
 290 0074 FFF7FEFF 		bl	clkn_start
 291              	.LVL34:
 292              	.L25:
 973:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 293              		.loc 1 973 0 discriminator 1
 294 0078 FFF7FEFF 		bl	cc2400_status
 295              	.LVL35:
 296 007c 4006     		lsls	r0, r0, #25
 297 007e FBD5     		bpl	.L25
 974:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 298              		.loc 1 974 0
 299 0080 6120     		movs	r0, #97
 300 0082 FFF7FEFF 		bl	cc2400_strobe
 301              	.LVL36:
 302              	.L27:
 975:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 303              		.loc 1 975 0 discriminator 1
 304 0086 FFF7FEFF 		bl	cc2400_status
 305              	.LVL37:
 306 008a 4107     		lsls	r1, r0, #29
 307 008c FBD5     		bpl	.L27
 976:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 308              		.loc 1 976 0
 309 008e 6220     		movs	r0, #98
 310 0090 FFF7FEFF 		bl	cc2400_strobe
 311              	.LVL38:
 978:bluetooth_rxtx.c **** 	HGM_SET;
 312              		.loc 1 978 0
 313 0094 054B     		ldr	r3, .L29+8
 314 0096 8022     		movs	r2, #128
 315 0098 1A60     		str	r2, [r3]
ARM GAS  /tmp/cckWTbJW.s 			page 31


 979:bluetooth_rxtx.c **** #endif
 316              		.loc 1 979 0
 317 009a 4FF48072 		mov	r2, #256
 318 009e 1A60     		str	r2, [r3]
 319              	.LVL39:
 320              	.L21:
 321 00a0 70BD     		pop	{r4, r5, r6, pc}
 322              	.L30:
 323 00a2 00BF     		.align	2
 324              	.L29:
 325 00a4 00000000 		.word	.LANCHOR0
 326 00a8 00000000 		.word	.LANCHOR1
 327 00ac 58C00920 		.word	537509976
 328              		.cfi_endproc
 329              	.LFE9:
 331              		.section	.text.enqueue,"ax",%progbits
 332              		.align	1
 333              		.thumb
 334              		.thumb_func
 336              	enqueue:
 337              	.LFB0:
 126:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 338              		.loc 1 126 0
 339              		.cfi_startproc
 340              		@ args = 0, pretend = 0, frame = 0
 341              		@ frame_needed = 0, uses_anonymous_args = 0
 342              	.LVL40:
 343 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 344              		.cfi_def_cfa_offset 24
 345              		.cfi_offset 3, -24
 346              		.cfi_offset 4, -20
 347              		.cfi_offset 5, -16
 348              		.cfi_offset 6, -12
 349              		.cfi_offset 7, -8
 350              		.cfi_offset 14, -4
 126:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 351              		.loc 1 126 0
 352 0002 0646     		mov	r6, r0
 353 0004 0F46     		mov	r7, r1
 127:bluetooth_rxtx.c **** 
 354              		.loc 1 127 0
 355 0006 FFF7FEFF 		bl	usb_enqueue
 356              	.LVL41:
 357 000a 1E4D     		ldr	r5, .L36
 130:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 358              		.loc 1 130 0
 359 000c 0446     		mov	r4, r0
 360 000e 20B9     		cbnz	r0, .L32
 131:bluetooth_rxtx.c **** 		return 0;
 361              		.loc 1 131 0
 362 0010 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 363 0012 43F00403 		orr	r3, r3, #4
 364 0016 6B70     		strb	r3, [r5, #1]
 132:bluetooth_rxtx.c **** 	}
 365              		.loc 1 132 0
 366 0018 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 367              	.LVL42:
ARM GAS  /tmp/cckWTbJW.s 			page 32


 368              	.L32:
 136:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 369              		.loc 1 136 0
 370 001a 042E     		cmp	r6, #4
 135:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 371              		.loc 1 135 0
 372 001c 0670     		strb	r6, [r0]
 136:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 373              		.loc 1 136 0
 374 001e 0ED1     		bne	.L34
 137:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 375              		.loc 1 137 0
 376 0020 194B     		ldr	r3, .L36+4
 138:bluetooth_rxtx.c **** 	} else {
 377              		.loc 1 138 0
 378 0022 40F63541 		movw	r1, #3125
 137:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 379              		.loc 1 137 0
 380 0026 1A68     		ldr	r2, [r3]
 381 0028 120D     		lsrs	r2, r2, #20
 382 002a C270     		strb	r2, [r0, #3]
 138:bluetooth_rxtx.c **** 	} else {
 383              		.loc 1 138 0
 384 002c 174A     		ldr	r2, .L36+8
 385 002e 1B68     		ldr	r3, [r3]
 386 0030 1268     		ldr	r2, [r2]
 387 0032 C3F31303 		ubfx	r3, r3, #0, #20
 388 0036 01FB0323 		mla	r3, r1, r3, r2
 389 003a 4360     		str	r3, [r0, #4]
 390 003c 15E0     		b	.L35
 391              	.L34:
 140:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 392              		.loc 1 140 0
 393 003e AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 394 0040 C370     		strb	r3, [r0, #3]
 141:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 395              		.loc 1 141 0
 396 0042 6B68     		ldr	r3, [r5, #4]
 397 0044 4360     		str	r3, [r0, #4]
 142:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 398              		.loc 1 142 0
 399 0046 2B89     		ldrh	r3, [r5, #8]
 400 0048 9BB2     		uxth	r3, r3
 401 004a 623B     		subs	r3, r3, #98
 402 004c 8370     		strb	r3, [r0, #2]
 143:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 403              		.loc 1 143 0
 404 004e 104B     		ldr	r3, .L36+12
 405 0050 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 406 0052 4372     		strb	r3, [r0, #9]
 144:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 407              		.loc 1 144 0
 408 0054 0F4B     		ldr	r3, .L36+16
 409 0056 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 410 0058 0372     		strb	r3, [r0, #8]
 145:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 411              		.loc 1 145 0
ARM GAS  /tmp/cckWTbJW.s 			page 33


 412 005a 2889     		ldrh	r0, [r5, #8]
 413              	.LVL43:
 414 005c 80B2     		uxth	r0, r0
 415 005e FFF7FEFF 		bl	rssi_get_avg
 416              	.LVL44:
 146:bluetooth_rxtx.c **** 	}
 417              		.loc 1 146 0
 418 0062 0D4B     		ldr	r3, .L36+20
 145:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 419              		.loc 1 145 0
 420 0064 A072     		strb	r0, [r4, #10]
 146:bluetooth_rxtx.c **** 	}
 421              		.loc 1 146 0
 422 0066 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 423 0068 E372     		strb	r3, [r4, #11]
 424              	.L35:
 149:bluetooth_rxtx.c **** 
 425              		.loc 1 149 0
 426 006a 04F10E00 		add	r0, r4, #14
 427 006e 3946     		mov	r1, r7
 428 0070 3222     		movs	r2, #50
 429 0072 FFF7FEFF 		bl	memcpy
 430              	.LVL45:
 151:bluetooth_rxtx.c **** 	status = 0;
 431              		.loc 1 151 0
 432 0076 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 154:bluetooth_rxtx.c **** }
 433              		.loc 1 154 0
 434 0078 0120     		movs	r0, #1
 151:bluetooth_rxtx.c **** 	status = 0;
 435              		.loc 1 151 0
 436 007a 6370     		strb	r3, [r4, #1]
 152:bluetooth_rxtx.c **** 
 437              		.loc 1 152 0
 438 007c 0023     		movs	r3, #0
 439 007e 6B70     		strb	r3, [r5, #1]
 155:bluetooth_rxtx.c **** 
 440              		.loc 1 155 0
 441 0080 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 442              	.LVL46:
 443              	.L37:
 444 0082 00BF     		.align	2
 445              	.L36:
 446 0084 00000000 		.word	.LANCHOR0
 447 0088 00000000 		.word	clkn
 448 008c 08400040 		.word	1073758216
 449 0090 00000000 		.word	rssi_min
 450 0094 00000000 		.word	rssi_max
 451 0098 00000000 		.word	rssi_count
 452              		.cfi_endproc
 453              	.LFE0:
 455              		.section	.text.le_set_access_address,"ax",%progbits
 456              		.align	1
 457              		.thumb
 458              		.thumb_func
 460              	le_set_access_address:
 461              	.LFB18:
ARM GAS  /tmp/cckWTbJW.s 			page 34


1350:bluetooth_rxtx.c **** 
1351:bluetooth_rxtx.c **** static uint16_t reverse16(uint16_t data)
1352:bluetooth_rxtx.c **** {
1353:bluetooth_rxtx.c **** 	uint16_t reversed = 0;
1354:bluetooth_rxtx.c **** 
1355:bluetooth_rxtx.c **** 	for(size_t i=0; i<16; i++)
1356:bluetooth_rxtx.c **** 	{
1357:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (15-i);
1358:bluetooth_rxtx.c **** 	}
1359:bluetooth_rxtx.c **** 
1360:bluetooth_rxtx.c **** 	return reversed;
1361:bluetooth_rxtx.c **** }
1362:bluetooth_rxtx.c **** 
1363:bluetooth_rxtx.c **** /*
1364:bluetooth_rxtx.c ****  * Transmit a BTBR packet with the specified access code.
1365:bluetooth_rxtx.c ****  *
1366:bluetooth_rxtx.c ****  * All modulation parameters are set within this function.
1367:bluetooth_rxtx.c ****  */
1368:bluetooth_rxtx.c **** void br_transmit()
1369:bluetooth_rxtx.c **** {
1370:bluetooth_rxtx.c **** 	uint16_t gio_save;
1371:bluetooth_rxtx.c **** 
1372:bluetooth_rxtx.c **** 	uint32_t clkn_saved = 0;
1373:bluetooth_rxtx.c **** 
1374:bluetooth_rxtx.c **** 	uint16_t preamble = (target.syncword & 1) == 1 ? 0x5555 : 0xaaaa;
1375:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
1376:bluetooth_rxtx.c **** 
1377:bluetooth_rxtx.c **** 	uint8_t data[16] = {
1378:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
1379:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
1380:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
1381:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
1382:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
1383:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
1384:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
1385:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
1386:bluetooth_rxtx.c **** 		reverse8(trailer),
1387:bluetooth_rxtx.c **** 		reverse8(0x77),
1388:bluetooth_rxtx.c **** 		reverse8(0x66),
1389:bluetooth_rxtx.c **** 		reverse8(0x55),
1390:bluetooth_rxtx.c **** 		reverse8(0x44),
1391:bluetooth_rxtx.c **** 		reverse8(0x33),
1392:bluetooth_rxtx.c **** 		reverse8(0x22),
1393:bluetooth_rxtx.c **** 		reverse8(0x11)
1394:bluetooth_rxtx.c **** 	};
1395:bluetooth_rxtx.c **** 
1396:bluetooth_rxtx.c **** 	cc2400_tx_sync(reverse16(preamble));
1397:bluetooth_rxtx.c **** 
1398:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1399:bluetooth_rxtx.c **** 
1400:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1401:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1402:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1403:bluetooth_rxtx.c **** 
1404:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_TX_SYMBOLS )
1405:bluetooth_rxtx.c **** 	{
1406:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 35


1407:bluetooth_rxtx.c **** 		while ((clkn >> 1) == (clkn_saved >> 1) || T0TC < 2250) {
1408:bluetooth_rxtx.c **** 
1409:bluetooth_rxtx.c **** 			// If timer says time to hop, do it.
1410:bluetooth_rxtx.c **** 			if (do_hop) {
1411:bluetooth_rxtx.c **** 				hop();
1412:bluetooth_rxtx.c **** 			}
1413:bluetooth_rxtx.c **** 		}
1414:bluetooth_rxtx.c **** 
1415:bluetooth_rxtx.c **** 		clkn_saved = clkn;
1416:bluetooth_rxtx.c **** 
1417:bluetooth_rxtx.c **** 		TXLED_SET;
1418:bluetooth_rxtx.c **** 
1419:bluetooth_rxtx.c **** 		cc2400_fifo_write(16, data);
1420:bluetooth_rxtx.c **** 
1421:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1422:bluetooth_rxtx.c **** 		TXLED_CLR;
1423:bluetooth_rxtx.c **** 
1424:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
1425:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
1426:bluetooth_rxtx.c **** 
1427:bluetooth_rxtx.c **** 		while (!(cc2400_status() & XOSC16M_STABLE));
1428:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1429:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
1430:bluetooth_rxtx.c **** 
1431:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1432:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1433:bluetooth_rxtx.c **** 
1434:bluetooth_rxtx.c **** 		handle_usb(clkn);
1435:bluetooth_rxtx.c **** 	}
1436:bluetooth_rxtx.c **** 
1437:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1438:bluetooth_rxtx.c **** 	PAEN_CLR;
1439:bluetooth_rxtx.c **** #endif
1440:bluetooth_rxtx.c **** 
1441:bluetooth_rxtx.c **** 	// reset GIO
1442:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1443:bluetooth_rxtx.c **** }
1444:bluetooth_rxtx.c **** 
1445:bluetooth_rxtx.c **** /* set LE access address */
1446:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa) {
 462              		.loc 1 1446 0
 463              		.cfi_startproc
 464              		@ args = 0, pretend = 0, frame = 0
 465              		@ frame_needed = 0, uses_anonymous_args = 0
 466              	.LVL47:
 467 0000 10B5     		push	{r4, lr}
 468              		.cfi_def_cfa_offset 8
 469              		.cfi_offset 4, -8
 470              		.cfi_offset 14, -4
1447:bluetooth_rxtx.c **** 	u32 aa_rev;
1448:bluetooth_rxtx.c **** 
1449:bluetooth_rxtx.c **** 	le.access_address = aa;
 471              		.loc 1 1449 0
 472 0002 044C     		ldr	r4, .L39
 473 0004 6060     		str	r0, [r4, #4]
1450:bluetooth_rxtx.c **** 	aa_rev = rbit(aa);
 474              		.loc 1 1450 0
ARM GAS  /tmp/cckWTbJW.s 			page 36


 475 0006 FFF7FEFF 		bl	rbit
 476              	.LVL48:
1451:bluetooth_rxtx.c **** 	le.syncl = aa_rev & 0xffff;
 477              		.loc 1 1451 0
 478 000a 6081     		strh	r0, [r4, #10]	@ movhi
1452:bluetooth_rxtx.c **** 	le.synch = aa_rev >> 16;
 479              		.loc 1 1452 0
 480 000c 000C     		lsrs	r0, r0, #16
 481              	.LVL49:
 482 000e 2081     		strh	r0, [r4, #8]	@ movhi
 483 0010 10BD     		pop	{r4, pc}
 484              	.L40:
 485 0012 00BF     		.align	2
 486              	.L39:
 487 0014 00000000 		.word	.LANCHOR1
 488              		.cfi_endproc
 489              	.LFE18:
 491              		.section	.text.cc2400_idle,"ax",%progbits
 492              		.align	1
 493              		.thumb
 494              		.thumb_func
 496              	cc2400_idle:
 497              	.LFB7:
 820:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 498              		.loc 1 820 0
 499              		.cfi_startproc
 500              		@ args = 0, pretend = 0, frame = 0
 501              		@ frame_needed = 0, uses_anonymous_args = 0
 502 0000 10B5     		push	{r4, lr}
 503              		.cfi_def_cfa_offset 8
 504              		.cfi_offset 4, -8
 505              		.cfi_offset 14, -4
 821:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 506              		.loc 1 821 0
 507 0002 6420     		movs	r0, #100
 508 0004 FFF7FEFF 		bl	cc2400_strobe
 509              	.LVL50:
 510              	.L43:
 822:bluetooth_rxtx.c **** 
 511              		.loc 1 822 0 discriminator 1
 512 0008 FFF7FEFF 		bl	cc2400_status
 513              	.LVL51:
 514 000c 00F00400 		and	r0, r0, #4
 515 0010 00F0FF04 		and	r4, r0, #255
 516 0014 0028     		cmp	r0, #0
 517 0016 F7D1     		bne	.L43
 825:bluetooth_rxtx.c **** 	HGM_CLR;
 518              		.loc 1 825 0
 519 0018 204B     		ldr	r3, .L44
 520 001a 8022     		movs	r2, #128
 521 001c 1A60     		str	r2, [r3]
 829:bluetooth_rxtx.c **** 	TXLED_CLR;
 522              		.loc 1 829 0
 523 001e 1021     		movs	r1, #16
 826:bluetooth_rxtx.c **** #endif
 524              		.loc 1 826 0
 525 0020 4FF48072 		mov	r2, #256
ARM GAS  /tmp/cckWTbJW.s 			page 37


 526 0024 1A60     		str	r2, [r3]
 829:bluetooth_rxtx.c **** 	TXLED_CLR;
 527              		.loc 1 829 0
 528 0026 43F8201C 		str	r1, [r3, #-32]
 830:bluetooth_rxtx.c **** 	USRLED_CLR;
 529              		.loc 1 830 0
 530 002a 43F8202C 		str	r2, [r3, #-32]
 831:bluetooth_rxtx.c **** 
 531              		.loc 1 831 0
 532 002e 0222     		movs	r2, #2
 533 0030 43F8202C 		str	r2, [r3, #-32]
 833:bluetooth_rxtx.c **** 	dio_ssp_stop();
 534              		.loc 1 833 0
 535 0034 FFF7FEFF 		bl	clkn_stop
 536              	.LVL52:
 834:bluetooth_rxtx.c **** 	cs_reset();
 537              		.loc 1 834 0
 538 0038 FFF7FEFF 		bl	dio_ssp_stop
 539              	.LVL53:
 835:bluetooth_rxtx.c **** 	rssi_reset();
 540              		.loc 1 835 0
 541 003c FFF7FEFF 		bl	cs_reset
 542              	.LVL54:
 836:bluetooth_rxtx.c **** 
 543              		.loc 1 836 0
 544 0040 FFF7FEFF 		bl	rssi_reset
 545              	.LVL55:
 839:bluetooth_rxtx.c **** 	do_hop = 0;
 546              		.loc 1 839 0
 547 0044 164B     		ldr	r3, .L44+4
 841:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 548              		.loc 1 841 0
 549 0046 174A     		ldr	r2, .L44+8
 550 0048 40F68911 		movw	r1, #2441
 839:bluetooth_rxtx.c **** 	do_hop = 0;
 551              		.loc 1 839 0
 552 004c 9C72     		strb	r4, [r3, #10]
 840:bluetooth_rxtx.c **** 	channel = 2441;
 553              		.loc 1 840 0
 554 004e DC72     		strb	r4, [r3, #11]
 841:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 555              		.loc 1 841 0
 556 0050 1180     		strh	r1, [r2]	@ movhi
 843:bluetooth_rxtx.c **** 	requested_channel = 0;
 557              		.loc 1 843 0
 558 0052 9E21     		movs	r1, #158
 842:bluetooth_rxtx.c **** 	hop_timeout = 158;
 559              		.loc 1 842 0
 560 0054 9C81     		strh	r4, [r3, #12]	@ movhi
 843:bluetooth_rxtx.c **** 	requested_channel = 0;
 561              		.loc 1 843 0
 562 0056 A2F84810 		strh	r1, [r2, #72]	@ movhi
 845:bluetooth_rxtx.c **** 
 563              		.loc 1 845 0
 564 005a 40F66211 		movw	r1, #2402
 844:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 565              		.loc 1 844 0
ARM GAS  /tmp/cckWTbJW.s 			page 38


 566 005e DC81     		strh	r4, [r3, #14]	@ movhi
 845:bluetooth_rxtx.c **** 
 567              		.loc 1 845 0
 568 0060 A2F84A10 		strh	r1, [r2, #74]	@ movhi
 849:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 569              		.loc 1 849 0
 570 0064 9C70     		strb	r4, [r3, #2]
 850:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 571              		.loc 1 850 0
 572 0066 5C60     		str	r4, [r3, #4]
 851:bluetooth_rxtx.c **** 	dma_discard = 0;
 573              		.loc 1 851 0
 574 0068 1C81     		strh	r4, [r3, #8]	@ movhi
 852:bluetooth_rxtx.c **** 	status = 0;
 575              		.loc 1 852 0
 576 006a 1C74     		strb	r4, [r3, #16]
 853:bluetooth_rxtx.c **** 
 577              		.loc 1 853 0
 578 006c 5C70     		strb	r4, [r3, #1]
 856:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 579              		.loc 1 856 0
 580 006e 5C74     		strb	r4, [r3, #17]
 857:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 581              		.loc 1 857 0
 582 0070 9C74     		strb	r4, [r3, #18]
 858:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 583              		.loc 1 858 0
 584 0072 DC74     		strb	r4, [r3, #19]
 859:bluetooth_rxtx.c **** 
 585              		.loc 1 859 0
 586 0074 1C75     		strb	r4, [r3, #20]
 861:bluetooth_rxtx.c **** 
 587              		.loc 1 861 0
 588 0076 1C70     		strb	r4, [r3]
 864:bluetooth_rxtx.c **** 	high_freq = 2483;
 589              		.loc 1 864 0
 590 0078 4FF41663 		mov	r3, #2400
 591 007c A2F84C30 		strh	r3, [r2, #76]	@ movhi
 865:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 592              		.loc 1 865 0
 593 0080 5333     		adds	r3, r3, #83
 594 0082 A2F84E30 		strh	r3, [r2, #78]	@ movhi
 868:bluetooth_rxtx.c **** 	target.syncword = 0;
 595              		.loc 1 868 0
 596 0086 0849     		ldr	r1, .L44+12
 866:bluetooth_rxtx.c **** 
 597              		.loc 1 866 0
 598 0088 E223     		movs	r3, #226
 599 008a 82F85030 		strb	r3, [r2, #80]
 868:bluetooth_rxtx.c **** 	target.syncword = 0;
 600              		.loc 1 868 0
 601 008e 0022     		movs	r2, #0
 602 0090 0023     		movs	r3, #0
 603 0092 C1E90023 		strd	r2, [r1]
 869:bluetooth_rxtx.c **** }
 604              		.loc 1 869 0
 605 0096 C1E90223 		strd	r2, [r1, #8]
ARM GAS  /tmp/cckWTbJW.s 			page 39


 606 009a 10BD     		pop	{r4, pc}
 607              	.L45:
 608              		.align	2
 609              	.L44:
 610 009c 5CC00920 		.word	537509980
 611 00a0 00000000 		.word	.LANCHOR0
 612 00a4 00000000 		.word	.LANCHOR1
 613 00a8 00000000 		.word	target
 614              		.cfi_endproc
 615              	.LFE7:
 617              		.section	.text.cb_follow_le,"ax",%progbits
 618              		.align	1
 619              		.global	cb_follow_le
 620              		.thumb
 621              		.thumb_func
 623              	cb_follow_le:
 624              	.LFB23:
1453:bluetooth_rxtx.c **** }
1454:bluetooth_rxtx.c **** 
1455:bluetooth_rxtx.c **** /* reset le state, called by bt_generic_le and bt_follow_le() */
1456:bluetooth_rxtx.c **** void reset_le() {
1457:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
1458:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
1459:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
1460:bluetooth_rxtx.c **** 	le.crc_verify = 0;
1461:bluetooth_rxtx.c **** 	le.last_packet = 0;
1462:bluetooth_rxtx.c **** 
1463:bluetooth_rxtx.c **** 	le.link_state = LINK_INACTIVE;
1464:bluetooth_rxtx.c **** 
1465:bluetooth_rxtx.c **** 	le.channel_idx = 0;
1466:bluetooth_rxtx.c **** 	le.channel_increment = 0;
1467:bluetooth_rxtx.c **** 
1468:bluetooth_rxtx.c **** 	le.conn_epoch = 0;
1469:bluetooth_rxtx.c **** 	le.interval_timer = 0;
1470:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1471:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1472:bluetooth_rxtx.c **** 	le.conn_count = 0;
1473:bluetooth_rxtx.c **** 
1474:bluetooth_rxtx.c **** 	le.win_size = 0;
1475:bluetooth_rxtx.c **** 	le.win_offset = 0;
1476:bluetooth_rxtx.c **** 
1477:bluetooth_rxtx.c **** 	le.update_pending = 0;
1478:bluetooth_rxtx.c **** 	le.update_instant = 0;
1479:bluetooth_rxtx.c **** 	le.interval_update = 0;
1480:bluetooth_rxtx.c **** 	le.win_size_update = 0;
1481:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
1482:bluetooth_rxtx.c **** 
1483:bluetooth_rxtx.c **** 	do_hop = 0;
1484:bluetooth_rxtx.c **** }
1485:bluetooth_rxtx.c **** 
1486:bluetooth_rxtx.c **** // reset LE Promisc state
1487:bluetooth_rxtx.c **** void reset_le_promisc(void) {
1488:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
1489:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
1490:bluetooth_rxtx.c **** }
1491:bluetooth_rxtx.c **** 
1492:bluetooth_rxtx.c **** /* generic le mode */
ARM GAS  /tmp/cckWTbJW.s 			page 40


1493:bluetooth_rxtx.c **** void bt_generic_le(u8 active_mode)
1494:bluetooth_rxtx.c **** {
1495:bluetooth_rxtx.c **** 	u8 hold;
1496:bluetooth_rxtx.c **** 	int i, j;
1497:bluetooth_rxtx.c **** 	int8_t rssi, rssi_at_trigger;
1498:bluetooth_rxtx.c **** 
1499:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1500:bluetooth_rxtx.c **** 	mode = active_mode;
1501:bluetooth_rxtx.c **** 
1502:bluetooth_rxtx.c **** 	reset_le();
1503:bluetooth_rxtx.c **** 
1504:bluetooth_rxtx.c **** 	// enable USB interrupts
1505:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1506:bluetooth_rxtx.c **** 
1507:bluetooth_rxtx.c **** 	RXLED_CLR;
1508:bluetooth_rxtx.c **** 
1509:bluetooth_rxtx.c **** 	queue_init();
1510:bluetooth_rxtx.c **** 	dio_ssp_init();
1511:bluetooth_rxtx.c **** 	dma_init();
1512:bluetooth_rxtx.c **** 	dio_ssp_start();
1513:bluetooth_rxtx.c **** 	cc2400_rx();
1514:bluetooth_rxtx.c **** 
1515:bluetooth_rxtx.c **** 	cs_trigger_enable();
1516:bluetooth_rxtx.c **** 
1517:bluetooth_rxtx.c **** 	hold = 0;
1518:bluetooth_rxtx.c **** 
1519:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1520:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1521:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1522:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1523:bluetooth_rxtx.c **** 
1524:bluetooth_rxtx.c **** 			/* Retune */
1525:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1526:bluetooth_rxtx.c **** 
1527:bluetooth_rxtx.c **** 			/* Wait for lock */
1528:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1529:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1530:bluetooth_rxtx.c **** 
1531:bluetooth_rxtx.c **** 			/* RX mode */
1532:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1533:bluetooth_rxtx.c **** 
1534:bluetooth_rxtx.c **** 			requested_channel = 0;
1535:bluetooth_rxtx.c **** 		}
1536:bluetooth_rxtx.c **** 
1537:bluetooth_rxtx.c **** 		if (do_hop) {
1538:bluetooth_rxtx.c **** 			hop();
1539:bluetooth_rxtx.c **** 		} else {
1540:bluetooth_rxtx.c **** 			TXLED_CLR;
1541:bluetooth_rxtx.c **** 		}
1542:bluetooth_rxtx.c **** 
1543:bluetooth_rxtx.c **** 		RXLED_CLR;
1544:bluetooth_rxtx.c **** 
1545:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1546:bluetooth_rxtx.c **** 		rssi_reset();
1547:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1548:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
1549:bluetooth_rxtx.c **** 		{
ARM GAS  /tmp/cckWTbJW.s 			page 41


1550:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1551:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1552:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1553:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1554:bluetooth_rxtx.c **** 			}
1555:bluetooth_rxtx.c **** 			rssi_add(rssi);
1556:bluetooth_rxtx.c **** 		}
1557:bluetooth_rxtx.c **** 
1558:bluetooth_rxtx.c **** 		if (rx_err) {
1559:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1560:bluetooth_rxtx.c **** 		}
1561:bluetooth_rxtx.c **** 
1562:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1563:bluetooth_rxtx.c **** 		if (!rx_tc)
1564:bluetooth_rxtx.c **** 			goto rx_continue;
1565:bluetooth_rxtx.c **** 
1566:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1567:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1568:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1569:bluetooth_rxtx.c **** 
1570:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1571:bluetooth_rxtx.c **** 
1572:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1573:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1574:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1575:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1576:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1577:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1578:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1579:bluetooth_rxtx.c **** 			cs_trigger = 0;
1580:bluetooth_rxtx.c **** 		}
1581:bluetooth_rxtx.c **** 
1582:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1583:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1584:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1585:bluetooth_rxtx.c **** 		}
1586:bluetooth_rxtx.c **** 
1587:bluetooth_rxtx.c **** 		/* Hold expired? Ignore data. */
1588:bluetooth_rxtx.c **** 		if (hold == 0) {
1589:bluetooth_rxtx.c **** 			goto rx_continue;
1590:bluetooth_rxtx.c **** 		}
1591:bluetooth_rxtx.c **** 		hold--;
1592:bluetooth_rxtx.c **** 
1593:bluetooth_rxtx.c **** 		// copy the previously unpacked symbols to the front of the buffer
1594:bluetooth_rxtx.c **** 		memcpy(unpacked, unpacked + DMA_SIZE*8, DMA_SIZE*8);
1595:bluetooth_rxtx.c **** 
1596:bluetooth_rxtx.c **** 		// unpack the new packet to the end of the buffer
1597:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; ++i) {
1598:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
1599:bluetooth_rxtx.c **** 			for (j = 0; j < 8; ++j) {
1600:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
1601:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
1602:bluetooth_rxtx.c **** 			}
1603:bluetooth_rxtx.c **** 		}
1604:bluetooth_rxtx.c **** 
1605:bluetooth_rxtx.c **** 		int ret = data_cb(unpacked);
1606:bluetooth_rxtx.c **** 		if (!ret) break;
ARM GAS  /tmp/cckWTbJW.s 			page 42


1607:bluetooth_rxtx.c **** 
1608:bluetooth_rxtx.c **** 	rx_continue:
1609:bluetooth_rxtx.c **** 		rx_tc = 0;
1610:bluetooth_rxtx.c **** 		rx_err = 0;
1611:bluetooth_rxtx.c **** 	}
1612:bluetooth_rxtx.c **** 
1613:bluetooth_rxtx.c **** 	// disable USB interrupts
1614:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1615:bluetooth_rxtx.c **** 
1616:bluetooth_rxtx.c **** 	// reset the radio completely
1617:bluetooth_rxtx.c **** 	cc2400_idle();
1618:bluetooth_rxtx.c **** 	dio_ssp_stop();
1619:bluetooth_rxtx.c **** 	cs_trigger_disable();
1620:bluetooth_rxtx.c **** }
1621:bluetooth_rxtx.c **** 
1622:bluetooth_rxtx.c **** 
1623:bluetooth_rxtx.c **** void bt_le_sync(u8 active_mode)
1624:bluetooth_rxtx.c **** {
1625:bluetooth_rxtx.c **** 	int i;
1626:bluetooth_rxtx.c **** 	int8_t rssi;
1627:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1628:bluetooth_rxtx.c **** 
1629:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1630:bluetooth_rxtx.c **** 	mode = active_mode;
1631:bluetooth_rxtx.c **** 
1632:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1633:bluetooth_rxtx.c **** 
1634:bluetooth_rxtx.c **** 	// enable USB interrupts
1635:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1636:bluetooth_rxtx.c **** 
1637:bluetooth_rxtx.c **** 	RXLED_CLR;
1638:bluetooth_rxtx.c **** 
1639:bluetooth_rxtx.c **** 	queue_init();
1640:bluetooth_rxtx.c **** 	dio_ssp_init();
1641:bluetooth_rxtx.c **** 	dma_init_le();
1642:bluetooth_rxtx.c **** 	dio_ssp_start();
1643:bluetooth_rxtx.c **** 
1644:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address)); // bit-reversed access address
1645:bluetooth_rxtx.c **** 
1646:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1647:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1648:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1649:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1650:bluetooth_rxtx.c **** 
1651:bluetooth_rxtx.c **** 			/* Retune */
1652:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1653:bluetooth_rxtx.c **** 
1654:bluetooth_rxtx.c **** 			/* Wait for lock */
1655:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1656:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1657:bluetooth_rxtx.c **** 
1658:bluetooth_rxtx.c **** 			/* RX mode */
1659:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1660:bluetooth_rxtx.c **** 
1661:bluetooth_rxtx.c **** 			requested_channel = 0;
1662:bluetooth_rxtx.c **** 		}
1663:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 43


1664:bluetooth_rxtx.c **** 		RXLED_CLR;
1665:bluetooth_rxtx.c **** 
1666:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1667:bluetooth_rxtx.c **** 		rssi_reset();
1668:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
1669:bluetooth_rxtx.c **** 			;
1670:bluetooth_rxtx.c **** 
1671:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1672:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
1673:bluetooth_rxtx.c **** 
1674:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
1675:bluetooth_rxtx.c **** 			goto cleanup;
1676:bluetooth_rxtx.c **** 		}
1677:bluetooth_rxtx.c **** 
1678:bluetooth_rxtx.c **** 		if (rx_err) {
1679:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1680:bluetooth_rxtx.c **** 		}
1681:bluetooth_rxtx.c **** 
1682:bluetooth_rxtx.c **** 		if (do_hop)
1683:bluetooth_rxtx.c **** 			goto rx_flush;
1684:bluetooth_rxtx.c **** 
1685:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1686:bluetooth_rxtx.c **** 		if (!rx_tc)
1687:bluetooth_rxtx.c **** 			continue;
1688:bluetooth_rxtx.c **** 
1689:bluetooth_rxtx.c **** 		/////////////////////
1690:bluetooth_rxtx.c **** 		// process the packet
1691:bluetooth_rxtx.c **** 
1692:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = { 0, };
1693:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
1694:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
1695:bluetooth_rxtx.c **** 
1696:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel-2402)];
1697:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
1698:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1699:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1700:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1701:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1702:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1703:bluetooth_rxtx.c **** 		}
1704:bluetooth_rxtx.c **** 
1705:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
1706:bluetooth_rxtx.c **** 		if (len > 39)
1707:bluetooth_rxtx.c **** 			goto rx_flush;
1708:bluetooth_rxtx.c **** 
1709:bluetooth_rxtx.c **** 		// transfer the minimum number of bytes from the CC2400
1710:bluetooth_rxtx.c **** 		// this allows us enough time to resume RX for subsequent packets on the same channel
1711:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
1712:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
1713:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
1714:bluetooth_rxtx.c **** 				;
1715:bluetooth_rxtx.c **** 		} else { // max transfers? just wait till DMA's done
1716:bluetooth_rxtx.c **** 			while (DMACC0Config & DMACCxConfig_E && rx_err == 0)
1717:bluetooth_rxtx.c **** 				;
1718:bluetooth_rxtx.c **** 		}
1719:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1720:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 44


1721:bluetooth_rxtx.c **** 		// strobe SFSON to allow the resync to occur while we process the packet
1722:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1723:bluetooth_rxtx.c **** 
1724:bluetooth_rxtx.c **** 		// unwhiten the rest of the packet
1725:bluetooth_rxtx.c **** 		for (i = 4; i < 44; i += 4) {
1726:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1727:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1728:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1729:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1730:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1731:bluetooth_rxtx.c **** 		}
1732:bluetooth_rxtx.c **** 
1733:bluetooth_rxtx.c **** 		if (le.crc_verify) {
1734:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
1735:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
1736:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
1737:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
1738:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
1739:bluetooth_rxtx.c **** 				goto rx_flush;
1740:bluetooth_rxtx.c **** 		}
1741:bluetooth_rxtx.c **** 
1742:bluetooth_rxtx.c **** 
1743:bluetooth_rxtx.c **** 		RXLED_SET;
1744:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
1745:bluetooth_rxtx.c **** 
1746:bluetooth_rxtx.c **** 		// disable USB interrupts while we touch USB data structures
1747:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
1748:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
1749:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
1750:bluetooth_rxtx.c **** 
1751:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
1752:bluetooth_rxtx.c **** 
1753:bluetooth_rxtx.c **** 	rx_flush:
1754:bluetooth_rxtx.c **** 		// this might happen twice, but it's safe to do so
1755:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1756:bluetooth_rxtx.c **** 
1757:bluetooth_rxtx.c **** 		// flush any excess bytes from the SSP's buffer
1758:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1759:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
1760:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
1761:bluetooth_rxtx.c **** 		}
1762:bluetooth_rxtx.c **** 
1763:bluetooth_rxtx.c **** 		// timeout - FIXME this is an ugly hack
1764:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
1765:bluetooth_rxtx.c **** 		if (now < le.last_packet)
1766:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
1767:bluetooth_rxtx.c **** 		if  ( // timeout
1768:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
1769:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
1770:bluetooth_rxtx.c **** 			// jam finished
1771:bluetooth_rxtx.c **** 			|| (le_jam_count == 1)
1772:bluetooth_rxtx.c **** 			)
1773:bluetooth_rxtx.c **** 		{
1774:bluetooth_rxtx.c **** 			reset_le();
1775:bluetooth_rxtx.c **** 			le_jam_count = 0;
1776:bluetooth_rxtx.c **** 			TXLED_CLR;
1777:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 45


1778:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
1779:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
1780:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
1781:bluetooth_rxtx.c **** 				goto cleanup;
1782:bluetooth_rxtx.c **** 			}
1783:bluetooth_rxtx.c **** 
1784:bluetooth_rxtx.c **** 			// go back to promisc if the connection dies
1785:bluetooth_rxtx.c **** 			if (active_mode == MODE_BT_PROMISC_LE)
1786:bluetooth_rxtx.c **** 				goto cleanup;
1787:bluetooth_rxtx.c **** 
1788:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
1789:bluetooth_rxtx.c **** 
1790:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1791:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1792:bluetooth_rxtx.c **** 
1793:bluetooth_rxtx.c **** 			/* Retune */
1794:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
1795:bluetooth_rxtx.c **** 			restart_jamming = 1;
1796:bluetooth_rxtx.c **** 		}
1797:bluetooth_rxtx.c **** 
1798:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
1799:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
1800:bluetooth_rxtx.c **** 
1801:bluetooth_rxtx.c **** 		if (do_hop)
1802:bluetooth_rxtx.c **** 			hop();
1803:bluetooth_rxtx.c **** 
1804:bluetooth_rxtx.c **** 		// ♪ you can jam but you keep turning off the light ♪
1805:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
1806:bluetooth_rxtx.c **** 			le_jam();
1807:bluetooth_rxtx.c **** 			--le_jam_count;
1808:bluetooth_rxtx.c **** 		} else {
1809:bluetooth_rxtx.c **** 			/* RX mode */
1810:bluetooth_rxtx.c **** 			dma_init_le();
1811:bluetooth_rxtx.c **** 			dio_ssp_start();
1812:bluetooth_rxtx.c **** 
1813:bluetooth_rxtx.c **** 			if (restart_jamming) {
1814:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
1815:bluetooth_rxtx.c **** 				restart_jamming = 0;
1816:bluetooth_rxtx.c **** 			} else {
1817:bluetooth_rxtx.c **** 				// wait till we're in FSLOCK before strobing RX
1818:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
1819:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
1820:bluetooth_rxtx.c **** 			}
1821:bluetooth_rxtx.c **** 		}
1822:bluetooth_rxtx.c **** 
1823:bluetooth_rxtx.c **** 		rx_tc = 0;
1824:bluetooth_rxtx.c **** 		rx_err = 0;
1825:bluetooth_rxtx.c **** 	}
1826:bluetooth_rxtx.c **** 
1827:bluetooth_rxtx.c **** cleanup:
1828:bluetooth_rxtx.c **** 
1829:bluetooth_rxtx.c **** 	// disable USB interrupts
1830:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1831:bluetooth_rxtx.c **** 
1832:bluetooth_rxtx.c **** 	// reset the radio completely
1833:bluetooth_rxtx.c **** 	cc2400_idle();
1834:bluetooth_rxtx.c **** 	dio_ssp_stop();
ARM GAS  /tmp/cckWTbJW.s 			page 46


1835:bluetooth_rxtx.c **** 	cs_trigger_disable();
1836:bluetooth_rxtx.c **** }
1837:bluetooth_rxtx.c **** 
1838:bluetooth_rxtx.c **** 
1839:bluetooth_rxtx.c **** 
1840:bluetooth_rxtx.c **** /* low energy connection following
1841:bluetooth_rxtx.c ****  * follows a known AA around */
1842:bluetooth_rxtx.c **** int cb_follow_le() {
 625              		.loc 1 1842 0
 626              		.cfi_startproc
 627              		@ args = 0, pretend = 0, frame = 0
 628              		@ frame_needed = 0, uses_anonymous_args = 0
 629 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 630              		.cfi_def_cfa_offset 32
 631              		.cfi_offset 3, -32
 632              		.cfi_offset 4, -28
 633              		.cfi_offset 5, -24
 634              		.cfi_offset 6, -20
 635              		.cfi_offset 7, -16
 636              		.cfi_offset 8, -12
 637              		.cfi_offset 9, -8
 638              		.cfi_offset 14, -4
1843:bluetooth_rxtx.c **** 	int i, j, k;
1844:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
 639              		.loc 1 1844 0
 640 0004 394C     		ldr	r4, .L67
 641 0006 2088     		ldrh	r0, [r4]
 642 0008 2646     		mov	r6, r4
 643 000a 80B2     		uxth	r0, r0
 644 000c 6238     		subs	r0, r0, #98
 645 000e C0B2     		uxtb	r0, r0
 646 0010 FFF7FEFF 		bl	btle_channel_index
 647              	.LVL56:
 648 0014 3649     		ldr	r1, .L67+4
1845:bluetooth_rxtx.c **** 
1846:bluetooth_rxtx.c **** 	u32 access_address = 0;
 649              		.loc 1 1846 0
 650 0016 0022     		movs	r2, #0
1844:bluetooth_rxtx.c **** 
 651              		.loc 1 1844 0
 652 0018 0D5C     		ldrb	r5, [r1, r0]	@ zero_extendqisi2
 653              	.LVL57:
1847:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 654              		.loc 1 1847 0
 655 001a 1346     		mov	r3, r2
 656 001c 8C46     		mov	ip, r1
 657              	.LVL58:
 658              	.L48:
1848:bluetooth_rxtx.c **** 		access_address >>= 1;
1849:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 659              		.loc 1 1849 0 discriminator 2
 660 001e 354F     		ldr	r7, .L67+8
 661 0020 D95D     		ldrb	r1, [r3, r7]	@ zero_extendqisi2
1847:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 662              		.loc 1 1847 0 discriminator 2
 663 0022 0133     		adds	r3, r3, #1
 664              	.LVL59:
ARM GAS  /tmp/cckWTbJW.s 			page 47


 665              		.loc 1 1849 0 discriminator 2
 666 0024 C907     		lsls	r1, r1, #31
1847:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 667              		.loc 1 1847 0 discriminator 2
 668 0026 1F2B     		cmp	r3, #31
 669              		.loc 1 1849 0 discriminator 2
 670 0028 41EA5202 		orr	r2, r1, r2, lsr #1
 671              	.LVL60:
1847:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 672              		.loc 1 1847 0 discriminator 2
 673 002c F7D1     		bne	.L48
1850:bluetooth_rxtx.c **** 	}
1851:bluetooth_rxtx.c **** 
1852:bluetooth_rxtx.c **** 	for (i = 31; i < DMA_SIZE * 8 + 32; i++) {
1853:bluetooth_rxtx.c **** 		access_address >>= 1;
1854:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
1855:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 674              		.loc 1 1855 0
 675 002e 7168     		ldr	r1, [r6, #4]
 676              	.L60:
 677              	.LVL61:
1854:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 678              		.loc 1 1854 0
 679 0030 F85C     		ldrb	r0, [r7, r3]	@ zero_extendqisi2
 680 0032 C007     		lsls	r0, r0, #31
 681 0034 40EA5202 		orr	r2, r0, r2, lsr #1
 682              	.LVL62:
 683              		.loc 1 1855 0
 684 0038 8A42     		cmp	r2, r1
 685 003a 4FD1     		bne	.L49
 686 003c 0022     		movs	r2, #0
 687              	.LVL63:
 688              	.L50:
 689 003e 07EB0308 		add	r8, r7, r3
1847:bluetooth_rxtx.c **** 		access_address >>= 1;
 690              		.loc 1 1847 0 discriminator 1
 691 0042 0020     		movs	r0, #0
 692 0044 08EBC208 		add	r8, r8, r2, lsl #3
 693 0048 0146     		mov	r1, r0
 694              	.LVL64:
 695              	.L55:
 696 004a 08EB0104 		add	r4, r8, r1
 697              	.LBB6:
 698              	.LBB7:
1856:bluetooth_rxtx.c **** 			for (j = 0; j < 46; ++j) {
1857:bluetooth_rxtx.c **** 				u8 byte = 0;
1858:bluetooth_rxtx.c **** 				for (k = 0; k < 8; k++) {
1859:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
1860:bluetooth_rxtx.c **** 					if (offset >= DMA_SIZE*8*2) break;
1861:bluetooth_rxtx.c **** 					int bit = unpacked[offset];
1862:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 699              		.loc 1 1862 0
 700 004e 032A     		cmp	r2, #3
1861:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 701              		.loc 1 1861 0
 702 0050 14F81F4C 		ldrb	r4, [r4, #-31]	@ zero_extendqisi2
 703              	.LVL65:
ARM GAS  /tmp/cckWTbJW.s 			page 48


 704              		.loc 1 1862 0
 705 0054 0CDD     		ble	.L52
1863:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 706              		.loc 1 1863 0
 707 0056 0CEB050E 		add	lr, ip, r5
 708 005a 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
1864:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 709              		.loc 1 1864 0
 710 005e 0135     		adds	r5, r5, #1
 711              	.LVL66:
1863:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 712              		.loc 1 1863 0
 713 0060 84EA0E04 		eor	r4, r4, lr
 714              	.LVL67:
 715              		.loc 1 1864 0
 716 0064 4FF07F0E 		mov	lr, #127
 717 0068 B5FBFEF9 		udiv	r9, r5, lr
 718 006c 0EFB1955 		mls	r5, lr, r9, r5
 719              	.LVL68:
 720              	.L52:
1865:bluetooth_rxtx.c **** 					}
1866:bluetooth_rxtx.c **** 					byte |= bit << k;
 721              		.loc 1 1866 0
 722 0070 8C40     		lsls	r4, r4, r1
 723              	.LVL69:
 724              	.LBE7:
1858:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 725              		.loc 1 1858 0
 726 0072 0131     		adds	r1, r1, #1
 727              	.LVL70:
 728              	.LBB8:
 729              		.loc 1 1866 0
 730 0074 2043     		orrs	r0, r0, r4
 731              	.LVL71:
 732              	.LBE8:
1858:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 733              		.loc 1 1858 0
 734 0076 0829     		cmp	r1, #8
 735              	.LBB9:
 736              		.loc 1 1866 0
 737 0078 C0B2     		uxtb	r0, r0
 738              	.LVL72:
 739              	.LBE9:
1858:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 740              		.loc 1 1858 0
 741 007a E6D1     		bne	.L55
1867:bluetooth_rxtx.c **** 				}
1868:bluetooth_rxtx.c **** 				idle_rxbuf[j] = byte;
 742              		.loc 1 1868 0
 743 007c 1E4C     		ldr	r4, .L67+12
 744 007e 2168     		ldr	r1, [r4]
 745              	.LVL73:
 746 0080 8854     		strb	r0, [r1, r2]
 747              	.LBE6:
1856:bluetooth_rxtx.c **** 				u8 byte = 0;
 748              		.loc 1 1856 0
 749 0082 0132     		adds	r2, r2, #1
ARM GAS  /tmp/cckWTbJW.s 			page 49


 750              	.LVL74:
 751 0084 2E2A     		cmp	r2, #46
 752 0086 DAD1     		bne	.L50
1869:bluetooth_rxtx.c **** 			}
1870:bluetooth_rxtx.c **** 
1871:bluetooth_rxtx.c **** 			// verify CRC
1872:bluetooth_rxtx.c **** 			if (le.crc_verify) {
 753              		.loc 1 1872 0
 754 0088 7369     		ldr	r3, [r6, #20]
 755              	.LVL75:
 756 008a 5BB9     		cbnz	r3, .L56
 757              	.LVL76:
 758              	.L58:
1873:bluetooth_rxtx.c **** 				int len		 = (idle_rxbuf[5] & 0x3f) + 2;
1874:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
1875:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
1876:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
1877:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
1878:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
1879:bluetooth_rxtx.c **** 					break;
1880:bluetooth_rxtx.c **** 			}
1881:bluetooth_rxtx.c **** 
1882:bluetooth_rxtx.c **** 			// send to PC
1883:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 759              		.loc 1 1883 0
 760 008c 2168     		ldr	r1, [r4]
 761 008e 0120     		movs	r0, #1
 762 0090 FFF7FEFF 		bl	enqueue
 763              	.LVL77:
1884:bluetooth_rxtx.c **** 			RXLED_SET;
 764              		.loc 1 1884 0
 765 0094 194B     		ldr	r3, .L67+16
 766 0096 1022     		movs	r2, #16
 767 0098 1A60     		str	r2, [r3]
1885:bluetooth_rxtx.c **** 
1886:bluetooth_rxtx.c **** 			packet_cb((uint8_t*)idle_rxbuf);
 768              		.loc 1 1886 0
 769 009a 194B     		ldr	r3, .L67+20
 770 009c 2068     		ldr	r0, [r4]
 771 009e 9B69     		ldr	r3, [r3, #24]
 772 00a0 9847     		blx	r3
 773              	.LVL78:
1887:bluetooth_rxtx.c **** 
1888:bluetooth_rxtx.c **** 			break;
 774              		.loc 1 1888 0
 775 00a2 1FE0     		b	.L57
 776              	.LVL79:
 777              	.L56:
 778              	.LBB10:
1873:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 779              		.loc 1 1873 0
 780 00a4 2368     		ldr	r3, [r4]
 781 00a6 5D79     		ldrb	r5, [r3, #5]	@ zero_extendqisi2
 782              	.LVL80:
1874:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 783              		.loc 1 1874 0
 784 00a8 104B     		ldr	r3, .L67
ARM GAS  /tmp/cckWTbJW.s 			page 50


 785 00aa 2168     		ldr	r1, [r4]
1873:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 786              		.loc 1 1873 0
 787 00ac 05F03F05 		and	r5, r5, #63
 788              	.LVL81:
1874:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 789              		.loc 1 1874 0
 790 00b0 AA1C     		adds	r2, r5, #2
 791              	.LVL82:
 792 00b2 1869     		ldr	r0, [r3, #16]
 793              	.LVL83:
 794 00b4 0431     		adds	r1, r1, #4
 795 00b6 FFF7FEFF 		bl	btle_crcgen_lut
 796              	.LVL84:
1875:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
 797              		.loc 1 1875 0
 798 00ba 2268     		ldr	r2, [r4]
 799 00bc 05F10803 		add	r3, r5, #8
 800 00c0 D15C     		ldrb	r1, [r2, r3]	@ zero_extendqisi2
1876:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 801              		.loc 1 1876 0
 802 00c2 2268     		ldr	r2, [r4]
 803 00c4 EB1D     		adds	r3, r5, #7
 804 00c6 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
1877:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 805              		.loc 1 1877 0
 806 00c8 2268     		ldr	r2, [r4]
 807 00ca 0635     		adds	r5, r5, #6
 808              	.LVL85:
 809 00cc 525D     		ldrb	r2, [r2, r5]	@ zero_extendqisi2
 810              	.LVL86:
1876:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 811              		.loc 1 1876 0
 812 00ce 1B02     		lsls	r3, r3, #8
 813              	.LVL87:
 814 00d0 43EA0143 		orr	r3, r3, r1, lsl #16
1877:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 815              		.loc 1 1877 0
 816 00d4 1343     		orrs	r3, r3, r2
1878:bluetooth_rxtx.c **** 					break;
 817              		.loc 1 1878 0
 818 00d6 9842     		cmp	r0, r3
 819 00d8 04D1     		bne	.L57
 820 00da D7E7     		b	.L58
 821              	.LVL88:
 822              	.L49:
 823              	.LBE10:
1852:bluetooth_rxtx.c **** 		access_address >>= 1;
 824              		.loc 1 1852 0
 825 00dc 0133     		adds	r3, r3, #1
 826              	.LVL89:
 827 00de B3F5D87F 		cmp	r3, #432
 828 00e2 A5D1     		bne	.L60
 829              	.LVL90:
 830              	.L57:
1889:bluetooth_rxtx.c **** 		}
1890:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/cckWTbJW.s 			page 51


1891:bluetooth_rxtx.c **** 
1892:bluetooth_rxtx.c **** 	return 1;
1893:bluetooth_rxtx.c **** }
 831              		.loc 1 1893 0
 832 00e4 0120     		movs	r0, #1
 833 00e6 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 834              	.L68:
 835 00ea 00BF     		.align	2
 836              	.L67:
 837 00ec 00000000 		.word	.LANCHOR1
 838 00f0 00000000 		.word	.LANCHOR2
 839 00f4 00000000 		.word	unpacked
 840 00f8 00000000 		.word	idle_rxbuf
 841 00fc 38C00920 		.word	537509944
 842 0100 00000000 		.word	.LANCHOR0
 843              		.cfi_endproc
 844              	.LFE23:
 846              		.section	.text.connection_follow_cb,"ax",%progbits
 847              		.align	1
 848              		.global	connection_follow_cb
 849              		.thumb
 850              		.thumb_func
 852              	connection_follow_cb:
 853              	.LFB24:
1894:bluetooth_rxtx.c **** 
1895:bluetooth_rxtx.c **** /**
1896:bluetooth_rxtx.c ****  * Called when we receive a packet in connection following mode.
1897:bluetooth_rxtx.c ****  */
1898:bluetooth_rxtx.c **** void connection_follow_cb(u8 *packet) {
 854              		.loc 1 1898 0
 855              		.cfi_startproc
 856              		@ args = 0, pretend = 0, frame = 0
 857              		@ frame_needed = 0, uses_anonymous_args = 0
 858              	.LVL91:
 859 0000 38B5     		push	{r3, r4, r5, lr}
 860              		.cfi_def_cfa_offset 16
 861              		.cfi_offset 3, -16
 862              		.cfi_offset 4, -12
 863              		.cfi_offset 5, -8
 864              		.cfi_offset 14, -4
 865              	.LVL92:
1899:bluetooth_rxtx.c **** 	int i;
1900:bluetooth_rxtx.c **** 	u32 aa = 0;
1901:bluetooth_rxtx.c **** 
1902:bluetooth_rxtx.c **** #define ADV_ADDRESS_IDX 0
1903:bluetooth_rxtx.c **** #define HEADER_IDX 4
1904:bluetooth_rxtx.c **** #define DATA_LEN_IDX 5
1905:bluetooth_rxtx.c **** #define DATA_START_IDX 6
1906:bluetooth_rxtx.c **** 
1907:bluetooth_rxtx.c **** 	// u8 *adv_addr = &packet[ADV_ADDRESS_IDX];
1908:bluetooth_rxtx.c **** 	u8 header = packet[HEADER_IDX];
1909:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
1910:bluetooth_rxtx.c **** 	u8 *data = &packet[DATA_START_IDX];
1911:bluetooth_rxtx.c **** 	// u8 *crc = &packet[DATA_START_IDX + *data_len];
1912:bluetooth_rxtx.c **** 
1913:bluetooth_rxtx.c **** 	if (le.link_state == LINK_CONN_PENDING) {
 866              		.loc 1 1913 0
ARM GAS  /tmp/cckWTbJW.s 			page 52


 867 0002 584B     		ldr	r3, .L87
1898:bluetooth_rxtx.c **** 	int i;
 868              		.loc 1 1898 0
 869 0004 0546     		mov	r5, r0
 870              		.loc 1 1913 0
 871 0006 1A7E     		ldrb	r2, [r3, #24]	@ zero_extendqisi2
1908:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
 872              		.loc 1 1908 0
 873 0008 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
 874              	.LVL93:
 875              		.loc 1 1913 0
 876 000a 022A     		cmp	r2, #2
 877 000c 1C46     		mov	r4, r3
 878 000e 13D1     		bne	.L70
1914:bluetooth_rxtx.c **** 		// We received a packet in the connection pending state, so now the device *should* be connected
1915:bluetooth_rxtx.c **** 		le.link_state = LINK_CONNECTED;
 879              		.loc 1 1915 0
 880 0010 0322     		movs	r2, #3
 881 0012 1A76     		strb	r2, [r3, #24]
 882              	.LVL94:
1916:bluetooth_rxtx.c **** 		le.conn_epoch = clkn;
 883              		.loc 1 1916 0
 884 0014 544A     		ldr	r2, .L87+4
 885 0016 1268     		ldr	r2, [r2]
 886 0018 DA61     		str	r2, [r3, #28]
1917:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval - 1;
 887              		.loc 1 1917 0
 888 001a 5A8C     		ldrh	r2, [r3, #34]
 889 001c 013A     		subs	r2, r2, #1
 890 001e 92B2     		uxth	r2, r2
 891 0020 1A84     		strh	r2, [r3, #32]	@ movhi
1918:bluetooth_rxtx.c **** 		le.conn_count = 0;
 892              		.loc 1 1918 0
 893 0022 0022     		movs	r2, #0
 894 0024 9A84     		strh	r2, [r3, #36]	@ movhi
1919:bluetooth_rxtx.c **** 		le.update_pending = 0;
 895              		.loc 1 1919 0
 896 0026 DA62     		str	r2, [r3, #44]
1920:bluetooth_rxtx.c **** 
1921:bluetooth_rxtx.c **** 		// hue hue hue
1922:bluetooth_rxtx.c **** 		if (jam_mode != JAM_NONE)
 897              		.loc 1 1922 0
 898 0028 504B     		ldr	r3, .L87+8
 899 002a DA7C     		ldrb	r2, [r3, #19]	@ zero_extendqisi2
 900 002c 002A     		cmp	r2, #0
 901 002e 00F09880 		beq	.L69
1923:bluetooth_rxtx.c **** 			le_jam_count = JAM_COUNT_DEFAULT;
 902              		.loc 1 1923 0
 903 0032 2822     		movs	r2, #40
 904 0034 DA61     		str	r2, [r3, #28]
 905 0036 38BD     		pop	{r3, r4, r5, pc}
 906              	.LVL95:
 907              	.L70:
1924:bluetooth_rxtx.c **** 
1925:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_CONNECTED) {
 908              		.loc 1 1925 0
 909 0038 032A     		cmp	r2, #3
ARM GAS  /tmp/cckWTbJW.s 			page 53


 910 003a 3BD1     		bne	.L73
 911              	.LBB11:
1926:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
1927:bluetooth_rxtx.c **** 
1928:bluetooth_rxtx.c **** 		// Apply any connection parameter update if necessary
1929:bluetooth_rxtx.c **** 		if (le.update_pending && le.conn_count == le.update_instant) {
 912              		.loc 1 1929 0
 913 003c DB6A     		ldr	r3, [r3, #44]
1926:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
 914              		.loc 1 1926 0
 915 003e 01F00301 		and	r1, r1, #3
 916              	.LVL96:
 917              		.loc 1 1929 0
 918 0042 A3B1     		cbz	r3, .L74
 919              		.loc 1 1929 0 is_stmt 0 discriminator 1
 920 0044 A38C     		ldrh	r3, [r4, #36]
 921 0046 228E     		ldrh	r2, [r4, #48]
 922 0048 9BB2     		uxth	r3, r3
 923 004a 9A42     		cmp	r2, r3
 924 004c 0FD1     		bne	.L74
1930:bluetooth_rxtx.c **** 			// This is the first packet received in the connection interval for which the new parameters app
1931:bluetooth_rxtx.c **** 			le.conn_epoch = clkn;
 925              		.loc 1 1931 0 is_stmt 1
 926 004e 464B     		ldr	r3, .L87+4
 927 0050 1B68     		ldr	r3, [r3]
 928 0052 E361     		str	r3, [r4, #28]
 929              	.LVL97:
1932:bluetooth_rxtx.c **** 			le.conn_interval = le.interval_update;
 930              		.loc 1 1932 0
 931 0054 638E     		ldrh	r3, [r4, #50]
 932 0056 6384     		strh	r3, [r4, #34]	@ movhi
1933:bluetooth_rxtx.c **** 			le.interval_timer = le.interval_update - 1;
 933              		.loc 1 1933 0
 934 0058 013B     		subs	r3, r3, #1
 935 005a 9BB2     		uxth	r3, r3
 936 005c 2384     		strh	r3, [r4, #32]	@ movhi
1934:bluetooth_rxtx.c **** 			le.win_size = le.win_size_update;
 937              		.loc 1 1934 0
 938 005e 94F83430 		ldrb	r3, [r4, #52]	@ zero_extendqisi2
 939 0062 84F82630 		strb	r3, [r4, #38]
1935:bluetooth_rxtx.c **** 			le.win_offset = le.win_offset_update;
 940              		.loc 1 1935 0
 941 0066 E38E     		ldrh	r3, [r4, #54]
 942 0068 2385     		strh	r3, [r4, #40]	@ movhi
1936:bluetooth_rxtx.c **** 			le.update_pending = 0;
 943              		.loc 1 1936 0
 944 006a 0023     		movs	r3, #0
 945 006c E362     		str	r3, [r4, #44]
 946              	.L74:
1937:bluetooth_rxtx.c **** 		}
1938:bluetooth_rxtx.c **** 
1939:bluetooth_rxtx.c **** 		if (llid == 0x03 && data[0] == 0x00) {
 947              		.loc 1 1939 0
 948 006e 0329     		cmp	r1, #3
 949 0070 77D1     		bne	.L69
 950              		.loc 1 1939 0 is_stmt 0 discriminator 1
 951 0072 AB79     		ldrb	r3, [r5, #6]	@ zero_extendqisi2
ARM GAS  /tmp/cckWTbJW.s 			page 54


 952 0074 002B     		cmp	r3, #0
 953 0076 74D1     		bne	.L69
1940:bluetooth_rxtx.c **** 			// This is a CONNECTION_UPDATE_REQ.
1941:bluetooth_rxtx.c **** 			// The host is changing the connection parameters.
1942:bluetooth_rxtx.c **** 			le.win_size_update = packet[7];
 954              		.loc 1 1942 0 is_stmt 1
 955 0078 EB79     		ldrb	r3, [r5, #7]	@ zero_extendqisi2
 956 007a 84F83430 		strb	r3, [r4, #52]
1943:bluetooth_rxtx.c **** 			le.win_offset_update = packet[8] + ((u16)packet[9] << 8);
 957              		.loc 1 1943 0
 958 007e 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 959 0080 2B7A     		ldrb	r3, [r5, #8]	@ zero_extendqisi2
 960 0082 03EB0223 		add	r3, r3, r2, lsl #8
 961 0086 E386     		strh	r3, [r4, #54]	@ movhi
1944:bluetooth_rxtx.c **** 			le.interval_update = packet[10] + ((u16)packet[11] << 8);
 962              		.loc 1 1944 0
 963 0088 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 964 008a AB7A     		ldrb	r3, [r5, #10]	@ zero_extendqisi2
 965 008c 03EB0223 		add	r3, r3, r2, lsl #8
 966 0090 6386     		strh	r3, [r4, #50]	@ movhi
1945:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 967              		.loc 1 1945 0
 968 0092 6A7C     		ldrb	r2, [r5, #17]	@ zero_extendqisi2
 969 0094 2B7C     		ldrb	r3, [r5, #16]	@ zero_extendqisi2
 970 0096 03EB0223 		add	r3, r3, r2, lsl #8
1946:bluetooth_rxtx.c **** 			if (le.update_instant - le.conn_count < 32767)
 971              		.loc 1 1946 0
 972 009a A28C     		ldrh	r2, [r4, #36]
1945:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 973              		.loc 1 1945 0
 974 009c 9BB2     		uxth	r3, r3
 975              		.loc 1 1946 0
 976 009e 92B2     		uxth	r2, r2
1945:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 977              		.loc 1 1945 0
 978 00a0 2386     		strh	r3, [r4, #48]	@ movhi
 979              		.loc 1 1946 0
 980 00a2 9B1A     		subs	r3, r3, r2
 981 00a4 47F6FE72 		movw	r2, #32766
 982 00a8 9342     		cmp	r3, r2
 983 00aa 5ADC     		bgt	.L69
1947:bluetooth_rxtx.c **** 				le.update_pending = 1;
 984              		.loc 1 1947 0
 985 00ac 2D4B     		ldr	r3, .L87
 986 00ae 0122     		movs	r2, #1
 987 00b0 DA62     		str	r2, [r3, #44]
 988 00b2 38BD     		pop	{r3, r4, r5, pc}
 989              	.LVL98:
 990              	.L73:
 991              	.LBE11:
1948:bluetooth_rxtx.c **** 		}
1949:bluetooth_rxtx.c **** 
1950:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_LISTENING) {
 992              		.loc 1 1950 0
 993 00b4 012A     		cmp	r2, #1
 994 00b6 54D1     		bne	.L69
 995              	.LVL99:
ARM GAS  /tmp/cckWTbJW.s 			page 55


 996              	.LBB12:
1951:bluetooth_rxtx.c **** 		u8 pkt_type = packet[4] & 0x0F;
1952:bluetooth_rxtx.c **** 		if (pkt_type == 0x05) {
 997              		.loc 1 1952 0
 998 00b8 01F00F01 		and	r1, r1, #15
 999              	.LVL100:
 1000 00bc 0529     		cmp	r1, #5
 1001 00be 50D1     		bne	.L69
 1002              	.LBB13:
1953:bluetooth_rxtx.c **** 			uint16_t conn_interval;
1954:bluetooth_rxtx.c **** 
1955:bluetooth_rxtx.c **** 			// ignore packets with incorrect length
1956:bluetooth_rxtx.c **** 			if (*data_len != 34)
 1003              		.loc 1 1956 0
 1004 00c0 4379     		ldrb	r3, [r0, #5]	@ zero_extendqisi2
 1005 00c2 222B     		cmp	r3, #34
 1006 00c4 4DD1     		bne	.L69
 1007              	.LVL101:
1957:bluetooth_rxtx.c **** 				return;
1958:bluetooth_rxtx.c **** 
1959:bluetooth_rxtx.c **** 			// conn interval must be [7.5 ms, 4.0s] in units of 1.25 ms
1960:bluetooth_rxtx.c **** 			conn_interval = (packet[29] << 8) | packet[28];
 1008              		.loc 1 1960 0
 1009 00c6 037F     		ldrb	r3, [r0, #28]	@ zero_extendqisi2
 1010 00c8 427F     		ldrb	r2, [r0, #29]	@ zero_extendqisi2
 1011 00ca 43EA0222 		orr	r2, r3, r2, lsl #8
1961:bluetooth_rxtx.c **** 			if (conn_interval < 6 || conn_interval > 3200)
 1012              		.loc 1 1961 0
 1013 00ce 063A     		subs	r2, r2, #6
 1014 00d0 92B2     		uxth	r2, r2
 1015 00d2 40F67A43 		movw	r3, #3194
 1016 00d6 9A42     		cmp	r2, r3
 1017 00d8 43D8     		bhi	.L69
1962:bluetooth_rxtx.c **** 				return;
1963:bluetooth_rxtx.c **** 
1964:bluetooth_rxtx.c **** 			// This is a connect packet
1965:bluetooth_rxtx.c **** 			// if we have a target, see if InitA or AdvA matches
1966:bluetooth_rxtx.c **** 			if (le.target_set &&
 1018              		.loc 1 1966 0
 1019 00da 236C     		ldr	r3, [r4, #64]
 1020 00dc 2BB9     		cbnz	r3, .L76
 1021              	.LVL102:
 1022              	.L78:
1967:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
1968:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
1969:bluetooth_rxtx.c **** 				return;
1970:bluetooth_rxtx.c **** 			}
1971:bluetooth_rxtx.c **** 
1972:bluetooth_rxtx.c **** 			le.link_state = LINK_CONN_PENDING;
 1023              		.loc 1 1972 0
 1024 00de 0223     		movs	r3, #2
1973:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1025              		.loc 1 1973 0
 1026 00e0 0020     		movs	r0, #0
1972:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1027              		.loc 1 1972 0
 1028 00e2 2376     		strb	r3, [r4, #24]
ARM GAS  /tmp/cckWTbJW.s 			page 56


 1029              		.loc 1 1973 0
 1030 00e4 6061     		str	r0, [r4, #20]
 1031              	.LVL103:
1974:bluetooth_rxtx.c **** 
1975:bluetooth_rxtx.c **** 			for (i = 0; i < 4; ++i)
 1032              		.loc 1 1975 0
 1033 00e6 0346     		mov	r3, r0
 1034 00e8 11E0     		b	.L77
 1035              	.LVL104:
 1036              	.L76:
1967:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1037              		.loc 1 1967 0 discriminator 1
 1038 00ea 04F13800 		add	r0, r4, #56
 1039              	.LVL105:
 1040 00ee A91D     		adds	r1, r5, #6
 1041 00f0 0622     		movs	r2, #6
 1042 00f2 FFF7FEFF 		bl	memcmp
 1043              	.LVL106:
1966:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
 1044              		.loc 1 1966 0 discriminator 1
 1045 00f6 0028     		cmp	r0, #0
 1046 00f8 F1D0     		beq	.L78
1968:bluetooth_rxtx.c **** 				return;
 1047              		.loc 1 1968 0
 1048 00fa 04F13800 		add	r0, r4, #56
 1049 00fe 05F10C01 		add	r1, r5, #12
 1050 0102 0622     		movs	r2, #6
 1051 0104 FFF7FEFF 		bl	memcmp
 1052              	.LVL107:
1967:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1053              		.loc 1 1967 0
 1054 0108 0028     		cmp	r0, #0
 1055 010a E8D0     		beq	.L78
 1056 010c 38BD     		pop	{r3, r4, r5, pc}
 1057              	.LVL108:
 1058              	.L77:
 1059 010e EA18     		adds	r2, r5, r3
1976:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1060              		.loc 1 1976 0 discriminator 2
 1061 0110 917C     		ldrb	r1, [r2, #18]	@ zero_extendqisi2
 1062 0112 DA00     		lsls	r2, r3, #3
 1063 0114 01FA02F2 		lsl	r2, r1, r2
1975:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1064              		.loc 1 1975 0 discriminator 2
 1065 0118 0133     		adds	r3, r3, #1
 1066              	.LVL109:
 1067 011a 042B     		cmp	r3, #4
 1068              		.loc 1 1976 0 discriminator 2
 1069 011c 40EA0200 		orr	r0, r0, r2
 1070              	.LVL110:
1975:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1071              		.loc 1 1975 0 discriminator 2
 1072 0120 F5D1     		bne	.L77
1977:bluetooth_rxtx.c **** 			le_set_access_address(aa);
 1073              		.loc 1 1977 0
 1074 0122 FFF7FEFF 		bl	le_set_access_address
 1075              	.LVL111:
ARM GAS  /tmp/cckWTbJW.s 			page 57


1978:bluetooth_rxtx.c **** 
1979:bluetooth_rxtx.c **** #define CRC_INIT (2+4+6+6+4)
1980:bluetooth_rxtx.c **** 			le.crc_init = (packet[CRC_INIT+2] << 16)
1981:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1076              		.loc 1 1981 0
 1077 0126 E87D     		ldrb	r0, [r5, #23]	@ zero_extendqisi2
1980:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1078              		.loc 1 1980 0
 1079 0128 2B7E     		ldrb	r3, [r5, #24]	@ zero_extendqisi2
 1080              		.loc 1 1981 0
 1081 012a 0002     		lsls	r0, r0, #8
 1082 012c 40EA0340 		orr	r0, r0, r3, lsl #16
1982:bluetooth_rxtx.c **** 						|  packet[CRC_INIT+0];
 1083              		.loc 1 1982 0
 1084 0130 AB7D     		ldrb	r3, [r5, #22]	@ zero_extendqisi2
 1085 0132 1843     		orrs	r0, r0, r3
1980:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1086              		.loc 1 1980 0
 1087 0134 E060     		str	r0, [r4, #12]
1983:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1088              		.loc 1 1983 0
 1089 0136 FFF7FEFF 		bl	rbit
 1090              	.LVL112:
1984:bluetooth_rxtx.c **** 
1985:bluetooth_rxtx.c **** #define WIN_SIZE (2+4+6+6+4+3)
1986:bluetooth_rxtx.c **** 			le.win_size = packet[WIN_SIZE];
 1091              		.loc 1 1986 0
 1092 013a 6B7E     		ldrb	r3, [r5, #25]	@ zero_extendqisi2
1983:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1093              		.loc 1 1983 0
 1094 013c 2061     		str	r0, [r4, #16]
 1095              		.loc 1 1986 0
 1096 013e 84F82630 		strb	r3, [r4, #38]
1987:bluetooth_rxtx.c **** 
1988:bluetooth_rxtx.c **** #define WIN_OFFSET (2+4+6+6+4+3+1)
1989:bluetooth_rxtx.c **** 			le.win_offset = packet[WIN_OFFSET];
 1097              		.loc 1 1989 0
 1098 0142 AB7E     		ldrb	r3, [r5, #26]	@ zero_extendqisi2
 1099 0144 2385     		strh	r3, [r4, #40]	@ movhi
1990:bluetooth_rxtx.c **** 
1991:bluetooth_rxtx.c **** #define CONN_INTERVAL (2+4+6+6+4+3+1+2)
1992:bluetooth_rxtx.c **** 			le.conn_interval = (packet[CONN_INTERVAL+1] << 8)
 1100              		.loc 1 1992 0
 1101 0146 6A7F     		ldrb	r2, [r5, #29]	@ zero_extendqisi2
 1102 0148 2B7F     		ldrb	r3, [r5, #28]	@ zero_extendqisi2
 1103 014a 43EA0223 		orr	r3, r3, r2, lsl #8
 1104 014e 6384     		strh	r3, [r4, #34]	@ movhi
1993:bluetooth_rxtx.c **** 							 |  packet[CONN_INTERVAL+0];
1994:bluetooth_rxtx.c **** 
1995:bluetooth_rxtx.c **** #define CHANNEL_INC (2+4+6+6+4+3+1+2+2+2+2+5)
1996:bluetooth_rxtx.c **** 			le.channel_increment = packet[CHANNEL_INC] & 0x1f;
 1105              		.loc 1 1996 0
 1106 0150 95F82730 		ldrb	r3, [r5, #39]	@ zero_extendqisi2
1997:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
1998:bluetooth_rxtx.c **** 
1999:bluetooth_rxtx.c **** 			// Hop to the initial channel immediately
2000:bluetooth_rxtx.c **** 			do_hop = 1;
ARM GAS  /tmp/cckWTbJW.s 			page 58


 1107              		.loc 1 2000 0
 1108 0154 0122     		movs	r2, #1
1996:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1109              		.loc 1 1996 0
 1110 0156 03F01F03 		and	r3, r3, #31
 1111 015a A376     		strb	r3, [r4, #26]
1997:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1112              		.loc 1 1997 0
 1113 015c 6376     		strb	r3, [r4, #25]
 1114              		.loc 1 2000 0
 1115 015e 034B     		ldr	r3, .L87+8
 1116 0160 DA72     		strb	r2, [r3, #11]
 1117              	.L69:
 1118 0162 38BD     		pop	{r3, r4, r5, pc}
 1119              	.LVL113:
 1120              	.L88:
 1121              		.align	2
 1122              	.L87:
 1123 0164 00000000 		.word	.LANCHOR1
 1124 0168 00000000 		.word	clkn
 1125 016c 00000000 		.word	.LANCHOR0
 1126              	.LBE13:
 1127              	.LBE12:
 1128              		.cfi_endproc
 1129              	.LFE24:
 1131              		.global	__aeabi_llsl
 1132              		.section	.text.vendor_request_handler,"ax",%progbits
 1133              		.align	1
 1134              		.thumb
 1135              		.thumb_func
 1137              	vendor_request_handler:
 1138              	.LFB2:
 185:bluetooth_rxtx.c **** 	uint32_t clock;
 1139              		.loc 1 185 0
 1140              		.cfi_startproc
 1141              		@ args = 0, pretend = 0, frame = 0
 1142              		@ frame_needed = 0, uses_anonymous_args = 0
 1143              	.LVL114:
 1144 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1145              		.cfi_def_cfa_offset 24
 1146              		.cfi_offset 4, -24
 1147              		.cfi_offset 5, -20
 1148              		.cfi_offset 6, -16
 1149              		.cfi_offset 7, -12
 1150              		.cfi_offset 8, -8
 1151              		.cfi_offset 14, -4
 1152              	.LVL115:
 185:bluetooth_rxtx.c **** 	uint32_t clock;
 1153              		.loc 1 185 0
 1154 0004 0D46     		mov	r5, r1
 1155 0006 1646     		mov	r6, r2
 1156 0008 1C46     		mov	r4, r3
 192:bluetooth_rxtx.c **** 
 1157              		.loc 1 192 0
 1158 000a 4528     		cmp	r0, #69
 1159 000c 00F20083 		bhi	.L201
 1160 0010 DFE810F0 		tbh	[pc, r0, lsl #1]
ARM GAS  /tmp/cckWTbJW.s 			page 59


 1161              	.LVL116:
 1162              	.L92:
 1163 0014 0001     		.2byte	(.L219-.L92)/2
 1164 0016 4800     		.2byte	(.L93-.L92)/2
 1165 0018 4D00     		.2byte	(.L94-.L92)/2
 1166 001a 5100     		.2byte	(.L95-.L92)/2
 1167 001c 5600     		.2byte	(.L96-.L92)/2
 1168 001e 5900     		.2byte	(.L97-.L92)/2
 1169 0020 5E00     		.2byte	(.L98-.L92)/2
 1170 0022 6100     		.2byte	(.L99-.L92)/2
 1171 0024 6300     		.2byte	(.L100-.L92)/2
 1172 0026 6700     		.2byte	(.L101-.L92)/2
 1173 0028 6C00     		.2byte	(.L102-.L92)/2
 1174 002a C100     		.2byte	(.L103-.L92)/2
 1175 002c C800     		.2byte	(.L104-.L92)/2
 1176 002e 0501     		.2byte	(.L234-.L92)/2
 1177 0030 7A00     		.2byte	(.L106-.L92)/2
 1178 0032 7500     		.2byte	(.L107-.L92)/2
 1179 0034 7F00     		.2byte	(.L108-.L92)/2
 1180 0036 8400     		.2byte	(.L109-.L92)/2
 1181 0038 8700     		.2byte	(.L110-.L92)/2
 1182 003a 8C00     		.2byte	(.L111-.L92)/2
 1183 003c 9400     		.2byte	(.L112-.L92)/2
 1184 003e B900     		.2byte	(.L113-.L92)/2
 1185 0040 BB00     		.2byte	(.L114-.L92)/2
 1186 0042 BD00     		.2byte	(.L115-.L92)/2
 1187 0044 FE00     		.2byte	(.L116-.L92)/2
 1188 0046 0201     		.2byte	(.L117-.L92)/2
 1189 0048 FE02     		.2byte	(.L201-.L92)/2
 1190 004a 0701     		.2byte	(.L118-.L92)/2
 1191 004c 9800     		.2byte	(.L119-.L92)/2
 1192 004e 9F00     		.2byte	(.L120-.L92)/2
 1193 0050 A900     		.2byte	(.L121-.L92)/2
 1194 0052 A700     		.2byte	(.L122-.L92)/2
 1195 0054 AB00     		.2byte	(.L123-.L92)/2
 1196 0056 3401     		.2byte	(.L124-.L92)/2
 1197 0058 2501     		.2byte	(.L125-.L92)/2
 1198 005a 5101     		.2byte	(.L126-.L92)/2
 1199 005c 5401     		.2byte	(.L127-.L92)/2
 1200 005e 5801     		.2byte	(.L128-.L92)/2
 1201 0060 5C01     		.2byte	(.L129-.L92)/2
 1202 0062 AE01     		.2byte	(.L130-.L92)/2
 1203 0064 E601     		.2byte	(.L131-.L92)/2
 1204 0066 0A02     		.2byte	(.L132-.L92)/2
 1205 0068 4A02     		.2byte	(.L133-.L92)/2
 1206 006a 5202     		.2byte	(.L134-.L92)/2
 1207 006c 5D02     		.2byte	(.L135-.L92)/2
 1208 006e FB02     		.2byte	(.L194-.L92)/2
 1209 0070 6C02     		.2byte	(.L137-.L92)/2
 1210 0072 7102     		.2byte	(.L138-.L92)/2
 1211 0074 7702     		.2byte	(.L139-.L92)/2
 1212 0076 7E02     		.2byte	(.L140-.L92)/2
 1213 0078 8D02     		.2byte	(.L141-.L92)/2
 1214 007a F301     		.2byte	(.L142-.L92)/2
 1215 007c 0002     		.2byte	(.L143-.L92)/2
 1216 007e 9B02     		.2byte	(.L144-.L92)/2
 1217 0080 D102     		.2byte	(.L145-.L92)/2
ARM GAS  /tmp/cckWTbJW.s 			page 60


 1218 0082 4301     		.2byte	(.L146-.L92)/2
 1219 0084 DB02     		.2byte	(.L147-.L92)/2
 1220 0086 FE02     		.2byte	(.L201-.L92)/2
 1221 0088 A302     		.2byte	(.L148-.L92)/2
 1222 008a F202     		.2byte	(.L149-.L92)/2
 1223 008c F602     		.2byte	(.L150-.L92)/2
 1224 008e CE01     		.2byte	(.L151-.L92)/2
 1225 0090 E101     		.2byte	(.L152-.L92)/2
 1226 0092 1502     		.2byte	(.L153-.L92)/2
 1227 0094 FE02     		.2byte	(.L201-.L92)/2
 1228 0096 4600     		.2byte	(.L154-.L92)/2
 1229 0098 B802     		.2byte	(.L155-.L92)/2
 1230 009a 2301     		.2byte	(.L156-.L92)/2
 1231 009c C802     		.2byte	(.L157-.L92)/2
 1232 009e 1C02     		.2byte	(.L158-.L92)/2
 1233              	.L154:
 1234 00a0 0024     		movs	r4, #0
 1235              	.LVL117:
 1236 00a2 5FE2     		b	.L159
 1237              	.LVL118:
 1238              	.L93:
 199:bluetooth_rxtx.c **** 		*data_len = 0;
 1239              		.loc 1 199 0
 1240 00a4 A34B     		ldr	r3, .L243
 1241 00a6 0120     		movs	r0, #1
 1242              	.LVL119:
 1243 00a8 9874     		strb	r0, [r3, #18]
 200:bluetooth_rxtx.c **** 		break;
 1244              		.loc 1 200 0
 1245 00aa 0023     		movs	r3, #0
 1246 00ac AFE1     		b	.L211
 1247              	.LVL120:
 1248              	.L94:
 204:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 1249              		.loc 1 204 0
 1250 00ae A14B     		ldr	r3, .L243
 1251 00b0 0222     		movs	r2, #2
 1252              	.LVL121:
 1253 00b2 9A72     		strb	r2, [r3, #10]
 1254 00b4 E0E0     		b	.L235
 1255              	.LVL122:
 1256              	.L95:
 210:bluetooth_rxtx.c **** 		*data_len = 1;
 1257              		.loc 1 210 0
 1258 00b6 A04B     		ldr	r3, .L243+4
 1259 00b8 1B68     		ldr	r3, [r3]
 1260 00ba C3F34003 		ubfx	r3, r3, #1, #1
 1261 00be 03E1     		b	.L213
 1262              	.L96:
 215:bluetooth_rxtx.c **** 			USRLED_SET;
 1263              		.loc 1 215 0
 1264 00c0 0A88     		ldrh	r2, [r1]
 1265              	.LVL123:
 1266 00c2 0223     		movs	r3, #2
 1267 00c4 15E0     		b	.L231
 1268              	.LVL124:
 1269              	.L97:
ARM GAS  /tmp/cckWTbJW.s 			page 61


 222:bluetooth_rxtx.c **** 		*data_len = 1;
 1270              		.loc 1 222 0
 1271 00c6 9C4B     		ldr	r3, .L243+4
 1272 00c8 1B68     		ldr	r3, [r3]
 1273 00ca C3F30013 		ubfx	r3, r3, #4, #1
 1274 00ce FBE0     		b	.L213
 1275              	.L98:
 227:bluetooth_rxtx.c **** 			RXLED_SET;
 1276              		.loc 1 227 0
 1277 00d0 0A88     		ldrh	r2, [r1]
 1278              	.LVL125:
 1279 00d2 1023     		movs	r3, #16
 1280 00d4 0DE0     		b	.L231
 1281              	.LVL126:
 1282              	.L99:
 234:bluetooth_rxtx.c **** 		*data_len = 1;
 1283              		.loc 1 234 0
 1284 00d6 984B     		ldr	r3, .L243+4
 1285 00d8 24E0     		b	.L238
 1286              	.L100:
 239:bluetooth_rxtx.c **** 			TXLED_SET;
 1287              		.loc 1 239 0
 1288 00da 0A88     		ldrh	r2, [r1]
 1289              	.LVL127:
 1290 00dc 4FF48073 		mov	r3, #256
 1291 00e0 07E0     		b	.L231
 1292              	.LVL128:
 1293              	.L101:
 246:bluetooth_rxtx.c **** 		*data_len = 1;
 1294              		.loc 1 246 0
 1295 00e2 954B     		ldr	r3, .L243+4
 1296 00e4 1B68     		ldr	r3, [r3]
 1297 00e6 C3F34023 		ubfx	r3, r3, #9, #1
 1298 00ea EDE0     		b	.L213
 1299              	.L102:
 251:bluetooth_rxtx.c **** 			CC1V8_SET;
 1300              		.loc 1 251 0
 1301 00ec 0A88     		ldrh	r2, [r1]
 1302              	.LVL129:
 1303 00ee 4FF40073 		mov	r3, #512
 1304              	.L231:
 1305 00f2 12B9     		cbnz	r2, .L242
 242:bluetooth_rxtx.c **** 		break;
 1306              		.loc 1 242 0
 1307 00f4 914A     		ldr	r2, .L243+8
 1308              	.L215:
 1309 00f6 1360     		str	r3, [r2]
 1310 00f8 87E2     		b	.L194
 1311              	.L242:
 252:bluetooth_rxtx.c **** 		else
 1312              		.loc 1 252 0
 1313 00fa 914A     		ldr	r2, .L243+12
 1314 00fc FBE7     		b	.L215
 1315              	.LVL130:
 1316              	.L107:
 258:bluetooth_rxtx.c **** 		break;
 1317              		.loc 1 258 0
ARM GAS  /tmp/cckWTbJW.s 			page 62


 1318 00fe 1046     		mov	r0, r2
 1319              	.LVL131:
 1320 0100 2146     		mov	r1, r4
 1321              	.LVL132:
 1322 0102 FFF7FEFF 		bl	get_part_num
 1323              	.LVL133:
 1324 0106 80E2     		b	.L194
 1325              	.LVL134:
 1326              	.L106:
 266:bluetooth_rxtx.c **** 		break;
 1327              		.loc 1 266 0
 1328 0108 1046     		mov	r0, r2
 1329              	.LVL135:
 1330 010a 2146     		mov	r1, r4
 1331              	.LVL136:
 1332 010c FFF7FEFF 		bl	get_device_serial
 1333              	.LVL137:
 1334 0110 7BE2     		b	.L194
 1335              	.LVL138:
 1336              	.L108:
 271:bluetooth_rxtx.c **** 		*data_len = 1;
 1337              		.loc 1 271 0
 1338 0112 8C4B     		ldr	r3, .L243+16
 1339 0114 1B68     		ldr	r3, [r3]
 1340 0116 C3F3C013 		ubfx	r3, r3, #7, #1
 1341 011a D5E0     		b	.L213
 1342              	.L109:
 276:bluetooth_rxtx.c **** 			PAEN_SET;
 1343              		.loc 1 276 0
 1344 011c 0A88     		ldrh	r2, [r1]
 1345              	.LVL139:
 1346 011e 8023     		movs	r3, #128
 1347 0120 07E0     		b	.L233
 1348              	.LVL140:
 1349              	.L110:
 283:bluetooth_rxtx.c **** 		*data_len = 1;
 1350              		.loc 1 283 0
 1351 0122 884B     		ldr	r3, .L243+16
 1352              	.L238:
 1353 0124 1B68     		ldr	r3, [r3]
 1354 0126 C3F30023 		ubfx	r3, r3, #8, #1
 1355 012a CDE0     		b	.L213
 1356              	.L111:
 288:bluetooth_rxtx.c **** 			HGM_SET;
 1357              		.loc 1 288 0
 1358 012c 0A88     		ldrh	r2, [r1]
 1359              	.LVL141:
 1360 012e 4FF48073 		mov	r3, #256
 1361              	.L233:
 1362 0132 0AB1     		cbz	r2, .L165
 289:bluetooth_rxtx.c **** 		else
 1363              		.loc 1 289 0
 1364 0134 844A     		ldr	r2, .L243+20
 1365 0136 DEE7     		b	.L215
 1366              	.L165:
 291:bluetooth_rxtx.c **** 		break;
 1367              		.loc 1 291 0
ARM GAS  /tmp/cckWTbJW.s 			page 63


 1368 0138 844A     		ldr	r2, .L243+24
 1369 013a DCE7     		b	.L215
 1370              	.LVL142:
 1371              	.L112:
 297:bluetooth_rxtx.c **** 		break;
 1372              		.loc 1 297 0
 1373 013c 0322     		movs	r2, #3
 1374              	.LVL143:
 1375              	.L218:
 1376 013e 7D4B     		ldr	r3, .L243
 1377 0140 9A74     		strb	r2, [r3, #18]
 1378 0142 62E2     		b	.L194
 1379              	.LVL144:
 1380              	.L119:
 301:bluetooth_rxtx.c **** 		*data_len = 1;
 1381              		.loc 1 301 0
 1382 0144 0520     		movs	r0, #5
 1383              	.LVL145:
 1384 0146 FFF7FEFF 		bl	cc2400_get
 1385              	.LVL146:
 1386 014a 00F00700 		and	r0, r0, #7
 1387 014e 3070     		strb	r0, [r6]
 1388 0150 E9E1     		b	.L208
 1389              	.LVL147:
 1390              	.L120:
 306:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 1391              		.loc 1 306 0
 1392 0152 0988     		ldrh	r1, [r1]
 1393              	.LVL148:
 1394 0154 0729     		cmp	r1, #7
 1395 0156 00F25B82 		bhi	.L201
 307:bluetooth_rxtx.c **** 		} else {
 1396              		.loc 1 307 0
 1397 015a 0520     		movs	r0, #5
 1398              	.LVL149:
 1399 015c 41F00801 		orr	r1, r1, #8
 1400 0160 FDE1     		b	.L223
 1401              	.LVL150:
 1402              	.L122:
 314:bluetooth_rxtx.c **** 		break;
 1403              		.loc 1 314 0
 1404 0162 0522     		movs	r2, #5
 1405              	.LVL151:
 1406 0164 EBE7     		b	.L218
 1407              	.LVL152:
 1408              	.L121:
 318:bluetooth_rxtx.c **** 		break;
 1409              		.loc 1 318 0
 1410 0166 0622     		movs	r2, #6
 1411              	.LVL153:
 1412 0168 E9E7     		b	.L218
 1413              	.LVL154:
 1414              	.L123:
 323:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 1415              		.loc 1 323 0
 1416 016a 794B     		ldr	r3, .L243+28
 1417 016c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
ARM GAS  /tmp/cckWTbJW.s 			page 64


 1418              	.LVL155:
 1419 016e 3270     		strb	r2, [r6]
 324:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 1420              		.loc 1 324 0
 1421 0170 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1422 0172 7270     		strb	r2, [r6, #1]
 325:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 1423              		.loc 1 325 0
 1424 0174 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1425 0176 B270     		strb	r2, [r6, #2]
 326:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 1426              		.loc 1 326 0
 1427 0178 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 1428 017a F270     		strb	r2, [r6, #3]
 327:bluetooth_rxtx.c **** 		*data_len = 5;
 1429              		.loc 1 327 0
 1430 017c 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 1431 017e 3371     		strb	r3, [r6, #4]
 328:bluetooth_rxtx.c **** 		break;
 1432              		.loc 1 328 0
 1433 0180 0523     		movs	r3, #5
 1434              	.LVL156:
 1435              	.L221:
 1436 0182 2360     		str	r3, [r4]
 1437 0184 41E2     		b	.L194
 1438              	.LVL157:
 1439              	.L113:
 332:bluetooth_rxtx.c **** 		break;
 1440              		.loc 1 332 0
 1441 0186 0022     		movs	r2, #0
 1442              	.LVL158:
 1443 0188 D9E7     		b	.L218
 1444              	.LVL159:
 1445              	.L114:
 336:bluetooth_rxtx.c **** 		*data_len = 1;
 1446              		.loc 1 336 0
 1447 018a 6A4B     		ldr	r3, .L243
 1448 018c 9BE0     		b	.L212
 1449              	.L115:
 341:bluetooth_rxtx.c **** 		break;
 1450              		.loc 1 341 0
 1451 018e 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 1452              	.LVL160:
 1453 0190 684B     		ldr	r3, .L243
 1454 0192 1A70     		strb	r2, [r3]
 1455 0194 39E2     		b	.L194
 1456              	.LVL161:
 1457              	.L103:
 345:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 1458              		.loc 1 345 0
 1459 0196 6F4B     		ldr	r3, .L243+32
 1460 0198 1A88     		ldrh	r2, [r3]
 1461              	.LVL162:
 1462 019a 3270     		strb	r2, [r6]
 346:bluetooth_rxtx.c **** 		*data_len = 2;
 1463              		.loc 1 346 0
 1464 019c 1B88     		ldrh	r3, [r3]
ARM GAS  /tmp/cckWTbJW.s 			page 65


 1465 019e C3F30723 		ubfx	r3, r3, #8, #8
 1466 01a2 A6E1     		b	.L241
 1467              	.LVL163:
 1468              	.L104:
 351:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1469              		.loc 1 351 0
 1470 01a4 0A88     		ldrh	r2, [r1]
 1471              	.LVL164:
 1472 01a6 634B     		ldr	r3, .L243
 1473 01a8 DA81     		strh	r2, [r3, #14]	@ movhi
 353:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1474              		.loc 1 353 0
 1475 01aa D989     		ldrh	r1, [r3, #14]
 1476              	.LVL165:
 1477 01ac 40F6EA22 		movw	r2, #2794
 1478 01b0 89B2     		uxth	r1, r1
 1479 01b2 9142     		cmp	r1, r2
 1480 01b4 04D9     		bls	.L166
 354:bluetooth_rxtx.c **** 			requested_channel = 2402;
 1481              		.loc 1 354 0
 1482 01b6 0122     		movs	r2, #1
 1483 01b8 9A72     		strb	r2, [r3, #10]
 355:bluetooth_rxtx.c **** 		}
 1484              		.loc 1 355 0
 1485 01ba 40F66212 		movw	r2, #2402
 1486 01be 15E0     		b	.L169
 1487              	.L166:
 359:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 1488              		.loc 1 359 0
 1489 01c0 0022     		movs	r2, #0
 1490 01c2 9A72     		strb	r2, [r3, #10]
 360:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1491              		.loc 1 360 0
 1492 01c4 D989     		ldrh	r1, [r3, #14]
 1493 01c6 40F6DC02 		movw	r2, #2268
 1494 01ca 89B2     		uxth	r1, r1
 1495 01cc 9142     		cmp	r1, r2
 1496 01ce 84BF     		itt	hi
 1497 01d0 DA89     		ldrhhi	r2, [r3, #14]
 1498 01d2 92B2     		uxthhi	r2, r2
 1499 01d4 DA81     		strh	r2, [r3, #14]	@ movhi
 361:bluetooth_rxtx.c **** 		}
 1500              		.loc 1 361 0
 1501 01d6 D989     		ldrh	r1, [r3, #14]
 1502 01d8 40F6E922 		movw	r2, #2793
 1503 01dc 89B2     		uxth	r1, r1
 1504 01de 9142     		cmp	r1, r2
 1505 01e0 97BF     		itett	ls
 1506 01e2 544A     		ldrls	r2, .L243
 1507 01e4 40F6EA22 		movwhi	r2, #2794
 1508 01e8 D289     		ldrhls	r2, [r2, #14]
 1509 01ea 92B2     		uxthls	r2, r2
 1510              	.L169:
 361:bluetooth_rxtx.c **** 		}
 1511              		.loc 1 361 0 is_stmt 0 discriminator 3
 1512 01ec DA81     		strh	r2, [r3, #14]	@ movhi
 364:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
ARM GAS  /tmp/cckWTbJW.s 			page 66


 1513              		.loc 1 364 0 is_stmt 1 discriminator 3
 1514 01ee D889     		ldrh	r0, [r3, #14]
 1515              	.LVL166:
 1516 01f0 584A     		ldr	r2, .L243+32
 1517 01f2 80B2     		uxth	r0, r0
 1518 01f4 A2F84A00 		strh	r0, [r2, #74]	@ movhi
 365:bluetooth_rxtx.c **** 			channel = requested_channel;
 1519              		.loc 1 365 0 discriminator 3
 1520 01f8 5B7C     		ldrb	r3, [r3, #17]	@ zero_extendqisi2
 364:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1521              		.loc 1 364 0 discriminator 3
 1522 01fa 4E49     		ldr	r1, .L243
 365:bluetooth_rxtx.c **** 			channel = requested_channel;
 1523              		.loc 1 365 0 discriminator 3
 1524 01fc 092B     		cmp	r3, #9
 1525 01fe 00F00482 		beq	.L194
 366:bluetooth_rxtx.c **** 			requested_channel = 0;
 1526              		.loc 1 366 0
 1527 0202 CB89     		ldrh	r3, [r1, #14]
 1528 0204 9BB2     		uxth	r3, r3
 1529 0206 1380     		strh	r3, [r2]	@ movhi
 367:bluetooth_rxtx.c **** 
 1530              		.loc 1 367 0
 1531 0208 0023     		movs	r3, #0
 1532 020a CB81     		strh	r3, [r1, #14]	@ movhi
 371:bluetooth_rxtx.c **** 		}
 1533              		.loc 1 371 0
 1534 020c 1088     		ldrh	r0, [r2]
 1535 020e 98E1     		b	.L225
 1536              	.LVL167:
 1537              	.L116:
 376:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 1538              		.loc 1 376 0
 1539 0210 FFF7FEFF 		bl	set_isp
 1540              	.LVL168:
 1541              	.L219:
 377:bluetooth_rxtx.c **** 		break;
 1542              		.loc 1 377 0
 1543 0214 0023     		movs	r3, #0
 1544 0216 B4E7     		b	.L221
 1545              	.LVL169:
 1546              	.L117:
 381:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 1547              		.loc 1 381 0
 1548 0218 4F4A     		ldr	r2, .L243+36
 1549              	.LVL170:
 1550 021a 504B     		ldr	r3, .L243+40
 1551 021c 1A60     		str	r2, [r3]
 1552              	.L234:
 382:bluetooth_rxtx.c **** 		break;
 1553              		.loc 1 382 0
 1554 021e 0B22     		movs	r2, #11
 1555 0220 8DE7     		b	.L218
 1556              	.LVL171:
 1557              	.L118:
 386:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1558              		.loc 1 386 0
ARM GAS  /tmp/cckWTbJW.s 			page 67


 1559 0222 0A88     		ldrh	r2, [r1]
 1560              	.LVL172:
 1561 0224 6FF40066 		mvn	r6, #2048
 1562              	.LVL173:
 1563 0228 9319     		adds	r3, r2, r6
 1564 022a 40F2FF31 		movw	r1, #1023
 1565              	.LVL174:
 1566 022e 9BB2     		uxth	r3, r3
 1567 0230 8B42     		cmp	r3, r1
 1568 0232 00F2ED81 		bhi	.L201
 387:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1569              		.loc 1 387 0 discriminator 1
 1570 0236 6B88     		ldrh	r3, [r5, #2]
 386:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1571              		.loc 1 386 0 discriminator 1
 1572 0238 6FF40065 		mvn	r5, #2048
 1573              	.LVL175:
 1574 023c 5819     		adds	r0, r3, r5
 1575              	.LVL176:
 1576 023e 80B2     		uxth	r0, r0
 1577 0240 8842     		cmp	r0, r1
 1578 0242 00F2E581 		bhi	.L201
 387:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1579              		.loc 1 387 0 discriminator 1
 1580 0246 9342     		cmp	r3, r2
 1581 0248 C0F0E281 		bcc	.L201
 390:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 1582              		.loc 1 390 0
 1583 024c 4149     		ldr	r1, .L243+32
 1584 024e A1F84C20 		strh	r2, [r1, #76]	@ movhi
 391:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 1585              		.loc 1 391 0
 1586 0252 A1F84E30 		strh	r3, [r1, #78]	@ movhi
 392:bluetooth_rxtx.c **** 		*data_len = 0;
 1587              		.loc 1 392 0
 1588 0256 0422     		movs	r2, #4
 1589 0258 0DE0     		b	.L236
 1590              	.LVL177:
 1591              	.L156:
 397:bluetooth_rxtx.c **** 		*data_len = 0;
 1592              		.loc 1 397 0
 1593 025a 0F22     		movs	r2, #15
 1594              	.LVL178:
 1595 025c 0BE0     		b	.L236
 1596              	.LVL179:
 1597              	.L125:
 402:bluetooth_rxtx.c **** 			return 0;
 1598              		.loc 1 402 0
 1599 025e 0B88     		ldrh	r3, [r1]
 1600 0260 B3F5807F 		cmp	r3, #256
 1601 0264 00F2D481 		bhi	.L201
 404:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 1602              		.loc 1 404 0
 1603 0268 3A4A     		ldr	r2, .L243+32
 1604              	.LVL180:
 1605 026a C3F13603 		rsb	r3, r3, #54
 1606 026e DBB2     		uxtb	r3, r3
ARM GAS  /tmp/cckWTbJW.s 			page 68


 1607 0270 82F85030 		strb	r3, [r2, #80]
 405:bluetooth_rxtx.c **** 		*data_len = 0;
 1608              		.loc 1 405 0
 1609 0274 0722     		movs	r2, #7
 1610              	.LVL181:
 1611              	.L236:
 1612 0276 2F4B     		ldr	r3, .L243
 1613              	.L235:
 1614 0278 9A74     		strb	r2, [r3, #18]
 1615 027a CBE7     		b	.L219
 1616              	.LVL182:
 1617              	.L124:
 410:bluetooth_rxtx.c **** 		data[1] = 0x00;
 1618              		.loc 1 410 0
 1619 027c 0023     		movs	r3, #0
 1620 027e 1370     		strb	r3, [r2]
 411:bluetooth_rxtx.c **** 
 1621              		.loc 1 411 0
 1622 0280 5370     		strb	r3, [r2, #1]
 413:bluetooth_rxtx.c **** 		data[2] = length;
 1623              		.loc 1 413 0
 1624 0282 3748     		ldr	r0, .L243+44
 1625              	.LVL183:
 1626 0284 FFF7FEFF 		bl	strlen
 1627              	.LVL184:
 1628 0288 C5B2     		uxtb	r5, r0
 1629              	.LVL185:
 414:bluetooth_rxtx.c **** 
 1630              		.loc 1 414 0
 1631 028a B570     		strb	r5, [r6, #2]
 416:bluetooth_rxtx.c **** 
 1632              		.loc 1 416 0
 1633 028c 2A46     		mov	r2, r5
 1634 028e F01C     		adds	r0, r6, #3
 1635 0290 3349     		ldr	r1, .L243+44
 1636 0292 FFF7FEFF 		bl	memcpy
 1637              	.LVL186:
 418:bluetooth_rxtx.c **** 		break;
 1638              		.loc 1 418 0
 1639 0296 0335     		adds	r5, r5, #3
 1640              	.LVL187:
 1641 0298 0BE0     		b	.L224
 1642              	.LVL188:
 1643              	.L146:
 422:bluetooth_rxtx.c **** 		data[0] = length;
 1644              		.loc 1 422 0
 1645 029a 3248     		ldr	r0, .L243+48
 1646              	.LVL189:
 1647 029c FFF7FEFF 		bl	strlen
 1648              	.LVL190:
 1649 02a0 C5B2     		uxtb	r5, r0
 1650              	.LVL191:
 423:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 1651              		.loc 1 423 0
 1652 02a2 3046     		mov	r0, r6
 1653 02a4 00F8015B 		strb	r5, [r0], #1
 424:bluetooth_rxtx.c **** 		*data_len = 1 + length;
ARM GAS  /tmp/cckWTbJW.s 			page 69


 1654              		.loc 1 424 0
 1655 02a8 2A46     		mov	r2, r5
 1656 02aa 2E49     		ldr	r1, .L243+48
 1657 02ac FFF7FEFF 		bl	memcpy
 1658              	.LVL192:
 425:bluetooth_rxtx.c **** 		break;
 1659              		.loc 1 425 0
 1660 02b0 0135     		adds	r5, r5, #1
 1661              	.LVL193:
 1662              	.L224:
 1663 02b2 2560     		str	r5, [r4]
 1664 02b4 A9E1     		b	.L194
 1665              	.LVL194:
 1666              	.L126:
 429:bluetooth_rxtx.c **** 		*data_len = 1;
 1667              		.loc 1 429 0
 1668 02b6 0120     		movs	r0, #1
 1669              	.LVL195:
 1670 02b8 1070     		strb	r0, [r2]
 1671 02ba 35E1     		b	.L209
 1672              	.LVL196:
 1673              	.L127:
 434:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1674              		.loc 1 434 0
 1675 02bc 0A88     		ldrh	r2, [r1]
 1676              	.LVL197:
 1677 02be 2A4B     		ldr	r3, .L243+52
 1678 02c0 1A70     		strb	r2, [r3]
 1679 02c2 3CE1     		b	.L222
 1680              	.LVL198:
 1681              	.L128:
 439:bluetooth_rxtx.c **** 		*data_len = 1;
 1682              		.loc 1 439 0
 1683 02c4 284B     		ldr	r3, .L243+52
 1684              	.L212:
 1685 02c6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1686              	.L213:
 1687 02c8 3370     		strb	r3, [r6]
 1688 02ca 2CE1     		b	.L208
 1689              	.L129:
 444:bluetooth_rxtx.c **** 		target.syncword = 0;
 1690              		.loc 1 444 0
 1691 02cc 274F     		ldr	r7, .L243+56
 1692 02ce 0024     		movs	r4, #0
 1693              	.LVL199:
 1694 02d0 0025     		movs	r5, #0
 1695 02d2 C7E90045 		strd	r4, [r7]
 445:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 1696              		.loc 1 445 0
 1697 02d6 C7E90245 		strd	r4, [r7, #8]
 1698              	.LVL200:
 1699              	.LBB14:
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1700              		.loc 1 446 0
 1701 02da 4FF00008 		mov	r8, #0
 1702              	.LVL201:
 1703              	.L172:
ARM GAS  /tmp/cckWTbJW.s 			page 70


 447:bluetooth_rxtx.c **** 		}
 1704              		.loc 1 447 0 discriminator 2
 1705 02de 16F80800 		ldrb	r0, [r6, r8]	@ zero_extendqisi2
 1706 02e2 4FEAC802 		lsl	r2, r8, #3
 1707 02e6 0021     		movs	r1, #0
 1708 02e8 FFF7FEFF 		bl	__aeabi_llsl
 1709              	.LVL202:
 1710 02ec D7E90045 		ldrd	r4, [r7]
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1711              		.loc 1 446 0 discriminator 2
 1712 02f0 08F10108 		add	r8, r8, #1
 1713              	.LVL203:
 447:bluetooth_rxtx.c **** 		}
 1714              		.loc 1 447 0 discriminator 2
 1715 02f4 2043     		orrs	r0, r0, r4
 1716 02f6 2943     		orrs	r1, r1, r5
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1717              		.loc 1 446 0 discriminator 2
 1718 02f8 B8F1080F 		cmp	r8, #8
 447:bluetooth_rxtx.c **** 		}
 1719              		.loc 1 447 0 discriminator 2
 1720 02fc C7E90001 		strd	r0, [r7]
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1721              		.loc 1 446 0 discriminator 2
 1722 0300 EDD1     		bne	.L172
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1723              		.loc 1 446 0 is_stmt 0
 1724 0302 4FF00008 		mov	r8, #0
 1725              	.LVL204:
 1726              	.L174:
 1727 0306 06EB0803 		add	r3, r6, r8
 1728              	.LBE14:
 1729              	.LBB15:
 450:bluetooth_rxtx.c **** 		}
 1730              		.loc 1 450 0 is_stmt 1 discriminator 2
 1731 030a 187A     		ldrb	r0, [r3, #8]	@ zero_extendqisi2
 1732 030c 4FEAC802 		lsl	r2, r8, #3
 1733 0310 0021     		movs	r1, #0
 1734 0312 FFF7FEFF 		bl	__aeabi_llsl
 1735              	.LVL205:
 1736 0316 D7E90245 		ldrd	r4, [r7, #8]
 449:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1737              		.loc 1 449 0 discriminator 2
 1738 031a 08F10108 		add	r8, r8, #1
 1739              	.LVL206:
 450:bluetooth_rxtx.c **** 		}
 1740              		.loc 1 450 0 discriminator 2
 1741 031e 2043     		orrs	r0, r0, r4
 1742 0320 2943     		orrs	r1, r1, r5
 449:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1743              		.loc 1 449 0 discriminator 2
 1744 0322 B8F1080F 		cmp	r8, #8
 450:bluetooth_rxtx.c **** 		}
 1745              		.loc 1 450 0 discriminator 2
 1746 0326 C7E90201 		strd	r0, [r7, #8]
 449:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1747              		.loc 1 449 0 discriminator 2
ARM GAS  /tmp/cckWTbJW.s 			page 71


 1748 032a ECD1     		bne	.L174
 1749              	.LBE15:
 452:bluetooth_rxtx.c **** 		break;
 1750              		.loc 1 452 0
 1751 032c FFF7FEFF 		bl	precalc
 1752              	.LVL207:
 1753 0330 6BE1     		b	.L194
 1754              	.L244:
 1755 0332 00BF     		.align	2
 1756              	.L243:
 1757 0334 00000000 		.word	.LANCHOR0
 1758 0338 34C00920 		.word	537509940
 1759 033c 3CC00920 		.word	537509948
 1760 0340 38C00920 		.word	537509944
 1761 0344 54C00920 		.word	537509972
 1762 0348 58C00920 		.word	537509976
 1763 034c 5CC00920 		.word	537509980
 1764 0350 00000000 		.word	rr
 1765 0354 00000000 		.word	.LANCHOR1
 1766 0358 21BB0543 		.word	1124449057
 1767 035c 00000000 		.word	bootloader_ctrl
 1768 0360 00000000 		.word	.LC3
 1769 0364 A7000000 		.word	.LANCHOR2+167
 1770 0368 00000000 		.word	cs_threshold_req
 1771 036c 00000000 		.word	target
 1772              	.LVL208:
 1773              	.L130:
 456:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1774              		.loc 1 456 0
 1775 0370 A94A     		ldr	r2, .L245
 1776              	.LVL209:
 1777 0372 0023     		movs	r3, #0
 1778 0374 1360     		str	r3, [r2]
 1779              	.LVL210:
 1780              	.L176:
 1781              	.LBB16:
 458:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 1782              		.loc 1 458 0 discriminator 2
 1783 0376 1168     		ldr	r1, [r2]
 1784 0378 0902     		lsls	r1, r1, #8
 1785 037a 1160     		str	r1, [r2]
 459:bluetooth_rxtx.c **** 		}
 1786              		.loc 1 459 0 discriminator 2
 1787 037c F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 1788 037e 1168     		ldr	r1, [r2]
 457:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1789              		.loc 1 457 0 discriminator 2
 1790 0380 0133     		adds	r3, r3, #1
 1791              	.LVL211:
 459:bluetooth_rxtx.c **** 		}
 1792              		.loc 1 459 0 discriminator 2
 1793 0382 0143     		orrs	r1, r1, r0
 457:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1794              		.loc 1 457 0 discriminator 2
 1795 0384 042B     		cmp	r3, #4
 459:bluetooth_rxtx.c **** 		}
 1796              		.loc 1 459 0 discriminator 2
ARM GAS  /tmp/cckWTbJW.s 			page 72


 1797 0386 1160     		str	r1, [r2]
 457:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1798              		.loc 1 457 0 discriminator 2
 1799 0388 F5D1     		bne	.L176
 1800              	.LBE16:
 461:bluetooth_rxtx.c **** 		dma_discard = 1;
 1801              		.loc 1 461 0
 1802 038a A44B     		ldr	r3, .L245+4
 1803              	.LVL212:
 1804 038c 0222     		movs	r2, #2
 1805 038e 9A72     		strb	r2, [r3, #10]
 463:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1806              		.loc 1 463 0
 1807 0390 A34A     		ldr	r2, .L245+8
 462:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1808              		.loc 1 462 0
 1809 0392 0120     		movs	r0, #1
 463:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1810              		.loc 1 463 0
 1811 0394 4FF08051 		mov	r1, #268435456
 462:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1812              		.loc 1 462 0
 1813 0398 1874     		strb	r0, [r3, #16]
 463:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1814              		.loc 1 463 0
 1815 039a 1160     		str	r1, [r2]
 464:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 1816              		.loc 1 464 0
 1817 039c 7279     		ldrb	r2, [r6, #5]	@ zero_extendqisi2
 1818 039e 3179     		ldrb	r1, [r6, #4]	@ zero_extendqisi2
 1819 03a0 42EA0121 		orr	r1, r2, r1, lsl #8
 1820 03a4 9F4A     		ldr	r2, .L245+12
 1821 03a6 1180     		strh	r1, [r2]	@ movhi
 465:bluetooth_rxtx.c **** 		break;
 1822              		.loc 1 465 0
 1823 03a8 0822     		movs	r2, #8
 1824 03aa 9A74     		strb	r2, [r3, #18]
 466:bluetooth_rxtx.c **** 
 1825              		.loc 1 466 0
 1826 03ac BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1827              	.LVL213:
 1828              	.L151:
 469:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 1829              		.loc 1 469 0
 1830 03b0 9A4B     		ldr	r3, .L245+4
 1831 03b2 0522     		movs	r2, #5
 1832              	.LVL214:
 1833 03b4 9A72     		strb	r2, [r3, #10]
 470:bluetooth_rxtx.c **** 
 1834              		.loc 1 470 0
 1835 03b6 0E22     		movs	r2, #14
 1836 03b8 9A74     		strb	r2, [r3, #18]
 1837              	.LVL215:
 1838              	.LBB17:
 472:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1839              		.loc 1 472 0
 1840 03ba 0023     		movs	r3, #0
ARM GAS  /tmp/cckWTbJW.s 			page 73


 1841              	.LVL216:
 1842              	.L178:
 473:bluetooth_rxtx.c **** 		}
 1843              		.loc 1 473 0 discriminator 2
 1844 03bc 9A49     		ldr	r1, .L245+16
 1845 03be 0022     		movs	r2, #0
 1846 03c0 5A54     		strb	r2, [r3, r1]
 472:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1847              		.loc 1 472 0 discriminator 2
 1848 03c2 0133     		adds	r3, r3, #1
 1849              	.LVL217:
 1850 03c4 0A2B     		cmp	r3, #10
 1851 03c6 F9D1     		bne	.L178
 1852              	.LBE17:
 475:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1853              		.loc 1 475 0
 1854 03c8 984B     		ldr	r3, .L245+20
 1855              	.LVL218:
 476:bluetooth_rxtx.c **** 		break;
 1856              		.loc 1 476 0
 1857 03ca 0120     		movs	r0, #1
 1858              	.LVL219:
 475:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1859              		.loc 1 475 0
 1860 03cc 1A70     		strb	r2, [r3]
 476:bluetooth_rxtx.c **** 		break;
 1861              		.loc 1 476 0
 1862 03ce 984B     		ldr	r3, .L245+24
 1863 03d0 1870     		strb	r0, [r3]
 477:bluetooth_rxtx.c **** 
 1864              		.loc 1 477 0
 1865 03d2 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1866              	.LVL220:
 1867              	.L152:
 480:bluetooth_rxtx.c **** 		break;
 1868              		.loc 1 480 0
 1869 03d6 914B     		ldr	r3, .L245+4
 1870 03d8 0120     		movs	r0, #1
 1871              	.LVL221:
 1872 03da D872     		strb	r0, [r3, #11]
 481:bluetooth_rxtx.c **** 
 1873              		.loc 1 481 0
 1874 03dc BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1875              	.LVL222:
 1876              	.L131:
 484:bluetooth_rxtx.c **** 		clkn = clock;
 1877              		.loc 1 484 0
 1878 03e0 5378     		ldrb	r3, [r2, #1]	@ zero_extendqisi2
 1879 03e2 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 1880              	.LVL223:
 1881 03e4 1204     		lsls	r2, r2, #16
 1882 03e6 42EA0322 		orr	r2, r2, r3, lsl #8
 1883 03ea 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 1884 03ec 1A43     		orrs	r2, r2, r3
 1885 03ee F378     		ldrb	r3, [r6, #3]	@ zero_extendqisi2
 1886 03f0 42EA0362 		orr	r2, r2, r3, lsl #24
 1887              	.LVL224:
ARM GAS  /tmp/cckWTbJW.s 			page 74


 485:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1888              		.loc 1 485 0
 1889 03f4 8F4B     		ldr	r3, .L245+28
 1890 03f6 1A60     		str	r2, [r3]
 1891 03f8 A1E0     		b	.L222
 1892              	.LVL225:
 1893              	.L142:
 192:bluetooth_rxtx.c **** 
 1894              		.loc 1 192 0
 1895 03fa 0023     		movs	r3, #0
 1896              	.LVL226:
 1897              	.L180:
 1898              	.LBB18:
 491:bluetooth_rxtx.c **** 		}
 1899              		.loc 1 491 0 discriminator 2
 1900 03fc F15C     		ldrb	r1, [r6, r3]	@ zero_extendqisi2
 1901 03fe 8A4A     		ldr	r2, .L245+16
 1902 0400 9954     		strb	r1, [r3, r2]
 490:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 1903              		.loc 1 490 0 discriminator 2
 1904 0402 0133     		adds	r3, r3, #1
 1905              	.LVL227:
 1906 0404 0A2B     		cmp	r3, #10
 1907 0406 F9D1     		bne	.L180
 1908              	.LBE18:
 493:bluetooth_rxtx.c **** 		*data_len = 10;
 1909              		.loc 1 493 0
 1910 0408 894A     		ldr	r2, .L245+24
 1911 040a 0120     		movs	r0, #1
 1912              	.LVL228:
 1913 040c 1070     		strb	r0, [r2]
 1914              	.LVL229:
 1915              	.L211:
 494:bluetooth_rxtx.c **** 		break;
 1916              		.loc 1 494 0
 1917 040e 2360     		str	r3, [r4]
 495:bluetooth_rxtx.c **** 
 1918              		.loc 1 495 0
 1919 0410 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1920              	.LVL230:
 1921              	.L143:
 192:bluetooth_rxtx.c **** 
 1922              		.loc 1 192 0
 1923 0414 0023     		movs	r3, #0
 1924              	.LVL231:
 1925              	.L182:
 1926              	.LBB19:
 499:bluetooth_rxtx.c **** 		}
 1927              		.loc 1 499 0 discriminator 2
 1928 0416 8449     		ldr	r1, .L245+16
 1929 0418 0022     		movs	r2, #0
 1930 041a 5A54     		strb	r2, [r3, r1]
 498:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1931              		.loc 1 498 0 discriminator 2
 1932 041c 0133     		adds	r3, r3, #1
 1933              	.LVL232:
 1934 041e 0A2B     		cmp	r3, #10
ARM GAS  /tmp/cckWTbJW.s 			page 75


 1935 0420 F9D1     		bne	.L182
 1936              	.LBE19:
 501:bluetooth_rxtx.c **** 		*data_len = 10;
 1937              		.loc 1 501 0
 1938 0422 8349     		ldr	r1, .L245+24
 1939 0424 0A70     		strb	r2, [r1]
 1940 0426 ACE6     		b	.L221
 1941              	.LVL233:
 1942              	.L132:
 506:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1943              		.loc 1 506 0
 1944 0428 824B     		ldr	r3, .L245+28
 1945 042a 1968     		ldr	r1, [r3]
 1946              	.LVL234:
 1947              	.LBB20:
 507:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1948              		.loc 1 507 0
 1949 042c 0023     		movs	r3, #0
 1950              	.LVL235:
 1951              	.L184:
 1952 042e DA00     		lsls	r2, r3, #3
 508:bluetooth_rxtx.c **** 		}
 1953              		.loc 1 508 0 discriminator 2
 1954 0430 21FA02F2 		lsr	r2, r1, r2
 1955 0434 F254     		strb	r2, [r6, r3]
 507:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1956              		.loc 1 507 0 discriminator 2
 1957 0436 0133     		adds	r3, r3, #1
 1958              	.LVL236:
 1959 0438 042B     		cmp	r3, #4
 1960 043a F8D1     		bne	.L184
 1961 043c A1E6     		b	.L221
 1962              	.LVL237:
 1963              	.L153:
 1964              	.LBE20:
 514:bluetooth_rxtx.c **** 		break;
 1965              		.loc 1 514 0
 1966 043e 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 1967 0440 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1968              	.LVL238:
 1969 0442 43EA0222 		orr	r2, r3, r2, lsl #8
 1970 0446 774B     		ldr	r3, .L245+12
 1971 0448 1A80     		strh	r2, [r3]	@ movhi
 1972 044a DEE0     		b	.L194
 1973              	.LVL239:
 1974              	.L158:
 518:bluetooth_rxtx.c **** 
 1975              		.loc 1 518 0
 1976 044c 7A4B     		ldr	r3, .L245+32
 1977 044e 1078     		ldrb	r0, [r2]	@ zero_extendqisi2
 1978              	.LVL240:
 1979 0450 1988     		ldrh	r1, [r3]
 1980              	.LVL241:
 1981 0452 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1982              	.LVL242:
 1983 0454 89B2     		uxth	r1, r1
 1984 0456 42EA0022 		orr	r2, r2, r0, lsl #8
ARM GAS  /tmp/cckWTbJW.s 			page 76


 1985 045a 0A44     		add	r2, r2, r1
 1986 045c 92B2     		uxth	r2, r2
 1987 045e 1A80     		strh	r2, [r3]	@ movhi
 521:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 1988              		.loc 1 521 0
 1989 0460 1A88     		ldrh	r2, [r3]
 1990 0462 7649     		ldr	r1, .L245+36
 1991 0464 12B2     		sxth	r2, r2
 1992 0466 002A     		cmp	r2, #0
 1993 0468 754A     		ldr	r2, .L245+40
 1994 046a 07DA     		bge	.L185
 522:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1995              		.loc 1 522 0
 1996 046c 1B88     		ldrh	r3, [r3]
 1997 046e 4FF4A070 		mov	r0, #320
 1998 0472 5B42     		negs	r3, r3
 1999 0474 9BB2     		uxth	r3, r3
 2000 0476 90FBF3F3 		sdiv	r3, r0, r3
 2001 047a 0AE0     		b	.L239
 2002              	.L185:
 526:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 2003              		.loc 1 526 0
 2004 047c 1888     		ldrh	r0, [r3]
 2005 047e 00B2     		sxth	r0, r0
 2006 0480 0028     		cmp	r0, #0
 2007 0482 0DDD     		ble	.L186
 527:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2008              		.loc 1 527 0
 2009 0484 1B88     		ldrh	r3, [r3]
 2010 0486 4FF4A070 		mov	r0, #320
 2011 048a 1BB2     		sxth	r3, r3
 2012 048c 90FBF3F3 		sdiv	r3, r0, r3
 2013 0490 9BB2     		uxth	r3, r3
 2014              	.L239:
 2015 0492 1380     		strh	r3, [r2]	@ movhi
 528:bluetooth_rxtx.c **** 		}
 2016              		.loc 1 528 0
 2017 0494 6B4B     		ldr	r3, .L245+44
 2018 0496 1868     		ldr	r0, [r3]
 2019 0498 1388     		ldrh	r3, [r2]
 2020 049a 9BB2     		uxth	r3, r3
 2021 049c 0344     		add	r3, r3, r0
 2022 049e 01E0     		b	.L216
 2023              	.L186:
 532:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 2024              		.loc 1 532 0
 2025 04a0 0023     		movs	r3, #0
 2026 04a2 1380     		strh	r3, [r2]	@ movhi
 2027              	.L216:
 533:bluetooth_rxtx.c **** 		}
 2028              		.loc 1 533 0
 2029 04a4 0B60     		str	r3, [r1]
 2030 04a6 B0E0     		b	.L194
 2031              	.LVL243:
 2032              	.L133:
 541:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2033              		.loc 1 541 0
ARM GAS  /tmp/cckWTbJW.s 			page 77


 2034 04a8 5C4B     		ldr	r3, .L245+4
 539:bluetooth_rxtx.c **** 
 2035              		.loc 1 539 0
 2036 04aa 0022     		movs	r2, #0
 2037              	.LVL244:
 2038 04ac 2260     		str	r2, [r4]
 541:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2039              		.loc 1 541 0
 2040 04ae DA72     		strb	r2, [r3, #11]
 542:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 2041              		.loc 1 542 0
 2042 04b0 0322     		movs	r2, #3
 2043 04b2 9A72     		strb	r2, [r3, #10]
 543:bluetooth_rxtx.c **** 
 2044              		.loc 1 543 0
 2045 04b4 0922     		movs	r2, #9
 2046 04b6 3FE0     		b	.L220
 2047              	.LVL245:
 2048              	.L134:
 192:bluetooth_rxtx.c **** 
 2049              		.loc 1 192 0
 2050 04b8 0023     		movs	r3, #0
 2051              	.LVL246:
 2052              	.L188:
 2053              	.LBB21:
 551:bluetooth_rxtx.c **** 		}
 2054              		.loc 1 551 0 discriminator 2
 2055 04ba 6349     		ldr	r1, .L245+48
 2056 04bc DA00     		lsls	r2, r3, #3
 2057 04be 4968     		ldr	r1, [r1, #4]
 2058 04c0 21FA02F2 		lsr	r2, r1, r2
 2059 04c4 F254     		strb	r2, [r6, r3]
 550:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 2060              		.loc 1 550 0 discriminator 2
 2061 04c6 0133     		adds	r3, r3, #1
 2062              	.LVL247:
 2063 04c8 042B     		cmp	r3, #4
 2064 04ca F6D1     		bne	.L188
 2065 04cc 59E6     		b	.L221
 2066              	.LVL248:
 2067              	.L135:
 2068              	.LBE21:
 557:bluetooth_rxtx.c **** 		le.target_set = 1;
 2069              		.loc 1 557 0
 2070 04ce B378     		ldrb	r3, [r6, #2]	@ zero_extendqisi2
 2071 04d0 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 2072              	.LVL249:
 2073 04d2 1B04     		lsls	r3, r3, #16
 2074 04d4 43EA0223 		orr	r3, r3, r2, lsl #8
 2075 04d8 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2076 04da F078     		ldrb	r0, [r6, #3]	@ zero_extendqisi2
 2077              	.LVL250:
 2078 04dc 1343     		orrs	r3, r3, r2
 2079 04de 43EA0060 		orr	r0, r3, r0, lsl #24
 2080 04e2 FFF7FEFF 		bl	le_set_access_address
 2081              	.LVL251:
 558:bluetooth_rxtx.c **** 		break;
ARM GAS  /tmp/cckWTbJW.s 			page 78


 2082              		.loc 1 558 0
 2083 04e6 0120     		movs	r0, #1
 2084 04e8 574B     		ldr	r3, .L245+48
 2085 04ea 82E0     		b	.L210
 2086              	.LVL252:
 2087              	.L137:
 568:bluetooth_rxtx.c **** 		data[1] = 0x37;
 2088              		.loc 1 568 0
 2089 04ec 1323     		movs	r3, #19
 2090 04ee 1370     		strb	r3, [r2]
 569:bluetooth_rxtx.c **** 		*data_len = 2;
 2091              		.loc 1 569 0
 2092 04f0 3723     		movs	r3, #55
 2093              	.LVL253:
 2094              	.L241:
 2095 04f2 7370     		strb	r3, [r6, #1]
 2096 04f4 2FE0     		b	.L237
 2097              	.LVL254:
 2098              	.L138:
 574:bluetooth_rxtx.c **** 		*data_len = 1;
 2099              		.loc 1 574 0
 2100 04f6 544B     		ldr	r3, .L245+48
 2101 04f8 5B69     		ldr	r3, [r3, #20]
 2102 04fa 0033     		adds	r3, r3, #0
 2103 04fc 18BF     		it	ne
 2104 04fe 0123     		movne	r3, #1
 2105 0500 E2E6     		b	.L213
 2106              	.L139:
 579:bluetooth_rxtx.c **** 		break;
 2107              		.loc 1 579 0
 2108 0502 0A88     		ldrh	r2, [r1]
 2109              	.LVL255:
 2110 0504 504B     		ldr	r3, .L245+48
 2111 0506 0032     		adds	r2, r2, #0
 2112 0508 18BF     		it	ne
 2113 050a 0122     		movne	r2, #1
 2114 050c 5A61     		str	r2, [r3, #20]
 2115 050e 7CE0     		b	.L194
 2116              	.LVL256:
 2117              	.L140:
 583:bluetooth_rxtx.c **** 		if (p != NULL) {
 2118              		.loc 1 583 0
 2119 0510 FFF7FEFF 		bl	dequeue
 2120              	.LVL257:
 584:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 2121              		.loc 1 584 0
 2122 0514 0146     		mov	r1, r0
 2123 0516 28B1     		cbz	r0, .L189
 585:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 2124              		.loc 1 585 0
 2125 0518 3046     		mov	r0, r6
 2126              	.LVL258:
 2127 051a 4022     		movs	r2, #64
 2128 051c FFF7FEFF 		bl	memcpy
 2129              	.LVL259:
 586:bluetooth_rxtx.c **** 		} else {
 2130              		.loc 1 586 0
ARM GAS  /tmp/cckWTbJW.s 			page 79


 2131 0520 4023     		movs	r3, #64
 2132 0522 2EE6     		b	.L221
 2133              	.LVL260:
 2134              	.L189:
 588:bluetooth_rxtx.c **** 			*data_len = 1;
 2135              		.loc 1 588 0
 2136 0524 3070     		strb	r0, [r6]
 2137              	.LVL261:
 2138              	.L208:
 589:bluetooth_rxtx.c **** 		}
 2139              		.loc 1 589 0
 2140 0526 0120     		movs	r0, #1
 2141              	.L209:
 2142 0528 2060     		str	r0, [r4]
 2143 052a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2144              	.LVL262:
 2145              	.L141:
 596:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2146              		.loc 1 596 0
 2147 052e 3B4B     		ldr	r3, .L245+4
 594:bluetooth_rxtx.c **** 
 2148              		.loc 1 594 0
 2149 0530 0022     		movs	r2, #0
 2150              	.LVL263:
 2151 0532 2260     		str	r2, [r4]
 596:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2152              		.loc 1 596 0
 2153 0534 9A72     		strb	r2, [r3, #10]
 597:bluetooth_rxtx.c **** 
 2154              		.loc 1 597 0
 2155 0536 0A22     		movs	r2, #10
 2156              	.L220:
 2157 0538 9A74     		strb	r2, [r3, #18]
 599:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 2158              		.loc 1 599 0
 2159 053a FFF7FEFF 		bl	queue_init
 2160              	.LVL264:
 2161              	.L222:
 600:bluetooth_rxtx.c **** 		break;
 2162              		.loc 1 600 0
 2163 053e 424B     		ldr	r3, .L245+48
 2164 0540 1888     		ldrh	r0, [r3]
 2165              	.L225:
 2166 0542 80B2     		uxth	r0, r0
 2167 0544 FFF7FEFF 		bl	cs_threshold_calc_and_set
 2168              	.LVL265:
 2169 0548 5FE0     		b	.L194
 2170              	.LVL266:
 2171              	.L144:
 604:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 2172              		.loc 1 604 0
 2173 054a 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2174              	.LVL267:
 2175 054c FFF7FEFF 		bl	cc2400_get
 2176              	.LVL268:
 605:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 2177              		.loc 1 605 0
ARM GAS  /tmp/cckWTbJW.s 			page 80


 2178 0550 030A     		lsrs	r3, r0, #8
 2179 0552 3370     		strb	r3, [r6]
 606:bluetooth_rxtx.c **** 		*data_len = 2;
 2180              		.loc 1 606 0
 2181 0554 7070     		strb	r0, [r6, #1]
 2182              	.LVL269:
 2183              	.L237:
 607:bluetooth_rxtx.c **** 		break;
 2184              		.loc 1 607 0
 2185 0556 0223     		movs	r3, #2
 2186 0558 13E6     		b	.L221
 2187              	.LVL270:
 2188              	.L148:
 611:bluetooth_rxtx.c **** 		break;
 2189              		.loc 1 611 0
 2190 055a 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2191              	.LVL271:
 2192 055c 4988     		ldrh	r1, [r1, #2]
 2193              	.LVL272:
 2194              	.L223:
 2195 055e FFF7FEFF 		bl	cc2400_set
 2196              	.LVL273:
 2197 0562 52E0     		b	.L194
 2198              	.LVL274:
 2199              	.L159:
 615:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2200              		.loc 1 615 0 discriminator 1
 2201 0564 2B88     		ldrh	r3, [r5]
 2202 0566 A342     		cmp	r3, r4
 2203 0568 4FD9     		bls	.L194
 616:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 2204              		.loc 1 616 0 discriminator 2
 2205 056a 0323     		movs	r3, #3
 2206 056c 6343     		muls	r3, r4, r3
 2207              	.LVL275:
 2208 056e F218     		adds	r2, r6, r3
 2209              	.LVL276:
 2210 0570 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 2211 0572 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 2212              	.LVL277:
 617:bluetooth_rxtx.c **** 		}
 2213              		.loc 1 617 0 discriminator 2
 2214 0574 F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 2215 0576 42EA0121 		orr	r1, r2, r1, lsl #8
 615:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2216              		.loc 1 615 0 discriminator 2
 2217 057a 0134     		adds	r4, r4, #1
 2218              	.LVL278:
 617:bluetooth_rxtx.c **** 		}
 2219              		.loc 1 617 0 discriminator 2
 2220 057c FFF7FEFF 		bl	cc2400_set
 2221              	.LVL279:
 615:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2222              		.loc 1 615 0 discriminator 2
 2223 0580 E4B2     		uxtb	r4, r4
 2224              	.LVL280:
 2225 0582 EFE7     		b	.L159
ARM GAS  /tmp/cckWTbJW.s 			page 81


 2226              	.LVL281:
 2227              	.L155:
 192:bluetooth_rxtx.c **** 
 2228              		.loc 1 192 0
 2229 0584 0025     		movs	r5, #0
 2230              	.LVL282:
 2231              	.L193:
 624:bluetooth_rxtx.c **** 			data[i*3] = i;
 2232              		.loc 1 624 0 discriminator 2
 2233 0586 2846     		mov	r0, r5
 2234 0588 FFF7FEFF 		bl	cc2400_get
 2235              	.LVL283:
 625:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 2236              		.loc 1 625 0 discriminator 2
 2237 058c 3570     		strb	r5, [r6]
 623:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2238              		.loc 1 623 0 discriminator 2
 2239 058e 0135     		adds	r5, r5, #1
 2240              	.LVL284:
 2241 0590 EDB2     		uxtb	r5, r5
 2242              	.LVL285:
 626:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2243              		.loc 1 626 0 discriminator 2
 2244 0592 030A     		lsrs	r3, r0, #8
 623:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2245              		.loc 1 623 0 discriminator 2
 2246 0594 2E2D     		cmp	r5, #46
 626:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2247              		.loc 1 626 0 discriminator 2
 2248 0596 7370     		strb	r3, [r6, #1]
 627:bluetooth_rxtx.c **** 		}
 2249              		.loc 1 627 0 discriminator 2
 2250 0598 B070     		strb	r0, [r6, #2]
 2251 059a 06F10306 		add	r6, r6, #3
 623:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2252              		.loc 1 623 0 discriminator 2
 2253 059e F2D1     		bne	.L193
 629:bluetooth_rxtx.c **** 		break;
 2254              		.loc 1 629 0
 2255 05a0 8723     		movs	r3, #135
 2256 05a2 EEE5     		b	.L221
 2257              	.LVL286:
 2258              	.L157:
 633:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2259              		.loc 1 633 0
 2260 05a4 9279     		ldrb	r2, [r2, #6]	@ zero_extendqisi2
 2261              	.LVL287:
 634:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2262              		.loc 1 634 0
 2263 05a6 2948     		ldr	r0, .L245+52
 2264              	.LVL288:
 633:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2265              		.loc 1 633 0
 2266 05a8 0732     		adds	r2, r2, #7
 634:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2267              		.loc 1 634 0
 2268 05aa D2B2     		uxtb	r2, r2
ARM GAS  /tmp/cckWTbJW.s 			page 82


 2269 05ac 3146     		mov	r1, r6
 2270              	.LVL289:
 2271 05ae FFF7FEFF 		bl	memcpy
 2272              	.LVL290:
 636:bluetooth_rxtx.c **** 		*data_len = 0;
 2273              		.loc 1 636 0
 2274 05b2 1022     		movs	r2, #16
 2275 05b4 5FE6     		b	.L236
 2276              	.LVL291:
 2277              	.L145:
 641:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2278              		.loc 1 641 0
 2279 05b6 194C     		ldr	r4, .L245+4
 2280              	.LVL292:
 2281 05b8 1146     		mov	r1, r2
 2282              	.LVL293:
 2283 05ba 04F12000 		add	r0, r4, #32
 2284              	.LVL294:
 2285 05be 0622     		movs	r2, #6
 2286              	.LVL295:
 2287 05c0 FFF7FEFF 		bl	memcpy
 2288              	.LVL296:
 642:bluetooth_rxtx.c **** 		break;
 2289              		.loc 1 642 0
 2290 05c4 0C23     		movs	r3, #12
 2291 05c6 A374     		strb	r3, [r4, #18]
 2292 05c8 1FE0     		b	.L194
 2293              	.LVL297:
 2294              	.L147:
 648:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2295              		.loc 1 648 0
 2296 05ca 5279     		ldrb	r2, [r2, #5]	@ zero_extendqisi2
 2297              	.LVL298:
 2298 05cc 1E4B     		ldr	r3, .L245+48
 654:bluetooth_rxtx.c **** 		break;
 2299              		.loc 1 654 0
 2300 05ce 0120     		movs	r0, #1
 2301              	.LVL299:
 648:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2302              		.loc 1 648 0
 2303 05d0 83F83820 		strb	r2, [r3, #56]
 649:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 2304              		.loc 1 649 0
 2305 05d4 3279     		ldrb	r2, [r6, #4]	@ zero_extendqisi2
 2306 05d6 83F83920 		strb	r2, [r3, #57]
 650:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 2307              		.loc 1 650 0
 2308 05da F278     		ldrb	r2, [r6, #3]	@ zero_extendqisi2
 2309 05dc 83F83A20 		strb	r2, [r3, #58]
 651:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 2310              		.loc 1 651 0
 2311 05e0 B278     		ldrb	r2, [r6, #2]	@ zero_extendqisi2
 2312 05e2 83F83B20 		strb	r2, [r3, #59]
 652:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 2313              		.loc 1 652 0
 2314 05e6 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 2315 05e8 83F83C20 		strb	r2, [r3, #60]
ARM GAS  /tmp/cckWTbJW.s 			page 83


 653:bluetooth_rxtx.c **** 		le.target_set = 1;
 2316              		.loc 1 653 0
 2317 05ec 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2318 05ee 83F83D20 		strb	r2, [r3, #61]
 2319              	.LVL300:
 2320              	.L210:
 654:bluetooth_rxtx.c **** 		break;
 2321              		.loc 1 654 0
 2322 05f2 1864     		str	r0, [r3, #64]
 655:bluetooth_rxtx.c **** 
 2323              		.loc 1 655 0
 2324 05f4 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2325              	.LVL301:
 2326              	.L149:
 659:bluetooth_rxtx.c **** 		break;
 2327              		.loc 1 659 0
 2328 05f8 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 2329              	.LVL302:
 2330 05fa 084B     		ldr	r3, .L245+4
 2331 05fc DA74     		strb	r2, [r3, #19]
 2332 05fe 04E0     		b	.L194
 2333              	.LVL303:
 2334              	.L150:
 668:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 2335              		.loc 1 668 0
 2336 0600 064B     		ldr	r3, .L245+4
 2337 0602 0D22     		movs	r2, #13
 2338              	.LVL304:
 2339 0604 9A74     		strb	r2, [r3, #18]
 669:bluetooth_rxtx.c **** 		break;
 2340              		.loc 1 669 0
 2341 0606 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 2342 0608 1A75     		strb	r2, [r3, #20]
 2343              	.LVL305:
 2344              	.L194:
 675:bluetooth_rxtx.c **** }
 2345              		.loc 1 675 0
 2346 060a 0120     		movs	r0, #1
 2347 060c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2348              	.LVL306:
 2349              	.L201:
 309:bluetooth_rxtx.c **** 		}
 2350              		.loc 1 309 0
 2351 0610 0020     		movs	r0, #0
 676:bluetooth_rxtx.c **** 
 2352              		.loc 1 676 0
 2353 0612 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2354              	.LVL307:
 2355              	.L246:
 2356 0616 00BF     		.align	2
 2357              	.L245:
 2358 0618 00000000 		.word	clkn_offset
 2359 061c 00000000 		.word	.LANCHOR0
 2360 0620 98C00920 		.word	537510040
 2361 0624 00000000 		.word	clk100ns_offset
 2362 0628 00000000 		.word	afh_map
 2363 062c 00000000 		.word	used_channels
ARM GAS  /tmp/cckWTbJW.s 			page 84


 2364 0630 00000000 		.word	afh_enabled
 2365 0634 00000000 		.word	clkn
 2366 0638 00000000 		.word	clk_drift_ppm
 2367 063c 00000000 		.word	clkn_next_drift_fix
 2368 0640 00000000 		.word	clk_drift_correction
 2369 0644 00000000 		.word	clkn_last_drift_fix
 2370 0648 00000000 		.word	.LANCHOR1
 2371 064c 00000000 		.word	tx_pkt
 2372              		.cfi_endproc
 2373              	.LFE2:
 2375              		.section	.text.enqueue_with_ts,"ax",%progbits
 2376              		.align	1
 2377              		.global	enqueue_with_ts
 2378              		.thumb
 2379              		.thumb_func
 2381              	enqueue_with_ts:
 2382              	.LFB1:
 158:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2383              		.loc 1 158 0
 2384              		.cfi_startproc
 2385              		@ args = 0, pretend = 0, frame = 0
 2386              		@ frame_needed = 0, uses_anonymous_args = 0
 2387              	.LVL308:
 2388 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2389              		.cfi_def_cfa_offset 24
 2390              		.cfi_offset 4, -24
 2391              		.cfi_offset 5, -20
 2392              		.cfi_offset 6, -16
 2393              		.cfi_offset 7, -12
 2394              		.cfi_offset 8, -8
 2395              		.cfi_offset 14, -4
 158:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2396              		.loc 1 158 0
 2397 0004 0646     		mov	r6, r0
 2398 0006 0F46     		mov	r7, r1
 2399 0008 9046     		mov	r8, r2
 159:bluetooth_rxtx.c **** 
 2400              		.loc 1 159 0
 2401 000a FFF7FEFF 		bl	usb_enqueue
 2402              	.LVL309:
 2403 000e 104D     		ldr	r5, .L250
 162:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2404              		.loc 1 162 0
 2405 0010 0446     		mov	r4, r0
 2406 0012 28B9     		cbnz	r0, .L248
 163:bluetooth_rxtx.c **** 		return 0;
 2407              		.loc 1 163 0
 2408 0014 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 2409 0016 43F00403 		orr	r3, r3, #4
 2410 001a 6B70     		strb	r3, [r5, #1]
 164:bluetooth_rxtx.c **** 	}
 2411              		.loc 1 164 0
 2412 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2413              	.LVL310:
 2414              	.L248:
 172:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2415              		.loc 1 172 0
ARM GAS  /tmp/cckWTbJW.s 			page 85


 2416 0020 0C4B     		ldr	r3, .L250+4
 167:bluetooth_rxtx.c **** 
 2417              		.loc 1 167 0
 2418 0022 0670     		strb	r6, [r0]
 172:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2419              		.loc 1 172 0
 2420 0024 1B88     		ldrh	r3, [r3]
 169:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2421              		.loc 1 169 0
 2422 0026 0026     		movs	r6, #0
 172:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2423              		.loc 1 172 0
 2424 0028 9BB2     		uxth	r3, r3
 2425 002a 623B     		subs	r3, r3, #98
 169:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2426              		.loc 1 169 0
 2427 002c C670     		strb	r6, [r0, #3]
 170:bluetooth_rxtx.c **** 
 2428              		.loc 1 170 0
 2429 002e C0F80480 		str	r8, [r0, #4]
 172:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2430              		.loc 1 172 0
 2431 0032 8370     		strb	r3, [r0, #2]
 173:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 2432              		.loc 1 173 0
 2433 0034 8672     		strb	r6, [r0, #10]
 174:bluetooth_rxtx.c **** 
 2434              		.loc 1 174 0
 2435 0036 C672     		strb	r6, [r0, #11]
 176:bluetooth_rxtx.c **** 
 2436              		.loc 1 176 0
 2437 0038 3946     		mov	r1, r7
 2438 003a 3222     		movs	r2, #50
 2439 003c 0E30     		adds	r0, r0, #14
 2440              	.LVL311:
 2441 003e FFF7FEFF 		bl	memcpy
 2442              	.LVL312:
 178:bluetooth_rxtx.c **** 	status = 0;
 2443              		.loc 1 178 0
 2444 0042 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 179:bluetooth_rxtx.c **** 
 2445              		.loc 1 179 0
 2446 0044 6E70     		strb	r6, [r5, #1]
 178:bluetooth_rxtx.c **** 	status = 0;
 2447              		.loc 1 178 0
 2448 0046 6370     		strb	r3, [r4, #1]
 181:bluetooth_rxtx.c **** }
 2449              		.loc 1 181 0
 2450 0048 0120     		movs	r0, #1
 182:bluetooth_rxtx.c **** 
 2451              		.loc 1 182 0
 2452 004a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2453              	.LVL313:
 2454              	.L251:
 2455 004e 00BF     		.align	2
 2456              	.L250:
 2457 0050 00000000 		.word	.LANCHOR0
ARM GAS  /tmp/cckWTbJW.s 			page 86


 2458 0054 00000000 		.word	.LANCHOR1
 2459              		.cfi_endproc
 2460              	.LFE1:
 2462              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 2463              		.align	1
 2464              		.global	TIMER0_IRQHandler
 2465              		.thumb
 2466              		.thumb_func
 2468              	TIMER0_IRQHandler:
 2469              	.LFB3:
 680:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 2470              		.loc 1 680 0
 2471              		.cfi_startproc
 2472              		@ args = 0, pretend = 0, frame = 0
 2473              		@ frame_needed = 0, uses_anonymous_args = 0
 2474 0000 70B5     		push	{r4, r5, r6, lr}
 2475              		.cfi_def_cfa_offset 16
 2476              		.cfi_offset 4, -16
 2477              		.cfi_offset 5, -12
 2478              		.cfi_offset 6, -8
 2479              		.cfi_offset 14, -4
 681:bluetooth_rxtx.c **** 
 2480              		.loc 1 681 0
 2481 0002 4FF04023 		mov	r3, #1073758208
 2482 0006 1B68     		ldr	r3, [r3]
 2483 0008 DB07     		lsls	r3, r3, #31
 2484 000a 7FD5     		bpl	.L252
 2485              	.LBB22:
 683:bluetooth_rxtx.c **** 		clkn_offset = 0;
 2486              		.loc 1 683 0
 2487 000c 4049     		ldr	r1, .L275
 2488 000e 414B     		ldr	r3, .L275+4
 2489 0010 0868     		ldr	r0, [r1]
 2490 0012 1A68     		ldr	r2, [r3]
 2491 0014 0244     		add	r2, r2, r0
 2492 0016 0132     		adds	r2, r2, #1
 2493 0018 0A60     		str	r2, [r1]
 684:bluetooth_rxtx.c **** 
 2494              		.loc 1 684 0
 2495 001a 0022     		movs	r2, #0
 2496 001c 1A60     		str	r2, [r3]
 691:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2497              		.loc 1 691 0
 2498 001e 3E4A     		ldr	r2, .L275+8
 686:bluetooth_rxtx.c **** 
 2499              		.loc 1 686 0
 2500 0020 0C68     		ldr	r4, [r1]
 2501 0022 3E4B     		ldr	r3, .L275+12
 691:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2502              		.loc 1 691 0
 2503 0024 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 686:bluetooth_rxtx.c **** 
 2504              		.loc 1 686 0
 2505 0026 D869     		ldr	r0, [r3, #28]
 2506              	.LVL314:
 2507 0028 1546     		mov	r5, r2
 691:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
ARM GAS  /tmp/cckWTbJW.s 			page 87


 2508              		.loc 1 691 0
 2509 002a 16B1     		cbz	r6, .L254
 691:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2510              		.loc 1 691 0 is_stmt 0 discriminator 1
 2511 002c 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 2512 002e 012E     		cmp	r6, #1
 2513 0030 05D1     		bne	.L255
 2514              	.L254:
 692:bluetooth_rxtx.c **** 				do_hop = 1;
 2515              		.loc 1 692 0 is_stmt 1
 2516 0032 0B68     		ldr	r3, [r1]
 2517 0034 5E06     		lsls	r6, r3, #25
 2518 0036 37D1     		bne	.L256
 693:bluetooth_rxtx.c **** 		}
 2519              		.loc 1 693 0
 2520 0038 0123     		movs	r3, #1
 2521 003a EB72     		strb	r3, [r5, #11]
 2522 003c 34E0     		b	.L256
 2523              	.L255:
 696:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 2524              		.loc 1 696 0
 2525 003e 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2526 0040 022D     		cmp	r5, #2
 2527 0042 03D1     		bne	.L257
 697:bluetooth_rxtx.c **** 				do_hop = 1;
 2528              		.loc 1 697 0
 2529 0044 0B68     		ldr	r3, [r1]
 2530 0046 DC07     		lsls	r4, r3, #31
 2531              	.LVL315:
 2532 0048 2ED4     		bmi	.L256
 2533 004a 2BE0     		b	.L273
 2534              	.LVL316:
 2535              	.L257:
 701:bluetooth_rxtx.c **** 			// Only hop if connected
 2536              		.loc 1 701 0
 2537 004c 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2538 004e 032D     		cmp	r5, #3
 2539 0050 1CD1     		bne	.L258
 703:bluetooth_rxtx.c **** 				--le.interval_timer;
 2540              		.loc 1 703 0
 2541 0052 1D7E     		ldrb	r5, [r3, #24]	@ zero_extendqisi2
 2542 0054 032D     		cmp	r5, #3
 2543 0056 27D1     		bne	.L256
 686:bluetooth_rxtx.c **** 
 2544              		.loc 1 686 0 discriminator 1
 2545 0058 201A     		subs	r0, r4, r0
 2546              	.LVL317:
 703:bluetooth_rxtx.c **** 				--le.interval_timer;
 2547              		.loc 1 703 0 discriminator 1
 2548 005a 8007     		lsls	r0, r0, #30
 2549 005c 24D1     		bne	.L256
 704:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 2550              		.loc 1 704 0
 2551 005e 188C     		ldrh	r0, [r3, #32]
 2552 0060 80B2     		uxth	r0, r0
 2553 0062 0138     		subs	r0, r0, #1
 2554 0064 80B2     		uxth	r0, r0
ARM GAS  /tmp/cckWTbJW.s 			page 88


 2555 0066 1884     		strh	r0, [r3, #32]	@ movhi
 705:bluetooth_rxtx.c **** 					do_hop = 1;
 2556              		.loc 1 705 0
 2557 0068 188C     		ldrh	r0, [r3, #32]
 2558 006a 80B2     		uxth	r0, r0
 2559 006c 48B9     		cbnz	r0, .L259
 706:bluetooth_rxtx.c **** 					++le.conn_count;
 2560              		.loc 1 706 0
 2561 006e 0120     		movs	r0, #1
 2562 0070 D072     		strb	r0, [r2, #11]
 707:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 2563              		.loc 1 707 0
 2564 0072 9A8C     		ldrh	r2, [r3, #36]
 2565 0074 92B2     		uxth	r2, r2
 2566 0076 0244     		add	r2, r2, r0
 2567 0078 92B2     		uxth	r2, r2
 2568 007a 9A84     		strh	r2, [r3, #36]	@ movhi
 708:bluetooth_rxtx.c **** 				} else {
 2569              		.loc 1 708 0
 2570 007c 5A8C     		ldrh	r2, [r3, #34]
 2571 007e 1A84     		strh	r2, [r3, #32]	@ movhi
 2572 0080 12E0     		b	.L256
 2573              	.L259:
 710:bluetooth_rxtx.c **** 				}
 2574              		.loc 1 710 0
 2575 0082 274B     		ldr	r3, .L275+16
 2576 0084 4FF48072 		mov	r2, #256
 2577 0088 1A60     		str	r2, [r3]
 2578 008a 0DE0     		b	.L256
 2579              	.LVL318:
 2580              	.L258:
 714:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 2581              		.loc 1 714 0
 2582 008c 907A     		ldrb	r0, [r2, #10]	@ zero_extendqisi2
 2583              	.LVL319:
 2584 008e 0528     		cmp	r0, #5
 2585 0090 0AD1     		bne	.L256
 715:bluetooth_rxtx.c **** 				do_hop = 1;
 2586              		.loc 1 715 0
 2587 0092 2448     		ldr	r0, .L275+20
 2588 0094 0468     		ldr	r4, [r0]
 2589              	.LVL320:
 2590 0096 B3F84800 		ldrh	r0, [r3, #72]
 2591 009a 0B68     		ldr	r3, [r1]
 2592 009c 80B2     		uxth	r0, r0
 2593 009e 2044     		add	r0, r0, r4
 2594 00a0 9842     		cmp	r0, r3
 2595 00a2 01D1     		bne	.L256
 2596              	.L273:
 716:bluetooth_rxtx.c **** 			}
 2597              		.loc 1 716 0
 2598 00a4 0123     		movs	r3, #1
 2599 00a6 D372     		strb	r3, [r2, #11]
 2600              	.L256:
 721:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2601              		.loc 1 721 0
 2602 00a8 1F4A     		ldr	r2, .L275+24
ARM GAS  /tmp/cckWTbJW.s 			page 89


 2603 00aa 204B     		ldr	r3, .L275+28
 2604 00ac 1068     		ldr	r0, [r2]
 2605 00ae C0B1     		cbz	r0, .L260
 721:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2606              		.loc 1 721 0 is_stmt 0 discriminator 1
 2607 00b0 1888     		ldrh	r0, [r3]
 2608 00b2 80B2     		uxth	r0, r0
 2609 00b4 A8B9     		cbnz	r0, .L260
 722:bluetooth_rxtx.c **** 
 2610              		.loc 1 722 0 is_stmt 1
 2611 00b6 0C68     		ldr	r4, [r1]
 2612 00b8 1068     		ldr	r0, [r2]
 2613 00ba 8442     		cmp	r4, r0
 2614 00bc 11D3     		bcc	.L260
 725:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 2615              		.loc 1 725 0
 2616 00be 1C48     		ldr	r0, .L275+32
 2617 00c0 0088     		ldrh	r0, [r0]
 2618 00c2 00B2     		sxth	r0, r0
 2619 00c4 0028     		cmp	r0, #0
 726:bluetooth_rxtx.c **** 				}
 2620              		.loc 1 726 0
 2621 00c6 ACBF     		ite	ge
 2622 00c8 0120     		movge	r0, #1
 731:bluetooth_rxtx.c **** 				}
 2623              		.loc 1 731 0
 2624 00ca 41F66900 		movwlt	r0, #6249
 2625 00ce 1880     		strh	r0, [r3]	@ movhi
 733:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2626              		.loc 1 733 0
 2627 00d0 0C68     		ldr	r4, [r1]
 2628 00d2 1848     		ldr	r0, .L275+36
 2629 00d4 0460     		str	r4, [r0]
 734:bluetooth_rxtx.c **** 			}
 2630              		.loc 1 734 0
 2631 00d6 0468     		ldr	r4, [r0]
 2632 00d8 1748     		ldr	r0, .L275+40
 2633 00da 0088     		ldrh	r0, [r0]
 2634 00dc 80B2     		uxth	r0, r0
 2635 00de 2044     		add	r0, r0, r4
 2636 00e0 1060     		str	r0, [r2]
 2637              	.L260:
 739:bluetooth_rxtx.c **** 			clkn += 2;
 2638              		.loc 1 739 0
 2639 00e2 1888     		ldrh	r0, [r3]
 2640 00e4 40F63442 		movw	r2, #3124
 2641 00e8 80B2     		uxth	r0, r0
 2642 00ea 9042     		cmp	r0, r2
 2643 00ec 02D9     		bls	.L263
 740:bluetooth_rxtx.c **** 
 2644              		.loc 1 740 0
 2645 00ee 0A68     		ldr	r2, [r1]
 2646 00f0 0232     		adds	r2, r2, #2
 2647 00f2 0A60     		str	r2, [r1]
 2648              	.L263:
 742:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 2649              		.loc 1 742 0
ARM GAS  /tmp/cckWTbJW.s 			page 90


 2650 00f4 1988     		ldrh	r1, [r3]
 2651 00f6 114A     		ldr	r2, .L275+44
 2652 00f8 89B2     		uxth	r1, r1
 2653 00fa 01F63441 		addw	r1, r1, #3124
 2654 00fe 1160     		str	r1, [r2]
 743:bluetooth_rxtx.c **** 
 2655              		.loc 1 743 0
 2656 0100 0022     		movs	r2, #0
 2657 0102 1A80     		strh	r2, [r3]	@ movhi
 746:bluetooth_rxtx.c **** 	}
 2658              		.loc 1 746 0
 2659 0104 0122     		movs	r2, #1
 2660 0106 4FF04023 		mov	r3, #1073758208
 2661 010a 1A60     		str	r2, [r3]
 2662              	.L252:
 2663 010c 70BD     		pop	{r4, r5, r6, pc}
 2664              	.L276:
 2665 010e 00BF     		.align	2
 2666              	.L275:
 2667 0110 00000000 		.word	clkn
 2668 0114 00000000 		.word	clkn_offset
 2669 0118 00000000 		.word	.LANCHOR0
 2670 011c 00000000 		.word	.LANCHOR1
 2671 0120 3CC00920 		.word	537509948
 2672 0124 00000000 		.word	last_hop
 2673 0128 00000000 		.word	clkn_next_drift_fix
 2674 012c 00000000 		.word	clk100ns_offset
 2675 0130 00000000 		.word	clk_drift_ppm
 2676 0134 00000000 		.word	clkn_last_drift_fix
 2677 0138 00000000 		.word	clk_drift_correction
 2678 013c 18400040 		.word	1073758232
 2679              	.LBE22:
 2680              		.cfi_endproc
 2681              	.LFE3:
 2683              		.section	.text.EINT3_IRQHandler,"ax",%progbits
 2684              		.align	1
 2685              		.global	EINT3_IRQHandler
 2686              		.thumb
 2687              		.thumb_func
 2689              	EINT3_IRQHandler:
 2690              	.LFB4:
 753:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 2691              		.loc 1 753 0
 2692              		.cfi_startproc
 2693              		@ args = 0, pretend = 0, frame = 0
 2694              		@ frame_needed = 0, uses_anonymous_args = 0
 2695              		@ link register save eliminated.
 755:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 2696              		.loc 1 755 0
 2697 0000 084B     		ldr	r3, .L279
 2698 0002 0422     		movs	r2, #4
 2699 0004 1A60     		str	r2, [r3]
 756:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 2700              		.loc 1 756 0
 2701 0006 084B     		ldr	r3, .L279+4
 2702 0008 4FF08052 		mov	r2, #268435456
 2703 000c 1A60     		str	r2, [r3]
ARM GAS  /tmp/cckWTbJW.s 			page 91


 757:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 2704              		.loc 1 757 0
 2705 000e 074B     		ldr	r3, .L279+8
 2706 0010 0122     		movs	r2, #1
 2707 0012 1A70     		strb	r2, [r3]
 758:bluetooth_rxtx.c **** 		dma_discard = 0;
 2708              		.loc 1 758 0
 2709 0014 064B     		ldr	r3, .L279+12
 2710 0016 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2711 0018 022A     		cmp	r2, #2
 759:bluetooth_rxtx.c **** 
 2712              		.loc 1 759 0
 2713 001a 04BF     		itt	eq
 2714 001c 0022     		moveq	r2, #0
 2715 001e 1A74     		strbeq	r2, [r3, #16]
 2716 0020 7047     		bx	lr
 2717              	.L280:
 2718 0022 00BF     		.align	2
 2719              	.L279:
 2720 0024 AC800240 		.word	1073905836
 2721 0028 9CC00920 		.word	537510044
 2722 002c 00000000 		.word	cs_trigger
 2723 0030 00000000 		.word	.LANCHOR0
 2724              		.cfi_endproc
 2725              	.LFE4:
 2727              		.section	.text.DMA_IRQHandler,"ax",%progbits
 2728              		.align	1
 2729              		.global	DMA_IRQHandler
 2730              		.thumb
 2731              		.thumb_func
 2733              	DMA_IRQHandler:
 2734              	.LFB6:
 783:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 2735              		.loc 1 783 0
 2736              		.cfi_startproc
 2737              		@ args = 0, pretend = 0, frame = 0
 2738              		@ frame_needed = 0, uses_anonymous_args = 0
 2739 0000 10B5     		push	{r4, lr}
 2740              		.cfi_def_cfa_offset 8
 2741              		.cfi_offset 4, -8
 2742              		.cfi_offset 14, -4
 784:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 2743              		.loc 1 784 0
 2744 0002 284B     		ldr	r3, .L317
 2745 0004 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2746 0006 012A     		cmp	r2, #1
 2747 0008 11D0     		beq	.L282
 785:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 2748              		.loc 1 785 0
 2749 000a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2750 000c 082A     		cmp	r2, #8
 2751 000e 0ED0     		beq	.L282
 786:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 2752              		.loc 1 786 0
 2753 0010 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2754 0012 042A     		cmp	r2, #4
 2755 0014 0BD0     		beq	.L282
ARM GAS  /tmp/cckWTbJW.s 			page 92


 787:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 2756              		.loc 1 787 0
 2757 0016 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2758 0018 092A     		cmp	r2, #9
 2759 001a 08D0     		beq	.L282
 788:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 2760              		.loc 1 788 0
 2761 001c 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2762 001e 0A2A     		cmp	r2, #10
 2763 0020 05D0     		beq	.L282
 789:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 2764              		.loc 1 789 0
 2765 0022 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2766 0024 0C2A     		cmp	r2, #12
 2767 0026 02D0     		beq	.L282
 790:bluetooth_rxtx.c **** 	{
 2768              		.loc 1 790 0
 2769 0028 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2770 002a 0F2A     		cmp	r2, #15
 2771 002c 39D1     		bne	.L281
 2772              	.L282:
 793:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 2773              		.loc 1 793 0
 2774 002e 1E4A     		ldr	r2, .L317+4
 2775 0030 1268     		ldr	r2, [r2]
 2776 0032 D007     		lsls	r0, r2, #31
 2777 0034 35D5     		bpl	.L281
 794:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 2778              		.loc 1 794 0
 2779 0036 1D4A     		ldr	r2, .L317+8
 2780 0038 1268     		ldr	r2, [r2]
 2781 003a D107     		lsls	r1, r2, #31
 2782 003c 26D5     		bpl	.L285
 2783              	.LBB23:
 795:bluetooth_rxtx.c **** 
 2784              		.loc 1 795 0
 2785 003e 1C4A     		ldr	r2, .L317+12
 2786 0040 0121     		movs	r1, #1
 2787 0042 1160     		str	r1, [r2]
 797:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 2788              		.loc 1 797 0
 2789 0044 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2790 0046 022A     		cmp	r2, #2
 2791 0048 03D1     		bne	.L286
 798:bluetooth_rxtx.c **** 
 2792              		.loc 1 798 0
 2793 004a 1A4A     		ldr	r2, .L317+16
 2794 004c 4FF08051 		mov	r1, #268435456
 2795 0050 1160     		str	r1, [r2]
 2796              	.L286:
 800:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2797              		.loc 1 800 0
 2798 0052 194A     		ldr	r2, .L317+20
 2799 0054 1948     		ldr	r0, .L317+24
 2800 0056 1168     		ldr	r1, [r2]
 2801 0058 0068     		ldr	r0, [r0]
 2802 005a C1F31301 		ubfx	r1, r1, #0, #20
ARM GAS  /tmp/cckWTbJW.s 			page 93


 2803 005e 40F63544 		movw	r4, #3125
 2804 0062 04FB0101 		mla	r1, r4, r1, r0
 2805 0066 5960     		str	r1, [r3, #4]
 801:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 2806              		.loc 1 801 0
 2807 0068 1268     		ldr	r2, [r2]
 2808 006a C2F30752 		ubfx	r2, r2, #20, #8
 2809 006e 9A70     		strb	r2, [r3, #2]
 802:bluetooth_rxtx.c **** 
 2810              		.loc 1 802 0
 2811 0070 134A     		ldr	r2, .L317+28
 2812 0072 1288     		ldrh	r2, [r2]
 2813 0074 92B2     		uxth	r2, r2
 2814 0076 1A81     		strh	r2, [r3, #8]	@ movhi
 805:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2815              		.loc 1 805 0
 2816 0078 124A     		ldr	r2, .L317+32
 806:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2817              		.loc 1 806 0
 2818 007a 134B     		ldr	r3, .L317+36
 805:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2819              		.loc 1 805 0
 2820 007c 1168     		ldr	r1, [r2]
 2821              	.LVL321:
 806:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2822              		.loc 1 806 0
 2823 007e 1868     		ldr	r0, [r3]
 2824 0080 1060     		str	r0, [r2]
 807:bluetooth_rxtx.c **** 
 2825              		.loc 1 807 0
 2826 0082 1960     		str	r1, [r3]
 809:bluetooth_rxtx.c **** 			}
 2827              		.loc 1 809 0
 2828 0084 114B     		ldr	r3, .L317+40
 2829 0086 1A68     		ldr	r2, [r3]
 2830 0088 0132     		adds	r2, r2, #1
 2831 008a 1A60     		str	r2, [r3]
 2832              	.LVL322:
 2833              	.L285:
 2834              	.LBE23:
 811:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 2835              		.loc 1 811 0
 2836 008c 104B     		ldr	r3, .L317+44
 2837 008e 1B68     		ldr	r3, [r3]
 2838 0090 DA07     		lsls	r2, r3, #31
 2839 0092 06D5     		bpl	.L281
 812:bluetooth_rxtx.c **** 				++rx_err;
 2840              		.loc 1 812 0
 2841 0094 0F4B     		ldr	r3, .L317+48
 2842 0096 0122     		movs	r2, #1
 2843 0098 1A60     		str	r2, [r3]
 813:bluetooth_rxtx.c **** 			}
 2844              		.loc 1 813 0
 2845 009a 0F4B     		ldr	r3, .L317+52
 2846 009c 1A68     		ldr	r2, [r3]
 2847 009e 0132     		adds	r2, r2, #1
 2848 00a0 1A60     		str	r2, [r3]
ARM GAS  /tmp/cckWTbJW.s 			page 94


 2849              	.L281:
 2850 00a2 10BD     		pop	{r4, pc}
 2851              	.L318:
 2852              		.align	2
 2853              	.L317:
 2854 00a4 00000000 		.word	.LANCHOR0
 2855 00a8 00400050 		.word	1342193664
 2856 00ac 04400050 		.word	1342193668
 2857 00b0 08400050 		.word	1342193672
 2858 00b4 98C00920 		.word	537510040
 2859 00b8 00000000 		.word	clkn
 2860 00bc 08400040 		.word	1073758216
 2861 00c0 00000000 		.word	.LANCHOR1
 2862 00c4 00000000 		.word	active_rxbuf
 2863 00c8 00000000 		.word	idle_rxbuf
 2864 00cc 00000000 		.word	rx_tc
 2865 00d0 0C400050 		.word	1342193676
 2866 00d4 10400050 		.word	1342193680
 2867 00d8 00000000 		.word	rx_err
 2868              		.cfi_endproc
 2869              	.LFE6:
 2871              		.section	.text.le_transmit,"ax",%progbits
 2872              		.align	1
 2873              		.global	le_transmit
 2874              		.thumb
 2875              		.thumb_func
 2877              	le_transmit:
 2878              	.LFB11:
1039:bluetooth_rxtx.c **** 	unsigned i, j;
 2879              		.loc 1 1039 0
 2880              		.cfi_startproc
 2881              		@ args = 0, pretend = 0, frame = 64
 2882              		@ frame_needed = 0, uses_anonymous_args = 0
 2883              	.LVL323:
 2884 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 2885              		.cfi_def_cfa_offset 32
 2886              		.cfi_offset 4, -32
 2887              		.cfi_offset 5, -28
 2888              		.cfi_offset 6, -24
 2889              		.cfi_offset 7, -20
 2890              		.cfi_offset 8, -16
 2891              		.cfi_offset 9, -12
 2892              		.cfi_offset 10, -8
 2893              		.cfi_offset 14, -4
 2894 0004 90B0     		sub	sp, sp, #64
 2895              		.cfi_def_cfa_offset 96
 2896              	.LVL324:
1039:bluetooth_rxtx.c **** 	unsigned i, j;
 2897              		.loc 1 1039 0
 2898 0006 8846     		mov	r8, r1
 2899 0008 0446     		mov	r4, r0
 2900 000a 9146     		mov	r9, r2
 2901 000c 0DF1FF33 		add	r3, sp, #-1
 2902 0010 0DF10301 		add	r1, sp, #3
 2903              	.LVL325:
 2904              	.L323:
1051:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
ARM GAS  /tmp/cckWTbJW.s 			page 95


 2905              		.loc 1 1051 0
 2906 0014 0022     		movs	r2, #0
1049:bluetooth_rxtx.c **** 		aa >>= 8;
 2907              		.loc 1 1049 0
 2908 0016 E6B2     		uxtb	r6, r4
 2909              	.LVL326:
1051:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 2910              		.loc 1 1051 0
 2911 0018 5A70     		strb	r2, [r3, #1]
1050:bluetooth_rxtx.c **** 		txbuf[i] = 0;
 2912              		.loc 1 1050 0
 2913 001a 240A     		lsrs	r4, r4, #8
 2914              	.LVL327:
1051:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 2915              		.loc 1 1051 0
 2916 001c 0725     		movs	r5, #7
 2917              	.LVL328:
 2918              	.L321:
1053:bluetooth_rxtx.c **** 			byte >>= 1;
 2919              		.loc 1 1053 0 discriminator 2
 2920 001e 06F00100 		and	r0, r6, #1
 2921 0022 A840     		lsls	r0, r0, r5
1052:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 2922              		.loc 1 1052 0 discriminator 2
 2923 0024 15F1FF35 		adds	r5, r5, #-1
 2924              	.LVL329:
1053:bluetooth_rxtx.c **** 			byte >>= 1;
 2925              		.loc 1 1053 0 discriminator 2
 2926 0028 40EA0202 		orr	r2, r0, r2
 2927 002c D2B2     		uxtb	r2, r2
1054:bluetooth_rxtx.c **** 		}
 2928              		.loc 1 1054 0 discriminator 2
 2929 002e 4FEA5606 		lsr	r6, r6, #1
 2930              	.LVL330:
1052:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 2931              		.loc 1 1052 0 discriminator 2
 2932 0032 F4D2     		bcs	.L321
 2933 0034 03F8012F 		strb	r2, [r3, #1]!
 2934              	.LVL331:
1048:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 2935              		.loc 1 1048 0
 2936 0038 8B42     		cmp	r3, r1
 2937 003a EBD1     		bne	.L323
1059:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 2938              		.loc 1 1059 0
 2939 003c 554D     		ldr	r5, .L347
 2940 003e 2888     		ldrh	r0, [r5]
 2941 0040 AA46     		mov	r10, r5
 2942 0042 80B2     		uxth	r0, r0
 2943 0044 6238     		subs	r0, r0, #98
 2944 0046 C0B2     		uxtb	r0, r0
 2945 0048 FFF7FEFF 		bl	btle_channel_index
 2946              	.LVL332:
 2947 004c 524B     		ldr	r3, .L347+4
 2948 004e 1E5C     		ldrb	r6, [r3, r0]	@ zero_extendqisi2
 2949              	.LVL333:
1060:bluetooth_rxtx.c **** 		byte = data[i];
ARM GAS  /tmp/cckWTbJW.s 			page 96


 2950              		.loc 1 1060 0
 2951 0050 0023     		movs	r3, #0
 2952              	.LVL334:
 2953              	.L324:
1060:bluetooth_rxtx.c **** 		byte = data[i];
 2954              		.loc 1 1060 0 is_stmt 0 discriminator 1
 2955 0052 4345     		cmp	r3, r8
 2956 0054 20D2     		bcs	.L346
 2957 0056 00A8     		add	r0, sp, #0
1061:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
 2958              		.loc 1 1061 0 is_stmt 1
 2959 0058 19F80370 		ldrb	r7, [r9, r3]	@ zero_extendqisi2
 2960              	.LVL335:
 2961 005c 1844     		add	r0, r0, r3
 2962              	.LVL336:
 2963 005e 0725     		movs	r5, #7
 2964 0060 0021     		movs	r1, #0
 2965              	.LVL337:
 2966              	.L326:
1064:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 2967              		.loc 1 1064 0 discriminator 2
 2968 0062 4D4A     		ldr	r2, .L347+4
 2969 0064 07F0010E 		and	lr, r7, #1
 2970 0068 3244     		add	r2, r2, r6
 2971 006a 92F82820 		ldrb	r2, [r2, #40]	@ zero_extendqisi2
1065:bluetooth_rxtx.c **** 			byte >>= 1;
 2972              		.loc 1 1065 0 discriminator 2
 2973 006e 0136     		adds	r6, r6, #1
 2974              	.LVL338:
1064:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 2975              		.loc 1 1064 0 discriminator 2
 2976 0070 8EEA020E 		eor	lr, lr, r2
 2977              	.LVL339:
1065:bluetooth_rxtx.c **** 			byte >>= 1;
 2978              		.loc 1 1065 0 discriminator 2
 2979 0074 7F22     		movs	r2, #127
 2980 0076 B6FBF2FC 		udiv	ip, r6, r2
 2981 007a 02FB1C66 		mls	r6, r2, ip, r6
 2982              	.LVL340:
1067:bluetooth_rxtx.c **** 		}
 2983              		.loc 1 1067 0 discriminator 2
 2984 007e 0EFA05F2 		lsl	r2, lr, r5
1063:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 2985              		.loc 1 1063 0 discriminator 2
 2986 0082 15F1FF35 		adds	r5, r5, #-1
 2987              	.LVL341:
1067:bluetooth_rxtx.c **** 		}
 2988              		.loc 1 1067 0 discriminator 2
 2989 0086 42EA0101 		orr	r1, r2, r1
1066:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
 2990              		.loc 1 1066 0 discriminator 2
 2991 008a 4FEA5707 		lsr	r7, r7, #1
 2992              	.LVL342:
1067:bluetooth_rxtx.c **** 		}
 2993              		.loc 1 1067 0 discriminator 2
 2994 008e C9B2     		uxtb	r1, r1
 2995              	.LVL343:
ARM GAS  /tmp/cckWTbJW.s 			page 97


1063:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 2996              		.loc 1 1063 0 discriminator 2
 2997 0090 E7D2     		bcs	.L326
 2998 0092 0171     		strb	r1, [r0, #4]
1060:bluetooth_rxtx.c **** 		byte = data[i];
 2999              		.loc 1 1060 0
 3000 0094 0133     		adds	r3, r3, #1
 3001              	.LVL344:
 3002 0096 DCE7     		b	.L324
 3003              	.LVL345:
 3004              	.L346:
1074:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3005              		.loc 1 1074 0
 3006 0098 0D20     		movs	r0, #13
 3007 009a 47F6FF71 		movw	r1, #32767
 3008 009e FFF7FEFF 		bl	cc2400_set
 3009              	.LVL346:
1075:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 3010              		.loc 1 1075 0
 3011 00a2 1220     		movs	r0, #18
 3012 00a4 42F62231 		movw	r1, #11042
 3013 00a8 FFF7FEFF 		bl	cc2400_set
 3014              	.LVL347:
1076:bluetooth_rxtx.c **** 
 3015              		.loc 1 1076 0
 3016 00ac 1420     		movs	r0, #20
 3017 00ae 41F24B31 		movw	r1, #4939
 3018 00b2 FFF7FEFF 		bl	cc2400_set
 3019              	.LVL348:
1078:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3020              		.loc 1 1078 0
 3021 00b6 2020     		movs	r0, #32
 3022 00b8 40F60141 		movw	r1, #3073
 3023 00bc FFF7FEFF 		bl	cc2400_set
 3024              	.LVL349:
1086:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3025              		.loc 1 1086 0
 3026 00c0 BAF80010 		ldrh	r1, [r10]
 3027 00c4 0220     		movs	r0, #2
 3028 00c6 89B2     		uxth	r1, r1
 3029 00c8 FFF7FEFF 		bl	cc2400_set
 3030              	.LVL350:
1087:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3031              		.loc 1 1087 0
 3032 00cc 0520     		movs	r0, #5
 3033 00ce 0B21     		movs	r1, #11
 3034 00d0 FFF7FEFF 		bl	cc2400_set
 3035              	.LVL351:
1088:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
 3036              		.loc 1 1088 0
 3037 00d4 0320     		movs	r0, #3
 3038 00d6 4021     		movs	r1, #64
 3039 00d8 FFF7FEFF 		bl	cc2400_set
 3040              	.LVL352:
1089:bluetooth_rxtx.c **** 
 3041              		.loc 1 1089 0
 3042 00dc 1421     		movs	r1, #20
ARM GAS  /tmp/cckWTbJW.s 			page 98


 3043 00de 2320     		movs	r0, #35
 3044 00e0 FFF7FEFF 		bl	cc2400_set
 3045              	.LVL353:
1092:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
 3046              		.loc 1 1092 0
 3047 00e4 E207     		lsls	r2, r4, #31
1093:bluetooth_rxtx.c **** 	else
 3048              		.loc 1 1093 0
 3049 00e6 4CBF     		ite	mi
 3050 00e8 4AF6AA21 		movwmi	r1, #43690
1095:bluetooth_rxtx.c **** 
 3051              		.loc 1 1095 0
 3052 00ec 45F25551 		movwpl	r1, #21845
1093:bluetooth_rxtx.c **** 	else
 3053              		.loc 1 1093 0
 3054 00f0 2D20     		movs	r0, #45
1095:bluetooth_rxtx.c **** 
 3055              		.loc 1 1095 0
 3056 00f2 FFF7FEFF 		bl	cc2400_set
 3057              	.LVL354:
1098:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3058              		.loc 1 1098 0
 3059 00f6 0820     		movs	r0, #8
 3060 00f8 FFF7FEFF 		bl	cc2400_get
 3061              	.LVL355:
1099:bluetooth_rxtx.c **** 
 3062              		.loc 1 1099 0
 3063 00fc C0F30801 		ubfx	r1, r0, #0, #9
1071:bluetooth_rxtx.c **** 
 3064              		.loc 1 1071 0
 3065 0100 08F10408 		add	r8, r8, #4
1098:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3066              		.loc 1 1098 0
 3067 0104 0446     		mov	r4, r0
 3068              	.LVL356:
1099:bluetooth_rxtx.c **** 
 3069              		.loc 1 1099 0
 3070 0106 41F49C41 		orr	r1, r1, #19968
 3071 010a 0820     		movs	r0, #8
1071:bluetooth_rxtx.c **** 
 3072              		.loc 1 1071 0
 3073 010c 5FFA88F8 		uxtb	r8, r8
 3074              	.LVL357:
1099:bluetooth_rxtx.c **** 
 3075              		.loc 1 1099 0
 3076 0110 FFF7FEFF 		bl	cc2400_set
 3077              	.LVL358:
 3078              	.L331:
1101:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3079              		.loc 1 1101 0 discriminator 1
 3080 0114 FFF7FEFF 		bl	cc2400_status
 3081              	.LVL359:
 3082 0118 4306     		lsls	r3, r0, #25
 3083 011a FBD5     		bpl	.L331
1102:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3084              		.loc 1 1102 0
 3085 011c 6120     		movs	r0, #97
ARM GAS  /tmp/cckWTbJW.s 			page 99


 3086 011e FFF7FEFF 		bl	cc2400_strobe
 3087              	.LVL360:
 3088              	.L333:
1103:bluetooth_rxtx.c **** 	TXLED_SET;
 3089              		.loc 1 1103 0 discriminator 1
 3090 0122 FFF7FEFF 		bl	cc2400_status
 3091              	.LVL361:
 3092 0126 4707     		lsls	r7, r0, #29
 3093 0128 FBD5     		bpl	.L333
1104:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3094              		.loc 1 1104 0
 3095 012a 1C4B     		ldr	r3, .L347+8
 3096 012c 4FF48072 		mov	r2, #256
 3097 0130 1A60     		str	r2, [r3]
1106:bluetooth_rxtx.c **** #endif
 3098              		.loc 1 1106 0
 3099 0132 8022     		movs	r2, #128
 3100 0134 1A62     		str	r2, [r3, #32]
 3101              	.L335:
1108:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3102              		.loc 1 1108 0 discriminator 1
 3103 0136 0E20     		movs	r0, #14
 3104 0138 FFF7FEFF 		bl	cc2400_get
 3105              	.LVL362:
 3106 013c 00F01F00 		and	r0, r0, #31
 3107 0140 0F28     		cmp	r0, #15
 3108 0142 F8D1     		bne	.L335
1109:bluetooth_rxtx.c **** 
 3109              		.loc 1 1109 0
 3110 0144 6320     		movs	r0, #99
 3111 0146 FFF7FEFF 		bl	cc2400_strobe
 3112              	.LVL363:
 3113              	.L337:
1121:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
 3114              		.loc 1 1121 0 discriminator 1
 3115 014a 154B     		ldr	r3, .L347+12
 3116 014c 1B68     		ldr	r3, [r3]
 3117 014e 5E07     		lsls	r6, r3, #29
 3118 0150 FBD4     		bmi	.L337
1122:bluetooth_rxtx.c **** 
 3119              		.loc 1 1122 0
 3120 0152 4046     		mov	r0, r8
 3121 0154 6946     		mov	r1, sp
 3122 0156 FFF7FEFF 		bl	cc2400_fifo_write
 3123              	.LVL364:
 3124              	.L339:
1124:bluetooth_rxtx.c **** 	TXLED_CLR;
 3125              		.loc 1 1124 0 discriminator 1
 3126 015a 0E20     		movs	r0, #14
 3127 015c FFF7FEFF 		bl	cc2400_get
 3128              	.LVL365:
 3129 0160 00F01F00 		and	r0, r0, #31
 3130 0164 0F28     		cmp	r0, #15
 3131 0166 F8D1     		bne	.L339
1125:bluetooth_rxtx.c **** 
 3132              		.loc 1 1125 0
 3133 0168 0E4B     		ldr	r3, .L347+16
ARM GAS  /tmp/cckWTbJW.s 			page 100


 3134 016a 4FF48072 		mov	r2, #256
 3135 016e 1A60     		str	r2, [r3]
1127:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 3136              		.loc 1 1127 0
 3137 0170 6420     		movs	r0, #100
 3138 0172 FFF7FEFF 		bl	cc2400_strobe
 3139              	.LVL366:
 3140              	.L341:
1128:bluetooth_rxtx.c **** 
 3141              		.loc 1 1128 0 discriminator 1
 3142 0176 FFF7FEFF 		bl	cc2400_status
 3143              	.LVL367:
 3144 017a 4507     		lsls	r5, r0, #29
 3145 017c FBD4     		bmi	.L341
1131:bluetooth_rxtx.c **** #endif
 3146              		.loc 1 1131 0
 3147 017e 0A4B     		ldr	r3, .L347+20
 3148 0180 8022     		movs	r2, #128
 3149 0182 1A60     		str	r2, [r3]
1135:bluetooth_rxtx.c **** }
 3150              		.loc 1 1135 0
 3151 0184 0820     		movs	r0, #8
 3152 0186 2146     		mov	r1, r4
 3153 0188 FFF7FEFF 		bl	cc2400_set
 3154              	.LVL368:
1136:bluetooth_rxtx.c **** 
 3155              		.loc 1 1136 0
 3156 018c 10B0     		add	sp, sp, #64
 3157              		@ sp needed
 3158 018e BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 3159              	.LVL369:
 3160              	.L348:
 3161 0192 00BF     		.align	2
 3162              	.L347:
 3163 0194 00000000 		.word	.LANCHOR1
 3164 0198 00000000 		.word	.LANCHOR2
 3165 019c 38C00920 		.word	537509944
 3166 01a0 54C00920 		.word	537509972
 3167 01a4 3CC00920 		.word	537509948
 3168 01a8 5CC00920 		.word	537509980
 3169              		.cfi_endproc
 3170              	.LFE11:
 3172              		.section	.text.le_jam,"ax",%progbits
 3173              		.align	1
 3174              		.global	le_jam
 3175              		.thumb
 3176              		.thumb_func
 3178              	le_jam:
 3179              	.LFB12:
1138:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 3180              		.loc 1 1138 0
 3181              		.cfi_startproc
 3182              		@ args = 0, pretend = 0, frame = 0
 3183              		@ frame_needed = 0, uses_anonymous_args = 0
 3184 0000 08B5     		push	{r3, lr}
 3185              		.cfi_def_cfa_offset 8
 3186              		.cfi_offset 3, -8
ARM GAS  /tmp/cckWTbJW.s 			page 101


 3187              		.cfi_offset 14, -4
1140:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3188              		.loc 1 1140 0
 3189 0002 0D20     		movs	r0, #13
 3190 0004 47F6FF71 		movw	r1, #32767
 3191 0008 FFF7FEFF 		bl	cc2400_set
 3192              	.LVL370:
1141:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
 3193              		.loc 1 1141 0
 3194 000c 1220     		movs	r0, #18
 3195 000e 42F62231 		movw	r1, #11042
 3196 0012 FFF7FEFF 		bl	cc2400_set
 3197              	.LVL371:
1142:bluetooth_rxtx.c **** 
 3198              		.loc 1 1142 0
 3199 0016 1420     		movs	r0, #20
 3200 0018 42F24B31 		movw	r1, #9035
 3201 001c FFF7FEFF 		bl	cc2400_set
 3202              	.LVL372:
1144:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3203              		.loc 1 1144 0
 3204 0020 2020     		movs	r0, #32
 3205 0022 40F60141 		movw	r1, #3073
 3206 0026 FFF7FEFF 		bl	cc2400_set
 3207              	.LVL373:
1153:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3208              		.loc 1 1153 0
 3209 002a 0520     		movs	r0, #5
 3210 002c 0B21     		movs	r1, #11
 3211 002e FFF7FEFF 		bl	cc2400_set
 3212              	.LVL374:
1154:bluetooth_rxtx.c **** 
 3213              		.loc 1 1154 0
 3214 0032 0320     		movs	r0, #3
 3215 0034 4021     		movs	r1, #64
 3216 0036 FFF7FEFF 		bl	cc2400_set
 3217              	.LVL375:
 3218              	.L351:
1156:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3219              		.loc 1 1156 0 discriminator 1
 3220 003a FFF7FEFF 		bl	cc2400_status
 3221              	.LVL376:
 3222 003e 4006     		lsls	r0, r0, #25
 3223 0040 FBD5     		bpl	.L351
1157:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3224              		.loc 1 1157 0
 3225 0042 6120     		movs	r0, #97
 3226 0044 FFF7FEFF 		bl	cc2400_strobe
 3227              	.LVL377:
 3228              	.L353:
1158:bluetooth_rxtx.c **** 	TXLED_SET;
 3229              		.loc 1 1158 0 discriminator 1
 3230 0048 FFF7FEFF 		bl	cc2400_status
 3231              	.LVL378:
 3232 004c 4107     		lsls	r1, r0, #29
 3233 004e FBD5     		bpl	.L353
1159:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
ARM GAS  /tmp/cckWTbJW.s 			page 102


 3234              		.loc 1 1159 0
 3235 0050 084B     		ldr	r3, .L356
 3236 0052 4FF48072 		mov	r2, #256
 3237 0056 1A60     		str	r2, [r3]
1161:bluetooth_rxtx.c **** #endif
 3238              		.loc 1 1161 0
 3239 0058 8022     		movs	r2, #128
 3240 005a 1A62     		str	r2, [r3, #32]
 3241              	.L355:
1163:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3242              		.loc 1 1163 0 discriminator 1
 3243 005c 0E20     		movs	r0, #14
 3244 005e FFF7FEFF 		bl	cc2400_get
 3245              	.LVL379:
 3246 0062 00F01F00 		and	r0, r0, #31
 3247 0066 0F28     		cmp	r0, #15
 3248 0068 F8D1     		bne	.L355
1164:bluetooth_rxtx.c **** #endif
 3249              		.loc 1 1164 0
 3250 006a 6320     		movs	r0, #99
1166:bluetooth_rxtx.c **** 
 3251              		.loc 1 1166 0
 3252 006c BDE80840 		pop	{r3, lr}
1164:bluetooth_rxtx.c **** #endif
 3253              		.loc 1 1164 0
 3254 0070 FFF7FEBF 		b	cc2400_strobe
 3255              	.LVL380:
 3256              	.L357:
 3257              		.align	2
 3258              	.L356:
 3259 0074 38C00920 		.word	537509944
 3260              		.cfi_endproc
 3261              	.LFE12:
 3263              		.section	.text.hop,"ax",%progbits
 3264              		.align	1
 3265              		.global	hop
 3266              		.thumb
 3267              		.thumb_func
 3269              	hop:
 3270              	.LFB13:
1171:bluetooth_rxtx.c **** 	do_hop = 0;
 3271              		.loc 1 1171 0
 3272              		.cfi_startproc
 3273              		@ args = 0, pretend = 0, frame = 0
 3274              		@ frame_needed = 0, uses_anonymous_args = 0
 3275 0000 38B5     		push	{r3, r4, r5, lr}
 3276              		.cfi_def_cfa_offset 16
 3277              		.cfi_offset 3, -16
 3278              		.cfi_offset 4, -12
 3279              		.cfi_offset 5, -8
 3280              		.cfi_offset 14, -4
1172:bluetooth_rxtx.c **** 	last_hop = clkn;
 3281              		.loc 1 1172 0
 3282 0002 5F4C     		ldr	r4, .L398
 3283 0004 0023     		movs	r3, #0
 3284 0006 E372     		strb	r3, [r4, #11]
1173:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 103


 3285              		.loc 1 1173 0
 3286 0008 5E4B     		ldr	r3, .L398+4
 3287 000a 5F4A     		ldr	r2, .L398+8
 3288 000c 1968     		ldr	r1, [r3]
 3289 000e 1160     		str	r1, [r2]
1176:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
 3290              		.loc 1 1176 0
 3291 0010 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3292 0012 4AB9     		cbnz	r2, .L359
1177:bluetooth_rxtx.c **** 			return;
 3293              		.loc 1 1177 0
 3294 0014 0220     		movs	r0, #2
 3295 0016 FFF7FEFF 		bl	cc2400_get
 3296              	.LVL381:
 3297 001a 5C4B     		ldr	r3, .L398+12
 3298 001c 1B88     		ldrh	r3, [r3]
 3299 001e 9BB2     		uxth	r3, r3
 3300 0020 013B     		subs	r3, r3, #1
 3301 0022 9842     		cmp	r0, r3
 3302 0024 7FD1     		bne	.L361
 3303 0026 38BD     		pop	{r3, r4, r5, pc}
 3304              	.L359:
1183:bluetooth_rxtx.c **** 		do {
 3305              		.loc 1 1183 0
 3306 0028 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3307 002a 012A     		cmp	r2, #1
 3308 002c 31D1     		bne	.L362
1188:bluetooth_rxtx.c **** 	}
 3309              		.loc 1 1188 0
 3310 002e 584B     		ldr	r3, .L398+16
 3311 0030 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3312 0032 584B     		ldr	r3, .L398+20
 3313 0034 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 3314              	.L366:
1185:bluetooth_rxtx.c **** 			if (channel > 2480)
 3315              		.loc 1 1185 0
 3316 0036 554B     		ldr	r3, .L398+12
 3317 0038 1A88     		ldrh	r2, [r3]
 3318 003a 92B2     		uxth	r2, r2
 3319 003c 2032     		adds	r2, r2, #32
 3320 003e 92B2     		uxth	r2, r2
 3321 0040 1A80     		strh	r2, [r3]	@ movhi
1186:bluetooth_rxtx.c **** 				channel -= 79;
 3322              		.loc 1 1186 0
 3323 0042 1A88     		ldrh	r2, [r3]
 3324 0044 92B2     		uxth	r2, r2
 3325 0046 B2F51B6F 		cmp	r2, #2480
 3326 004a 04D9     		bls	.L363
1187:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
 3327              		.loc 1 1187 0
 3328 004c 1A88     		ldrh	r2, [r3]
 3329 004e 92B2     		uxth	r2, r2
 3330 0050 4F3A     		subs	r2, r2, #79
 3331 0052 92B2     		uxth	r2, r2
 3332 0054 1A80     		strh	r2, [r3]	@ movhi
 3333              	.L363:
1188:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/cckWTbJW.s 			page 104


 3334              		.loc 1 1188 0
 3335 0056 0029     		cmp	r1, #0
 3336 0058 65D0     		beq	.L361
1188:bluetooth_rxtx.c **** 	}
 3337              		.loc 1 1188 0 is_stmt 0 discriminator 1
 3338 005a 0028     		cmp	r0, #0
 3339 005c 63D0     		beq	.L361
 3340 005e 1A88     		ldrh	r2, [r3]
 3341 0060 1D88     		ldrh	r5, [r3]
 3342 0062 92B2     		uxth	r2, r2
 3343 0064 A2F66213 		subw	r3, r2, #2402
 3344 0068 0822     		movs	r2, #8
 3345 006a 93FBF2F3 		sdiv	r3, r3, r2
 3346 006e 4A4A     		ldr	r2, .L398+24
 3347 0070 ADB2     		uxth	r5, r5
 3348 0072 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3349 0074 494B     		ldr	r3, .L398+28
 3350 0076 A5F66215 		subw	r5, r5, #2402
 3351 007a 2B40     		ands	r3, r3, r5
 3352 007c 002B     		cmp	r3, #0
 3353 007e 03DA     		bge	.L365
 3354 0080 013B     		subs	r3, r3, #1
 3355 0082 63F00703 		orn	r3, r3, #7
 3356 0086 0133     		adds	r3, r3, #1
 3357              	.L365:
 3358 0088 42FA03F3 		asr	r3, r2, r3
 3359 008c DD07     		lsls	r5, r3, #31
 3360 008e D2D5     		bpl	.L366
 3361 0090 49E0     		b	.L361
 3362              	.L362:
1194:bluetooth_rxtx.c **** 		do {
 3363              		.loc 1 1194 0 is_stmt 1
 3364 0092 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3365 0094 052A     		cmp	r2, #5
 3366 0096 2DD1     		bne	.L367
1199:bluetooth_rxtx.c **** 	}
 3367              		.loc 1 1199 0
 3368 0098 3D4B     		ldr	r3, .L398+16
 3369 009a 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3370              	.L370:
1196:bluetooth_rxtx.c **** 			if (channel > 2480)
 3371              		.loc 1 1196 0
 3372 009c 3B4B     		ldr	r3, .L398+12
 3373 009e 1A88     		ldrh	r2, [r3]
 3374 00a0 92B2     		uxth	r2, r2
 3375 00a2 2032     		adds	r2, r2, #32
 3376 00a4 92B2     		uxth	r2, r2
 3377 00a6 1A80     		strh	r2, [r3]	@ movhi
1197:bluetooth_rxtx.c **** 				channel -= 79;
 3378              		.loc 1 1197 0
 3379 00a8 1A88     		ldrh	r2, [r3]
 3380 00aa 92B2     		uxth	r2, r2
 3381 00ac B2F51B6F 		cmp	r2, #2480
 3382 00b0 04D9     		bls	.L368
1198:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
 3383              		.loc 1 1198 0
 3384 00b2 1A88     		ldrh	r2, [r3]
ARM GAS  /tmp/cckWTbJW.s 			page 105


 3385 00b4 92B2     		uxth	r2, r2
 3386 00b6 4F3A     		subs	r2, r2, #79
 3387 00b8 92B2     		uxth	r2, r2
 3388 00ba 1A80     		strh	r2, [r3]	@ movhi
 3389              	.L368:
1199:bluetooth_rxtx.c **** 	}
 3390              		.loc 1 1199 0
 3391 00bc 4F29     		cmp	r1, #79
 3392 00be 32D0     		beq	.L361
1199:bluetooth_rxtx.c **** 	}
 3393              		.loc 1 1199 0 is_stmt 0 discriminator 1
 3394 00c0 1A88     		ldrh	r2, [r3]
 3395 00c2 1888     		ldrh	r0, [r3]
 3396 00c4 92B2     		uxth	r2, r2
 3397 00c6 A2F66213 		subw	r3, r2, #2402
 3398 00ca 0822     		movs	r2, #8
 3399 00cc 93FBF2F3 		sdiv	r3, r3, r2
 3400 00d0 314A     		ldr	r2, .L398+24
 3401 00d2 80B2     		uxth	r0, r0
 3402 00d4 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3403 00d6 314B     		ldr	r3, .L398+28
 3404 00d8 A0F66210 		subw	r0, r0, #2402
 3405 00dc 0340     		ands	r3, r3, r0
 3406 00de 002B     		cmp	r3, #0
 3407 00e0 03DA     		bge	.L369
 3408 00e2 013B     		subs	r3, r3, #1
 3409 00e4 63F00703 		orn	r3, r3, #7
 3410 00e8 0133     		adds	r3, r3, #1
 3411              	.L369:
 3412 00ea 42FA03F3 		asr	r3, r2, r3
 3413 00ee DA07     		lsls	r2, r3, #31
 3414 00f0 D4D4     		bmi	.L370
 3415 00f2 18E0     		b	.L361
 3416              	.L367:
1202:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
 3417              		.loc 1 1202 0 is_stmt 1
 3418 00f4 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3419 00f6 022A     		cmp	r2, #2
 3420 00f8 05D1     		bne	.L371
1203:bluetooth_rxtx.c **** 	}
 3421              		.loc 1 1203 0
 3422 00fa 1868     		ldr	r0, [r3]
 3423 00fc FFF7FEFF 		bl	next_hop
 3424              	.LVL382:
 3425 0100 224B     		ldr	r3, .L398+12
 3426 0102 1880     		strh	r0, [r3]	@ movhi
 3427 0104 0FE0     		b	.L361
 3428              	.L371:
1206:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
 3429              		.loc 1 1206 0
 3430 0106 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3431 0108 032B     		cmp	r3, #3
 3432 010a 05D1     		bne	.L372
1207:bluetooth_rxtx.c **** 	}
 3433              		.loc 1 1207 0
 3434 010c 1F4D     		ldr	r5, .L398+12
 3435 010e 281D     		adds	r0, r5, #4
ARM GAS  /tmp/cckWTbJW.s 			page 106


 3436 0110 FFF7FEFF 		bl	btle_next_hop
 3437              	.LVL383:
 3438 0114 2880     		strh	r0, [r5]	@ movhi
 3439 0116 06E0     		b	.L361
 3440              	.L372:
1210:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
 3441              		.loc 1 1210 0
 3442 0118 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3443 011a 042B     		cmp	r3, #4
 3444 011c 03D1     		bne	.L361
1211:bluetooth_rxtx.c **** 	}
 3445              		.loc 1 1211 0
 3446 011e A289     		ldrh	r2, [r4, #12]
 3447 0120 1A4B     		ldr	r3, .L398+12
 3448 0122 92B2     		uxth	r2, r2
 3449 0124 1A80     		strh	r2, [r3]	@ movhi
 3450              	.L361:
1214:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 3451              		.loc 1 1214 0
 3452 0126 6420     		movs	r0, #100
 3453 0128 FFF7FEFF 		bl	cc2400_strobe
 3454              	.LVL384:
 3455              	.L374:
1215:bluetooth_rxtx.c **** 
 3456              		.loc 1 1215 0 discriminator 1
 3457 012c FFF7FEFF 		bl	cc2400_status
 3458              	.LVL385:
 3459 0130 4307     		lsls	r3, r0, #29
 3460 0132 FBD4     		bmi	.L374
 3461 0134 154D     		ldr	r5, .L398+12
1218:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3462              		.loc 1 1218 0
 3463 0136 607C     		ldrb	r0, [r4, #17]	@ zero_extendqisi2
1219:bluetooth_rxtx.c **** 	else
 3464              		.loc 1 1219 0
 3465 0138 2988     		ldrh	r1, [r5]
1218:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3466              		.loc 1 1218 0
 3467 013a C0B2     		uxtb	r0, r0
 3468 013c 0228     		cmp	r0, #2
1219:bluetooth_rxtx.c **** 	else
 3469              		.loc 1 1219 0
 3470 013e 89B2     		uxth	r1, r1
1221:bluetooth_rxtx.c **** 
 3471              		.loc 1 1221 0
 3472 0140 1EBF     		ittt	ne
 3473 0142 01F1FF31 		addne	r1, r1, #-1
 3474 0146 0220     		movne	r0, #2
 3475 0148 89B2     		uxthne	r1, r1
 3476 014a FFF7FEFF 		bl	cc2400_set
 3477              	.LVL386:
1224:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 3478              		.loc 1 1224 0
 3479 014e A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3480 0150 1BB1     		cbz	r3, .L377
1225:bluetooth_rxtx.c **** 	}
 3481              		.loc 1 1225 0
ARM GAS  /tmp/cckWTbJW.s 			page 107


 3482 0152 2888     		ldrh	r0, [r5]
 3483 0154 80B2     		uxth	r0, r0
 3484 0156 FFF7FEFF 		bl	cs_threshold_calc_and_set
 3485              	.LVL387:
 3486              	.L377:
1229:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3487              		.loc 1 1229 0
 3488 015a 6120     		movs	r0, #97
 3489 015c FFF7FEFF 		bl	cc2400_strobe
 3490              	.LVL388:
 3491              	.L379:
1230:bluetooth_rxtx.c **** 
 3492              		.loc 1 1230 0 discriminator 1
 3493 0160 FFF7FEFF 		bl	cc2400_status
 3494              	.LVL389:
 3495 0164 4507     		lsls	r5, r0, #29
 3496 0166 FBD5     		bpl	.L379
1232:bluetooth_rxtx.c **** 
 3497              		.loc 1 1232 0
 3498 0168 0123     		movs	r3, #1
 3499 016a 2374     		strb	r3, [r4, #16]
1234:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 3500              		.loc 1 1234 0
 3501 016c 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 3502 016e 022B     		cmp	r3, #2
1235:bluetooth_rxtx.c **** 	else
 3503              		.loc 1 1235 0
 3504 0170 0CBF     		ite	eq
 3505 0172 6320     		moveq	r0, #99
1237:bluetooth_rxtx.c **** }
 3506              		.loc 1 1237 0
 3507 0174 6220     		movne	r0, #98
1238:bluetooth_rxtx.c **** 
 3508              		.loc 1 1238 0
 3509 0176 BDE83840 		pop	{r3, r4, r5, lr}
1237:bluetooth_rxtx.c **** }
 3510              		.loc 1 1237 0
 3511 017a FFF7FEBF 		b	cc2400_strobe
 3512              	.LVL390:
 3513              	.L399:
 3514 017e 00BF     		.align	2
 3515              	.L398:
 3516 0180 00000000 		.word	.LANCHOR0
 3517 0184 00000000 		.word	clkn
 3518 0188 00000000 		.word	last_hop
 3519 018c 00000000 		.word	.LANCHOR1
 3520 0190 00000000 		.word	used_channels
 3521 0194 00000000 		.word	afh_enabled
 3522 0198 00000000 		.word	afh_map
 3523 019c 07000080 		.word	-2147483641
 3524              		.cfi_endproc
 3525              	.LFE13:
 3527              		.section	.text.bt_stream_rx,"ax",%progbits
 3528              		.align	1
 3529              		.global	bt_stream_rx
 3530              		.thumb
 3531              		.thumb_func
ARM GAS  /tmp/cckWTbJW.s 			page 108


 3533              	bt_stream_rx:
 3534              	.LFB14:
1242:bluetooth_rxtx.c **** 	int8_t rssi;
 3535              		.loc 1 1242 0
 3536              		.cfi_startproc
 3537              		@ args = 0, pretend = 0, frame = 0
 3538              		@ frame_needed = 0, uses_anonymous_args = 0
 3539 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 3540              		.cfi_def_cfa_offset 32
 3541              		.cfi_offset 3, -32
 3542              		.cfi_offset 4, -28
 3543              		.cfi_offset 5, -24
 3544              		.cfi_offset 6, -20
 3545              		.cfi_offset 7, -16
 3546              		.cfi_offset 8, -12
 3547              		.cfi_offset 9, -8
 3548              		.cfi_offset 14, -4
1246:bluetooth_rxtx.c **** 
 3549              		.loc 1 1246 0
 3550 0004 494B     		ldr	r3, .L434
 3551 0006 1022     		movs	r2, #16
 3552 0008 1A60     		str	r2, [r3]
1248:bluetooth_rxtx.c **** 	dio_ssp_init();
 3553              		.loc 1 1248 0
 3554 000a FFF7FEFF 		bl	queue_init
 3555              	.LVL391:
1249:bluetooth_rxtx.c **** 	dma_init();
 3556              		.loc 1 1249 0
 3557 000e FFF7FEFF 		bl	dio_ssp_init
 3558              	.LVL392:
1250:bluetooth_rxtx.c **** 	dio_ssp_start();
 3559              		.loc 1 1250 0
 3560 0012 FFF7FEFF 		bl	dma_init
 3561              	.LVL393:
1251:bluetooth_rxtx.c **** 
 3562              		.loc 1 1251 0
 3563 0016 FFF7FEFF 		bl	dio_ssp_start
 3564              	.LVL394:
1253:bluetooth_rxtx.c **** 
 3565              		.loc 1 1253 0
 3566 001a FFF7FEFF 		bl	cc2400_rx
 3567              	.LVL395:
1255:bluetooth_rxtx.c **** 
 3568              		.loc 1 1255 0
 3569 001e FFF7FEFF 		bl	cs_trigger_enable
 3570              	.LVL396:
 3571              	.L401:
1257:bluetooth_rxtx.c **** 	{
 3572              		.loc 1 1257 0 discriminator 1
 3573 0022 434C     		ldr	r4, .L434+4
 3574 0024 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3575 0026 A146     		mov	r9, r4
 3576 0028 012B     		cmp	r3, #1
 3577 002a 75D1     		bne	.L432
 3578              	.L413:
1260:bluetooth_rxtx.c **** 
 3579              		.loc 1 1260 0
ARM GAS  /tmp/cckWTbJW.s 			page 109


 3580 002c 3F4B     		ldr	r3, .L434
 3581 002e 1022     		movs	r2, #16
 3582 0030 1A60     		str	r2, [r3]
1272:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 3583              		.loc 1 1272 0
 3584 0032 FFF7FEFF 		bl	rssi_reset
 3585              	.LVL397:
1273:bluetooth_rxtx.c **** 		while (!rx_tc) {
 3586              		.loc 1 1273 0
 3587 0036 8025     		movs	r5, #128
 3588              	.LVL398:
 3589              	.L402:
1274:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 3590              		.loc 1 1274 0 discriminator 1
 3591 0038 3E4F     		ldr	r7, .L434+8
 3592 003a 3F4E     		ldr	r6, .L434+12
 3593 003c 3B68     		ldr	r3, [r7]
 3594 003e DFF81881 		ldr	r8, .L434+44
 3595 0042 2BBB     		cbnz	r3, .L433
1275:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3596              		.loc 1 1275 0
 3597 0044 0620     		movs	r0, #6
 3598 0046 FFF7FEFF 		bl	cc2400_get
 3599              	.LVL399:
1276:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3600              		.loc 1 1276 0
 3601 004a 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
1275:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3602              		.loc 1 1275 0
 3603 004c C0F30720 		ubfx	r0, r0, #8, #8
 3604              	.LVL400:
1276:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3605              		.loc 1 1276 0
 3606 0050 63B1     		cbz	r3, .L403
1276:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3607              		.loc 1 1276 0 is_stmt 0 discriminator 1
 3608 0052 6BB2     		sxtb	r3, r5
 3609 0054 8033     		adds	r3, r3, #128
 3610 0056 09D1     		bne	.L403
1277:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 3611              		.loc 1 1277 0 is_stmt 1
 3612 0058 384B     		ldr	r3, .L434+16
 3613 005a 40B2     		sxtb	r0, r0
 3614              	.LVL401:
 3615 005c 93F90050 		ldrsb	r5, [r3]
 3616              	.LVL402:
 3617 0060 3635     		adds	r5, r5, #54
 3618 0062 A842     		cmp	r0, r5
 3619 0064 A8BF     		it	ge
 3620 0066 0546     		movge	r5, r0
 3621 0068 EDB2     		uxtb	r5, r5
1278:bluetooth_rxtx.c **** 			}
 3622              		.loc 1 1278 0
 3623 006a 2846     		mov	r0, r5
 3624              	.L403:
 3625              	.LVL403:
1280:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 110


 3626              		.loc 1 1280 0
 3627 006c 40B2     		sxtb	r0, r0
 3628              	.LVL404:
 3629 006e FFF7FEFF 		bl	rssi_add
 3630              	.LVL405:
1282:bluetooth_rxtx.c **** 
 3631              		.loc 1 1282 0
 3632 0072 D8F80000 		ldr	r0, [r8]
 3633 0076 FFF7FEFF 		bl	handle_usb
 3634              	.LVL406:
1285:bluetooth_rxtx.c **** 				hop();
 3635              		.loc 1 1285 0
 3636 007a 99F80B30 		ldrb	r3, [r9, #11]	@ zero_extendqisi2
 3637 007e 13B1     		cbz	r3, .L404
1286:bluetooth_rxtx.c **** 			} else {
 3638              		.loc 1 1286 0
 3639 0080 FFF7FEFF 		bl	hop
 3640              	.LVL407:
 3641 0084 D8E7     		b	.L402
 3642              	.L404:
1288:bluetooth_rxtx.c **** 			}
 3643              		.loc 1 1288 0
 3644 0086 294B     		ldr	r3, .L434
 3645 0088 4FF48072 		mov	r2, #256
 3646 008c 1A60     		str	r2, [r3]
 3647 008e D3E7     		b	.L402
 3648              	.L433:
1294:bluetooth_rxtx.c **** 
 3649              		.loc 1 1294 0
 3650 0090 2B4B     		ldr	r3, .L434+20
 3651 0092 1022     		movs	r2, #16
1296:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3652              		.loc 1 1296 0
 3653 0094 2B4D     		ldr	r5, .L434+24
 3654              	.LVL408:
1294:bluetooth_rxtx.c **** 
 3655              		.loc 1 1294 0
 3656 0096 1A60     		str	r2, [r3]
1296:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3657              		.loc 1 1296 0
 3658 0098 2B68     		ldr	r3, [r5]
 3659 009a 1BB1     		cbz	r3, .L407
1297:bluetooth_rxtx.c **** 		}
 3660              		.loc 1 1297 0
 3661 009c 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3662 009e 43F00203 		orr	r3, r3, #2
 3663 00a2 6370     		strb	r3, [r4, #1]
 3664              	.L407:
1301:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 3665              		.loc 1 1301 0
 3666 00a4 3B68     		ldr	r3, [r7]
 3667 00a6 012B     		cmp	r3, #1
 3668 00a8 03D9     		bls	.L408
1302:bluetooth_rxtx.c **** 
 3669              		.loc 1 1302 0
 3670 00aa 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3671 00ac 43F00103 		orr	r3, r3, #1
ARM GAS  /tmp/cckWTbJW.s 			page 111


 3672 00b0 6370     		strb	r3, [r4, #1]
 3673              	.L408:
1304:bluetooth_rxtx.c **** 			status |= DISCARD;
 3674              		.loc 1 1304 0
 3675 00b2 227C     		ldrb	r2, [r4, #16]	@ zero_extendqisi2
 3676 00b4 1E4B     		ldr	r3, .L434+4
 3677 00b6 2AB1     		cbz	r2, .L409
1305:bluetooth_rxtx.c **** 			dma_discard = 0;
 3678              		.loc 1 1305 0
 3679 00b8 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 3680 00ba 42F02002 		orr	r2, r2, #32
 3681 00be 5A70     		strb	r2, [r3, #1]
1306:bluetooth_rxtx.c **** 		}
 3682              		.loc 1 1306 0
 3683 00c0 0022     		movs	r2, #0
 3684 00c2 1A74     		strb	r2, [r3, #16]
 3685              	.L409:
1309:bluetooth_rxtx.c **** 
 3686              		.loc 1 1309 0
 3687 00c4 204B     		ldr	r3, .L434+28
 3688 00c6 1888     		ldrh	r0, [r3]
 3689 00c8 80B2     		uxth	r0, r0
 3690 00ca FFF7FEFF 		bl	rssi_iir_update
 3691              	.LVL409:
1315:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3692              		.loc 1 1315 0
 3693 00ce 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 3694 00d0 13B9     		cbnz	r3, .L410
1315:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3695              		.loc 1 1315 0 is_stmt 0 discriminator 1
 3696 00d2 1E4B     		ldr	r3, .L434+32
 3697 00d4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3698 00d6 2BB1     		cbz	r3, .L411
 3699              	.L410:
1316:bluetooth_rxtx.c **** 			cs_trigger = 0;
 3700              		.loc 1 1316 0 is_stmt 1
 3701 00d8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3702 00da 43F00803 		orr	r3, r3, #8
 3703 00de 6370     		strb	r3, [r4, #1]
1317:bluetooth_rxtx.c **** 		}
 3704              		.loc 1 1317 0
 3705 00e0 0023     		movs	r3, #0
 3706 00e2 3370     		strb	r3, [r6]
 3707              	.L411:
1320:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 3708              		.loc 1 1320 0
 3709 00e4 154B     		ldr	r3, .L434+16
 3710 00e6 93F90020 		ldrsb	r2, [r3]
 3711 00ea 194B     		ldr	r3, .L434+36
 3712 00ec 3532     		adds	r2, r2, #53
 3713 00ee 93F90030 		ldrsb	r3, [r3]
 3714 00f2 9A42     		cmp	r2, r3
 3715 00f4 03DA     		bge	.L412
1321:bluetooth_rxtx.c **** 		}
 3716              		.loc 1 1321 0
 3717 00f6 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3718 00f8 43F01003 		orr	r3, r3, #16
ARM GAS  /tmp/cckWTbJW.s 			page 112


 3719 00fc 6370     		strb	r3, [r4, #1]
 3720              	.L412:
1324:bluetooth_rxtx.c **** 
 3721              		.loc 1 1324 0
 3722 00fe 154B     		ldr	r3, .L434+40
 3723 0100 0020     		movs	r0, #0
 3724 0102 1968     		ldr	r1, [r3]
 3725 0104 FFF7FEFF 		bl	enqueue
 3726              	.LVL410:
1326:bluetooth_rxtx.c **** 		rx_tc = 0;
 3727              		.loc 1 1326 0
 3728 0108 D8F80000 		ldr	r0, [r8]
 3729 010c FFF7FEFF 		bl	handle_usb
 3730              	.LVL411:
1327:bluetooth_rxtx.c **** 		rx_err = 0;
 3731              		.loc 1 1327 0
 3732 0110 0023     		movs	r3, #0
 3733 0112 3B60     		str	r3, [r7]
1328:bluetooth_rxtx.c **** 	}
 3734              		.loc 1 1328 0
 3735 0114 2B60     		str	r3, [r5]
 3736 0116 84E7     		b	.L401
 3737              	.L432:
1257:bluetooth_rxtx.c **** 	{
 3738              		.loc 1 1257 0 discriminator 2
 3739 0118 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3740 011a 082B     		cmp	r3, #8
 3741 011c 86D0     		beq	.L413
1335:bluetooth_rxtx.c **** 	cs_trigger_disable();
 3742              		.loc 1 1335 0
 3743 011e FFF7FEFF 		bl	dio_ssp_stop
 3744              	.LVL412:
1337:bluetooth_rxtx.c **** 
 3745              		.loc 1 1337 0
 3746 0122 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1336:bluetooth_rxtx.c **** }
 3747              		.loc 1 1336 0
 3748 0126 FFF7FEBF 		b	cs_trigger_disable
 3749              	.LVL413:
 3750              	.L435:
 3751 012a 00BF     		.align	2
 3752              	.L434:
 3753 012c 3CC00920 		.word	537509948
 3754 0130 00000000 		.word	.LANCHOR0
 3755 0134 00000000 		.word	rx_tc
 3756 0138 00000000 		.word	cs_trigger
 3757 013c 00000000 		.word	cs_threshold_cur
 3758 0140 38C00920 		.word	537509944
 3759 0144 00000000 		.word	rx_err
 3760 0148 00000000 		.word	.LANCHOR1
 3761 014c 00000000 		.word	cs_no_squelch
 3762 0150 00000000 		.word	rssi_max
 3763 0154 00000000 		.word	idle_rxbuf
 3764 0158 00000000 		.word	clkn
 3765              		.cfi_endproc
 3766              	.LFE14:
 3768              		.section	.text.br_transmit,"ax",%progbits
ARM GAS  /tmp/cckWTbJW.s 			page 113


 3769              		.align	1
 3770              		.global	br_transmit
 3771              		.thumb
 3772              		.thumb_func
 3774              	br_transmit:
 3775              	.LFB17:
1369:bluetooth_rxtx.c **** 	uint16_t gio_save;
 3776              		.loc 1 1369 0
 3777              		.cfi_startproc
 3778              		@ args = 0, pretend = 0, frame = 16
 3779              		@ frame_needed = 0, uses_anonymous_args = 0
 3780 0000 2DE9FF41 		push	{r0, r1, r2, r3, r4, r5, r6, r7, r8, lr}
 3781              		.cfi_def_cfa_offset 40
 3782              		.cfi_offset 0, -40
 3783              		.cfi_offset 1, -36
 3784              		.cfi_offset 2, -32
 3785              		.cfi_offset 3, -28
 3786              		.cfi_offset 4, -24
 3787              		.cfi_offset 5, -20
 3788              		.cfi_offset 6, -16
 3789              		.cfi_offset 7, -12
 3790              		.cfi_offset 8, -8
 3791              		.cfi_offset 14, -4
 3792              	.LVL414:
1374:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3793              		.loc 1 1374 0
 3794 0004 954B     		ldr	r3, .L472
 3795 0006 0122     		movs	r2, #1
 3796 0008 D3E90245 		ldrd	r4, [r3, #8]
 3797 000c 0023     		movs	r3, #0
 3798 000e 2240     		ands	r2, r2, r4
 3799 0010 2B40     		ands	r3, r3, r5
 3800 0012 52EA0301 		orrs	r1, r2, r3
1375:bluetooth_rxtx.c **** 
 3801              		.loc 1 1375 0
 3802 0016 4FF00007 		mov	r7, #0
1374:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3803              		.loc 1 1374 0
 3804 001a 45F25553 		movw	r3, #21845
1375:bluetooth_rxtx.c **** 
 3805              		.loc 1 1375 0
 3806 001e 4FEAD576 		lsr	r6, r5, #31
1374:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3807              		.loc 1 1374 0
 3808 0022 4AF6AA28 		movw	r8, #43690
 3809 0026 18BF     		it	ne
 3810 0028 9846     		movne	r8, r3
 3811              	.LVL415:
1378:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 3812              		.loc 1 1378 0
 3813 002a E0B2     		uxtb	r0, r4
1375:bluetooth_rxtx.c **** 
 3814              		.loc 1 1375 0
 3815 002c 002F     		cmp	r7, #0
 3816 002e 08BF     		it eq
 3817 0030 012E     		cmpeq	r6, #1
 3818 0032 14BF     		ite	ne
ARM GAS  /tmp/cckWTbJW.s 			page 114


 3819 0034 5526     		movne	r6, #85
 3820 0036 AA26     		moveq	r6, #170
 3821              	.LVL416:
1378:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 3822              		.loc 1 1378 0
 3823 0038 FFF7FEFF 		bl	reverse8
 3824              	.LVL417:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3825              		.loc 1 1377 0
 3826 003c 8DF80000 		strb	r0, [sp]
1379:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
 3827              		.loc 1 1379 0
 3828 0040 C4F30720 		ubfx	r0, r4, #8, #8
 3829 0044 FFF7FEFF 		bl	reverse8
 3830              	.LVL418:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3831              		.loc 1 1377 0
 3832 0048 8DF80100 		strb	r0, [sp, #1]
1380:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
 3833              		.loc 1 1380 0
 3834 004c C4F30740 		ubfx	r0, r4, #16, #8
 3835 0050 FFF7FEFF 		bl	reverse8
 3836              	.LVL419:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3837              		.loc 1 1377 0
 3838 0054 8DF80200 		strb	r0, [sp, #2]
1381:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
 3839              		.loc 1 1381 0
 3840 0058 200E     		lsrs	r0, r4, #24
 3841 005a FFF7FEFF 		bl	reverse8
 3842              	.LVL420:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3843              		.loc 1 1377 0
 3844 005e 8DF80300 		strb	r0, [sp, #3]
1382:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
 3845              		.loc 1 1382 0
 3846 0062 E8B2     		uxtb	r0, r5
 3847 0064 FFF7FEFF 		bl	reverse8
 3848              	.LVL421:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3849              		.loc 1 1377 0
 3850 0068 8DF80400 		strb	r0, [sp, #4]
1383:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
 3851              		.loc 1 1383 0
 3852 006c C5F30720 		ubfx	r0, r5, #8, #8
 3853 0070 FFF7FEFF 		bl	reverse8
 3854              	.LVL422:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3855              		.loc 1 1377 0
 3856 0074 8DF80500 		strb	r0, [sp, #5]
1384:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
 3857              		.loc 1 1384 0
 3858 0078 C5F30740 		ubfx	r0, r5, #16, #8
 3859 007c FFF7FEFF 		bl	reverse8
 3860              	.LVL423:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3861              		.loc 1 1377 0
ARM GAS  /tmp/cckWTbJW.s 			page 115


 3862 0080 8DF80600 		strb	r0, [sp, #6]
1385:bluetooth_rxtx.c **** 		reverse8(trailer),
 3863              		.loc 1 1385 0
 3864 0084 280E     		lsrs	r0, r5, #24
 3865 0086 FFF7FEFF 		bl	reverse8
 3866              	.LVL424:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3867              		.loc 1 1377 0
 3868 008a 8DF80700 		strb	r0, [sp, #7]
1386:bluetooth_rxtx.c **** 		reverse8(0x77),
 3869              		.loc 1 1386 0
 3870 008e 3046     		mov	r0, r6
 3871 0090 FFF7FEFF 		bl	reverse8
 3872              	.LVL425:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3873              		.loc 1 1377 0
 3874 0094 8DF80800 		strb	r0, [sp, #8]
1387:bluetooth_rxtx.c **** 		reverse8(0x66),
 3875              		.loc 1 1387 0
 3876 0098 7720     		movs	r0, #119
 3877 009a FFF7FEFF 		bl	reverse8
 3878              	.LVL426:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3879              		.loc 1 1377 0
 3880 009e 8DF80900 		strb	r0, [sp, #9]
1388:bluetooth_rxtx.c **** 		reverse8(0x55),
 3881              		.loc 1 1388 0
 3882 00a2 6620     		movs	r0, #102
 3883 00a4 FFF7FEFF 		bl	reverse8
 3884              	.LVL427:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3885              		.loc 1 1377 0
 3886 00a8 8DF80A00 		strb	r0, [sp, #10]
1389:bluetooth_rxtx.c **** 		reverse8(0x44),
 3887              		.loc 1 1389 0
 3888 00ac 5520     		movs	r0, #85
 3889 00ae FFF7FEFF 		bl	reverse8
 3890              	.LVL428:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3891              		.loc 1 1377 0
 3892 00b2 8DF80B00 		strb	r0, [sp, #11]
1390:bluetooth_rxtx.c **** 		reverse8(0x33),
 3893              		.loc 1 1390 0
 3894 00b6 4420     		movs	r0, #68
 3895 00b8 FFF7FEFF 		bl	reverse8
 3896              	.LVL429:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3897              		.loc 1 1377 0
 3898 00bc 8DF80C00 		strb	r0, [sp, #12]
1391:bluetooth_rxtx.c **** 		reverse8(0x22),
 3899              		.loc 1 1391 0
 3900 00c0 3320     		movs	r0, #51
 3901 00c2 FFF7FEFF 		bl	reverse8
 3902              	.LVL430:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3903              		.loc 1 1377 0
 3904 00c6 8DF80D00 		strb	r0, [sp, #13]
ARM GAS  /tmp/cckWTbJW.s 			page 116


1392:bluetooth_rxtx.c **** 		reverse8(0x11)
 3905              		.loc 1 1392 0
 3906 00ca 2220     		movs	r0, #34
 3907 00cc FFF7FEFF 		bl	reverse8
 3908              	.LVL431:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3909              		.loc 1 1377 0
 3910 00d0 8DF80E00 		strb	r0, [sp, #14]
1393:bluetooth_rxtx.c **** 	};
 3911              		.loc 1 1393 0
 3912 00d4 1120     		movs	r0, #17
 3913 00d6 FFF7FEFF 		bl	reverse8
 3914              	.LVL432:
 3915              	.LBB29:
 3916              	.LBB30:
1353:bluetooth_rxtx.c **** 
 3917              		.loc 1 1353 0
 3918 00da 3C46     		mov	r4, r7
 3919              	.LBE30:
 3920              	.LBE29:
1377:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3921              		.loc 1 1377 0
 3922 00dc 8DF80F00 		strb	r0, [sp, #15]
 3923              	.LVL433:
 3924              	.LBB33:
 3925              	.LBB32:
 3926              	.LBB31:
1355:bluetooth_rxtx.c **** 	{
 3927              		.loc 1 1355 0
 3928 00e0 3B46     		mov	r3, r7
 3929              	.LVL434:
 3930              	.L440:
1357:bluetooth_rxtx.c **** 	}
 3931              		.loc 1 1357 0
 3932 00e2 48FA03F2 		asr	r2, r8, r3
 3933 00e6 C3F10F01 		rsb	r1, r3, #15
 3934 00ea 02F00102 		and	r2, r2, #1
 3935 00ee 8A40     		lsls	r2, r2, r1
1355:bluetooth_rxtx.c **** 	{
 3936              		.loc 1 1355 0
 3937 00f0 0133     		adds	r3, r3, #1
 3938              	.LVL435:
1357:bluetooth_rxtx.c **** 	}
 3939              		.loc 1 1357 0
 3940 00f2 1443     		orrs	r4, r4, r2
 3941              	.LVL436:
1355:bluetooth_rxtx.c **** 	{
 3942              		.loc 1 1355 0
 3943 00f4 102B     		cmp	r3, #16
1357:bluetooth_rxtx.c **** 	}
 3944              		.loc 1 1357 0
 3945 00f6 A4B2     		uxth	r4, r4
 3946              	.LVL437:
1355:bluetooth_rxtx.c **** 	{
 3947              		.loc 1 1355 0
 3948 00f8 F3D1     		bne	.L440
 3949              	.LVL438:
ARM GAS  /tmp/cckWTbJW.s 			page 117


 3950              	.LBE31:
 3951              	.LBE32:
 3952              	.LBE33:
 3953              	.LBB34:
 3954              	.LBB35:
 988:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3955              		.loc 1 988 0
 3956 00fa 0D20     		movs	r0, #13
 3957 00fc 47F6FF71 		movw	r1, #32767
 3958 0100 FFF7FEFF 		bl	cc2400_set
 3959              	.LVL439:
 989:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 3960              		.loc 1 989 0
 3961 0104 1220     		movs	r0, #18
 3962 0106 42F62231 		movw	r1, #11042
 3963 010a FFF7FEFF 		bl	cc2400_set
 3964              	.LVL440:
 990:bluetooth_rxtx.c **** 
 3965              		.loc 1 990 0
 3966 010e 1420     		movs	r0, #20
 3967 0110 41F24B31 		movw	r1, #4939
 3968 0114 FFF7FEFF 		bl	cc2400_set
 3969              	.LVL441:
 992:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3970              		.loc 1 992 0
 3971 0118 2020     		movs	r0, #32
 3972 011a 40F60141 		movw	r1, #3073
 3973 011e FFF7FEFF 		bl	cc2400_set
 3974              	.LVL442:
1000:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 3975              		.loc 1 1000 0
 3976 0122 2146     		mov	r1, r4
 3977 0124 2C20     		movs	r0, #44
 3978 0126 FFF7FEFF 		bl	cc2400_set
 3979              	.LVL443:
1001:bluetooth_rxtx.c **** 
 3980              		.loc 1 1001 0
 3981 012a 2D20     		movs	r0, #45
 3982 012c 0021     		movs	r1, #0
 3983 012e FFF7FEFF 		bl	cc2400_set
 3984              	.LVL444:
1003:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3985              		.loc 1 1003 0
 3986 0132 4B4B     		ldr	r3, .L472+4
 3987 0134 0220     		movs	r0, #2
 3988 0136 1988     		ldrh	r1, [r3]
1006:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 3989              		.loc 1 1006 0
 3990 0138 4A4C     		ldr	r4, .L472+8
 3991              	.LVL445:
1003:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3992              		.loc 1 1003 0
 3993 013a 89B2     		uxth	r1, r1
 3994 013c FFF7FEFF 		bl	cc2400_set
 3995              	.LVL446:
1004:bluetooth_rxtx.c **** 
 3996              		.loc 1 1004 0
ARM GAS  /tmp/cckWTbJW.s 			page 118


 3997 0140 0520     		movs	r0, #5
 3998 0142 0B21     		movs	r1, #11
 3999 0144 FFF7FEFF 		bl	cc2400_set
 4000              	.LVL447:
1006:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4001              		.loc 1 1006 0
 4002 0148 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4003 014a 13B9     		cbnz	r3, .L441
1007:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 4004              		.loc 1 1007 0
 4005 014c 0320     		movs	r0, #3
 4006 014e 2921     		movs	r1, #41
 4007 0150 04E0     		b	.L470
 4008              	.L441:
1008:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 4009              		.loc 1 1008 0
 4010 0152 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4011 0154 012B     		cmp	r3, #1
 4012 0156 1DD1     		bne	.L443
1009:bluetooth_rxtx.c **** 	} else {
 4013              		.loc 1 1009 0
 4014 0158 0320     		movs	r0, #3
 4015 015a 4021     		movs	r1, #64
 4016              	.L470:
 4017 015c FFF7FEFF 		bl	cc2400_set
 4018              	.LVL448:
1015:bluetooth_rxtx.c **** 
 4019              		.loc 1 1015 0
 4020 0160 FFF7FEFF 		bl	clkn_start
 4021              	.LVL449:
 4022              	.L445:
1017:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 4023              		.loc 1 1017 0
 4024 0164 FFF7FEFF 		bl	cc2400_status
 4025              	.LVL450:
 4026 0168 4506     		lsls	r5, r0, #25
 4027 016a FBD5     		bpl	.L445
1018:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 4028              		.loc 1 1018 0
 4029 016c 6120     		movs	r0, #97
 4030 016e FFF7FEFF 		bl	cc2400_strobe
 4031              	.LVL451:
 4032              	.L447:
1019:bluetooth_rxtx.c **** 
 4033              		.loc 1 1019 0
 4034 0172 FFF7FEFF 		bl	cc2400_status
 4035              	.LVL452:
 4036 0176 4007     		lsls	r0, r0, #29
 4037 0178 FBD5     		bpl	.L447
1022:bluetooth_rxtx.c **** #endif
 4038              		.loc 1 1022 0
 4039 017a 3B4B     		ldr	r3, .L472+12
 4040 017c 8022     		movs	r2, #128
 4041 017e 1A60     		str	r2, [r3]
 4042              	.L449:
1025:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 4043              		.loc 1 1025 0
ARM GAS  /tmp/cckWTbJW.s 			page 119


 4044 0180 0E20     		movs	r0, #14
 4045 0182 FFF7FEFF 		bl	cc2400_get
 4046              	.LVL453:
 4047 0186 00F01F00 		and	r0, r0, #31
 4048 018a 0F28     		cmp	r0, #15
 4049 018c F8D1     		bne	.L449
1026:bluetooth_rxtx.c **** 
 4050              		.loc 1 1026 0
 4051 018e 6320     		movs	r0, #99
 4052 0190 FFF7FEFF 		bl	cc2400_strobe
 4053              	.LVL454:
 4054              	.L443:
 4055              	.LBE35:
 4056              	.LBE34:
1398:bluetooth_rxtx.c **** 
 4057              		.loc 1 1398 0 discriminator 3
 4058 0194 1421     		movs	r1, #20
 4059 0196 2320     		movs	r0, #35
 4060 0198 FFF7FEFF 		bl	cc2400_set
 4061              	.LVL455:
1401:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4062              		.loc 1 1401 0 discriminator 3
 4063 019c 0820     		movs	r0, #8
 4064 019e FFF7FEFF 		bl	cc2400_get
 4065              	.LVL456:
1402:bluetooth_rxtx.c **** 
 4066              		.loc 1 1402 0 discriminator 3
 4067 01a2 C0F30801 		ubfx	r1, r0, #0, #9
1401:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4068              		.loc 1 1401 0 discriminator 3
 4069 01a6 0546     		mov	r5, r0
 4070              	.LVL457:
1402:bluetooth_rxtx.c **** 
 4071              		.loc 1 1402 0 discriminator 3
 4072 01a8 41F49C41 		orr	r1, r1, #19968
 4073 01ac 0820     		movs	r0, #8
 4074              	.LVL458:
 4075 01ae FFF7FEFF 		bl	cc2400_set
 4076              	.LVL459:
1372:bluetooth_rxtx.c **** 
 4077              		.loc 1 1372 0 discriminator 3
 4078 01b2 0026     		movs	r6, #0
 4079              	.LVL460:
 4080              	.L450:
1404:bluetooth_rxtx.c **** 	{
 4081              		.loc 1 1404 0 discriminator 1
 4082 01b4 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4083 01b6 022B     		cmp	r3, #2
 4084 01b8 45D1     		bne	.L464
1407:bluetooth_rxtx.c **** 
 4085              		.loc 1 1407 0
 4086 01ba 7608     		lsrs	r6, r6, #1
 4087              	.LVL461:
 4088              	.L452:
1407:bluetooth_rxtx.c **** 
 4089              		.loc 1 1407 0 is_stmt 0 discriminator 1
 4090 01bc 2B4F     		ldr	r7, .L472+16
ARM GAS  /tmp/cckWTbJW.s 			page 120


 4091 01be 3B68     		ldr	r3, [r7]
 4092 01c0 B6EB530F 		cmp	r6, r3, lsr #1
 4093 01c4 05D1     		bne	.L471
 4094              	.L453:
1410:bluetooth_rxtx.c **** 				hop();
 4095              		.loc 1 1410 0 is_stmt 1
 4096 01c6 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4097 01c8 002B     		cmp	r3, #0
 4098 01ca F7D0     		beq	.L452
1411:bluetooth_rxtx.c **** 			}
 4099              		.loc 1 1411 0
 4100 01cc FFF7FEFF 		bl	hop
 4101              	.LVL462:
 4102 01d0 F4E7     		b	.L452
 4103              	.L471:
1407:bluetooth_rxtx.c **** 
 4104              		.loc 1 1407 0 discriminator 2
 4105 01d2 274B     		ldr	r3, .L472+20
 4106 01d4 1A68     		ldr	r2, [r3]
 4107 01d6 40F6C903 		movw	r3, #2249
 4108 01da 9A42     		cmp	r2, r3
 4109 01dc F3D9     		bls	.L453
1417:bluetooth_rxtx.c **** 
 4110              		.loc 1 1417 0
 4111 01de 254B     		ldr	r3, .L472+24
 4112 01e0 4FF48072 		mov	r2, #256
1415:bluetooth_rxtx.c **** 
 4113              		.loc 1 1415 0
 4114 01e4 3E68     		ldr	r6, [r7]
 4115              	.LVL463:
1419:bluetooth_rxtx.c **** 
 4116              		.loc 1 1419 0
 4117 01e6 1020     		movs	r0, #16
1417:bluetooth_rxtx.c **** 
 4118              		.loc 1 1417 0
 4119 01e8 1A60     		str	r2, [r3]
1419:bluetooth_rxtx.c **** 
 4120              		.loc 1 1419 0
 4121 01ea 6946     		mov	r1, sp
 4122 01ec FFF7FEFF 		bl	cc2400_fifo_write
 4123              	.LVL464:
 4124              	.L455:
1421:bluetooth_rxtx.c **** 		TXLED_CLR;
 4125              		.loc 1 1421 0 discriminator 1
 4126 01f0 0E20     		movs	r0, #14
 4127 01f2 FFF7FEFF 		bl	cc2400_get
 4128              	.LVL465:
 4129 01f6 00F01F00 		and	r0, r0, #31
 4130 01fa 0F28     		cmp	r0, #15
 4131 01fc F8D1     		bne	.L455
1422:bluetooth_rxtx.c **** 
 4132              		.loc 1 1422 0
 4133 01fe 1E4B     		ldr	r3, .L472+28
 4134 0200 4FF48072 		mov	r2, #256
 4135 0204 1A60     		str	r2, [r3]
1424:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 4136              		.loc 1 1424 0
ARM GAS  /tmp/cckWTbJW.s 			page 121


 4137 0206 6420     		movs	r0, #100
 4138 0208 FFF7FEFF 		bl	cc2400_strobe
 4139              	.LVL466:
 4140              	.L457:
1425:bluetooth_rxtx.c **** 
 4141              		.loc 1 1425 0 discriminator 1
 4142 020c FFF7FEFF 		bl	cc2400_status
 4143              	.LVL467:
 4144 0210 4107     		lsls	r1, r0, #29
 4145 0212 FBD4     		bmi	.L457
 4146              	.L459:
1427:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 4147              		.loc 1 1427 0
 4148 0214 FFF7FEFF 		bl	cc2400_status
 4149              	.LVL468:
 4150 0218 4206     		lsls	r2, r0, #25
 4151 021a FBD5     		bpl	.L459
1428:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 4152              		.loc 1 1428 0
 4153 021c 6120     		movs	r0, #97
 4154 021e FFF7FEFF 		bl	cc2400_strobe
 4155              	.LVL469:
 4156              	.L461:
1429:bluetooth_rxtx.c **** 
 4157              		.loc 1 1429 0 discriminator 1
 4158 0222 FFF7FEFF 		bl	cc2400_status
 4159              	.LVL470:
 4160 0226 4307     		lsls	r3, r0, #29
 4161 0228 FBD5     		bpl	.L461
 4162              	.L463:
1431:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 4163              		.loc 1 1431 0
 4164 022a 0E20     		movs	r0, #14
 4165 022c FFF7FEFF 		bl	cc2400_get
 4166              	.LVL471:
 4167 0230 00F01F00 		and	r0, r0, #31
 4168 0234 0F28     		cmp	r0, #15
 4169 0236 F8D1     		bne	.L463
1432:bluetooth_rxtx.c **** 
 4170              		.loc 1 1432 0
 4171 0238 6320     		movs	r0, #99
 4172 023a FFF7FEFF 		bl	cc2400_strobe
 4173              	.LVL472:
1434:bluetooth_rxtx.c **** 	}
 4174              		.loc 1 1434 0
 4175 023e 3868     		ldr	r0, [r7]
 4176 0240 FFF7FEFF 		bl	handle_usb
 4177              	.LVL473:
 4178 0244 B6E7     		b	.L450
 4179              	.L464:
1438:bluetooth_rxtx.c **** #endif
 4180              		.loc 1 1438 0
 4181 0246 0D4B     		ldr	r3, .L472+32
 4182 0248 8022     		movs	r2, #128
 4183 024a 1A60     		str	r2, [r3]
1442:bluetooth_rxtx.c **** }
 4184              		.loc 1 1442 0
ARM GAS  /tmp/cckWTbJW.s 			page 122


 4185 024c 0820     		movs	r0, #8
 4186 024e 2946     		mov	r1, r5
 4187 0250 FFF7FEFF 		bl	cc2400_set
 4188              	.LVL474:
1443:bluetooth_rxtx.c **** 
 4189              		.loc 1 1443 0
 4190 0254 04B0     		add	sp, sp, #16
 4191              		@ sp needed
 4192 0256 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 4193              	.LVL475:
 4194              	.L473:
 4195 025a 00BF     		.align	2
 4196              	.L472:
 4197 025c 00000000 		.word	target
 4198 0260 00000000 		.word	.LANCHOR1
 4199 0264 00000000 		.word	.LANCHOR0
 4200 0268 58C00920 		.word	537509976
 4201 026c 00000000 		.word	clkn
 4202 0270 08400040 		.word	1073758216
 4203 0274 38C00920 		.word	537509944
 4204 0278 3CC00920 		.word	537509948
 4205 027c 5CC00920 		.word	537509980
 4206              		.cfi_endproc
 4207              	.LFE17:
 4209              		.section	.text.reset_le,"ax",%progbits
 4210              		.align	1
 4211              		.global	reset_le
 4212              		.thumb
 4213              		.thumb_func
 4215              	reset_le:
 4216              	.LFB19:
1456:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
 4217              		.loc 1 1456 0
 4218              		.cfi_startproc
 4219              		@ args = 0, pretend = 0, frame = 0
 4220              		@ frame_needed = 0, uses_anonymous_args = 0
 4221 0000 08B5     		push	{r3, lr}
 4222              		.cfi_def_cfa_offset 8
 4223              		.cfi_offset 3, -8
 4224              		.cfi_offset 14, -4
1457:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
 4225              		.loc 1 1457 0
 4226 0002 0F48     		ldr	r0, .L475
 4227 0004 FFF7FEFF 		bl	le_set_access_address
 4228              	.LVL476:
1458:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
 4229              		.loc 1 1458 0
 4230 0008 0E4B     		ldr	r3, .L475+4
 4231 000a 0F4A     		ldr	r2, .L475+8
 4232 000c DA60     		str	r2, [r3, #12]
1459:bluetooth_rxtx.c **** 	le.crc_verify = 0;
 4233              		.loc 1 1459 0
 4234 000e 0F4A     		ldr	r2, .L475+12
 4235 0010 1A61     		str	r2, [r3, #16]
1460:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4236              		.loc 1 1460 0
 4237 0012 0022     		movs	r2, #0
ARM GAS  /tmp/cckWTbJW.s 			page 123


1469:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4238              		.loc 1 1469 0
 4239 0014 1A84     		strh	r2, [r3, #32]	@ movhi
1460:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4240              		.loc 1 1460 0
 4241 0016 5A61     		str	r2, [r3, #20]
1472:bluetooth_rxtx.c **** 
 4242              		.loc 1 1472 0
 4243 0018 9A84     		strh	r2, [r3, #36]	@ movhi
1461:bluetooth_rxtx.c **** 
 4244              		.loc 1 1461 0
 4245 001a 5A64     		str	r2, [r3, #68]
1463:bluetooth_rxtx.c **** 
 4246              		.loc 1 1463 0
 4247 001c 1A76     		strb	r2, [r3, #24]
1465:bluetooth_rxtx.c **** 	le.channel_increment = 0;
 4248              		.loc 1 1465 0
 4249 001e 5A76     		strb	r2, [r3, #25]
1466:bluetooth_rxtx.c **** 
 4250              		.loc 1 1466 0
 4251 0020 9A76     		strb	r2, [r3, #26]
1468:bluetooth_rxtx.c **** 	le.interval_timer = 0;
 4252              		.loc 1 1468 0
 4253 0022 DA61     		str	r2, [r3, #28]
1470:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4254              		.loc 1 1470 0
 4255 0024 5A84     		strh	r2, [r3, #34]	@ movhi
1474:bluetooth_rxtx.c **** 	le.win_offset = 0;
 4256              		.loc 1 1474 0
 4257 0026 83F82620 		strb	r2, [r3, #38]
1475:bluetooth_rxtx.c **** 
 4258              		.loc 1 1475 0
 4259 002a 1A85     		strh	r2, [r3, #40]	@ movhi
1477:bluetooth_rxtx.c **** 	le.update_instant = 0;
 4260              		.loc 1 1477 0
 4261 002c DA62     		str	r2, [r3, #44]
1478:bluetooth_rxtx.c **** 	le.interval_update = 0;
 4262              		.loc 1 1478 0
 4263 002e 1A86     		strh	r2, [r3, #48]	@ movhi
1479:bluetooth_rxtx.c **** 	le.win_size_update = 0;
 4264              		.loc 1 1479 0
 4265 0030 5A86     		strh	r2, [r3, #50]	@ movhi
1480:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
 4266              		.loc 1 1480 0
 4267 0032 83F83420 		strb	r2, [r3, #52]
1481:bluetooth_rxtx.c **** 
 4268              		.loc 1 1481 0
 4269 0036 DA86     		strh	r2, [r3, #54]	@ movhi
1483:bluetooth_rxtx.c **** }
 4270              		.loc 1 1483 0
 4271 0038 054B     		ldr	r3, .L475+16
 4272 003a DA72     		strb	r2, [r3, #11]
 4273 003c 08BD     		pop	{r3, pc}
 4274              	.L476:
 4275 003e 00BF     		.align	2
 4276              	.L475:
 4277 0040 D6BE898E 		.word	-1903575338
ARM GAS  /tmp/cckWTbJW.s 			page 124


 4278 0044 00000000 		.word	.LANCHOR1
 4279 0048 55555500 		.word	5592405
 4280 004c AAAAAA00 		.word	11184810
 4281 0050 00000000 		.word	.LANCHOR0
 4282              		.cfi_endproc
 4283              	.LFE19:
 4285              		.section	.text.reset_le_promisc,"ax",%progbits
 4286              		.align	1
 4287              		.global	reset_le_promisc
 4288              		.thumb
 4289              		.thumb_func
 4291              	reset_le_promisc:
 4292              	.LFB20:
1487:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
 4293              		.loc 1 1487 0
 4294              		.cfi_startproc
 4295              		@ args = 0, pretend = 0, frame = 0
 4296              		@ frame_needed = 0, uses_anonymous_args = 0
 4297 0000 10B5     		push	{r4, lr}
 4298              		.cfi_def_cfa_offset 8
 4299              		.cfi_offset 4, -8
 4300              		.cfi_offset 14, -4
1488:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
 4301              		.loc 1 1488 0
 4302 0002 064C     		ldr	r4, .L478
 4303 0004 0021     		movs	r1, #0
 4304 0006 2046     		mov	r0, r4
 4305 0008 4FF48472 		mov	r2, #264
 4306 000c FFF7FEFF 		bl	memset
 4307              	.LVL477:
1489:bluetooth_rxtx.c **** }
 4308              		.loc 1 1489 0
 4309 0010 4FF0FF33 		mov	r3, #-1
 4310 0014 C4F80031 		str	r3, [r4, #256]
 4311 0018 10BD     		pop	{r4, pc}
 4312              	.L479:
 4313 001a 00BF     		.align	2
 4314              	.L478:
 4315 001c 00000000 		.word	le_promisc
 4316              		.cfi_endproc
 4317              	.LFE20:
 4319              		.section	.text.bt_generic_le,"ax",%progbits
 4320              		.align	1
 4321              		.global	bt_generic_le
 4322              		.thumb
 4323              		.thumb_func
 4325              	bt_generic_le:
 4326              	.LFB21:
1494:bluetooth_rxtx.c **** 	u8 hold;
 4327              		.loc 1 1494 0
 4328              		.cfi_startproc
 4329              		@ args = 0, pretend = 0, frame = 0
 4330              		@ frame_needed = 0, uses_anonymous_args = 0
 4331              	.LVL478:
 4332 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 4333              		.cfi_def_cfa_offset 32
 4334              		.cfi_offset 3, -32
ARM GAS  /tmp/cckWTbJW.s 			page 125


 4335              		.cfi_offset 4, -28
 4336              		.cfi_offset 5, -24
 4337              		.cfi_offset 6, -20
 4338              		.cfi_offset 7, -16
 4339              		.cfi_offset 8, -12
 4340              		.cfi_offset 9, -8
 4341              		.cfi_offset 14, -4
1499:bluetooth_rxtx.c **** 	mode = active_mode;
 4342              		.loc 1 1499 0
 4343 0004 694C     		ldr	r4, .L525
 4344 0006 0123     		movs	r3, #1
1494:bluetooth_rxtx.c **** 	u8 hold;
 4345              		.loc 1 1494 0
 4346 0008 8046     		mov	r8, r0
1499:bluetooth_rxtx.c **** 	mode = active_mode;
 4347              		.loc 1 1499 0
 4348 000a 2370     		strb	r3, [r4]
1500:bluetooth_rxtx.c **** 
 4349              		.loc 1 1500 0
 4350 000c 6074     		strb	r0, [r4, #17]
1502:bluetooth_rxtx.c **** 
 4351              		.loc 1 1502 0
 4352 000e FFF7FEFF 		bl	reset_le
 4353              	.LVL479:
1505:bluetooth_rxtx.c **** 
 4354              		.loc 1 1505 0
 4355 0012 674B     		ldr	r3, .L525+4
 4356 0014 4FF08072 		mov	r2, #16777216
 4357 0018 1A60     		str	r2, [r3]
1507:bluetooth_rxtx.c **** 
 4358              		.loc 1 1507 0
 4359 001a 664B     		ldr	r3, .L525+8
 4360 001c 1022     		movs	r2, #16
 4361 001e 1A60     		str	r2, [r3]
1509:bluetooth_rxtx.c **** 	dio_ssp_init();
 4362              		.loc 1 1509 0
 4363 0020 FFF7FEFF 		bl	queue_init
 4364              	.LVL480:
1510:bluetooth_rxtx.c **** 	dma_init();
 4365              		.loc 1 1510 0
 4366 0024 FFF7FEFF 		bl	dio_ssp_init
 4367              	.LVL481:
1511:bluetooth_rxtx.c **** 	dio_ssp_start();
 4368              		.loc 1 1511 0
 4369 0028 FFF7FEFF 		bl	dma_init
 4370              	.LVL482:
1512:bluetooth_rxtx.c **** 	cc2400_rx();
 4371              		.loc 1 1512 0
 4372 002c FFF7FEFF 		bl	dio_ssp_start
 4373              	.LVL483:
1513:bluetooth_rxtx.c **** 
 4374              		.loc 1 1513 0
 4375 0030 FFF7FEFF 		bl	cc2400_rx
 4376              	.LVL484:
1515:bluetooth_rxtx.c **** 
 4377              		.loc 1 1515 0
 4378 0034 FFF7FEFF 		bl	cs_trigger_enable
ARM GAS  /tmp/cckWTbJW.s 			page 126


 4379              	.LVL485:
1517:bluetooth_rxtx.c **** 
 4380              		.loc 1 1517 0
 4381 0038 0025     		movs	r5, #0
 4382              	.LVL486:
 4383              	.L481:
1519:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4384              		.loc 1 1519 0 discriminator 1
 4385 003a A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4386 003c 4345     		cmp	r3, r8
 4387 003e 40F0A380 		bne	.L505
 4388              	.LBB36:
1520:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4389              		.loc 1 1520 0
 4390 0042 5A4B     		ldr	r3, .L525
 4391 0044 DB89     		ldrh	r3, [r3, #14]
 4392 0046 9BB2     		uxth	r3, r3
 4393 0048 D3B1     		cbz	r3, .L482
1521:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4394              		.loc 1 1521 0
 4395 004a 6420     		movs	r0, #100
 4396 004c FFF7FEFF 		bl	cc2400_strobe
 4397              	.LVL487:
 4398              	.L484:
1522:bluetooth_rxtx.c **** 
 4399              		.loc 1 1522 0 discriminator 1
 4400 0050 FFF7FEFF 		bl	cc2400_status
 4401              	.LVL488:
 4402 0054 4707     		lsls	r7, r0, #29
 4403 0056 FBD4     		bmi	.L484
1525:bluetooth_rxtx.c **** 
 4404              		.loc 1 1525 0
 4405 0058 574B     		ldr	r3, .L525+12
 4406 005a 0220     		movs	r0, #2
 4407 005c 1988     		ldrh	r1, [r3]
 4408 005e 89B2     		uxth	r1, r1
 4409 0060 0139     		subs	r1, r1, #1
 4410 0062 89B2     		uxth	r1, r1
 4411 0064 FFF7FEFF 		bl	cc2400_set
 4412              	.LVL489:
1528:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4413              		.loc 1 1528 0
 4414 0068 6120     		movs	r0, #97
 4415 006a FFF7FEFF 		bl	cc2400_strobe
 4416              	.LVL490:
 4417              	.L486:
1529:bluetooth_rxtx.c **** 
 4418              		.loc 1 1529 0 discriminator 1
 4419 006e FFF7FEFF 		bl	cc2400_status
 4420              	.LVL491:
 4421 0072 4607     		lsls	r6, r0, #29
 4422 0074 FBD5     		bpl	.L486
1532:bluetooth_rxtx.c **** 
 4423              		.loc 1 1532 0
 4424 0076 6220     		movs	r0, #98
 4425 0078 FFF7FEFF 		bl	cc2400_strobe
 4426              	.LVL492:
ARM GAS  /tmp/cckWTbJW.s 			page 127


1534:bluetooth_rxtx.c **** 		}
 4427              		.loc 1 1534 0
 4428 007c 0023     		movs	r3, #0
 4429 007e E381     		strh	r3, [r4, #14]	@ movhi
 4430              	.L482:
1537:bluetooth_rxtx.c **** 			hop();
 4431              		.loc 1 1537 0
 4432 0080 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4433 0082 4C4E     		ldr	r6, .L525+8
 4434 0084 13B1     		cbz	r3, .L487
1538:bluetooth_rxtx.c **** 		} else {
 4435              		.loc 1 1538 0
 4436 0086 FFF7FEFF 		bl	hop
 4437              	.LVL493:
 4438 008a 02E0     		b	.L488
 4439              	.L487:
1540:bluetooth_rxtx.c **** 		}
 4440              		.loc 1 1540 0
 4441 008c 4FF48073 		mov	r3, #256
 4442 0090 3360     		str	r3, [r6]
 4443              	.L488:
1543:bluetooth_rxtx.c **** 
 4444              		.loc 1 1543 0
 4445 0092 1023     		movs	r3, #16
 4446 0094 3360     		str	r3, [r6]
1546:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 4447              		.loc 1 1546 0
 4448 0096 FFF7FEFF 		bl	rssi_reset
 4449              	.LVL494:
1547:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
 4450              		.loc 1 1547 0
 4451 009a 8027     		movs	r7, #128
 4452              	.LVL495:
 4453              	.L489:
1548:bluetooth_rxtx.c **** 		{
 4454              		.loc 1 1548 0 discriminator 1
 4455 009c 474B     		ldr	r3, .L525+16
 4456 009e 484E     		ldr	r6, .L525+20
 4457 00a0 1A68     		ldr	r2, [r3]
 4458 00a2 9946     		mov	r9, r3
 4459 00a4 D2B9     		cbnz	r2, .L491
1548:bluetooth_rxtx.c **** 		{
 4460              		.loc 1 1548 0 is_stmt 0 discriminator 2
 4461 00a6 3368     		ldr	r3, [r6]
 4462 00a8 C3B9     		cbnz	r3, .L491
1550:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4463              		.loc 1 1550 0 is_stmt 1
 4464 00aa 0620     		movs	r0, #6
 4465 00ac FFF7FEFF 		bl	cc2400_get
 4466              	.LVL496:
1551:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4467              		.loc 1 1551 0
 4468 00b0 444B     		ldr	r3, .L525+24
1550:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4469              		.loc 1 1550 0
 4470 00b2 C0F30720 		ubfx	r0, r0, #8, #8
 4471              	.LVL497:
ARM GAS  /tmp/cckWTbJW.s 			page 128


1551:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4472              		.loc 1 1551 0
 4473 00b6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4474 00b8 63B1     		cbz	r3, .L490
1551:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4475              		.loc 1 1551 0 is_stmt 0 discriminator 1
 4476 00ba 7BB2     		sxtb	r3, r7
 4477 00bc 8033     		adds	r3, r3, #128
 4478 00be 09D1     		bne	.L490
1552:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 4479              		.loc 1 1552 0 is_stmt 1
 4480 00c0 414B     		ldr	r3, .L525+28
 4481 00c2 40B2     		sxtb	r0, r0
 4482              	.LVL498:
 4483 00c4 93F90070 		ldrsb	r7, [r3]
 4484              	.LVL499:
 4485 00c8 3637     		adds	r7, r7, #54
 4486 00ca B842     		cmp	r0, r7
 4487 00cc A8BF     		it	ge
 4488 00ce 0746     		movge	r7, r0
 4489 00d0 FFB2     		uxtb	r7, r7
1553:bluetooth_rxtx.c **** 			}
 4490              		.loc 1 1553 0
 4491 00d2 3846     		mov	r0, r7
 4492              	.L490:
 4493              	.LVL500:
1555:bluetooth_rxtx.c **** 		}
 4494              		.loc 1 1555 0
 4495 00d4 40B2     		sxtb	r0, r0
 4496              	.LVL501:
 4497 00d6 FFF7FEFF 		bl	rssi_add
 4498              	.LVL502:
 4499 00da DFE7     		b	.L489
 4500              	.L491:
1558:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4501              		.loc 1 1558 0
 4502 00dc 3368     		ldr	r3, [r6]
 4503 00de 1BB1     		cbz	r3, .L493
1559:bluetooth_rxtx.c **** 		}
 4504              		.loc 1 1559 0
 4505 00e0 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4506 00e2 43F00203 		orr	r3, r3, #2
 4507 00e6 6370     		strb	r3, [r4, #1]
 4508              	.L493:
1563:bluetooth_rxtx.c **** 			goto rx_continue;
 4509              		.loc 1 1563 0
 4510 00e8 D9F80030 		ldr	r3, [r9]
 4511 00ec 002B     		cmp	r3, #0
 4512 00ee 57D0     		beq	.L494
1567:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 4513              		.loc 1 1567 0
 4514 00f0 324B     		ldr	r3, .L525+16
 4515 00f2 1B68     		ldr	r3, [r3]
 4516 00f4 012B     		cmp	r3, #1
 4517 00f6 03D9     		bls	.L495
1568:bluetooth_rxtx.c **** 
 4518              		.loc 1 1568 0
ARM GAS  /tmp/cckWTbJW.s 			page 129


 4519 00f8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4520 00fa 43F00103 		orr	r3, r3, #1
 4521 00fe 6370     		strb	r3, [r4, #1]
 4522              	.L495:
1570:bluetooth_rxtx.c **** 
 4523              		.loc 1 1570 0
 4524 0100 2D4B     		ldr	r3, .L525+12
 4525 0102 1888     		ldrh	r0, [r3]
 4526 0104 80B2     		uxth	r0, r0
 4527 0106 FFF7FEFF 		bl	rssi_iir_update
 4528              	.LVL503:
1576:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4529              		.loc 1 1576 0
 4530 010a 2E4B     		ldr	r3, .L525+24
 4531 010c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 4532 010e 12B9     		cbnz	r2, .L496
1576:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4533              		.loc 1 1576 0 is_stmt 0 discriminator 1
 4534 0110 2E4A     		ldr	r2, .L525+32
 4535 0112 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 4536 0114 32B1     		cbz	r2, .L497
 4537              	.L496:
1577:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4538              		.loc 1 1577 0 is_stmt 1
 4539 0116 6278     		ldrb	r2, [r4, #1]	@ zero_extendqisi2
1578:bluetooth_rxtx.c **** 			cs_trigger = 0;
 4540              		.loc 1 1578 0
 4541 0118 0225     		movs	r5, #2
 4542              	.LVL504:
1577:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4543              		.loc 1 1577 0
 4544 011a 42F00802 		orr	r2, r2, #8
 4545 011e 6270     		strb	r2, [r4, #1]
 4546              	.LVL505:
1579:bluetooth_rxtx.c **** 		}
 4547              		.loc 1 1579 0
 4548 0120 0022     		movs	r2, #0
 4549 0122 1A70     		strb	r2, [r3]
 4550              	.LVL506:
 4551              	.L497:
1582:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 4552              		.loc 1 1582 0
 4553 0124 284B     		ldr	r3, .L525+28
 4554 0126 93F90020 		ldrsb	r2, [r3]
 4555 012a 294B     		ldr	r3, .L525+36
 4556 012c 3532     		adds	r2, r2, #53
 4557 012e 93F90030 		ldrsb	r3, [r3]
 4558 0132 9A42     		cmp	r2, r3
 4559 0134 05DA     		bge	.L498
1583:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4560              		.loc 1 1583 0
 4561 0136 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
1584:bluetooth_rxtx.c **** 		}
 4562              		.loc 1 1584 0
 4563 0138 0225     		movs	r5, #2
 4564              	.LVL507:
1583:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
ARM GAS  /tmp/cckWTbJW.s 			page 130


 4565              		.loc 1 1583 0
 4566 013a 43F01003 		orr	r3, r3, #16
 4567 013e 6370     		strb	r3, [r4, #1]
 4568              	.LVL508:
 4569 0140 00E0     		b	.L499
 4570              	.LVL509:
 4571              	.L498:
1588:bluetooth_rxtx.c **** 			goto rx_continue;
 4572              		.loc 1 1588 0
 4573 0142 6DB3     		cbz	r5, .L494
 4574              	.LVL510:
 4575              	.L499:
1594:bluetooth_rxtx.c **** 
 4576              		.loc 1 1594 0
 4577 0144 2348     		ldr	r0, .L525+40
1591:bluetooth_rxtx.c **** 
 4578              		.loc 1 1591 0
 4579 0146 013D     		subs	r5, r5, #1
 4580              	.LVL511:
1594:bluetooth_rxtx.c **** 
 4581              		.loc 1 1594 0
 4582 0148 00F5C871 		add	r1, r0, #400
 4583 014c 4FF4C872 		mov	r2, #400
 4584 0150 FFF7FEFF 		bl	memcpy
 4585              	.LVL512:
1591:bluetooth_rxtx.c **** 
 4586              		.loc 1 1591 0
 4587 0154 EDB2     		uxtb	r5, r5
 4588              	.LVL513:
1597:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4589              		.loc 1 1597 0
 4590 0156 0023     		movs	r3, #0
 4591              	.LVL514:
 4592              	.L500:
 4593 0158 1F48     		ldr	r0, .L525+44
1584:bluetooth_rxtx.c **** 		}
 4594              		.loc 1 1584 0 discriminator 1
 4595 015a 0022     		movs	r2, #0
 4596 015c 00EBC300 		add	r0, r0, r3, lsl #3
 4597              	.LVL515:
 4598              	.L503:
1600:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4599              		.loc 1 1600 0 discriminator 2
 4600 0160 1E49     		ldr	r1, .L525+48
 4601 0162 0F68     		ldr	r7, [r1]
 4602 0164 FF5C     		ldrb	r7, [r7, r3]	@ zero_extendqisi2
1601:bluetooth_rxtx.c **** 			}
 4603              		.loc 1 1601 0 discriminator 2
 4604 0166 0968     		ldr	r1, [r1]
1600:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4605              		.loc 1 1600 0 discriminator 2
 4606 0168 FF09     		lsrs	r7, r7, #7
 4607 016a 8754     		strb	r7, [r0, r2]
1601:bluetooth_rxtx.c **** 			}
 4608              		.loc 1 1601 0 discriminator 2
 4609 016c CF5C     		ldrb	r7, [r1, r3]	@ zero_extendqisi2
1599:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
ARM GAS  /tmp/cckWTbJW.s 			page 131


 4610              		.loc 1 1599 0 discriminator 2
 4611 016e 0132     		adds	r2, r2, #1
 4612              	.LVL516:
1601:bluetooth_rxtx.c **** 			}
 4613              		.loc 1 1601 0 discriminator 2
 4614 0170 7F00     		lsls	r7, r7, #1
 4615 0172 FFB2     		uxtb	r7, r7
1599:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4616              		.loc 1 1599 0 discriminator 2
 4617 0174 082A     		cmp	r2, #8
1601:bluetooth_rxtx.c **** 			}
 4618              		.loc 1 1601 0 discriminator 2
 4619 0176 CF54     		strb	r7, [r1, r3]
1599:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4620              		.loc 1 1599 0 discriminator 2
 4621 0178 F2D1     		bne	.L503
1597:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4622              		.loc 1 1597 0
 4623 017a 0133     		adds	r3, r3, #1
 4624              	.LVL517:
 4625 017c 322B     		cmp	r3, #50
 4626 017e EBD1     		bne	.L500
1605:bluetooth_rxtx.c **** 		if (!ret) break;
 4627              		.loc 1 1605 0
 4628 0180 A36A     		ldr	r3, [r4, #40]
 4629              	.LVL518:
 4630 0182 1448     		ldr	r0, .L525+40
 4631 0184 9847     		blx	r3
 4632              	.LVL519:
1606:bluetooth_rxtx.c **** 
 4633              		.loc 1 1606 0
 4634 0186 58B9     		cbnz	r0, .L494
 4635              	.LVL520:
 4636              	.L505:
 4637              	.LBE36:
1614:bluetooth_rxtx.c **** 
 4638              		.loc 1 1614 0
 4639 0188 154B     		ldr	r3, .L525+52
 4640 018a 4FF08072 		mov	r2, #16777216
 4641 018e 1A60     		str	r2, [r3]
1617:bluetooth_rxtx.c **** 	dio_ssp_stop();
 4642              		.loc 1 1617 0
 4643 0190 FFF7FEFF 		bl	cc2400_idle
 4644              	.LVL521:
1618:bluetooth_rxtx.c **** 	cs_trigger_disable();
 4645              		.loc 1 1618 0
 4646 0194 FFF7FEFF 		bl	dio_ssp_stop
 4647              	.LVL522:
1620:bluetooth_rxtx.c **** 
 4648              		.loc 1 1620 0
 4649 0198 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1619:bluetooth_rxtx.c **** }
 4650              		.loc 1 1619 0
 4651 019c FFF7FEBF 		b	cs_trigger_disable
 4652              	.LVL523:
 4653              	.L494:
 4654              	.LBB37:
ARM GAS  /tmp/cckWTbJW.s 			page 132


1609:bluetooth_rxtx.c **** 		rx_err = 0;
 4655              		.loc 1 1609 0
 4656 01a0 0023     		movs	r3, #0
 4657 01a2 C9F80030 		str	r3, [r9]
1610:bluetooth_rxtx.c **** 	}
 4658              		.loc 1 1610 0
 4659 01a6 3360     		str	r3, [r6]
 4660 01a8 47E7     		b	.L481
 4661              	.L526:
 4662 01aa 00BF     		.align	2
 4663              	.L525:
 4664 01ac 00000000 		.word	.LANCHOR0
 4665 01b0 00E100E0 		.word	-536813312
 4666 01b4 3CC00920 		.word	537509948
 4667 01b8 00000000 		.word	.LANCHOR1
 4668 01bc 00000000 		.word	rx_tc
 4669 01c0 00000000 		.word	rx_err
 4670 01c4 00000000 		.word	cs_trigger
 4671 01c8 00000000 		.word	cs_threshold_cur
 4672 01cc 00000000 		.word	cs_no_squelch
 4673 01d0 00000000 		.word	rssi_max
 4674 01d4 00000000 		.word	unpacked
 4675 01d8 90010000 		.word	unpacked+400
 4676 01dc 00000000 		.word	idle_rxbuf
 4677 01e0 80E100E0 		.word	-536813184
 4678              	.LBE37:
 4679              		.cfi_endproc
 4680              	.LFE21:
 4682              		.section	.text.bt_le_sync,"ax",%progbits
 4683              		.align	1
 4684              		.global	bt_le_sync
 4685              		.thumb
 4686              		.thumb_func
 4688              	bt_le_sync:
 4689              	.LFB22:
1624:bluetooth_rxtx.c **** 	int i;
 4690              		.loc 1 1624 0
 4691              		.cfi_startproc
 4692              		@ args = 0, pretend = 0, frame = 64
 4693              		@ frame_needed = 0, uses_anonymous_args = 0
 4694              	.LVL524:
 4695 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4696              		.cfi_def_cfa_offset 36
 4697              		.cfi_offset 4, -36
 4698              		.cfi_offset 5, -32
 4699              		.cfi_offset 6, -28
 4700              		.cfi_offset 7, -24
 4701              		.cfi_offset 8, -20
 4702              		.cfi_offset 9, -16
 4703              		.cfi_offset 10, -12
 4704              		.cfi_offset 11, -8
 4705              		.cfi_offset 14, -4
 4706 0004 91B0     		sub	sp, sp, #68
 4707              		.cfi_def_cfa_offset 104
1629:bluetooth_rxtx.c **** 	mode = active_mode;
 4708              		.loc 1 1629 0
 4709 0006 AF4D     		ldr	r5, .L590
ARM GAS  /tmp/cckWTbJW.s 			page 133


1632:bluetooth_rxtx.c **** 
 4710              		.loc 1 1632 0
 4711 0008 AF4C     		ldr	r4, .L590+4
1629:bluetooth_rxtx.c **** 	mode = active_mode;
 4712              		.loc 1 1629 0
 4713 000a 0123     		movs	r3, #1
 4714 000c 2B70     		strb	r3, [r5]
1632:bluetooth_rxtx.c **** 
 4715              		.loc 1 1632 0
 4716 000e 2376     		strb	r3, [r4, #24]
1635:bluetooth_rxtx.c **** 
 4717              		.loc 1 1635 0
 4718 0010 AE4B     		ldr	r3, .L590+8
 4719 0012 4FF08072 		mov	r2, #16777216
1630:bluetooth_rxtx.c **** 
 4720              		.loc 1 1630 0
 4721 0016 6874     		strb	r0, [r5, #17]
1635:bluetooth_rxtx.c **** 
 4722              		.loc 1 1635 0
 4723 0018 1A60     		str	r2, [r3]
1637:bluetooth_rxtx.c **** 
 4724              		.loc 1 1637 0
 4725 001a AD4B     		ldr	r3, .L590+12
 4726 001c 1022     		movs	r2, #16
 4727 001e 1A60     		str	r2, [r3]
1624:bluetooth_rxtx.c **** 	int i;
 4728              		.loc 1 1624 0
 4729 0020 0646     		mov	r6, r0
1639:bluetooth_rxtx.c **** 	dio_ssp_init();
 4730              		.loc 1 1639 0
 4731 0022 FFF7FEFF 		bl	queue_init
 4732              	.LVL525:
1640:bluetooth_rxtx.c **** 	dma_init_le();
 4733              		.loc 1 1640 0
 4734 0026 FFF7FEFF 		bl	dio_ssp_init
 4735              	.LVL526:
1641:bluetooth_rxtx.c **** 	dio_ssp_start();
 4736              		.loc 1 1641 0
 4737 002a FFF7FEFF 		bl	dma_init_le
 4738              	.LVL527:
1642:bluetooth_rxtx.c **** 
 4739              		.loc 1 1642 0
 4740 002e FFF7FEFF 		bl	dio_ssp_start
 4741              	.LVL528:
1644:bluetooth_rxtx.c **** 
 4742              		.loc 1 1644 0
 4743 0032 6068     		ldr	r0, [r4, #4]
 4744 0034 FFF7FEFF 		bl	rbit
 4745              	.LVL529:
 4746 0038 FFF7FEFF 		bl	cc2400_rx_sync
 4747              	.LVL530:
 4748              	.L528:
1646:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4749              		.loc 1 1646 0 discriminator 1
 4750 003c AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 4751 003e B342     		cmp	r3, r6
 4752 0040 40F0B681 		bne	.L568
ARM GAS  /tmp/cckWTbJW.s 			page 134


 4753              	.LBB38:
1647:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4754              		.loc 1 1647 0
 4755 0044 9F4B     		ldr	r3, .L590
 4756 0046 DB89     		ldrh	r3, [r3, #14]
 4757 0048 9BB2     		uxth	r3, r3
 4758 004a CBB1     		cbz	r3, .L529
1648:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4759              		.loc 1 1648 0
 4760 004c 6420     		movs	r0, #100
 4761 004e FFF7FEFF 		bl	cc2400_strobe
 4762              	.LVL531:
 4763              	.L531:
1649:bluetooth_rxtx.c **** 
 4764              		.loc 1 1649 0 discriminator 1
 4765 0052 FFF7FEFF 		bl	cc2400_status
 4766              	.LVL532:
 4767 0056 4307     		lsls	r3, r0, #29
 4768 0058 FBD4     		bmi	.L531
1652:bluetooth_rxtx.c **** 
 4769              		.loc 1 1652 0
 4770 005a 2188     		ldrh	r1, [r4]
 4771 005c 0220     		movs	r0, #2
 4772 005e 89B2     		uxth	r1, r1
 4773 0060 0139     		subs	r1, r1, #1
 4774 0062 89B2     		uxth	r1, r1
 4775 0064 FFF7FEFF 		bl	cc2400_set
 4776              	.LVL533:
1655:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4777              		.loc 1 1655 0
 4778 0068 6120     		movs	r0, #97
 4779 006a FFF7FEFF 		bl	cc2400_strobe
 4780              	.LVL534:
 4781              	.L533:
1656:bluetooth_rxtx.c **** 
 4782              		.loc 1 1656 0 discriminator 1
 4783 006e FFF7FEFF 		bl	cc2400_status
 4784              	.LVL535:
 4785 0072 4707     		lsls	r7, r0, #29
 4786 0074 FBD5     		bpl	.L533
1659:bluetooth_rxtx.c **** 
 4787              		.loc 1 1659 0
 4788 0076 6220     		movs	r0, #98
 4789 0078 FFF7FEFF 		bl	cc2400_strobe
 4790              	.LVL536:
1661:bluetooth_rxtx.c **** 		}
 4791              		.loc 1 1661 0
 4792 007c 0023     		movs	r3, #0
 4793 007e EB81     		strh	r3, [r5, #14]	@ movhi
 4794              	.L529:
1664:bluetooth_rxtx.c **** 
 4795              		.loc 1 1664 0
 4796 0080 934B     		ldr	r3, .L590+12
 4797 0082 1022     		movs	r2, #16
 4798 0084 1A60     		str	r2, [r3]
1667:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
 4799              		.loc 1 1667 0
ARM GAS  /tmp/cckWTbJW.s 			page 135


 4800 0086 FFF7FEFF 		bl	rssi_reset
 4801              	.LVL537:
 4802              	.L535:
1668:bluetooth_rxtx.c **** 			;
 4803              		.loc 1 1668 0 discriminator 1
 4804 008a 924B     		ldr	r3, .L590+16
 4805 008c 1A68     		ldr	r2, [r3]
 4806 008e 9946     		mov	r9, r3
 4807 0090 42B9     		cbnz	r2, .L534
1668:bluetooth_rxtx.c **** 			;
 4808              		.loc 1 1668 0 is_stmt 0 discriminator 2
 4809 0092 914B     		ldr	r3, .L590+20
 4810 0094 1B68     		ldr	r3, [r3]
 4811 0096 2BB9     		cbnz	r3, .L534
1668:bluetooth_rxtx.c **** 			;
 4812              		.loc 1 1668 0 discriminator 1
 4813 0098 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 4814 009a 1BB9     		cbnz	r3, .L534
 4815 009c 894B     		ldr	r3, .L590
 4816 009e 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 4817 00a0 B342     		cmp	r3, r6
 4818 00a2 F2D0     		beq	.L535
 4819              	.L534:
1671:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 4820              		.loc 1 1671 0 is_stmt 1
 4821 00a4 0620     		movs	r0, #6
 4822 00a6 FFF7FEFF 		bl	cc2400_get
 4823              	.LVL538:
1672:bluetooth_rxtx.c **** 
 4824              		.loc 1 1672 0
 4825 00aa 8C4B     		ldr	r3, .L590+24
1671:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 4826              		.loc 1 1671 0
 4827 00ac C0F30720 		ubfx	r0, r0, #8, #8
 4828              	.LVL539:
1674:bluetooth_rxtx.c **** 			goto cleanup;
 4829              		.loc 1 1674 0
 4830 00b0 AA7C     		ldrb	r2, [r5, #18]	@ zero_extendqisi2
1672:bluetooth_rxtx.c **** 
 4831              		.loc 1 1672 0
 4832 00b2 1870     		strb	r0, [r3]
 4833 00b4 8A4B     		ldr	r3, .L590+28
1674:bluetooth_rxtx.c **** 			goto cleanup;
 4834              		.loc 1 1674 0
 4835 00b6 B242     		cmp	r2, r6
1672:bluetooth_rxtx.c **** 
 4836              		.loc 1 1672 0
 4837 00b8 1870     		strb	r0, [r3]
1674:bluetooth_rxtx.c **** 			goto cleanup;
 4838              		.loc 1 1674 0
 4839 00ba 824B     		ldr	r3, .L590
 4840 00bc 40F07881 		bne	.L568
1678:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4841              		.loc 1 1678 0
 4842 00c0 854F     		ldr	r7, .L590+20
 4843 00c2 3A68     		ldr	r2, [r7]
 4844 00c4 BB46     		mov	fp, r7
ARM GAS  /tmp/cckWTbJW.s 			page 136


 4845 00c6 1AB1     		cbz	r2, .L537
1679:bluetooth_rxtx.c **** 		}
 4846              		.loc 1 1679 0
 4847 00c8 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 4848 00ca 42F00202 		orr	r2, r2, #2
 4849 00ce 5A70     		strb	r2, [r3, #1]
 4850              	.L537:
1682:bluetooth_rxtx.c **** 			goto rx_flush;
 4851              		.loc 1 1682 0
 4852 00d0 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 4853 00d2 03F0FF01 		and	r1, r3, #255
 4854 00d6 002B     		cmp	r3, #0
 4855 00d8 40F0B780 		bne	.L539
1686:bluetooth_rxtx.c **** 			continue;
 4856              		.loc 1 1686 0
 4857 00dc D9F80030 		ldr	r3, [r9]
 4858 00e0 002B     		cmp	r3, #0
 4859 00e2 ABD0     		beq	.L528
1692:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
 4860              		.loc 1 1692 0
 4861 00e4 3422     		movs	r2, #52
 4862 00e6 03A8     		add	r0, sp, #12
 4863              	.LVL540:
 4864 00e8 FFF7FEFF 		bl	memset
 4865              	.LVL541:
1696:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 4866              		.loc 1 1696 0
 4867 00ec 2088     		ldrh	r0, [r4]
1694:bluetooth_rxtx.c **** 
 4868              		.loc 1 1694 0
 4869 00ee 6368     		ldr	r3, [r4, #4]
1696:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 4870              		.loc 1 1696 0
 4871 00f0 80B2     		uxth	r0, r0
 4872 00f2 6238     		subs	r0, r0, #98
 4873 00f4 C0B2     		uxtb	r0, r0
1694:bluetooth_rxtx.c **** 
 4874              		.loc 1 1694 0
 4875 00f6 0393     		str	r3, [sp, #12]
1696:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 4876              		.loc 1 1696 0
 4877 00f8 FFF7FEFF 		bl	btle_channel_index
 4878              	.LVL542:
 4879 00fc 4FF03008 		mov	r8, #48
 4880 0100 08FB00F8 		mul	r8, r8, r0
 4881 0104 DFF808A2 		ldr	r10, .L590+76
 4882 0108 0AEB0803 		add	r3, r10, r8
 4883 010c 0193     		str	r3, [sp, #4]
 4884              	.LVL543:
 4885              	.LBB39:
1698:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 4886              		.loc 1 1698 0
 4887 010e 754B     		ldr	r3, .L590+32
 4888              	.LVL544:
 4889 0110 93F800E0 		ldrb	lr, [r3]	@ zero_extendqisi2
1699:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 4890              		.loc 1 1699 0
ARM GAS  /tmp/cckWTbJW.s 			page 137


 4891 0114 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
1700:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 4892              		.loc 1 1700 0
 4893 0116 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
1699:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 4894              		.loc 1 1699 0
 4895 0118 1204     		lsls	r2, r2, #16
1701:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 4896              		.loc 1 1701 0
 4897 011a D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 4898              	.LVL545:
1699:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 4899              		.loc 1 1699 0
 4900 011c 42EA0E62 		orr	r2, r2, lr, lsl #24
1700:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 4901              		.loc 1 1700 0
 4902 0120 0A43     		orrs	r2, r2, r1
1702:bluetooth_rxtx.c **** 		}
 4903              		.loc 1 1702 0
 4904 0122 42EA0020 		orr	r0, r2, r0, lsl #8
 4905 0126 0093     		str	r3, [sp]
 4906 0128 FFF7FEFF 		bl	rbit
 4907              	.LVL546:
 4908 012c 5AF80820 		ldr	r2, [r10, r8]
 4909              	.LBE39:
1706:bluetooth_rxtx.c **** 			goto rx_flush;
 4910              		.loc 1 1706 0
 4911 0130 009B     		ldr	r3, [sp]
 4912              	.LBB40:
1702:bluetooth_rxtx.c **** 		}
 4913              		.loc 1 1702 0
 4914 0132 5040     		eors	r0, r0, r2
 4915              	.LBE40:
1705:bluetooth_rxtx.c **** 		if (len > 39)
 4916              		.loc 1 1705 0
 4917 0134 C0F3052A 		ubfx	r10, r0, #8, #6
 4918 0138 0AF10208 		add	r8, r10, #2
1706:bluetooth_rxtx.c **** 			goto rx_flush;
 4919              		.loc 1 1706 0
 4920 013c B8F1270F 		cmp	r8, #39
 4921              	.LBB41:
1702:bluetooth_rxtx.c **** 		}
 4922              		.loc 1 1702 0
 4923 0140 0490     		str	r0, [sp, #16]
 4924              	.LVL547:
 4925              	.LBE41:
1706:bluetooth_rxtx.c **** 			goto rx_flush;
 4926              		.loc 1 1706 0
 4927 0142 00F28280 		bhi	.L539
1711:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 4928              		.loc 1 1711 0
 4929 0146 0AF1080A 		add	r10, r10, #8
 4930 014a 4FEA9A02 		lsr	r2, r10, #2
 4931              	.LVL548:
1712:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
 4932              		.loc 1 1712 0
 4933 014e 0B2A     		cmp	r2, #11
ARM GAS  /tmp/cckWTbJW.s 			page 138


 4934 0150 0DD0     		beq	.L546
1713:bluetooth_rxtx.c **** 				;
 4935              		.loc 1 1713 0
 4936 0152 03EB8203 		add	r3, r3, r2, lsl #2
 4937              	.LVL549:
 4938              	.L545:
 4939 0156 644A     		ldr	r2, .L590+36
 4940 0158 1268     		ldr	r2, [r2]
 4941 015a 9A42     		cmp	r2, r3
 4942 015c 0BD2     		bcs	.L544
1713:bluetooth_rxtx.c **** 				;
 4943              		.loc 1 1713 0 is_stmt 0 discriminator 2
 4944 015e DBF80010 		ldr	r1, [fp]
 4945 0162 0029     		cmp	r1, #0
 4946 0164 F7D0     		beq	.L545
 4947 0166 06E0     		b	.L544
 4948              	.LVL550:
 4949              	.L588:
1716:bluetooth_rxtx.c **** 				;
 4950              		.loc 1 1716 0 is_stmt 1 discriminator 2
 4951 0168 DBF80030 		ldr	r3, [fp]
 4952 016c 1BB9     		cbnz	r3, .L544
 4953              	.L546:
1716:bluetooth_rxtx.c **** 				;
 4954              		.loc 1 1716 0 is_stmt 0
 4955 016e 5F4B     		ldr	r3, .L590+40
 4956 0170 1B68     		ldr	r3, [r3]
 4957 0172 D807     		lsls	r0, r3, #31
 4958 0174 F8D4     		bmi	.L588
 4959              	.LVL551:
 4960              	.L544:
1719:bluetooth_rxtx.c **** 
 4961              		.loc 1 1719 0 is_stmt 1
 4962 0176 5E4B     		ldr	r3, .L590+44
1722:bluetooth_rxtx.c **** 
 4963              		.loc 1 1722 0
 4964 0178 6120     		movs	r0, #97
1719:bluetooth_rxtx.c **** 
 4965              		.loc 1 1719 0
 4966 017a 1A68     		ldr	r2, [r3]
1725:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 4967              		.loc 1 1725 0
 4968 017c 4FF0040B 		mov	fp, #4
1719:bluetooth_rxtx.c **** 
 4969              		.loc 1 1719 0
 4970 0180 22F00102 		bic	r2, r2, #1
 4971 0184 1A60     		str	r2, [r3]
1722:bluetooth_rxtx.c **** 
 4972              		.loc 1 1722 0
 4973 0186 FFF7FEFF 		bl	cc2400_strobe
 4974              	.LVL552:
 4975              	.L548:
 4976              	.LBB42:
1726:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 4977              		.loc 1 1726 0 discriminator 2
 4978 018a 564A     		ldr	r2, .L590+32
 4979 018c 0BF10100 		add	r0, fp, #1
ARM GAS  /tmp/cckWTbJW.s 			page 139


 4980 0190 12F80B10 		ldrb	r1, [r2, fp]	@ zero_extendqisi2
 4981 0194 0BF1030C 		add	ip, fp, #3
1727:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 4982              		.loc 1 1727 0 discriminator 2
 4983 0198 12F800E0 		ldrb	lr, [r2, r0]	@ zero_extendqisi2
 4984 019c 0BF10200 		add	r0, fp, #2
1728:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 4985              		.loc 1 1728 0 discriminator 2
 4986 01a0 105C     		ldrb	r0, [r2, r0]	@ zero_extendqisi2
1729:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 4987              		.loc 1 1729 0 discriminator 2
 4988 01a2 12F80CC0 		ldrb	ip, [r2, ip]	@ zero_extendqisi2
 4989              	.LVL553:
1730:bluetooth_rxtx.c **** 		}
 4990              		.loc 1 1730 0 discriminator 2
 4991 01a6 4FEAAB02 		asr	r2, fp, #2
1727:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 4992              		.loc 1 1727 0 discriminator 2
 4993 01aa 4CEA0161 		orr	r1, ip, r1, lsl #24
 4994              	.LVL554:
1728:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 4995              		.loc 1 1728 0 discriminator 2
 4996 01ae 41EA0E41 		orr	r1, r1, lr, lsl #16
1730:bluetooth_rxtx.c **** 		}
 4997              		.loc 1 1730 0 discriminator 2
 4998 01b2 41EA0020 		orr	r0, r1, r0, lsl #8
 4999 01b6 0092     		str	r2, [sp]
 5000 01b8 FFF7FEFF 		bl	rbit
 5001              	.LVL555:
 5002 01bc 009A     		ldr	r2, [sp]
 5003 01be 10AB     		add	r3, sp, #64
 5004 01c0 03EB8201 		add	r1, r3, r2, lsl #2
 5005 01c4 019B     		ldr	r3, [sp, #4]
 5006              	.LBE42:
1725:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5007              		.loc 1 1725 0 discriminator 2
 5008 01c6 0BF1040B 		add	fp, fp, #4
 5009              	.LVL556:
 5010              	.LBB43:
1730:bluetooth_rxtx.c **** 		}
 5011              		.loc 1 1730 0 discriminator 2
 5012 01ca 53F82220 		ldr	r2, [r3, r2, lsl #2]
 5013              	.LBE43:
1725:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5014              		.loc 1 1725 0 discriminator 2
 5015 01ce BBF12C0F 		cmp	fp, #44
 5016              	.LBB44:
1730:bluetooth_rxtx.c **** 		}
 5017              		.loc 1 1730 0 discriminator 2
 5018 01d2 82EA0000 		eor	r0, r2, r0
 5019 01d6 41F8300C 		str	r0, [r1, #-48]
 5020              	.LBE44:
1725:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5021              		.loc 1 1725 0 discriminator 2
 5022 01da D6D1     		bne	.L548
1733:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 5023              		.loc 1 1733 0
ARM GAS  /tmp/cckWTbJW.s 			page 140


 5024 01dc 6369     		ldr	r3, [r4, #20]
 5025 01de EBB9     		cbnz	r3, .L549
 5026              	.L550:
1743:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5027              		.loc 1 1743 0
 5028 01e0 444B     		ldr	r3, .L590+48
 5029 01e2 1022     		movs	r2, #16
 5030 01e4 1A60     		str	r2, [r3]
1744:bluetooth_rxtx.c **** 
 5031              		.loc 1 1744 0
 5032 01e6 03A8     		add	r0, sp, #12
 5033              	.LVL557:
 5034 01e8 AB69     		ldr	r3, [r5, #24]
 5035 01ea 9847     		blx	r3
 5036              	.LVL558:
1747:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 5037              		.loc 1 1747 0
 5038 01ec 424B     		ldr	r3, .L590+52
 5039 01ee 4FF08078 		mov	r8, #16777216
 5040              	.LVL559:
 5041 01f2 C3F80080 		str	r8, [r3]
1748:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5042              		.loc 1 1748 0
 5043 01f6 03A9     		add	r1, sp, #12
 5044              	.LVL560:
 5045 01f8 0120     		movs	r0, #1
 5046 01fa FFF7FEFF 		bl	enqueue
 5047              	.LVL561:
1749:bluetooth_rxtx.c **** 
 5048              		.loc 1 1749 0
 5049 01fe 334B     		ldr	r3, .L590+8
1751:bluetooth_rxtx.c **** 
 5050              		.loc 1 1751 0
 5051 0200 3E4A     		ldr	r2, .L590+56
1749:bluetooth_rxtx.c **** 
 5052              		.loc 1 1749 0
 5053 0202 C3F80080 		str	r8, [r3]
1751:bluetooth_rxtx.c **** 
 5054              		.loc 1 1751 0
 5055 0206 3E4B     		ldr	r3, .L590+60
 5056 0208 40F63541 		movw	r1, #3125
 5057 020c 1B68     		ldr	r3, [r3]
 5058 020e 1268     		ldr	r2, [r2]
 5059 0210 C3F31303 		ubfx	r3, r3, #0, #20
 5060 0214 01FB0323 		mla	r3, r1, r3, r2
 5061 0218 6364     		str	r3, [r4, #68]
 5062 021a 16E0     		b	.L539
 5063              	.LVL562:
 5064              	.L549:
 5065              	.LBB45:
1734:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 5066              		.loc 1 1734 0
 5067 021c 2A4B     		ldr	r3, .L590+4
 5068 021e 04A9     		add	r1, sp, #16
 5069 0220 1869     		ldr	r0, [r3, #16]
 5070 0222 4246     		mov	r2, r8
 5071 0224 FFF7FEFF 		bl	btle_crcgen_lut
ARM GAS  /tmp/cckWTbJW.s 			page 141


 5072              	.LVL563:
1735:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5073              		.loc 1 1735 0
 5074 0228 10AB     		add	r3, sp, #64
 5075 022a 5344     		add	r3, r3, r10
 5076 022c 13F8342C 		ldrb	r2, [r3, #-52]	@ zero_extendqisi2
1736:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5077              		.loc 1 1736 0
 5078 0230 10AB     		add	r3, sp, #64
 5079 0232 4344     		add	r3, r3, r8
 5080 0234 13F82F1C 		ldrb	r1, [r3, #-47]	@ zero_extendqisi2
 5081 0238 0902     		lsls	r1, r1, #8
 5082 023a 41EA0241 		orr	r1, r1, r2, lsl #16
1737:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
 5083              		.loc 1 1737 0
 5084 023e 13F8302C 		ldrb	r2, [r3, #-48]	@ zero_extendqisi2
 5085 0242 41EA0203 		orr	r3, r1, r2
1738:bluetooth_rxtx.c **** 				goto rx_flush;
 5086              		.loc 1 1738 0
 5087 0246 9842     		cmp	r0, r3
 5088 0248 CAD0     		beq	.L550
 5089              	.LVL564:
 5090              	.L539:
 5091              	.LBE45:
1755:bluetooth_rxtx.c **** 
 5092              		.loc 1 1755 0
 5093 024a 6120     		movs	r0, #97
 5094 024c FFF7FEFF 		bl	cc2400_strobe
 5095              	.LVL565:
1758:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5096              		.loc 1 1758 0
 5097 0250 274B     		ldr	r3, .L590+44
 5098 0252 1A68     		ldr	r2, [r3]
 5099 0254 22F00102 		bic	r2, r2, #1
 5100 0258 1A60     		str	r2, [r3]
 5101              	.L551:
1759:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5102              		.loc 1 1759 0 discriminator 1
 5103 025a 2A4B     		ldr	r3, .L590+64
 5104 025c 1B68     		ldr	r3, [r3]
 5105 025e 5907     		lsls	r1, r3, #29
 5106 0260 02D5     		bpl	.L589
 5107              	.LBB46:
1760:bluetooth_rxtx.c **** 		}
 5108              		.loc 1 1760 0
 5109 0262 294B     		ldr	r3, .L590+68
 5110 0264 1B68     		ldr	r3, [r3]
 5111 0266 F8E7     		b	.L551
 5112              	.L589:
 5113              	.LBE46:
1764:bluetooth_rxtx.c **** 		if (now < le.last_packet)
 5114              		.loc 1 1764 0
 5115 0268 254B     		ldr	r3, .L590+60
 5116 026a 244A     		ldr	r2, .L590+56
 5117 026c 1B68     		ldr	r3, [r3]
 5118 026e 1268     		ldr	r2, [r2]
 5119 0270 40F63541 		movw	r1, #3125
ARM GAS  /tmp/cckWTbJW.s 			page 142


 5120 0274 C3F31303 		ubfx	r3, r3, #0, #20
 5121 0278 01FB0323 		mla	r3, r1, r3, r2
 5122              	.LVL566:
1765:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5123              		.loc 1 1765 0
 5124 027c 626C     		ldr	r2, [r4, #68]
1768:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5125              		.loc 1 1768 0
 5126 027e 217E     		ldrb	r1, [r4, #24]	@ zero_extendqisi2
1765:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5127              		.loc 1 1765 0
 5128 0280 9342     		cmp	r3, r2
1768:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5129              		.loc 1 1768 0
 5130 0282 A1F10201 		sub	r1, r1, #2
1766:bluetooth_rxtx.c **** 		if  ( // timeout
 5131              		.loc 1 1766 0
 5132 0286 38BF     		it	cc
 5133 0288 03F14343 		addcc	r3, r3, #-1023410176
 5134              	.LVL567:
1767:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5135              		.loc 1 1767 0
 5136 028c C9B2     		uxtb	r1, r1
1766:bluetooth_rxtx.c **** 		if  ( // timeout
 5137              		.loc 1 1766 0
 5138 028e 38BF     		it	cc
 5139 0290 03F5A003 		addcc	r3, r3, #5242880
 5140              	.LVL568:
1767:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5141              		.loc 1 1767 0
 5142 0294 0129     		cmp	r1, #1
 5143 0296 03D8     		bhi	.L554
1769:bluetooth_rxtx.c **** 			// jam finished
 5144              		.loc 1 1769 0
 5145 0298 1C49     		ldr	r1, .L590+72
 5146 029a 9B1A     		subs	r3, r3, r2
 5147              	.LVL569:
 5148 029c 8B42     		cmp	r3, r1
 5149 029e 02D8     		bhi	.L555
 5150              	.L554:
1771:bluetooth_rxtx.c **** 			)
 5151              		.loc 1 1771 0
 5152 02a0 EB69     		ldr	r3, [r5, #28]
 5153 02a2 012B     		cmp	r3, #1
 5154 02a4 4FD1     		bne	.L556
 5155              	.L555:
1774:bluetooth_rxtx.c **** 			le_jam_count = 0;
 5156              		.loc 1 1774 0
 5157 02a6 FFF7FEFF 		bl	reset_le
 5158              	.LVL570:
1776:bluetooth_rxtx.c **** 
 5159              		.loc 1 1776 0
 5160 02aa 0949     		ldr	r1, .L590+12
1775:bluetooth_rxtx.c **** 			TXLED_CLR;
 5161              		.loc 1 1775 0
 5162 02ac 0023     		movs	r3, #0
1776:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 143


 5163              		.loc 1 1776 0
 5164 02ae 4FF48070 		mov	r0, #256
1775:bluetooth_rxtx.c **** 			TXLED_CLR;
 5165              		.loc 1 1775 0
 5166 02b2 EB61     		str	r3, [r5, #28]
1776:bluetooth_rxtx.c **** 
 5167              		.loc 1 1776 0
 5168 02b4 0860     		str	r0, [r1]
1778:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5169              		.loc 1 1778 0
 5170 02b6 E97C     		ldrb	r1, [r5, #19]	@ zero_extendqisi2
1775:bluetooth_rxtx.c **** 			TXLED_CLR;
 5171              		.loc 1 1775 0
 5172 02b8 024A     		ldr	r2, .L590
1778:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5173              		.loc 1 1778 0
 5174 02ba 0129     		cmp	r1, #1
 5175 02bc 2AD1     		bne	.L557
1779:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 5176              		.loc 1 1779 0
 5177 02be D374     		strb	r3, [r2, #19]
1780:bluetooth_rxtx.c **** 				goto cleanup;
 5178              		.loc 1 1780 0
 5179 02c0 9374     		strb	r3, [r2, #18]
1781:bluetooth_rxtx.c **** 			}
 5180              		.loc 1 1781 0
 5181 02c2 75E0     		b	.L568
 5182              	.L591:
 5183              		.align	2
 5184              	.L590:
 5185 02c4 00000000 		.word	.LANCHOR0
 5186 02c8 00000000 		.word	.LANCHOR1
 5187 02cc 00E100E0 		.word	-536813312
 5188 02d0 3CC00920 		.word	537509948
 5189 02d4 00000000 		.word	rx_tc
 5190 02d8 00000000 		.word	rx_err
 5191 02dc 00000000 		.word	rssi_max
 5192 02e0 00000000 		.word	rssi_min
 5193 02e4 00000000 		.word	rxbuf1
 5194 02e8 04410050 		.word	1342193924
 5195 02ec 10410050 		.word	1342193936
 5196 02f0 24000340 		.word	1073938468
 5197 02f4 38C00920 		.word	537509944
 5198 02f8 80E100E0 		.word	-536813184
 5199 02fc 08400040 		.word	1073758216
 5200 0300 00000000 		.word	clkn
 5201 0304 0C000340 		.word	1073938444
 5202 0308 08000340 		.word	1073938440
 5203 030c 80F0FA02 		.word	50000000
 5204 0310 F0000000 		.word	.LANCHOR2+240
 5205              	.L557:
1785:bluetooth_rxtx.c **** 				goto cleanup;
 5206              		.loc 1 1785 0
 5207 0314 0A2E     		cmp	r6, #10
 5208 0316 4BD0     		beq	.L568
1788:bluetooth_rxtx.c **** 
 5209              		.loc 1 1788 0
ARM GAS  /tmp/cckWTbJW.s 			page 144


 5210 0318 0123     		movs	r3, #1
1790:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5211              		.loc 1 1790 0
 5212 031a 6420     		movs	r0, #100
1788:bluetooth_rxtx.c **** 
 5213              		.loc 1 1788 0
 5214 031c 2376     		strb	r3, [r4, #24]
1790:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5215              		.loc 1 1790 0
 5216 031e FFF7FEFF 		bl	cc2400_strobe
 5217              	.LVL571:
 5218              	.L560:
1791:bluetooth_rxtx.c **** 
 5219              		.loc 1 1791 0 discriminator 1
 5220 0322 FFF7FEFF 		bl	cc2400_status
 5221              	.LVL572:
 5222 0326 4207     		lsls	r2, r0, #29
 5223 0328 FBD4     		bmi	.L560
1794:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5224              		.loc 1 1794 0
 5225 032a B4F84A30 		ldrh	r3, [r4, #74]
 5226 032e 9BB2     		uxth	r3, r3
 5227 0330 23B1     		cbz	r3, .L570
1794:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5228              		.loc 1 1794 0 is_stmt 0 discriminator 1
 5229 0332 264B     		ldr	r3, .L592
 5230 0334 B3F84A30 		ldrh	r3, [r3, #74]
 5231 0338 9BB2     		uxth	r3, r3
 5232 033a 01E0     		b	.L561
 5233              	.L570:
1794:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5234              		.loc 1 1794 0
 5235 033c 40F66213 		movw	r3, #2402
 5236              	.L561:
1794:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5237              		.loc 1 1794 0 discriminator 3
 5238 0340 2380     		strh	r3, [r4]	@ movhi
1795:bluetooth_rxtx.c **** 		}
 5239              		.loc 1 1795 0 is_stmt 1 discriminator 3
 5240 0342 0123     		movs	r3, #1
 5241 0344 EB62     		str	r3, [r5, #44]
 5242              	.L556:
1798:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 5243              		.loc 1 1798 0
 5244 0346 2C20     		movs	r0, #44
 5245 0348 6189     		ldrh	r1, [r4, #10]
 5246 034a FFF7FEFF 		bl	cc2400_set
 5247              	.LVL573:
1799:bluetooth_rxtx.c **** 
 5248              		.loc 1 1799 0
 5249 034e 2D20     		movs	r0, #45
 5250 0350 2189     		ldrh	r1, [r4, #8]
 5251 0352 FFF7FEFF 		bl	cc2400_set
 5252              	.LVL574:
1801:bluetooth_rxtx.c **** 			hop();
 5253              		.loc 1 1801 0
 5254 0356 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
ARM GAS  /tmp/cckWTbJW.s 			page 145


 5255 0358 0BB1     		cbz	r3, .L562
1802:bluetooth_rxtx.c **** 
 5256              		.loc 1 1802 0
 5257 035a FFF7FEFF 		bl	hop
 5258              	.LVL575:
 5259              	.L562:
1805:bluetooth_rxtx.c **** 			le_jam();
 5260              		.loc 1 1805 0
 5261 035e EB69     		ldr	r3, [r5, #28]
 5262 0360 DFF87080 		ldr	r8, .L592+8
 5263 0364 002B     		cmp	r3, #0
 5264 0366 07DD     		ble	.L563
1806:bluetooth_rxtx.c **** 			--le_jam_count;
 5265              		.loc 1 1806 0
 5266 0368 FFF7FEFF 		bl	le_jam
 5267              	.LVL576:
1807:bluetooth_rxtx.c **** 		} else {
 5268              		.loc 1 1807 0
 5269 036c D8F81C30 		ldr	r3, [r8, #28]
 5270 0370 013B     		subs	r3, r3, #1
 5271 0372 C8F81C30 		str	r3, [r8, #28]
 5272 0376 16E0     		b	.L564
 5273              	.L563:
1810:bluetooth_rxtx.c **** 			dio_ssp_start();
 5274              		.loc 1 1810 0
 5275 0378 FFF7FEFF 		bl	dma_init_le
 5276              	.LVL577:
1811:bluetooth_rxtx.c **** 
 5277              		.loc 1 1811 0
 5278 037c FFF7FEFF 		bl	dio_ssp_start
 5279              	.LVL578:
1813:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 5280              		.loc 1 1813 0
 5281 0380 D8F82C30 		ldr	r3, [r8, #44]
 5282 0384 43B1     		cbz	r3, .L567
1814:bluetooth_rxtx.c **** 				restart_jamming = 0;
 5283              		.loc 1 1814 0
 5284 0386 6068     		ldr	r0, [r4, #4]
 5285 0388 FFF7FEFF 		bl	rbit
 5286              	.LVL579:
 5287 038c FFF7FEFF 		bl	cc2400_rx_sync
 5288              	.LVL580:
1815:bluetooth_rxtx.c **** 			} else {
 5289              		.loc 1 1815 0
 5290 0390 0023     		movs	r3, #0
 5291 0392 C8F82C30 		str	r3, [r8, #44]
 5292 0396 06E0     		b	.L564
 5293              	.L567:
1818:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 5294              		.loc 1 1818 0
 5295 0398 FFF7FEFF 		bl	cc2400_status
 5296              	.LVL581:
 5297 039c 4307     		lsls	r3, r0, #29
 5298 039e FBD5     		bpl	.L567
1819:bluetooth_rxtx.c **** 			}
 5299              		.loc 1 1819 0
 5300 03a0 6220     		movs	r0, #98
ARM GAS  /tmp/cckWTbJW.s 			page 146


 5301 03a2 FFF7FEFF 		bl	cc2400_strobe
 5302              	.LVL582:
 5303              	.L564:
1823:bluetooth_rxtx.c **** 		rx_err = 0;
 5304              		.loc 1 1823 0 discriminator 1
 5305 03a6 0023     		movs	r3, #0
 5306 03a8 C9F80030 		str	r3, [r9]
1824:bluetooth_rxtx.c **** 	}
 5307              		.loc 1 1824 0 discriminator 1
 5308 03ac 3B60     		str	r3, [r7]
 5309 03ae 45E6     		b	.L528
 5310              	.L568:
 5311              	.LBE38:
1830:bluetooth_rxtx.c **** 
 5312              		.loc 1 1830 0
 5313 03b0 074B     		ldr	r3, .L592+4
 5314 03b2 4FF08072 		mov	r2, #16777216
 5315 03b6 1A60     		str	r2, [r3]
1833:bluetooth_rxtx.c **** 	dio_ssp_stop();
 5316              		.loc 1 1833 0
 5317 03b8 FFF7FEFF 		bl	cc2400_idle
 5318              	.LVL583:
1834:bluetooth_rxtx.c **** 	cs_trigger_disable();
 5319              		.loc 1 1834 0
 5320 03bc FFF7FEFF 		bl	dio_ssp_stop
 5321              	.LVL584:
1835:bluetooth_rxtx.c **** }
 5322              		.loc 1 1835 0
 5323 03c0 FFF7FEFF 		bl	cs_trigger_disable
 5324              	.LVL585:
1836:bluetooth_rxtx.c **** 
 5325              		.loc 1 1836 0
 5326 03c4 11B0     		add	sp, sp, #68
 5327              		@ sp needed
 5328 03c6 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5329              	.L593:
 5330 03ca 00BF     		.align	2
 5331              	.L592:
 5332 03cc 00000000 		.word	.LANCHOR1
 5333 03d0 80E100E0 		.word	-536813184
 5334 03d4 00000000 		.word	.LANCHOR0
 5335              		.cfi_endproc
 5336              	.LFE22:
 5338              		.section	.text.bt_follow_le,"ax",%progbits
 5339              		.align	1
 5340              		.global	bt_follow_le
 5341              		.thumb
 5342              		.thumb_func
 5344              	bt_follow_le:
 5345              	.LFB25:
2001:bluetooth_rxtx.c **** 		}
2002:bluetooth_rxtx.c **** 	}
2003:bluetooth_rxtx.c **** }
2004:bluetooth_rxtx.c **** 
2005:bluetooth_rxtx.c **** void bt_follow_le() {
 5346              		.loc 1 2005 0
 5347              		.cfi_startproc
ARM GAS  /tmp/cckWTbJW.s 			page 147


 5348              		@ args = 0, pretend = 0, frame = 0
 5349              		@ frame_needed = 0, uses_anonymous_args = 0
 5350 0000 10B5     		push	{r4, lr}
 5351              		.cfi_def_cfa_offset 8
 5352              		.cfi_offset 4, -8
 5353              		.cfi_offset 14, -4
2006:bluetooth_rxtx.c **** 	reset_le();
 5354              		.loc 1 2006 0
 5355 0002 FFF7FEFF 		bl	reset_le
 5356              	.LVL586:
2007:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 5357              		.loc 1 2007 0
 5358 0006 044C     		ldr	r4, .L595
 5359 0008 044B     		ldr	r3, .L595+4
2008:bluetooth_rxtx.c **** 	bt_le_sync(MODE_BT_FOLLOW_LE);
 5360              		.loc 1 2008 0
 5361 000a 0920     		movs	r0, #9
2007:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 5362              		.loc 1 2007 0
 5363 000c A361     		str	r3, [r4, #24]
 5364              		.loc 1 2008 0
 5365 000e FFF7FEFF 		bl	bt_le_sync
 5366              	.LVL587:
2009:bluetooth_rxtx.c **** 
2010:bluetooth_rxtx.c **** 	/* old non-sync mode
2011:bluetooth_rxtx.c **** 	data_cb = cb_follow_le;
2012:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
2013:bluetooth_rxtx.c **** 	bt_generic_le(MODE_BT_FOLLOW_LE);
2014:bluetooth_rxtx.c **** 	*/
2015:bluetooth_rxtx.c **** 
2016:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 5367              		.loc 1 2016 0
 5368 0012 0023     		movs	r3, #0
 5369 0014 6374     		strb	r3, [r4, #17]
 5370 0016 10BD     		pop	{r4, pc}
 5371              	.L596:
 5372              		.align	2
 5373              	.L595:
 5374 0018 00000000 		.word	.LANCHOR0
 5375 001c 00000000 		.word	connection_follow_cb
 5376              		.cfi_endproc
 5377              	.LFE25:
 5379              		.section	.text.le_promisc_state,"ax",%progbits
 5380              		.align	1
 5381              		.global	le_promisc_state
 5382              		.thumb
 5383              		.thumb_func
 5385              	le_promisc_state:
 5386              	.LFB26:
2017:bluetooth_rxtx.c **** }
2018:bluetooth_rxtx.c **** 
2019:bluetooth_rxtx.c **** // issue state change message
2020:bluetooth_rxtx.c **** void le_promisc_state(u8 type, void *data, unsigned len) {
 5387              		.loc 1 2020 0
 5388              		.cfi_startproc
 5389              		@ args = 0, pretend = 0, frame = 56
 5390              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/cckWTbJW.s 			page 148


 5391              	.LVL588:
 5392 0000 70B5     		push	{r4, r5, r6, lr}
 5393              		.cfi_def_cfa_offset 16
 5394              		.cfi_offset 4, -16
 5395              		.cfi_offset 5, -12
 5396              		.cfi_offset 6, -8
 5397              		.cfi_offset 14, -4
 5398 0002 8EB0     		sub	sp, sp, #56
 5399              		.cfi_def_cfa_offset 72
 5400              		.loc 1 2020 0
 5401 0004 0646     		mov	r6, r0
 5402 0006 0D46     		mov	r5, r1
 5403 0008 1446     		mov	r4, r2
2021:bluetooth_rxtx.c **** 	u8 buf[50] = { 0, };
 5404              		.loc 1 2021 0
 5405 000a 01A8     		add	r0, sp, #4
 5406              	.LVL589:
 5407 000c 0021     		movs	r1, #0
 5408              	.LVL590:
 5409 000e 3222     		movs	r2, #50
 5410              	.LVL591:
 5411 0010 FFF7FEFF 		bl	memset
 5412              	.LVL592:
2022:bluetooth_rxtx.c **** 	if (len > 49)
2023:bluetooth_rxtx.c **** 		len = 49;
2024:bluetooth_rxtx.c **** 
2025:bluetooth_rxtx.c **** 	buf[0] = type;
2026:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 5413              		.loc 1 2026 0
 5414 0014 2946     		mov	r1, r5
 5415 0016 312C     		cmp	r4, #49
 5416 0018 34BF     		ite	cc
 5417 001a 2246     		movcc	r2, r4
 5418 001c 3122     		movcs	r2, #49
 5419              	.LVL593:
 5420 001e 0DF10500 		add	r0, sp, #5
2025:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 5421              		.loc 1 2025 0
 5422 0022 8DF80460 		strb	r6, [sp, #4]
 5423              		.loc 1 2026 0
 5424 0026 FFF7FEFF 		bl	memcpy
 5425              	.LVL594:
2027:bluetooth_rxtx.c **** 	enqueue(LE_PROMISC, (uint8_t*)buf);
 5426              		.loc 1 2027 0
 5427 002a 01A9     		add	r1, sp, #4
 5428 002c 0520     		movs	r0, #5
 5429 002e FFF7FEFF 		bl	enqueue
 5430              	.LVL595:
2028:bluetooth_rxtx.c **** }
 5431              		.loc 1 2028 0
 5432 0032 0EB0     		add	sp, sp, #56
 5433              		@ sp needed
 5434 0034 70BD     		pop	{r4, r5, r6, pc}
 5435              		.cfi_endproc
 5436              	.LFE26:
 5438              		.section	.text.promisc_recover_hop_increment,"ax",%progbits
 5439              		.align	1
ARM GAS  /tmp/cckWTbJW.s 			page 149


 5440              		.global	promisc_recover_hop_increment
 5441              		.thumb
 5442              		.thumb_func
 5444              	promisc_recover_hop_increment:
 5445              	.LFB27:
2029:bluetooth_rxtx.c **** 
2030:bluetooth_rxtx.c **** // divide, rounding to the nearest integer: round up at 0.5.
2031:bluetooth_rxtx.c **** #define DIVIDE_ROUND(N, D) ((N) + (D)/2) / (D)
2032:bluetooth_rxtx.c **** 
2033:bluetooth_rxtx.c **** void promisc_recover_hop_increment(u8 *packet) {
 5446              		.loc 1 2033 0
 5447              		.cfi_startproc
 5448              		@ args = 0, pretend = 0, frame = 0
 5449              		@ frame_needed = 0, uses_anonymous_args = 0
 5450              	.LVL596:
 5451 0000 38B5     		push	{r3, r4, r5, lr}
 5452              		.cfi_def_cfa_offset 16
 5453              		.cfi_offset 3, -16
 5454              		.cfi_offset 4, -12
 5455              		.cfi_offset 5, -8
 5456              		.cfi_offset 14, -4
2034:bluetooth_rxtx.c **** 	static u32 first_ts = 0;
2035:bluetooth_rxtx.c **** 	if (channel == 2404) {
 5457              		.loc 1 2035 0
 5458 0002 314A     		ldr	r2, .L607
 5459 0004 40F66413 		movw	r3, #2404
 5460 0008 1188     		ldrh	r1, [r2]
 5461 000a 304C     		ldr	r4, .L607+4
 5462 000c 89B2     		uxth	r1, r1
 5463 000e 9942     		cmp	r1, r3
 5464 0010 0DD1     		bne	.L599
2036:bluetooth_rxtx.c **** 		first_ts = CLK100NS;
 5465              		.loc 1 2036 0
 5466 0012 2F4B     		ldr	r3, .L607+8
 5467 0014 2F4A     		ldr	r2, .L607+12
 5468 0016 1B68     		ldr	r3, [r3]
 5469 0018 1268     		ldr	r2, [r2]
 5470 001a C3F31303 		ubfx	r3, r3, #0, #20
 5471 001e 40F63541 		movw	r1, #3125
 5472 0022 01FB0323 		mla	r3, r1, r3, r2
 5473 0026 2363     		str	r3, [r4, #48]
2037:bluetooth_rxtx.c **** 		hop_direct_channel = 2406;
 5474              		.loc 1 2037 0
 5475 0028 40F66613 		movw	r3, #2406
 5476 002c 48E0     		b	.L601
 5477              	.L599:
2038:bluetooth_rxtx.c **** 		do_hop = 1;
2039:bluetooth_rxtx.c **** 	} else if (channel == 2406) {
 5478              		.loc 1 2039 0
 5479 002e 1088     		ldrh	r0, [r2]
 5480              	.LVL597:
 5481 0030 40F66611 		movw	r1, #2406
 5482 0034 80B2     		uxth	r0, r0
 5483 0036 8842     		cmp	r0, r1
 5484 0038 42D1     		bne	.L601
 5485              	.LVL598:
 5486              	.LBB51:
ARM GAS  /tmp/cckWTbJW.s 			page 150


 5487              	.LBB52:
 5488              	.LBB53:
2040:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 5489              		.loc 1 2040 0
 5490 003a 254B     		ldr	r3, .L607+8
 5491 003c 2549     		ldr	r1, .L607+12
 5492 003e 1B68     		ldr	r3, [r3]
 5493 0040 0968     		ldr	r1, [r1]
 5494 0042 40F63540 		movw	r0, #3125
 5495 0046 C3F31303 		ubfx	r3, r3, #0, #20
 5496 004a 00FB0313 		mla	r3, r0, r3, r1
 5497              	.LVL599:
2041:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 5498              		.loc 1 2041 0
 5499 004e 206B     		ldr	r0, [r4, #48]
2042:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
2043:bluetooth_rxtx.c **** 		// Number of channels hopped between previous and current timestamp.
2044:bluetooth_rxtx.c **** 		u32 channels_hopped = DIVIDE_ROUND(second_ts - first_ts,
 5500              		.loc 1 2044 0
 5501 0050 528C     		ldrh	r2, [r2, #34]
2041:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 5502              		.loc 1 2041 0
 5503 0052 8342     		cmp	r3, r0
2042:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
 5504              		.loc 1 2042 0
 5505 0054 3CBF     		itt	cc
 5506 0056 03F14343 		addcc	r3, r3, #-1023410176
 5507              	.LVL600:
 5508 005a 03F5A003 		addcc	r3, r3, #5242880
 5509              	.LVL601:
 5510              		.loc 1 2044 0
 5511 005e 1B1A     		subs	r3, r3, r0
 5512              	.LVL602:
 5513 0060 43F2D405 		movw	r5, #12500
 5514 0064 41F66A00 		movw	r0, #6250
 5515 0068 00FB0233 		mla	r3, r0, r2, r3
 5516 006c 5543     		muls	r5, r2, r5
 5517 006e B3FBF5F3 		udiv	r3, r3, r5
 5518              	.LVL603:
2045:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
2046:bluetooth_rxtx.c **** 		if (channels_hopped < 37) {
 5519              		.loc 1 2046 0
 5520 0072 242B     		cmp	r3, #36
2044:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
 5521              		.loc 1 2044 0
 5522 0074 1449     		ldr	r1, .L607
 5523              		.loc 1 2046 0
 5524 0076 21D8     		bhi	.L603
2047:bluetooth_rxtx.c **** 			// Get the hop increment based on the number of channels hopped.
2048:bluetooth_rxtx.c **** 			le.channel_increment = hop_interval_lut[channels_hopped];
 5525              		.loc 1 2048 0
 5526 0078 1748     		ldr	r0, .L607+16
2049:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5527              		.loc 1 2049 0
 5528 007a 5208     		lsrs	r2, r2, #1
2048:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5529              		.loc 1 2048 0
ARM GAS  /tmp/cckWTbJW.s 			page 151


 5530 007c 0344     		add	r3, r3, r0
 5531              	.LVL604:
 5532 007e 93F87008 		ldrb	r0, [r3, #2160]	@ zero_extendqisi2
 5533              		.loc 1 2049 0
 5534 0082 0A84     		strh	r2, [r1, #32]	@ movhi
2048:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5535              		.loc 1 2048 0
 5536 0084 8876     		strb	r0, [r1, #26]
2050:bluetooth_rxtx.c **** 			le.conn_count = 0;
2051:bluetooth_rxtx.c **** 			le.conn_epoch = 0;
2052:bluetooth_rxtx.c **** 			do_hop = 0;
2053:bluetooth_rxtx.c **** 			// Move on to regular connection following.
2054:bluetooth_rxtx.c **** 			le.channel_idx = (1 + le.channel_increment) % 37;
 5537              		.loc 1 2054 0
 5538 0086 2522     		movs	r2, #37
 5539 0088 0130     		adds	r0, r0, #1
 5540 008a 90FBF2F5 		sdiv	r5, r0, r2
 5541 008e 02FB1502 		mls	r2, r2, r5, r0
2050:bluetooth_rxtx.c **** 			le.conn_count = 0;
 5542              		.loc 1 2050 0
 5543 0092 0023     		movs	r3, #0
 5544              	.LVL605:
 5545 0094 8B84     		strh	r3, [r1, #36]	@ movhi
2051:bluetooth_rxtx.c **** 			do_hop = 0;
 5546              		.loc 1 2051 0
 5547 0096 CB61     		str	r3, [r1, #28]
2052:bluetooth_rxtx.c **** 			// Move on to regular connection following.
 5548              		.loc 1 2052 0
 5549 0098 E372     		strb	r3, [r4, #11]
2055:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 5550              		.loc 1 2055 0
 5551 009a 0320     		movs	r0, #3
2056:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 5552              		.loc 1 2056 0
 5553 009c 4B61     		str	r3, [r1, #20]
2057:bluetooth_rxtx.c **** 			hop_mode = HOP_BTLE;
2058:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 5554              		.loc 1 2058 0
 5555 009e 0F4B     		ldr	r3, .L607+20
2054:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 5556              		.loc 1 2054 0
 5557 00a0 4A76     		strb	r2, [r1, #25]
2055:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 5558              		.loc 1 2055 0
 5559 00a2 0876     		strb	r0, [r1, #24]
2059:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 5560              		.loc 1 2059 0
 5561 00a4 0122     		movs	r2, #1
 5562 00a6 1A31     		adds	r1, r1, #26
2058:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 5563              		.loc 1 2058 0
 5564 00a8 A361     		str	r3, [r4, #24]
2057:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 5565              		.loc 1 2057 0
 5566 00aa A072     		strb	r0, [r4, #10]
 5567              		.loc 1 2059 0
 5568 00ac FFF7FEFF 		bl	le_promisc_state
ARM GAS  /tmp/cckWTbJW.s 			page 152


 5569              	.LVL606:
2060:bluetooth_rxtx.c **** 
2061:bluetooth_rxtx.c **** 			if (jam_mode != JAM_NONE)
 5570              		.loc 1 2061 0
 5571 00b0 E37C     		ldrb	r3, [r4, #19]	@ zero_extendqisi2
 5572 00b2 43B1     		cbz	r3, .L598
2062:bluetooth_rxtx.c **** 				le_jam_count = JAM_COUNT_DEFAULT;
 5573              		.loc 1 2062 0
 5574 00b4 054B     		ldr	r3, .L607+4
 5575 00b6 2822     		movs	r2, #40
 5576 00b8 DA61     		str	r2, [r3, #28]
 5577 00ba 38BD     		pop	{r3, r4, r5, pc}
 5578              	.LVL607:
 5579              	.L603:
2063:bluetooth_rxtx.c **** 
2064:bluetooth_rxtx.c **** 			return;
2065:bluetooth_rxtx.c **** 		}
2066:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 5580              		.loc 1 2066 0
 5581 00bc 40F66413 		movw	r3, #2404
 5582              	.LVL608:
 5583              	.L601:
 5584              	.LBE53:
 5585              	.LBE52:
 5586              	.LBE51:
2067:bluetooth_rxtx.c **** 		do_hop = 1;
2068:bluetooth_rxtx.c **** 	}
2069:bluetooth_rxtx.c **** 	else {
2070:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 5587              		.loc 1 2070 0
 5588 00c0 A381     		strh	r3, [r4, #12]	@ movhi
2071:bluetooth_rxtx.c **** 		do_hop = 1;
 5589              		.loc 1 2071 0
 5590 00c2 0123     		movs	r3, #1
 5591 00c4 E372     		strb	r3, [r4, #11]
 5592              	.L598:
 5593 00c6 38BD     		pop	{r3, r4, r5, pc}
 5594              	.L608:
 5595              		.align	2
 5596              	.L607:
 5597 00c8 00000000 		.word	.LANCHOR1
 5598 00cc 00000000 		.word	.LANCHOR0
 5599 00d0 00000000 		.word	clkn
 5600 00d4 08400040 		.word	1073758216
 5601 00d8 00000000 		.word	.LANCHOR2
 5602 00dc 00000000 		.word	connection_follow_cb
 5603              		.cfi_endproc
 5604              	.LFE27:
 5606              		.section	.text.promisc_recover_hop_interval,"ax",%progbits
 5607              		.align	1
 5608              		.global	promisc_recover_hop_interval
 5609              		.thumb
 5610              		.thumb_func
 5612              	promisc_recover_hop_interval:
 5613              	.LFB28:
2072:bluetooth_rxtx.c **** 	}
2073:bluetooth_rxtx.c **** }
ARM GAS  /tmp/cckWTbJW.s 			page 153


2074:bluetooth_rxtx.c **** 
2075:bluetooth_rxtx.c **** void promisc_recover_hop_interval(u8 *packet) {
 5614              		.loc 1 2075 0
 5615              		.cfi_startproc
 5616              		@ args = 0, pretend = 0, frame = 0
 5617              		@ frame_needed = 0, uses_anonymous_args = 0
 5618              	.LVL609:
 5619 0000 38B5     		push	{r3, r4, r5, lr}
 5620              		.cfi_def_cfa_offset 16
 5621              		.cfi_offset 3, -16
 5622              		.cfi_offset 4, -12
 5623              		.cfi_offset 5, -8
 5624              		.cfi_offset 14, -4
2076:bluetooth_rxtx.c **** 	static u32 prev_clk = 0;
2077:bluetooth_rxtx.c **** 
2078:bluetooth_rxtx.c **** 	u32 cur_clk = CLK100NS;
 5625              		.loc 1 2078 0
 5626 0002 254B     		ldr	r3, .L615
 5627 0004 40F63542 		movw	r2, #3125
 5628 0008 1C68     		ldr	r4, [r3]
 5629 000a 244B     		ldr	r3, .L615+4
 5630 000c C4F31304 		ubfx	r4, r4, #0, #20
 5631 0010 1B68     		ldr	r3, [r3]
2079:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 5632              		.loc 1 2079 0
 5633 0012 234D     		ldr	r5, .L615+8
2078:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 5634              		.loc 1 2078 0
 5635 0014 02FB0434 		mla	r4, r2, r4, r3
 5636              	.LVL610:
 5637              		.loc 1 2079 0
 5638 0018 6B6B     		ldr	r3, [r5, #52]
 5639 001a 9C42     		cmp	r4, r3
 5640 001c 05D2     		bcs	.L610
2080:bluetooth_rxtx.c **** 		cur_clk += 3267800000; // handle rollover
 5641              		.loc 1 2080 0
 5642 001e 04F14344 		add	r4, r4, #-1023410176
 5643              	.LVL611:
 5644 0022 A4F56514 		sub	r4, r4, #3751936
 5645              	.LVL612:
 5646 0026 A4F5A254 		sub	r4, r4, #5184
 5647              	.LVL613:
 5648              	.L610:
2081:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
 5649              		.loc 1 2081 0
 5650 002a E31A     		subs	r3, r4, r3
 5651              	.LVL614:
2082:bluetooth_rxtx.c **** 	u16 obsv_hop_interval; // observed hop interval
2083:bluetooth_rxtx.c **** 
2084:bluetooth_rxtx.c **** 	// probably consecutive data packets on the same channel
2085:bluetooth_rxtx.c **** 	if (clk_diff < 2 * LE_BASECLK)
 5652              		.loc 1 2085 0
 5653 002c 46F2A712 		movw	r2, #24999
 5654 0030 9342     		cmp	r3, r2
 5655 0032 30D9     		bls	.L609
2086:bluetooth_rxtx.c **** 		return;
2087:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 154


2088:bluetooth_rxtx.c **** 	if (clk_diff < le_promisc.smallest_hop_interval)
 5656              		.loc 1 2088 0
 5657 0034 1B4A     		ldr	r2, .L615+12
 5658 0036 D2F80011 		ldr	r1, [r2, #256]
 5659 003a 8B42     		cmp	r3, r1
2089:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
 5660              		.loc 1 2089 0
 5661 003c 38BF     		it	cc
 5662 003e C2F80031 		strcc	r3, [r2, #256]
2090:bluetooth_rxtx.c **** 
2091:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(le_promisc.smallest_hop_interval, 37 * LE_BASECLK);
 5663              		.loc 1 2091 0
 5664 0042 D2F80021 		ldr	r2, [r2, #256]
 5665 0046 1849     		ldr	r1, .L615+16
 5666 0048 02F56132 		add	r2, r2, #230400
 5667 004c 02F25232 		addw	r2, r2, #850
 5668 0050 B2FBF1F2 		udiv	r2, r2, r1
2092:bluetooth_rxtx.c **** 
2093:bluetooth_rxtx.c **** 	if (le.conn_interval == obsv_hop_interval) {
 5669              		.loc 1 2093 0
 5670 0054 1549     		ldr	r1, .L615+20
2091:bluetooth_rxtx.c **** 
 5671              		.loc 1 2091 0
 5672 0056 92B2     		uxth	r2, r2
 5673              	.LVL615:
 5674              		.loc 1 2093 0
 5675 0058 488C     		ldrh	r0, [r1, #34]
 5676              	.LVL616:
2091:bluetooth_rxtx.c **** 
 5677              		.loc 1 2091 0
 5678 005a 124B     		ldr	r3, .L615+12
 5679              	.LVL617:
 5680              		.loc 1 2093 0
 5681 005c 9042     		cmp	r0, r2
 5682 005e 15D1     		bne	.L613
2094:bluetooth_rxtx.c **** 		// 5 consecutive hop intervals: consider it legit and move on
2095:bluetooth_rxtx.c **** 		++le_promisc.consec_intervals;
 5683              		.loc 1 2095 0
 5684 0060 D3F80421 		ldr	r2, [r3, #260]
 5685              	.LVL618:
 5686 0064 0132     		adds	r2, r2, #1
2096:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 5687              		.loc 1 2096 0
 5688 0066 052A     		cmp	r2, #5
2095:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 5689              		.loc 1 2095 0
 5690 0068 C3F80421 		str	r2, [r3, #260]
 5691              		.loc 1 2096 0
 5692 006c 12D1     		bne	.L614
2097:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 5693              		.loc 1 2097 0
 5694 006e 104B     		ldr	r3, .L615+24
2098:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
2099:bluetooth_rxtx.c **** 			hop_mode = HOP_DIRECT;
2100:bluetooth_rxtx.c **** 			do_hop = 1;
2101:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5695              		.loc 1 2101 0
ARM GAS  /tmp/cckWTbJW.s 			page 155


 5696 0070 0220     		movs	r0, #2
2097:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 5697              		.loc 1 2097 0
 5698 0072 AB61     		str	r3, [r5, #24]
2098:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
 5699              		.loc 1 2098 0
 5700 0074 40F66413 		movw	r3, #2404
 5701 0078 AB81     		strh	r3, [r5, #12]	@ movhi
2099:bluetooth_rxtx.c **** 			do_hop = 1;
 5702              		.loc 1 2099 0
 5703 007a 0423     		movs	r3, #4
 5704 007c AB72     		strb	r3, [r5, #10]
 5705              		.loc 1 2101 0
 5706 007e 2231     		adds	r1, r1, #34
2100:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5707              		.loc 1 2100 0
 5708 0080 0123     		movs	r3, #1
 5709              		.loc 1 2101 0
 5710 0082 0246     		mov	r2, r0
2100:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5711              		.loc 1 2100 0
 5712 0084 EB72     		strb	r3, [r5, #11]
 5713              		.loc 1 2101 0
 5714 0086 FFF7FEFF 		bl	le_promisc_state
 5715              	.LVL619:
 5716 008a 03E0     		b	.L614
 5717              	.LVL620:
 5718              	.L613:
2102:bluetooth_rxtx.c **** 		}
2103:bluetooth_rxtx.c **** 	} else {
2104:bluetooth_rxtx.c **** 		le.conn_interval = obsv_hop_interval;
 5719              		.loc 1 2104 0
 5720 008c 4A84     		strh	r2, [r1, #34]	@ movhi
2105:bluetooth_rxtx.c **** 		le_promisc.consec_intervals = 0;
 5721              		.loc 1 2105 0
 5722 008e 0022     		movs	r2, #0
 5723              	.LVL621:
 5724 0090 C3F80421 		str	r2, [r3, #260]
 5725              	.LVL622:
 5726              	.L614:
2106:bluetooth_rxtx.c **** 	}
2107:bluetooth_rxtx.c **** 
2108:bluetooth_rxtx.c **** 	prev_clk = cur_clk;
 5727              		.loc 1 2108 0
 5728 0094 6C63     		str	r4, [r5, #52]
 5729              	.L609:
 5730 0096 38BD     		pop	{r3, r4, r5, pc}
 5731              	.LVL623:
 5732              	.L616:
 5733              		.align	2
 5734              	.L615:
 5735 0098 00000000 		.word	clkn
 5736 009c 08400040 		.word	1073758216
 5737 00a0 00000000 		.word	.LANCHOR0
 5738 00a4 00000000 		.word	le_promisc
 5739 00a8 A40E0700 		.word	462500
 5740 00ac 00000000 		.word	.LANCHOR1
ARM GAS  /tmp/cckWTbJW.s 			page 156


 5741 00b0 00000000 		.word	promisc_recover_hop_increment
 5742              		.cfi_endproc
 5743              	.LFE28:
 5745              		.section	.text.promisc_follow_cb,"ax",%progbits
 5746              		.align	1
 5747              		.global	promisc_follow_cb
 5748              		.thumb
 5749              		.thumb_func
 5751              	promisc_follow_cb:
 5752              	.LFB29:
2109:bluetooth_rxtx.c **** }
2110:bluetooth_rxtx.c **** 
2111:bluetooth_rxtx.c **** void promisc_follow_cb(u8 *packet) {
 5753              		.loc 1 2111 0
 5754              		.cfi_startproc
 5755              		@ args = 0, pretend = 0, frame = 0
 5756              		@ frame_needed = 0, uses_anonymous_args = 0
 5757              	.LVL624:
 5758 0000 38B5     		push	{r3, r4, r5, lr}
 5759              		.cfi_def_cfa_offset 16
 5760              		.cfi_offset 3, -16
 5761              		.cfi_offset 4, -12
 5762              		.cfi_offset 5, -8
 5763              		.cfi_offset 14, -4
2112:bluetooth_rxtx.c **** 	int i;
2113:bluetooth_rxtx.c **** 
2114:bluetooth_rxtx.c **** 	// get the CRCInit
2115:bluetooth_rxtx.c **** 	if (!le.crc_verify && packet[4] == 0x01 && packet[5] == 0x00) {
 5764              		.loc 1 2115 0
 5765 0002 184C     		ldr	r4, .L622
2111:bluetooth_rxtx.c **** 	int i;
 5766              		.loc 1 2111 0
 5767 0004 0146     		mov	r1, r0
 5768              		.loc 1 2115 0
 5769 0006 6369     		ldr	r3, [r4, #20]
 5770 0008 53BB     		cbnz	r3, .L617
 5771              		.loc 1 2115 0 is_stmt 0 discriminator 1
 5772 000a 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 5773 000c 012B     		cmp	r3, #1
 5774 000e 27D1     		bne	.L617
 5775 0010 4579     		ldrb	r5, [r0, #5]	@ zero_extendqisi2
 5776 0012 2DBB     		cbnz	r5, .L617
 5777              	.LVL625:
 5778              	.LBB57:
 5779              	.LBB58:
 5780              	.LBB59:
2116:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 5781              		.loc 1 2116 0 is_stmt 1
 5782 0014 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 5783 0016 C079     		ldrb	r0, [r0, #7]	@ zero_extendqisi2
 5784              	.LVL626:
2117:bluetooth_rxtx.c **** 
2118:bluetooth_rxtx.c **** 		le.crc_init = btle_reverse_crc(crc, packet + 4, 2);
 5785              		.loc 1 2118 0
 5786 0018 0222     		movs	r2, #2
2116:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 5787              		.loc 1 2116 0
ARM GAS  /tmp/cckWTbJW.s 			page 157


 5788 001a 0002     		lsls	r0, r0, #8
 5789 001c 40EA0340 		orr	r0, r0, r3, lsl #16
 5790 0020 8B79     		ldrb	r3, [r1, #6]	@ zero_extendqisi2
 5791              		.loc 1 2118 0
 5792 0022 0431     		adds	r1, r1, #4
 5793              	.LVL627:
 5794 0024 1843     		orrs	r0, r0, r3
 5795 0026 FFF7FEFF 		bl	btle_reverse_crc
 5796              	.LVL628:
 5797 002a 2A46     		mov	r2, r5
 5798 002c E060     		str	r0, [r4, #12]
 5799              	.LVL629:
2119:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
2120:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 5800              		.loc 1 2120 0
 5801 002e 2B46     		mov	r3, r5
 5802              	.LVL630:
 5803              	.L620:
2121:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5804              		.loc 1 2121 0
 5805 0030 20FA03F1 		lsr	r1, r0, r3
 5806 0034 C3F11705 		rsb	r5, r3, #23
 5807 0038 01F00101 		and	r1, r1, #1
 5808 003c A940     		lsls	r1, r1, r5
2120:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5809              		.loc 1 2120 0
 5810 003e 0133     		adds	r3, r3, #1
 5811              	.LVL631:
 5812 0040 182B     		cmp	r3, #24
 5813              		.loc 1 2121 0
 5814 0042 42EA0102 		orr	r2, r2, r1
2120:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5815              		.loc 1 2120 0
 5816 0046 F3D1     		bne	.L620
 5817 0048 2261     		str	r2, [r4, #16]
2122:bluetooth_rxtx.c **** 
2123:bluetooth_rxtx.c **** 		le.crc_verify = 1;
2124:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 5818              		.loc 1 2124 0
 5819 004a 074B     		ldr	r3, .L622+4
 5820              	.LVL632:
 5821 004c 074A     		ldr	r2, .L622+8
2123:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 5822              		.loc 1 2123 0
 5823 004e 0120     		movs	r0, #1
 5824              		.loc 1 2124 0
 5825 0050 9A61     		str	r2, [r3, #24]
2123:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 5826              		.loc 1 2123 0
 5827 0052 6061     		str	r0, [r4, #20]
2125:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 5828              		.loc 1 2125 0
 5829 0054 0649     		ldr	r1, .L622+12
 5830 0056 0322     		movs	r2, #3
 5831              	.LBE59:
 5832              	.LBE58:
 5833              	.LBE57:
ARM GAS  /tmp/cckWTbJW.s 			page 158


2126:bluetooth_rxtx.c **** 	}
2127:bluetooth_rxtx.c **** }
 5834              		.loc 1 2127 0
 5835 0058 BDE83840 		pop	{r3, r4, r5, lr}
 5836              	.LBB62:
 5837              	.LBB61:
 5838              	.LBB60:
2125:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 5839              		.loc 1 2125 0
 5840 005c FFF7FEBF 		b	le_promisc_state
 5841              	.LVL633:
 5842              	.L617:
 5843 0060 38BD     		pop	{r3, r4, r5, pc}
 5844              	.L623:
 5845 0062 00BF     		.align	2
 5846              	.L622:
 5847 0064 00000000 		.word	.LANCHOR1
 5848 0068 00000000 		.word	.LANCHOR0
 5849 006c 00000000 		.word	promisc_recover_hop_interval
 5850 0070 0C000000 		.word	.LANCHOR1+12
 5851              	.LBE60:
 5852              	.LBE61:
 5853              	.LBE62:
 5854              		.cfi_endproc
 5855              	.LFE29:
 5857              		.section	.text.see_aa,"ax",%progbits
 5858              		.align	1
 5859              		.global	see_aa
 5860              		.thumb
 5861              		.thumb_func
 5863              	see_aa:
 5864              	.LFB30:
2128:bluetooth_rxtx.c **** 
2129:bluetooth_rxtx.c **** // called when we see an AA, add it to the list
2130:bluetooth_rxtx.c **** void see_aa(u32 aa) {
 5865              		.loc 1 2130 0
 5866              		.cfi_startproc
 5867              		@ args = 0, pretend = 0, frame = 0
 5868              		@ frame_needed = 0, uses_anonymous_args = 0
 5869              	.LVL634:
 5870 0000 30B5     		push	{r4, r5, lr}
 5871              		.cfi_def_cfa_offset 12
 5872              		.cfi_offset 4, -12
 5873              		.cfi_offset 5, -8
 5874              		.cfi_offset 14, -4
 5875              	.LVL635:
2131:bluetooth_rxtx.c **** 	int i, max = -1, killme = -1;
2132:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
 5876              		.loc 1 2132 0
 5877 0002 0022     		movs	r2, #0
 5878              	.LVL636:
 5879              	.L628:
2133:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 5880              		.loc 1 2133 0
 5881 0004 144D     		ldr	r5, .L637
 5882 0006 55F83210 		ldr	r1, [r5, r2, lsl #3]
 5883 000a 05EBC203 		add	r3, r5, r2, lsl #3
ARM GAS  /tmp/cckWTbJW.s 			page 159


 5884 000e 8142     		cmp	r1, r0
 5885 0010 02D1     		bne	.L625
2134:bluetooth_rxtx.c **** 			++le_promisc.active_aa[i].count;
 5886              		.loc 1 2134 0
 5887 0012 5A68     		ldr	r2, [r3, #4]
 5888              	.LVL637:
 5889 0014 0132     		adds	r2, r2, #1
 5890 0016 1CE0     		b	.L636
 5891              	.LVL638:
 5892              	.L625:
2132:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 5893              		.loc 1 2132 0
 5894 0018 0132     		adds	r2, r2, #1
 5895              	.LVL639:
 5896 001a 202A     		cmp	r2, #32
 5897 001c F2D1     		bne	.L628
 5898 001e 4FF0FF33 		mov	r3, #-1
 5899 0022 1946     		mov	r1, r3
 5900 0024 0022     		movs	r2, #0
 5901              	.LVL640:
 5902              	.L631:
 5903 0026 05EBC204 		add	r4, r5, r2, lsl #3
2135:bluetooth_rxtx.c **** 			return;
2136:bluetooth_rxtx.c **** 		}
2137:bluetooth_rxtx.c **** 
2138:bluetooth_rxtx.c **** 	// evict someone
2139:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
2140:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 5904              		.loc 1 2140 0
 5905 002a 6468     		ldr	r4, [r4, #4]
 5906 002c 8C42     		cmp	r4, r1
 5907 002e 05DB     		blt	.L632
 5908              		.loc 1 2140 0 is_stmt 0 discriminator 1
 5909 0030 0029     		cmp	r1, #0
 5910 0032 A8BF     		it	ge
 5911 0034 0C46     		movge	r4, r1
 5912 0036 B8BF     		it	lt
 5913 0038 1346     		movlt	r3, r2
 5914              	.LVL641:
 5915 003a 00E0     		b	.L629
 5916              	.LVL642:
 5917              	.L632:
 5918 003c 1346     		mov	r3, r2
 5919              	.LVL643:
 5920              	.L629:
2139:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 5921              		.loc 1 2139 0 is_stmt 1
 5922 003e 0132     		adds	r2, r2, #1
 5923              	.LVL644:
 5924 0040 202A     		cmp	r2, #32
 5925 0042 01D0     		beq	.L630
 5926 0044 2146     		mov	r1, r4
 5927 0046 EEE7     		b	.L631
 5928              	.L630:
2141:bluetooth_rxtx.c **** 			killme = i;
2142:bluetooth_rxtx.c **** 			max = le_promisc.active_aa[i].count;
2143:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/cckWTbJW.s 			page 160


2144:bluetooth_rxtx.c **** 
2145:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].aa = aa;
 5929              		.loc 1 2145 0
 5930 0048 45F83300 		str	r0, [r5, r3, lsl #3]
2146:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 5931              		.loc 1 2146 0
 5932 004c 0122     		movs	r2, #1
 5933              	.LVL645:
 5934 004e 05EBC303 		add	r3, r5, r3, lsl #3
 5935              	.LVL646:
 5936              	.L636:
 5937 0052 5A60     		str	r2, [r3, #4]
 5938 0054 30BD     		pop	{r4, r5, pc}
 5939              	.L638:
 5940 0056 00BF     		.align	2
 5941              	.L637:
 5942 0058 00000000 		.word	le_promisc
 5943              		.cfi_endproc
 5944              	.LFE30:
 5946              		.section	.text.cb_le_promisc,"ax",%progbits
 5947              		.align	1
 5948              		.global	cb_le_promisc
 5949              		.thumb
 5950              		.thumb_func
 5952              	cb_le_promisc:
 5953              	.LFB31:
2147:bluetooth_rxtx.c **** }
2148:bluetooth_rxtx.c **** 
2149:bluetooth_rxtx.c **** /* le promiscuous mode */
2150:bluetooth_rxtx.c **** int cb_le_promisc(char *unpacked) {
 5954              		.loc 1 2150 0
 5955              		.cfi_startproc
 5956              		@ args = 0, pretend = 0, frame = 80
 5957              		@ frame_needed = 0, uses_anonymous_args = 0
 5958              	.LVL647:
 5959 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 5960              		.cfi_def_cfa_offset 28
 5961              		.cfi_offset 4, -28
 5962              		.cfi_offset 5, -24
 5963              		.cfi_offset 6, -20
 5964              		.cfi_offset 7, -16
 5965              		.cfi_offset 8, -12
 5966              		.cfi_offset 9, -8
 5967              		.cfi_offset 14, -4
 5968 0004 95B0     		sub	sp, sp, #84
 5969              		.cfi_def_cfa_offset 112
2151:bluetooth_rxtx.c **** 	int i, j, k;
2152:bluetooth_rxtx.c **** 	int idx;
2153:bluetooth_rxtx.c **** 
2154:bluetooth_rxtx.c **** 	// empty data PDU: 01 00
2155:bluetooth_rxtx.c **** 	char desired[4][16] = {
 5970              		.loc 1 2155 0
 5971 0006 0021     		movs	r1, #0
2150:bluetooth_rxtx.c **** 	int i, j, k;
 5972              		.loc 1 2150 0
 5973 0008 8046     		mov	r8, r0
 5974              		.loc 1 2155 0
ARM GAS  /tmp/cckWTbJW.s 			page 161


 5975 000a 4022     		movs	r2, #64
 5976 000c 04A8     		add	r0, sp, #16
 5977              	.LVL648:
 5978 000e FFF7FEFF 		bl	memset
 5979              	.LVL649:
 5980 0012 0123     		movs	r3, #1
 5981 0014 8DF81030 		strb	r3, [sp, #16]
 5982 0018 8DF82030 		strb	r3, [sp, #32]
 5983 001c 8DF82330 		strb	r3, [sp, #35]
 5984 0020 8DF83030 		strb	r3, [sp, #48]
 5985 0024 8DF83230 		strb	r3, [sp, #50]
 5986 0028 8DF84030 		strb	r3, [sp, #64]
 5987 002c 8DF84230 		strb	r3, [sp, #66]
 5988 0030 8DF84330 		strb	r3, [sp, #67]
 5989              	.LVL650:
 5990 0034 14AD     		add	r5, sp, #80
 5991 0036 04AC     		add	r4, sp, #16
 5992              	.LVL651:
 5993              	.L643:
2156:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
2157:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2158:bluetooth_rxtx.c **** 		{ 1, 0, 0, 1, 0, 0, 0, 0,
2159:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2160:bluetooth_rxtx.c **** 		{ 1, 0, 1, 0, 0, 0, 0, 0,
2161:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2162:bluetooth_rxtx.c **** 		{ 1, 0, 1, 1, 0, 0, 0, 0,
2163:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2164:bluetooth_rxtx.c **** 	};
2165:bluetooth_rxtx.c **** 
2166:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
2167:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 5994              		.loc 1 2167 0
 5995 0038 504E     		ldr	r6, .L675
 5996 003a 514F     		ldr	r7, .L675+4
 5997 003c 3088     		ldrh	r0, [r6]
 5998 003e 80B2     		uxth	r0, r0
 5999 0040 6238     		subs	r0, r0, #98
 6000 0042 C0B2     		uxtb	r0, r0
 6001 0044 FFF7FEFF 		bl	btle_channel_index
 6002              	.LVL652:
 6003 0048 3A5C     		ldrb	r2, [r7, r0]	@ zero_extendqisi2
 6004              	.LVL653:
2168:bluetooth_rxtx.c **** 
2169:bluetooth_rxtx.c **** 		// whiten the desired data
2170:bluetooth_rxtx.c **** 		for (j = 0; j < (int)sizeof(desired[i]); ++j) {
 6005              		.loc 1 2170 0
 6006 004a 0023     		movs	r3, #0
 6007              	.LVL654:
 6008              	.L641:
2171:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6009              		.loc 1 2171 0 discriminator 2
 6010 004c B918     		adds	r1, r7, r2
 6011 004e E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 6012 0050 91F82810 		ldrb	r1, [r1, #40]	@ zero_extendqisi2
2172:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 6013              		.loc 1 2172 0 discriminator 2
 6014 0054 0132     		adds	r2, r2, #1
ARM GAS  /tmp/cckWTbJW.s 			page 162


 6015              	.LVL655:
2171:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6016              		.loc 1 2171 0 discriminator 2
 6017 0056 4140     		eors	r1, r1, r0
 6018 0058 E154     		strb	r1, [r4, r3]
 6019              		.loc 1 2172 0 discriminator 2
 6020 005a 7F21     		movs	r1, #127
2170:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6021              		.loc 1 2170 0 discriminator 2
 6022 005c 0133     		adds	r3, r3, #1
 6023              	.LVL656:
 6024              		.loc 1 2172 0 discriminator 2
 6025 005e B2FBF1F0 		udiv	r0, r2, r1
2170:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6026              		.loc 1 2170 0 discriminator 2
 6027 0062 102B     		cmp	r3, #16
 6028              		.loc 1 2172 0 discriminator 2
 6029 0064 01FB1022 		mls	r2, r1, r0, r2
 6030              	.LVL657:
2170:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6031              		.loc 1 2170 0 discriminator 2
 6032 0068 F0D1     		bne	.L641
 6033 006a 1034     		adds	r4, r4, #16
2166:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 6034              		.loc 1 2166 0
 6035 006c AC42     		cmp	r4, r5
 6036 006e E3D1     		bne	.L643
 6037 0070 08F12005 		add	r5, r8, #32
 6038 0074 08F53C78 		add	r8, r8, #752
 6039              	.LVL658:
 6040              	.L659:
 6041              	.LBB63:
2173:bluetooth_rxtx.c **** 		}
2174:bluetooth_rxtx.c **** 	}
2175:bluetooth_rxtx.c **** 
2176:bluetooth_rxtx.c **** 	// then look for that bitsream in our receive buffer
2177:bluetooth_rxtx.c **** 	for (i = 32; i < (DMA_SIZE*8*2 - 32 - 16); i++) {
2178:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 6042              		.loc 1 2178 0
 6043 0078 424B     		ldr	r3, .L675+8
 6044 007a 6C46     		mov	r4, sp
 6045 007c 0FCB     		ldmia	r3, {r0, r1, r2, r3}
 6046 007e 8DE80F00 		stmia	sp, {r0, r1, r2, r3}
 6047              	.LVL659:
 6048 0082 0022     		movs	r2, #0
 6049              	.LVL660:
 6050              	.L644:
 6051 0084 04AB     		add	r3, sp, #16
 6052 0086 03EB8201 		add	r1, r3, r2, lsl #2
 6053              	.LBE63:
2170:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6054              		.loc 1 2170 0 discriminator 1
 6055 008a 0023     		movs	r3, #0
 6056              	.LVL661:
 6057              	.L649:
 6058              	.LBB68:
2179:bluetooth_rxtx.c **** 		int matching = -1;
ARM GAS  /tmp/cckWTbJW.s 			page 163


2180:bluetooth_rxtx.c **** 
2181:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2182:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
2183:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 6059              		.loc 1 2183 0
 6060 008c 15F803C0 		ldrb	ip, [r5, r3]	@ zero_extendqisi2
 6061 0090 C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
 6062 0092 8445     		cmp	ip, r0
 6063 0094 02D0     		beq	.L645
2184:bluetooth_rxtx.c **** 					ok[j] = 0;
 6064              		.loc 1 2184 0
 6065 0096 0023     		movs	r3, #0
 6066              	.LVL662:
 6067 0098 A350     		str	r3, [r4, r2]
2185:bluetooth_rxtx.c **** 					break;
 6068              		.loc 1 2185 0
 6069 009a 02E0     		b	.L646
 6070              	.LVL663:
 6071              	.L645:
2182:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 6072              		.loc 1 2182 0
 6073 009c 0133     		adds	r3, r3, #1
 6074              	.LVL664:
 6075 009e 102B     		cmp	r3, #16
 6076 00a0 F4D1     		bne	.L649
 6077              	.LVL665:
 6078              	.L646:
 6079 00a2 0432     		adds	r2, r2, #4
2181:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6080              		.loc 1 2181 0
 6081 00a4 102A     		cmp	r2, #16
 6082 00a6 EDD1     		bne	.L644
 6083 00a8 0023     		movs	r3, #0
 6084              	.L652:
2186:bluetooth_rxtx.c **** 				}
2187:bluetooth_rxtx.c **** 			}
2188:bluetooth_rxtx.c **** 		}
2189:bluetooth_rxtx.c **** 
2190:bluetooth_rxtx.c **** 		// see if any match
2191:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2192:bluetooth_rxtx.c **** 			if (ok[j]) {
 6085              		.loc 1 2192 0
 6086 00aa E258     		ldr	r2, [r4, r3]
 6087 00ac 1AB9     		cbnz	r2, .L650
 6088 00ae 0433     		adds	r3, r3, #4
2191:bluetooth_rxtx.c **** 			if (ok[j]) {
 6089              		.loc 1 2191 0
 6090 00b0 102B     		cmp	r3, #16
 6091 00b2 FAD1     		bne	.L652
 6092 00b4 3EE0     		b	.L663
 6093              	.L650:
 6094              	.LVL666:
2193:bluetooth_rxtx.c **** 				matching = j;
2194:bluetooth_rxtx.c **** 				break;
2195:bluetooth_rxtx.c **** 			}
2196:bluetooth_rxtx.c **** 		}
2197:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 164


2198:bluetooth_rxtx.c **** 		// skip if no match
2199:bluetooth_rxtx.c **** 		if (matching < 0)
2200:bluetooth_rxtx.c **** 			continue;
2201:bluetooth_rxtx.c **** 
2202:bluetooth_rxtx.c **** 		// found a match! unwhiten it and send it home
2203:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 6095              		.loc 1 2203 0
 6096 00b6 3088     		ldrh	r0, [r6]
 6097 00b8 80B2     		uxth	r0, r0
 6098 00ba 6238     		subs	r0, r0, #98
 6099 00bc C0B2     		uxtb	r0, r0
 6100 00be FFF7FEFF 		bl	btle_channel_index
 6101              	.LVL667:
 6102 00c2 385C     		ldrb	r0, [r7, r0]	@ zero_extendqisi2
 6103              	.LVL668:
2204:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 6104              		.loc 1 2204 0
 6105 00c4 0023     		movs	r3, #0
 6106              	.LVL669:
 6107              	.L664:
2181:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6108              		.loc 1 2181 0 discriminator 1
 6109 00c6 0021     		movs	r1, #0
 6110 00c8 05EBC30C 		add	ip, r5, r3, lsl #3
 6111 00cc 0A46     		mov	r2, r1
 6112              	.LVL670:
 6113              	.L657:
 6114 00ce 0CEB0204 		add	r4, ip, r2
 6115              	.LBB64:
 6116              	.LBB65:
2205:bluetooth_rxtx.c **** 			u8 byte = 0;
2206:bluetooth_rxtx.c **** 			for (k = 0; k < 8; k++) {
2207:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
2208:bluetooth_rxtx.c **** 				if (offset >= DMA_SIZE*8*2) break;
2209:bluetooth_rxtx.c **** 				int bit = unpacked[offset];
2210:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 6117              		.loc 1 2210 0
 6118 00d2 032B     		cmp	r3, #3
2209:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 6119              		.loc 1 2209 0
 6120 00d4 14F8204C 		ldrb	r4, [r4, #-32]	@ zero_extendqisi2
 6121              	.LVL671:
 6122              		.loc 1 2210 0
 6123 00d8 0CDD     		ble	.L654
2211:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 6124              		.loc 1 2211 0
 6125 00da 07EB000E 		add	lr, r7, r0
 6126 00de 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
2212:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 6127              		.loc 1 2212 0
 6128 00e2 0130     		adds	r0, r0, #1
 6129              	.LVL672:
2211:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 6130              		.loc 1 2211 0
 6131 00e4 84EA0E04 		eor	r4, r4, lr
 6132              	.LVL673:
 6133              		.loc 1 2212 0
ARM GAS  /tmp/cckWTbJW.s 			page 165


 6134 00e8 4FF07F0E 		mov	lr, #127
 6135 00ec B0FBFEF9 		udiv	r9, r0, lr
 6136 00f0 0EFB1900 		mls	r0, lr, r9, r0
 6137              	.LVL674:
 6138              	.L654:
2213:bluetooth_rxtx.c **** 				}
2214:bluetooth_rxtx.c **** 				byte |= bit << k;
 6139              		.loc 1 2214 0
 6140 00f4 9440     		lsls	r4, r4, r2
 6141              	.LVL675:
 6142              	.LBE65:
2206:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6143              		.loc 1 2206 0
 6144 00f6 0132     		adds	r2, r2, #1
 6145              	.LVL676:
 6146              	.LBB66:
 6147              		.loc 1 2214 0
 6148 00f8 2143     		orrs	r1, r1, r4
 6149              	.LVL677:
 6150              	.LBE66:
2206:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6151              		.loc 1 2206 0
 6152 00fa 082A     		cmp	r2, #8
 6153              	.LBB67:
 6154              		.loc 1 2214 0
 6155 00fc C9B2     		uxtb	r1, r1
 6156              	.LVL678:
 6157              	.LBE67:
2206:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6158              		.loc 1 2206 0
 6159 00fe E6D1     		bne	.L657
2215:bluetooth_rxtx.c **** 			}
2216:bluetooth_rxtx.c **** 			idle_rxbuf[j] = byte;
 6160              		.loc 1 2216 0
 6161 0100 214C     		ldr	r4, .L675+12
 6162 0102 2268     		ldr	r2, [r4]
 6163              	.LVL679:
 6164 0104 D154     		strb	r1, [r2, r3]
 6165              	.LBE64:
2204:bluetooth_rxtx.c **** 			u8 byte = 0;
 6166              		.loc 1 2204 0
 6167 0106 0133     		adds	r3, r3, #1
 6168              	.LVL680:
 6169 0108 0A2B     		cmp	r3, #10
 6170 010a DCD1     		bne	.L664
2217:bluetooth_rxtx.c **** 		}
2218:bluetooth_rxtx.c **** 
2219:bluetooth_rxtx.c **** 		u32 aa = (idle_rxbuf[3] << 24) |
 6171              		.loc 1 2219 0
 6172 010c 2368     		ldr	r3, [r4]
 6173              	.LVL681:
 6174 010e D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 6175              	.LVL682:
2220:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6176              		.loc 1 2220 0
 6177 0110 2368     		ldr	r3, [r4]
 6178 0112 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
ARM GAS  /tmp/cckWTbJW.s 			page 166


2221:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 6179              		.loc 1 2221 0
 6180 0114 2268     		ldr	r2, [r4]
2220:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6181              		.loc 1 2220 0
 6182 0116 1B04     		lsls	r3, r3, #16
 6183              		.loc 1 2221 0
 6184 0118 5078     		ldrb	r0, [r2, #1]	@ zero_extendqisi2
 6185              	.LVL683:
2222:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 6186              		.loc 1 2222 0
 6187 011a 2268     		ldr	r2, [r4]
2219:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6188              		.loc 1 2219 0
 6189 011c 43EA0163 		orr	r3, r3, r1, lsl #24
 6190              		.loc 1 2222 0
 6191 0120 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 6192              	.LVL684:
2220:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 6193              		.loc 1 2220 0
 6194 0122 1343     		orrs	r3, r3, r2
2223:bluetooth_rxtx.c **** 		see_aa(aa);
 6195              		.loc 1 2223 0
 6196 0124 43EA0020 		orr	r0, r3, r0, lsl #8
 6197 0128 FFF7FEFF 		bl	see_aa
 6198              	.LVL685:
2224:bluetooth_rxtx.c **** 
2225:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 6199              		.loc 1 2225 0
 6200 012c 2168     		ldr	r1, [r4]
 6201 012e 0120     		movs	r0, #1
 6202 0130 FFF7FEFF 		bl	enqueue
 6203              	.LVL686:
 6204              	.L663:
 6205 0134 0135     		adds	r5, r5, #1
 6206              	.LVL687:
 6207              	.LBE68:
2177:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 6208              		.loc 1 2177 0
 6209 0136 4545     		cmp	r5, r8
 6210 0138 9ED1     		bne	.L659
 6211 013a 0023     		movs	r3, #0
 6212              	.LVL688:
 6213              	.L662:
 6214 013c 134A     		ldr	r2, .L675+16
 6215 013e 02EBC301 		add	r1, r2, r3, lsl #3
2226:bluetooth_rxtx.c **** 
2227:bluetooth_rxtx.c **** 	}
2228:bluetooth_rxtx.c **** 
2229:bluetooth_rxtx.c **** 	// once we see an AA 5 times, start following it
2230:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i) {
2231:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 6216              		.loc 1 2231 0
 6217 0142 4968     		ldr	r1, [r1, #4]
 6218 0144 0329     		cmp	r1, #3
 6219 0146 11DD     		ble	.L660
2232:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
ARM GAS  /tmp/cckWTbJW.s 			page 167


 6220              		.loc 1 2232 0
 6221 0148 52F83300 		ldr	r0, [r2, r3, lsl #3]
 6222 014c FFF7FEFF 		bl	le_set_access_address
 6223              	.LVL689:
2233:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 6224              		.loc 1 2233 0
 6225 0150 0F4B     		ldr	r3, .L675+20
 6226 0152 104A     		ldr	r2, .L675+24
2234:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
2235:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 6227              		.loc 1 2235 0
 6228 0154 0024     		movs	r4, #0
2233:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 6229              		.loc 1 2233 0
 6230 0156 9A62     		str	r2, [r3, #40]
2234:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 6231              		.loc 1 2234 0
 6232 0158 0F4A     		ldr	r2, .L675+28
2236:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 6233              		.loc 1 2236 0
 6234 015a 2046     		mov	r0, r4
2234:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 6235              		.loc 1 2234 0
 6236 015c 9A61     		str	r2, [r3, #24]
 6237              		.loc 1 2236 0
 6238 015e 0F49     		ldr	r1, .L675+32
 6239 0160 0422     		movs	r2, #4
2235:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 6240              		.loc 1 2235 0
 6241 0162 7461     		str	r4, [r6, #20]
 6242              		.loc 1 2236 0
 6243 0164 FFF7FEFF 		bl	le_promisc_state
 6244              	.LVL690:
2237:bluetooth_rxtx.c **** 			// quit using the old stuff and switch to sync mode
2238:bluetooth_rxtx.c **** 			return 0;
 6245              		.loc 1 2238 0
 6246 0168 2046     		mov	r0, r4
 6247 016a 03E0     		b	.L674
 6248              	.LVL691:
 6249              	.L660:
2230:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 6250              		.loc 1 2230 0
 6251 016c 0133     		adds	r3, r3, #1
 6252              	.LVL692:
 6253 016e 202B     		cmp	r3, #32
 6254 0170 E4D1     		bne	.L662
2239:bluetooth_rxtx.c **** 		}
2240:bluetooth_rxtx.c **** 	}
2241:bluetooth_rxtx.c **** 
2242:bluetooth_rxtx.c **** 	return 1;
 6255              		.loc 1 2242 0
 6256 0172 0120     		movs	r0, #1
 6257              	.LVL693:
 6258              	.L674:
2243:bluetooth_rxtx.c **** }
 6259              		.loc 1 2243 0
 6260 0174 15B0     		add	sp, sp, #84
ARM GAS  /tmp/cckWTbJW.s 			page 168


 6261              		@ sp needed
 6262 0176 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 6263              	.LVL694:
 6264              	.L676:
 6265 017a 00BF     		.align	2
 6266              	.L675:
 6267 017c 00000000 		.word	.LANCHOR1
 6268 0180 00000000 		.word	.LANCHOR2
 6269 0184 98080000 		.word	.LANCHOR2+2200
 6270 0188 00000000 		.word	idle_rxbuf
 6271 018c 00000000 		.word	le_promisc
 6272 0190 00000000 		.word	.LANCHOR0
 6273 0194 00000000 		.word	cb_follow_le
 6274 0198 00000000 		.word	promisc_follow_cb
 6275 019c 04000000 		.word	.LANCHOR1+4
 6276              		.cfi_endproc
 6277              	.LFE31:
 6279              		.section	.text.bt_promisc_le,"ax",%progbits
 6280              		.align	1
 6281              		.global	bt_promisc_le
 6282              		.thumb
 6283              		.thumb_func
 6285              	bt_promisc_le:
 6286              	.LFB32:
2244:bluetooth_rxtx.c **** 
2245:bluetooth_rxtx.c **** void bt_promisc_le() {
 6287              		.loc 1 2245 0
 6288              		.cfi_startproc
 6289              		@ args = 0, pretend = 0, frame = 0
 6290              		@ frame_needed = 0, uses_anonymous_args = 0
 6291 0000 38B5     		push	{r3, r4, r5, lr}
 6292              		.cfi_def_cfa_offset 16
 6293              		.cfi_offset 3, -16
 6294              		.cfi_offset 4, -12
 6295              		.cfi_offset 5, -8
 6296              		.cfi_offset 14, -4
 6297              	.L678:
2246:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_PROMISC_LE) {
 6298              		.loc 1 2246 0 discriminator 1
 6299 0002 164D     		ldr	r5, .L687
 6300 0004 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 6301 0006 0A2B     		cmp	r3, #10
 6302 0008 26D1     		bne	.L677
2247:bluetooth_rxtx.c **** 		reset_le_promisc();
2248:bluetooth_rxtx.c **** 
2249:bluetooth_rxtx.c **** 		// jump to a random data channel and turn up the squelch
2250:bluetooth_rxtx.c **** 		if ((channel & 1) == 1)
 6303              		.loc 1 2250 0
 6304 000a 154C     		ldr	r4, .L687+4
2247:bluetooth_rxtx.c **** 		reset_le_promisc();
 6305              		.loc 1 2247 0
 6306 000c FFF7FEFF 		bl	reset_le_promisc
 6307              	.LVL695:
 6308              		.loc 1 2250 0
 6309 0010 2388     		ldrh	r3, [r4]
 6310 0012 DA07     		lsls	r2, r3, #31
2251:bluetooth_rxtx.c **** 			channel = 2440;
ARM GAS  /tmp/cckWTbJW.s 			page 169


 6311              		.loc 1 2251 0
 6312 0014 44BF     		itt	mi
 6313 0016 40F68813 		movwmi	r3, #2440
 6314 001a 2380     		strhmi	r3, [r4]	@ movhi
2252:bluetooth_rxtx.c **** 
2253:bluetooth_rxtx.c **** 		// if the PC hasn't given us AA, determine by listening
2254:bluetooth_rxtx.c **** 		if (!le.target_set) {
 6315              		.loc 1 2254 0
 6316 001c 236C     		ldr	r3, [r4, #64]
 6317 001e 4BB9     		cbnz	r3, .L680
2255:bluetooth_rxtx.c **** 			// cs_threshold_req = -80;
2256:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 6318              		.loc 1 2256 0
 6319 0020 0F4B     		ldr	r3, .L687+4
 6320 0022 1888     		ldrh	r0, [r3]
 6321 0024 80B2     		uxth	r0, r0
 6322 0026 FFF7FEFF 		bl	cs_threshold_calc_and_set
 6323              	.LVL696:
2257:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 6324              		.loc 1 2257 0
 6325 002a 0E4B     		ldr	r3, .L687+8
2258:bluetooth_rxtx.c **** 			bt_generic_le(MODE_BT_PROMISC_LE);
 6326              		.loc 1 2258 0
 6327 002c 0A20     		movs	r0, #10
2257:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 6328              		.loc 1 2257 0
 6329 002e AB62     		str	r3, [r5, #40]
 6330              		.loc 1 2258 0
 6331 0030 FFF7FEFF 		bl	bt_generic_le
 6332              	.LVL697:
 6333              	.L680:
2259:bluetooth_rxtx.c **** 		}
2260:bluetooth_rxtx.c **** 
2261:bluetooth_rxtx.c **** 		// could have got mode change in middle of above
2262:bluetooth_rxtx.c **** 		if (requested_mode != MODE_BT_PROMISC_LE)
 6334              		.loc 1 2262 0
 6335 0034 AD7C     		ldrb	r5, [r5, #18]	@ zero_extendqisi2
 6336 0036 EDB2     		uxtb	r5, r5
 6337 0038 0A2D     		cmp	r5, #10
 6338 003a 0DD1     		bne	.L677
2263:bluetooth_rxtx.c **** 			break;
2264:bluetooth_rxtx.c **** 
2265:bluetooth_rxtx.c **** 		le_promisc_state(0, &le.access_address, 4);
 6339              		.loc 1 2265 0
 6340 003c 0020     		movs	r0, #0
 6341 003e 0A49     		ldr	r1, .L687+12
 6342 0040 0422     		movs	r2, #4
 6343 0042 FFF7FEFF 		bl	le_promisc_state
 6344              	.LVL698:
2266:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 6345              		.loc 1 2266 0
 6346 0046 094A     		ldr	r2, .L687+16
 6347 0048 044B     		ldr	r3, .L687
2267:bluetooth_rxtx.c **** 		le.crc_verify = 0;
2268:bluetooth_rxtx.c **** 		bt_le_sync(MODE_BT_PROMISC_LE);
 6348              		.loc 1 2268 0
 6349 004a 2846     		mov	r0, r5
ARM GAS  /tmp/cckWTbJW.s 			page 170


2266:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 6350              		.loc 1 2266 0
 6351 004c 9A61     		str	r2, [r3, #24]
2267:bluetooth_rxtx.c **** 		le.crc_verify = 0;
 6352              		.loc 1 2267 0
 6353 004e 0023     		movs	r3, #0
 6354 0050 6361     		str	r3, [r4, #20]
 6355              		.loc 1 2268 0
 6356 0052 FFF7FEFF 		bl	bt_le_sync
 6357              	.LVL699:
 6358 0056 D4E7     		b	.L678
 6359              	.L677:
 6360 0058 38BD     		pop	{r3, r4, r5, pc}
 6361              	.L688:
 6362 005a 00BF     		.align	2
 6363              	.L687:
 6364 005c 00000000 		.word	.LANCHOR0
 6365 0060 00000000 		.word	.LANCHOR1
 6366 0064 00000000 		.word	cb_le_promisc
 6367 0068 04000000 		.word	.LANCHOR1+4
 6368 006c 00000000 		.word	promisc_follow_cb
 6369              		.cfi_endproc
 6370              	.LFE32:
 6372              		.section	.text.bt_slave_le,"ax",%progbits
 6373              		.align	1
 6374              		.global	bt_slave_le
 6375              		.thumb
 6376              		.thumb_func
 6378              	bt_slave_le:
 6379              	.LFB33:
2269:bluetooth_rxtx.c **** 	}
2270:bluetooth_rxtx.c **** }
2271:bluetooth_rxtx.c **** 
2272:bluetooth_rxtx.c **** void bt_slave_le() {
 6380              		.loc 1 2272 0
 6381              		.cfi_startproc
 6382              		@ args = 0, pretend = 0, frame = 24
 6383              		@ frame_needed = 0, uses_anonymous_args = 0
 6384 0000 70B5     		push	{r4, r5, r6, lr}
 6385              		.cfi_def_cfa_offset 16
 6386              		.cfi_offset 4, -16
 6387              		.cfi_offset 5, -12
 6388              		.cfi_offset 6, -8
 6389              		.cfi_offset 14, -4
 6390 0002 86B0     		sub	sp, sp, #24
 6391              		.cfi_def_cfa_offset 40
2273:bluetooth_rxtx.c **** 	u32 calc_crc;
2274:bluetooth_rxtx.c **** 	int i;
2275:bluetooth_rxtx.c **** 
2276:bluetooth_rxtx.c **** 	u8 adv_ind[] = {
 6392              		.loc 1 2276 0
 6393 0004 234B     		ldr	r3, .L700
 6394 0006 01AC     		add	r4, sp, #4
 6395 0008 03F11002 		add	r2, r3, #16
 6396 000c 2646     		mov	r6, r4
 6397              	.L690:
 6398 000e 1868     		ldr	r0, [r3]	@ unaligned
ARM GAS  /tmp/cckWTbJW.s 			page 171


 6399 0010 5968     		ldr	r1, [r3, #4]	@ unaligned
 6400 0012 2546     		mov	r5, r4
 6401 0014 03C5     		stmia	r5!, {r0, r1}
 6402 0016 0833     		adds	r3, r3, #8
 6403 0018 9342     		cmp	r3, r2
 6404 001a 2C46     		mov	r4, r5
 6405 001c F7D1     		bne	.L690
 6406 001e 1868     		ldr	r0, [r3]	@ unaligned
 6407 0020 0523     		movs	r3, #5
 6408 0022 2860     		str	r0, [r5]	@ unaligned
 6409              	.LVL700:
 6410              	.L692:
2277:bluetooth_rxtx.c **** 		// LL header
2278:bluetooth_rxtx.c **** 		0x00, 0x0f,
2279:bluetooth_rxtx.c **** 
2280:bluetooth_rxtx.c **** 		// advertising address
2281:bluetooth_rxtx.c **** 		0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
2282:bluetooth_rxtx.c **** 
2283:bluetooth_rxtx.c **** 		// advertising data
2284:bluetooth_rxtx.c **** 		0x05, 0x01, 0x06, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13,
2285:bluetooth_rxtx.c **** 
2286:bluetooth_rxtx.c **** 		// CRC (calc)
2287:bluetooth_rxtx.c **** 		0xff, 0xff, 0xff,
2288:bluetooth_rxtx.c **** 	};
2289:bluetooth_rxtx.c **** 
2290:bluetooth_rxtx.c **** 	u8 adv_ind_len = sizeof(adv_ind) - 3;
2291:bluetooth_rxtx.c **** 
2292:bluetooth_rxtx.c **** 	// copy the user-specified mac address
2293:bluetooth_rxtx.c **** 	for (i = 0; i < 6; ++i)
2294:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 6411              		.loc 1 2294 0 discriminator 2
 6412 0024 1C49     		ldr	r1, .L700+4
 6413 0026 F21A     		subs	r2, r6, r3
 6414 0028 595C     		ldrb	r1, [r3, r1]	@ zero_extendqisi2
2293:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 6415              		.loc 1 2293 0 discriminator 2
 6416 002a 13F1FF33 		adds	r3, r3, #-1
 6417              	.LVL701:
 6418              		.loc 1 2294 0 discriminator 2
 6419 002e D171     		strb	r1, [r2, #7]
 6420              	.LVL702:
2293:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 6421              		.loc 1 2293 0 discriminator 2
 6422 0030 F8D2     		bcs	.L692
2295:bluetooth_rxtx.c **** 
2296:bluetooth_rxtx.c **** 	calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind, adv_ind_len);
 6423              		.loc 1 2296 0
 6424 0032 1A4B     		ldr	r3, .L700+8
 6425 0034 3146     		mov	r1, r6
 6426 0036 1869     		ldr	r0, [r3, #16]
 6427 0038 1122     		movs	r2, #17
 6428 003a FFF7FEFF 		bl	btle_calc_crc
 6429              	.LVL703:
2297:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+0] = (calc_crc >>  0) & 0xff;
2298:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+1] = (calc_crc >>  8) & 0xff;
 6430              		.loc 1 2298 0
 6431 003e 030A     		lsrs	r3, r0, #8
ARM GAS  /tmp/cckWTbJW.s 			page 172


2297:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+0] = (calc_crc >>  0) & 0xff;
 6432              		.loc 1 2297 0
 6433 0040 8DF81500 		strb	r0, [sp, #21]
2299:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 6434              		.loc 1 2299 0
 6435 0044 000C     		lsrs	r0, r0, #16
 6436              	.LVL704:
2298:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 6437              		.loc 1 2298 0
 6438 0046 8DF81630 		strb	r3, [sp, #22]
 6439              		.loc 1 2299 0
 6440 004a 8DF81700 		strb	r0, [sp, #23]
2300:bluetooth_rxtx.c **** 
2301:bluetooth_rxtx.c **** 	clkn_start();
 6441              		.loc 1 2301 0
 6442 004e FFF7FEFF 		bl	clkn_start
 6443              	.LVL705:
 6444              	.L693:
2302:bluetooth_rxtx.c **** 
2303:bluetooth_rxtx.c **** 	// spam advertising packets
2304:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_SLAVE_LE) {
 6445              		.loc 1 2304 0 discriminator 1
 6446 0052 134B     		ldr	r3, .L700+12
 6447 0054 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 6448 0056 0C2B     		cmp	r3, #12
 6449 0058 1AD1     		bne	.L699
2305:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 6450              		.loc 1 2305 0
 6451 005a 124B     		ldr	r3, .L700+16
 6452 005c 4FF08075 		mov	r5, #16777216
2306:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 6453              		.loc 1 2306 0
 6454 0060 4FF08064 		mov	r4, #67108864
2305:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 6455              		.loc 1 2305 0
 6456 0064 1D60     		str	r5, [r3]
2307:bluetooth_rxtx.c **** 		le_transmit(0x8e89bed6, adv_ind_len+3, adv_ind);
 6457              		.loc 1 2307 0
 6458 0066 3246     		mov	r2, r6
2306:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 6459              		.loc 1 2306 0
 6460 0068 1C60     		str	r4, [r3]
 6461              		.loc 1 2307 0
 6462 006a 0F48     		ldr	r0, .L700+20
 6463 006c 1421     		movs	r1, #20
 6464 006e FFF7FEFF 		bl	le_transmit
 6465              	.LVL706:
2308:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 6466              		.loc 1 2308 0
 6467 0072 0E4B     		ldr	r3, .L700+24
 6468 0074 1D60     		str	r5, [r3]
2309:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_DMA;
 6469              		.loc 1 2309 0
 6470 0076 1C60     		str	r4, [r3]
 6471              	.LVL707:
 6472              	.LBB71:
 6473              	.LBB72:
ARM GAS  /tmp/cckWTbJW.s 			page 173


 770:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 6474              		.loc 1 770 0
 6475 0078 0D4B     		ldr	r3, .L700+28
 6476 007a 1A68     		ldr	r2, [r3]
 6477              	.LVL708:
 6478 007c 22F07F42 		bic	r2, r2, #-16777216
 6479              	.LVL709:
 771:bluetooth_rxtx.c **** 
 6480              		.loc 1 771 0
 6481 0080 02F5A072 		add	r2, r2, #320
 6482              	.LVL710:
 6483              	.L695:
 778:bluetooth_rxtx.c **** 	}
 6484              		.loc 1 778 0
 6485 0084 1968     		ldr	r1, [r3]
 6486 0086 21F07F41 		bic	r1, r1, #-16777216
 6487 008a 9142     		cmp	r1, r2
 6488 008c FAD3     		bcc	.L695
 6489 008e E0E7     		b	.L693
 6490              	.LVL711:
 6491              	.L699:
 6492              	.LBE72:
 6493              	.LBE71:
2310:bluetooth_rxtx.c **** 		msleep(100);
2311:bluetooth_rxtx.c **** 	}
2312:bluetooth_rxtx.c **** }
 6494              		.loc 1 2312 0
 6495 0090 06B0     		add	sp, sp, #24
 6496              		@ sp needed
 6497 0092 70BD     		pop	{r4, r5, r6, pc}
 6498              	.L701:
 6499              		.align	2
 6500              	.L700:
 6501 0094 A8080000 		.word	.LANCHOR2+2216
 6502 0098 20000000 		.word	.LANCHOR0+32
 6503 009c 00000000 		.word	.LANCHOR1
 6504 00a0 00000000 		.word	.LANCHOR0
 6505 00a4 80E100E0 		.word	-536813184
 6506 00a8 D6BE898E 		.word	-1903575338
 6507 00ac 00E100E0 		.word	-536813312
 6508 00b0 00000000 		.word	clkn
 6509              		.cfi_endproc
 6510              	.LFE33:
 6512              		.section	.text.rx_generic_sync,"ax",%progbits
 6513              		.align	1
 6514              		.global	rx_generic_sync
 6515              		.thumb
 6516              		.thumb_func
 6518              	rx_generic_sync:
 6519              	.LFB34:
2313:bluetooth_rxtx.c **** 
2314:bluetooth_rxtx.c **** void rx_generic_sync(void) {
 6520              		.loc 1 2314 0
 6521              		.cfi_startproc
 6522              		@ args = 0, pretend = 0, frame = 40
 6523              		@ frame_needed = 0, uses_anonymous_args = 0
 6524 0000 00B5     		push	{lr}
ARM GAS  /tmp/cckWTbJW.s 			page 174


 6525              		.cfi_def_cfa_offset 4
 6526              		.cfi_offset 14, -4
 6527 0002 8BB0     		sub	sp, sp, #44
 6528              		.cfi_def_cfa_offset 48
 6529              	.LVL712:
2315:bluetooth_rxtx.c **** 	u8 len = 32;
2316:bluetooth_rxtx.c **** 	u8 buf[len+4];
2317:bluetooth_rxtx.c **** 	u16 reg_val;
2318:bluetooth_rxtx.c **** 
2319:bluetooth_rxtx.c **** 	/* Put syncword at start of buffer
2320:bluetooth_rxtx.c **** 	 * DGS: fix this later, we don't know number of syncword bytes, etc
2321:bluetooth_rxtx.c **** 	 */
2322:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCH);
 6530              		.loc 1 2322 0
 6531 0004 2D20     		movs	r0, #45
 6532 0006 FFF7FEFF 		bl	cc2400_get
 6533              	.LVL713:
2323:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 6534              		.loc 1 2323 0
 6535 000a 030A     		lsrs	r3, r0, #8
2324:bluetooth_rxtx.c **** 	buf[1] = reg_val & 0xFF;
 6536              		.loc 1 2324 0
 6537 000c 8DF80500 		strb	r0, [sp, #5]
2325:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCL);
 6538              		.loc 1 2325 0
 6539 0010 2C20     		movs	r0, #44
 6540              	.LVL714:
2323:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 6541              		.loc 1 2323 0
 6542 0012 8DF80430 		strb	r3, [sp, #4]
 6543              		.loc 1 2325 0
 6544 0016 FFF7FEFF 		bl	cc2400_get
 6545              	.LVL715:
2326:bluetooth_rxtx.c **** 	buf[2] = (reg_val >> 8) & 0xFF;
 6546              		.loc 1 2326 0
 6547 001a 030A     		lsrs	r3, r0, #8
 6548 001c 8DF80630 		strb	r3, [sp, #6]
2327:bluetooth_rxtx.c **** 	buf[3] = reg_val & 0xFF;
 6549              		.loc 1 2327 0
 6550 0020 8DF80700 		strb	r0, [sp, #7]
2328:bluetooth_rxtx.c **** 
2329:bluetooth_rxtx.c **** 	queue_init();
 6551              		.loc 1 2329 0
 6552 0024 FFF7FEFF 		bl	queue_init
 6553              	.LVL716:
2330:bluetooth_rxtx.c **** 	clkn_start();
 6554              		.loc 1 2330 0
 6555 0028 FFF7FEFF 		bl	clkn_start
 6556              	.LVL717:
 6557              	.L704:
2331:bluetooth_rxtx.c **** 
2332:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 6558              		.loc 1 2332 0 discriminator 1
 6559 002c FFF7FEFF 		bl	cc2400_status
 6560              	.LVL718:
 6561 0030 4306     		lsls	r3, r0, #25
 6562 0032 FBD5     		bpl	.L704
ARM GAS  /tmp/cckWTbJW.s 			page 175


2333:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 6563              		.loc 1 2333 0
 6564 0034 6120     		movs	r0, #97
 6565 0036 FFF7FEFF 		bl	cc2400_strobe
 6566              	.LVL719:
 6567              	.L706:
2334:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 6568              		.loc 1 2334 0 discriminator 1
 6569 003a FFF7FEFF 		bl	cc2400_status
 6570              	.LVL720:
 6571 003e 4007     		lsls	r0, r0, #29
 6572 0040 FBD5     		bpl	.L706
2335:bluetooth_rxtx.c **** 	RXLED_SET;
 6573              		.loc 1 2335 0
 6574 0042 144B     		ldr	r3, .L712
 6575 0044 1022     		movs	r2, #16
 6576 0046 1A60     		str	r2, [r3]
2336:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2337:bluetooth_rxtx.c **** 		PAEN_SET;
 6577              		.loc 1 2337 0
 6578 0048 8022     		movs	r2, #128
 6579 004a 1A62     		str	r2, [r3, #32]
2338:bluetooth_rxtx.c **** 		HGM_SET;
 6580              		.loc 1 2338 0
 6581 004c 4FF48072 		mov	r2, #256
 6582 0050 1A62     		str	r2, [r3, #32]
 6583              	.L708:
2339:bluetooth_rxtx.c **** #endif
2340:bluetooth_rxtx.c **** 	while (1) {
2341:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 6584              		.loc 1 2341 0 discriminator 1
 6585 0052 0E20     		movs	r0, #14
 6586 0054 FFF7FEFF 		bl	cc2400_get
 6587              	.LVL721:
 6588 0058 00F01F00 		and	r0, r0, #31
 6589 005c 0F28     		cmp	r0, #15
 6590 005e F8D1     		bne	.L708
2342:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 6591              		.loc 1 2342 0
 6592 0060 6220     		movs	r0, #98
 6593 0062 FFF7FEFF 		bl	cc2400_strobe
 6594              	.LVL722:
2343:bluetooth_rxtx.c **** 		USRLED_CLR;
 6595              		.loc 1 2343 0
 6596 0066 0C4B     		ldr	r3, .L712+4
 6597 0068 0222     		movs	r2, #2
 6598 006a 1A60     		str	r2, [r3]
 6599              	.L710:
2344:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
 6600              		.loc 1 2344 0 discriminator 1
 6601 006c FFF7FEFF 		bl	cc2400_status
 6602              	.LVL723:
 6603 0070 C106     		lsls	r1, r0, #27
 6604 0072 FBD5     		bpl	.L710
2345:bluetooth_rxtx.c **** 		USRLED_SET;
 6605              		.loc 1 2345 0
 6606 0074 074B     		ldr	r3, .L712
ARM GAS  /tmp/cckWTbJW.s 			page 176


 6607 0076 0222     		movs	r2, #2
 6608 0078 1A60     		str	r2, [r3]
2346:bluetooth_rxtx.c **** 
2347:bluetooth_rxtx.c **** 		cc2400_fifo_read(len, buf+4);
 6609              		.loc 1 2347 0
 6610 007a 02A9     		add	r1, sp, #8
 6611 007c 2020     		movs	r0, #32
 6612 007e FFF7FEFF 		bl	cc2400_fifo_read
 6613              	.LVL724:
2348:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
 6614              		.loc 1 2348 0
 6615 0082 01A9     		add	r1, sp, #4
 6616              	.LVL725:
 6617 0084 0020     		movs	r0, #0
 6618 0086 FFF7FEFF 		bl	enqueue
 6619              	.LVL726:
2349:bluetooth_rxtx.c **** 		handle_usb(clkn);
 6620              		.loc 1 2349 0
 6621 008a 044B     		ldr	r3, .L712+8
 6622 008c 1868     		ldr	r0, [r3]
 6623 008e FFF7FEFF 		bl	handle_usb
 6624              	.LVL727:
2350:bluetooth_rxtx.c **** 	}
 6625              		.loc 1 2350 0
 6626 0092 DEE7     		b	.L708
 6627              	.L713:
 6628              		.align	2
 6629              	.L712:
 6630 0094 38C00920 		.word	537509944
 6631 0098 3CC00920 		.word	537509948
 6632 009c 00000000 		.word	clkn
 6633              		.cfi_endproc
 6634              	.LFE34:
 6636              		.section	.text.rx_generic,"ax",%progbits
 6637              		.align	1
 6638              		.global	rx_generic
 6639              		.thumb
 6640              		.thumb_func
 6642              	rx_generic:
 6643              	.LFB35:
2351:bluetooth_rxtx.c **** }
2352:bluetooth_rxtx.c **** 
2353:bluetooth_rxtx.c **** void rx_generic(void) {
 6644              		.loc 1 2353 0
 6645              		.cfi_startproc
 6646              		@ args = 0, pretend = 0, frame = 0
 6647              		@ frame_needed = 0, uses_anonymous_args = 0
 6648 0000 08B5     		push	{r3, lr}
 6649              		.cfi_def_cfa_offset 8
 6650              		.cfi_offset 3, -8
 6651              		.cfi_offset 14, -4
2354:bluetooth_rxtx.c **** 	// Check for packet mode
2355:bluetooth_rxtx.c **** 	if(cc2400_get(GRMDM) && 0x0400) {
 6652              		.loc 1 2355 0
 6653 0002 2020     		movs	r0, #32
 6654 0004 FFF7FEFF 		bl	cc2400_get
 6655              	.LVL728:
ARM GAS  /tmp/cckWTbJW.s 			page 177


 6656 0008 08B1     		cbz	r0, .L715
2356:bluetooth_rxtx.c **** 		rx_generic_sync();
 6657              		.loc 1 2356 0
 6658 000a FFF7FEFF 		bl	rx_generic_sync
 6659              	.LVL729:
 6660              	.L715:
2357:bluetooth_rxtx.c **** 	} else {
2358:bluetooth_rxtx.c **** 		modulation = MOD_NONE;
 6661              		.loc 1 2358 0
 6662 000e 034B     		ldr	r3, .L716
 6663 0010 0322     		movs	r2, #3
 6664 0012 1A70     		strb	r2, [r3]
2359:bluetooth_rxtx.c **** 		bt_stream_rx();
2360:bluetooth_rxtx.c **** 	}
2361:bluetooth_rxtx.c **** }
 6665              		.loc 1 2361 0
 6666 0014 BDE80840 		pop	{r3, lr}
2359:bluetooth_rxtx.c **** 		bt_stream_rx();
 6667              		.loc 1 2359 0
 6668 0018 FFF7FEBF 		b	bt_stream_rx
 6669              	.LVL730:
 6670              	.L717:
 6671              		.align	2
 6672              	.L716:
 6673 001c 00000000 		.word	.LANCHOR0
 6674              		.cfi_endproc
 6675              	.LFE35:
 6677              		.section	.text.tx_generic,"ax",%progbits
 6678              		.align	1
 6679              		.global	tx_generic
 6680              		.thumb
 6681              		.thumb_func
 6683              	tx_generic:
 6684              	.LFB36:
2362:bluetooth_rxtx.c **** 
2363:bluetooth_rxtx.c **** void tx_generic(void) {
 6685              		.loc 1 2363 0
 6686              		.cfi_startproc
 6687              		@ args = 0, pretend = 0, frame = 0
 6688              		@ frame_needed = 0, uses_anonymous_args = 0
 6689 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 6690              		.cfi_def_cfa_offset 24
 6691              		.cfi_offset 4, -24
 6692              		.cfi_offset 5, -20
 6693              		.cfi_offset 6, -16
 6694              		.cfi_offset 7, -12
 6695              		.cfi_offset 8, -8
 6696              		.cfi_offset 14, -4
2364:bluetooth_rxtx.c **** 	u16 synch, syncl;
2365:bluetooth_rxtx.c **** 	u8 prev_mode = mode;
 6697              		.loc 1 2365 0
 6698 0004 354D     		ldr	r5, .L729
2366:bluetooth_rxtx.c **** 
2367:bluetooth_rxtx.c **** 	mode = MODE_TX_GENERIC;
 6699              		.loc 1 2367 0
 6700 0006 1023     		movs	r3, #16
2368:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 178


2369:bluetooth_rxtx.c **** 	// Save existing syncword
2370:bluetooth_rxtx.c **** 	synch = cc2400_get(SYNCH);
 6701              		.loc 1 2370 0
 6702 0008 2D20     		movs	r0, #45
2365:bluetooth_rxtx.c **** 
 6703              		.loc 1 2365 0
 6704 000a 6E7C     		ldrb	r6, [r5, #17]	@ zero_extendqisi2
2367:bluetooth_rxtx.c **** 
 6705              		.loc 1 2367 0
 6706 000c 6B74     		strb	r3, [r5, #17]
 6707              		.loc 1 2370 0
 6708 000e FFF7FEFF 		bl	cc2400_get
 6709              	.LVL731:
 6710 0012 8046     		mov	r8, r0
2371:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 6711              		.loc 1 2371 0
 6712 0014 2C20     		movs	r0, #44
 6713 0016 FFF7FEFF 		bl	cc2400_get
 6714              	.LVL732:
2372:bluetooth_rxtx.c **** 
2373:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, tx_pkt.synch);
 6715              		.loc 1 2373 0
 6716 001a 314C     		ldr	r4, .L729+4
2371:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 6717              		.loc 1 2371 0
 6718 001c 0746     		mov	r7, r0
 6719              		.loc 1 2373 0
 6720 001e 2188     		ldrh	r1, [r4]
 6721 0020 2D20     		movs	r0, #45
 6722 0022 FFF7FEFF 		bl	cc2400_set
 6723              	.LVL733:
2374:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, tx_pkt.syncl);
 6724              		.loc 1 2374 0
 6725 0026 2C20     		movs	r0, #44
 6726 0028 6188     		ldrh	r1, [r4, #2]
 6727 002a FFF7FEFF 		bl	cc2400_set
 6728              	.LVL734:
2375:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0057);
 6729              		.loc 1 2375 0
 6730 002e 0320     		movs	r0, #3
 6731 0030 5721     		movs	r1, #87
 6732 0032 FFF7FEFF 		bl	cc2400_set
 6733              	.LVL735:
2376:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);
 6734              		.loc 1 2376 0
 6735 0036 1420     		movs	r0, #20
 6736 0038 41F24B31 		movw	r1, #4939
 6737 003c FFF7FEFF 		bl	cc2400_set
 6738              	.LVL736:
2377:bluetooth_rxtx.c **** 	cc2400_set(GRMDM, 0x0f61);
 6739              		.loc 1 2377 0
 6740 0040 2020     		movs	r0, #32
 6741 0042 40F66171 		movw	r1, #3937
 6742 0046 FFF7FEFF 		bl	cc2400_set
 6743              	.LVL737:
2378:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, tx_pkt.channel);
 6744              		.loc 1 2378 0
ARM GAS  /tmp/cckWTbJW.s 			page 179


 6745 004a 0220     		movs	r0, #2
 6746 004c A188     		ldrh	r1, [r4, #4]
 6747 004e FFF7FEFF 		bl	cc2400_set
 6748              	.LVL738:
2379:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pkt.pa_level);
 6749              		.loc 1 2379 0
 6750 0052 0520     		movs	r0, #5
 6751 0054 E179     		ldrb	r1, [r4, #7]	@ zero_extendqisi2
2365:bluetooth_rxtx.c **** 
 6752              		.loc 1 2365 0
 6753 0056 F6B2     		uxtb	r6, r6
 6754              	.LVL739:
 6755              		.loc 1 2379 0
 6756 0058 FFF7FEFF 		bl	cc2400_set
 6757              	.LVL740:
 6758              	.L720:
2380:bluetooth_rxtx.c **** 
2381:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 6759              		.loc 1 2381 0 discriminator 1
 6760 005c FFF7FEFF 		bl	cc2400_status
 6761              	.LVL741:
 6762 0060 4006     		lsls	r0, r0, #25
 6763 0062 FBD5     		bpl	.L720
2382:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 6764              		.loc 1 2382 0
 6765 0064 6120     		movs	r0, #97
 6766 0066 FFF7FEFF 		bl	cc2400_strobe
 6767              	.LVL742:
 6768              	.L722:
2383:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 6769              		.loc 1 2383 0 discriminator 1
 6770 006a FFF7FEFF 		bl	cc2400_status
 6771              	.LVL743:
 6772 006e 4107     		lsls	r1, r0, #29
 6773 0070 FBD5     		bpl	.L722
2384:bluetooth_rxtx.c **** 	TXLED_SET;
 6774              		.loc 1 2384 0
 6775 0072 1C4B     		ldr	r3, .L729+8
 6776 0074 4FF48072 		mov	r2, #256
 6777 0078 1A60     		str	r2, [r3]
2385:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2386:bluetooth_rxtx.c **** 		PAEN_SET;
 6778              		.loc 1 2386 0
 6779 007a 8022     		movs	r2, #128
 6780 007c 1A62     		str	r2, [r3, #32]
 6781              	.L724:
2387:bluetooth_rxtx.c **** #endif
2388:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 6782              		.loc 1 2388 0 discriminator 1
 6783 007e 0E20     		movs	r0, #14
 6784 0080 FFF7FEFF 		bl	cc2400_get
 6785              	.LVL744:
 6786 0084 00F01F00 		and	r0, r0, #31
 6787 0088 0F28     		cmp	r0, #15
 6788 008a F8D1     		bne	.L724
2389:bluetooth_rxtx.c **** 
2390:bluetooth_rxtx.c **** 	cc2400_fifo_write(tx_pkt.length, tx_pkt.data);
ARM GAS  /tmp/cckWTbJW.s 			page 180


 6789              		.loc 1 2390 0
 6790 008c A079     		ldrb	r0, [r4, #6]	@ zero_extendqisi2
 6791 008e 1649     		ldr	r1, .L729+12
 6792 0090 FFF7FEFF 		bl	cc2400_fifo_write
 6793              	.LVL745:
2391:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 6794              		.loc 1 2391 0
 6795 0094 6320     		movs	r0, #99
 6796 0096 FFF7FEFF 		bl	cc2400_strobe
 6797              	.LVL746:
 6798              	.L726:
2392:bluetooth_rxtx.c **** 
2393:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 6799              		.loc 1 2393 0 discriminator 1
 6800 009a 0E20     		movs	r0, #14
 6801 009c FFF7FEFF 		bl	cc2400_get
 6802              	.LVL747:
 6803 00a0 00F01F00 		and	r0, r0, #31
 6804 00a4 0F28     		cmp	r0, #15
 6805 00a6 F8D1     		bne	.L726
2394:bluetooth_rxtx.c **** 	TXLED_CLR;
 6806              		.loc 1 2394 0
 6807 00a8 104B     		ldr	r3, .L729+16
 6808 00aa 4FF48072 		mov	r2, #256
 6809 00ae 1A60     		str	r2, [r3]
2395:bluetooth_rxtx.c **** 
2396:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 6810              		.loc 1 2396 0
 6811 00b0 6420     		movs	r0, #100
 6812 00b2 FFF7FEFF 		bl	cc2400_strobe
 6813              	.LVL748:
 6814              	.L728:
2397:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 6815              		.loc 1 2397 0 discriminator 1
 6816 00b6 FFF7FEFF 		bl	cc2400_status
 6817              	.LVL749:
 6818 00ba 4207     		lsls	r2, r0, #29
 6819 00bc FBD4     		bmi	.L728
2398:bluetooth_rxtx.c **** 
2399:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2400:bluetooth_rxtx.c **** 	PAEN_CLR;
 6820              		.loc 1 2400 0
 6821 00be 0C4B     		ldr	r3, .L729+20
 6822 00c0 8022     		movs	r2, #128
 6823 00c2 1A60     		str	r2, [r3]
2401:bluetooth_rxtx.c **** #endif
2402:bluetooth_rxtx.c **** 
2403:bluetooth_rxtx.c **** 	// Restore state
2404:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, synch);
 6824              		.loc 1 2404 0
 6825 00c4 2D20     		movs	r0, #45
 6826 00c6 4146     		mov	r1, r8
 6827 00c8 FFF7FEFF 		bl	cc2400_set
 6828              	.LVL750:
2405:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, syncl);
 6829              		.loc 1 2405 0
 6830 00cc 2C20     		movs	r0, #44
ARM GAS  /tmp/cckWTbJW.s 			page 181


 6831 00ce 3946     		mov	r1, r7
 6832 00d0 FFF7FEFF 		bl	cc2400_set
 6833              	.LVL751:
2406:bluetooth_rxtx.c **** 	requested_mode = prev_mode;
 6834              		.loc 1 2406 0
 6835 00d4 AE74     		strb	r6, [r5, #18]
 6836 00d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 6837              	.LVL752:
 6838              	.L730:
 6839 00da 00BF     		.align	2
 6840              	.L729:
 6841 00dc 00000000 		.word	.LANCHOR0
 6842 00e0 00000000 		.word	tx_pkt
 6843 00e4 38C00920 		.word	537509944
 6844 00e8 08000000 		.word	tx_pkt+8
 6845 00ec 3CC00920 		.word	537509948
 6846 00f0 5CC00920 		.word	537509980
 6847              		.cfi_endproc
 6848              	.LFE36:
 6850              		.section	.text.specan,"ax",%progbits
 6851              		.align	1
 6852              		.global	specan
 6853              		.thumb
 6854              		.thumb_func
 6856              	specan:
 6857              	.LFB37:
2407:bluetooth_rxtx.c **** }
2408:bluetooth_rxtx.c **** 
2409:bluetooth_rxtx.c **** /* spectrum analysis */
2410:bluetooth_rxtx.c **** void specan()
2411:bluetooth_rxtx.c **** {
 6858              		.loc 1 2411 0
 6859              		.cfi_startproc
 6860              		@ args = 0, pretend = 0, frame = 56
 6861              		@ frame_needed = 0, uses_anonymous_args = 0
 6862 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 6863              		.cfi_def_cfa_offset 24
 6864              		.cfi_offset 4, -24
 6865              		.cfi_offset 5, -20
 6866              		.cfi_offset 6, -16
 6867              		.cfi_offset 7, -12
 6868              		.cfi_offset 8, -8
 6869              		.cfi_offset 14, -4
 6870 0004 8EB0     		sub	sp, sp, #56
 6871              		.cfi_def_cfa_offset 80
 6872              	.LVL753:
2412:bluetooth_rxtx.c **** 	u16 f;
2413:bluetooth_rxtx.c **** 	u8 i = 0;
2414:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
2415:bluetooth_rxtx.c **** 
2416:bluetooth_rxtx.c **** 	RXLED_SET;
 6873              		.loc 1 2416 0
 6874 0006 3D4B     		ldr	r3, .L748
 6875 0008 1022     		movs	r2, #16
 6876 000a 1A60     		str	r2, [r3]
2417:bluetooth_rxtx.c **** 
2418:bluetooth_rxtx.c **** 	queue_init();
ARM GAS  /tmp/cckWTbJW.s 			page 182


 6877              		.loc 1 2418 0
 6878 000c FFF7FEFF 		bl	queue_init
 6879              	.LVL754:
2419:bluetooth_rxtx.c **** 	clkn_start();
 6880              		.loc 1 2419 0
 6881 0010 FFF7FEFF 		bl	clkn_start
 6882              	.LVL755:
2420:bluetooth_rxtx.c **** 
2421:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2422:bluetooth_rxtx.c **** 	PAEN_SET;
 6883              		.loc 1 2422 0
 6884 0014 3A4B     		ldr	r3, .L748+4
 6885 0016 8022     		movs	r2, #128
 6886 0018 1A60     		str	r2, [r3]
2423:bluetooth_rxtx.c **** 	//HGM_SET;
2424:bluetooth_rxtx.c **** #endif
2425:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 6887              		.loc 1 2425 0
 6888 001a 1220     		movs	r0, #18
 6889 001c 42F62231 		movw	r1, #11042
 6890 0020 FFF7FEFF 		bl	cc2400_set
 6891              	.LVL756:
2426:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 6892              		.loc 1 2426 0
 6893 0024 1420     		movs	r0, #20
 6894 0026 41F24B31 		movw	r1, #4939
 6895 002a FFF7FEFF 		bl	cc2400_set
 6896              	.LVL757:
2427:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 6897              		.loc 1 2427 0
 6898 002e 2020     		movs	r0, #32
 6899 0030 40F20111 		movw	r1, #257
 6900 0034 FFF7FEFF 		bl	cc2400_set
 6901              	.LVL758:
2428:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 6902              		.loc 1 2428 0
 6903 0038 0320     		movs	r0, #3
 6904 003a 2921     		movs	r1, #41
 6905 003c FFF7FEFF 		bl	cc2400_set
 6906              	.LVL759:
 6907              	.L733:
2429:bluetooth_rxtx.c **** 	//FIXME maybe set RSSI.RSSI_FILT
2430:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 6908              		.loc 1 2430 0 discriminator 1
 6909 0040 FFF7FEFF 		bl	cc2400_status
 6910              	.LVL760:
 6911 0044 4306     		lsls	r3, r0, #25
 6912 0046 FBD5     		bpl	.L733
 6913              	.L735:
2431:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 6914              		.loc 1 2431 0
 6915 0048 FFF7FEFF 		bl	cc2400_status
 6916              	.LVL761:
 6917 004c 00F00400 		and	r0, r0, #4
 6918 0050 00F0FF05 		and	r5, r0, #255
 6919 0054 0028     		cmp	r0, #0
 6920 0056 F7D1     		bne	.L735
ARM GAS  /tmp/cckWTbJW.s 			page 183


 6921              	.LVL762:
 6922              	.L736:
2432:bluetooth_rxtx.c **** 
2433:bluetooth_rxtx.c **** 	while (requested_mode == MODE_SPECAN) {
 6923              		.loc 1 2433 0 discriminator 1
 6924 0058 2A4B     		ldr	r3, .L748+8
 6925 005a 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 6926 005c 042B     		cmp	r3, #4
 6927 005e 47D1     		bne	.L747
2434:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 6928              		.loc 1 2434 0
 6929 0060 294B     		ldr	r3, .L748+12
 6930 0062 B3F84C40 		ldrh	r4, [r3, #76]
 6931 0066 9846     		mov	r8, r3
 6932 0068 A4B2     		uxth	r4, r4
 6933              	.LVL763:
 6934              	.L737:
 6935              		.loc 1 2434 0 is_stmt 0 discriminator 1
 6936 006a B8F84E30 		ldrh	r3, [r8, #78]
 6937 006e 9BB2     		uxth	r3, r3
 6938 0070 A342     		cmp	r3, r4
 6939 0072 F1DB     		blt	.L736
 6940 0074 611E     		subs	r1, r4, #1
 6941              	.LBB73:
2435:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 6942              		.loc 1 2435 0 is_stmt 1
 6943 0076 0220     		movs	r0, #2
 6944 0078 89B2     		uxth	r1, r1
 6945 007a FFF7FEFF 		bl	cc2400_set
 6946              	.LVL764:
2436:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 6947              		.loc 1 2436 0
 6948 007e 6120     		movs	r0, #97
 6949 0080 FFF7FEFF 		bl	cc2400_strobe
 6950              	.LVL765:
 6951              	.L739:
2437:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 6952              		.loc 1 2437 0 discriminator 1
 6953 0084 FFF7FEFF 		bl	cc2400_status
 6954              	.LVL766:
 6955 0088 4707     		lsls	r7, r0, #29
 6956 008a FBD5     		bpl	.L739
2438:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 6957              		.loc 1 2438 0
 6958 008c 6220     		movs	r0, #98
 6959 008e FFF7FEFF 		bl	cc2400_strobe
 6960              	.LVL767:
2439:bluetooth_rxtx.c **** 
2440:bluetooth_rxtx.c **** 			/* give the CC2400 time to acquire RSSI reading */
2441:bluetooth_rxtx.c **** 			volatile u32 j = 500; while (--j); //FIXME crude delay
 6961              		.loc 1 2441 0
 6962 0092 4FF4FA73 		mov	r3, #500
 6963 0096 0093     		str	r3, [sp]
 6964              	.L741:
 6965              		.loc 1 2441 0 is_stmt 0 discriminator 1
 6966 0098 009E     		ldr	r6, [sp]
 6967 009a 013E     		subs	r6, r6, #1
ARM GAS  /tmp/cckWTbJW.s 			page 184


 6968 009c 0096     		str	r6, [sp]
 6969 009e 002E     		cmp	r6, #0
 6970 00a0 FAD1     		bne	.L741
2442:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 6971              		.loc 1 2442 0 is_stmt 1
 6972 00a2 0EAB     		add	r3, sp, #56
 6973 00a4 0327     		movs	r7, #3
 6974 00a6 07FB0537 		mla	r7, r7, r5, r3
2443:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
2444:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
 6975              		.loc 1 2444 0
 6976 00aa 0620     		movs	r0, #6
2442:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 6977              		.loc 1 2442 0
 6978 00ac 230A     		lsrs	r3, r4, #8
 6979 00ae 07F8343C 		strb	r3, [r7, #-52]
2443:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
 6980              		.loc 1 2443 0
 6981 00b2 07F8334C 		strb	r4, [r7, #-51]
 6982              		.loc 1 2444 0
 6983 00b6 FFF7FEFF 		bl	cc2400_get
 6984              	.LVL768:
2445:bluetooth_rxtx.c **** 			i++;
 6985              		.loc 1 2445 0
 6986 00ba 0135     		adds	r5, r5, #1
 6987              	.LVL769:
 6988 00bc EDB2     		uxtb	r5, r5
 6989              	.LVL770:
2444:bluetooth_rxtx.c **** 			i++;
 6990              		.loc 1 2444 0
 6991 00be 000A     		lsrs	r0, r0, #8
2446:bluetooth_rxtx.c **** 			if (i == 16) {
 6992              		.loc 1 2446 0
 6993 00c0 102D     		cmp	r5, #16
2444:bluetooth_rxtx.c **** 			i++;
 6994              		.loc 1 2444 0
 6995 00c2 07F8320C 		strb	r0, [r7, #-50]
 6996              		.loc 1 2446 0
 6997 00c6 09D1     		bne	.L742
2447:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 6998              		.loc 1 2447 0
 6999 00c8 0420     		movs	r0, #4
 7000 00ca 0DEB0001 		add	r1, sp, r0
 7001 00ce FFF7FEFF 		bl	enqueue
 7002              	.LVL771:
2448:bluetooth_rxtx.c **** 				i = 0;
2449:bluetooth_rxtx.c **** 
2450:bluetooth_rxtx.c **** 				handle_usb(clkn);
 7003              		.loc 1 2450 0
 7004 00d2 0E4B     		ldr	r3, .L748+16
2448:bluetooth_rxtx.c **** 				i = 0;
 7005              		.loc 1 2448 0
 7006 00d4 3546     		mov	r5, r6
 7007              		.loc 1 2450 0
 7008 00d6 1868     		ldr	r0, [r3]
 7009 00d8 FFF7FEFF 		bl	handle_usb
 7010              	.LVL772:
ARM GAS  /tmp/cckWTbJW.s 			page 185


 7011              	.L742:
2451:bluetooth_rxtx.c **** 			}
2452:bluetooth_rxtx.c **** 
2453:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 7012              		.loc 1 2453 0
 7013 00dc 6420     		movs	r0, #100
 7014 00de FFF7FEFF 		bl	cc2400_strobe
 7015              	.LVL773:
 7016              	.L744:
2454:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 7017              		.loc 1 2454 0 discriminator 1
 7018 00e2 FFF7FEFF 		bl	cc2400_status
 7019              	.LVL774:
 7020 00e6 4607     		lsls	r6, r0, #29
 7021 00e8 FBD4     		bmi	.L744
 7022              	.LBE73:
2434:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 7023              		.loc 1 2434 0
 7024 00ea 0134     		adds	r4, r4, #1
 7025              	.LVL775:
 7026 00ec A4B2     		uxth	r4, r4
 7027              	.LVL776:
 7028 00ee BCE7     		b	.L737
 7029              	.LVL777:
 7030              	.L747:
2455:bluetooth_rxtx.c **** 		}
2456:bluetooth_rxtx.c **** 	}
2457:bluetooth_rxtx.c **** 	RXLED_CLR;
 7031              		.loc 1 2457 0
 7032 00f0 074B     		ldr	r3, .L748+20
 7033 00f2 1022     		movs	r2, #16
 7034 00f4 1A60     		str	r2, [r3]
2458:bluetooth_rxtx.c **** }
 7035              		.loc 1 2458 0
 7036 00f6 0EB0     		add	sp, sp, #56
 7037              		@ sp needed
 7038 00f8 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 7039              	.LVL778:
 7040              	.L749:
 7041              		.align	2
 7042              	.L748:
 7043 00fc 38C00920 		.word	537509944
 7044 0100 58C00920 		.word	537509976
 7045 0104 00000000 		.word	.LANCHOR0
 7046 0108 00000000 		.word	.LANCHOR1
 7047 010c 00000000 		.word	clkn
 7048 0110 3CC00920 		.word	537509948
 7049              		.cfi_endproc
 7050              	.LFE37:
 7052              		.section	.text.led_specan,"ax",%progbits
 7053              		.align	1
 7054              		.global	led_specan
 7055              		.thumb
 7056              		.thumb_func
 7058              	led_specan:
 7059              	.LFB38:
2459:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cckWTbJW.s 			page 186


2460:bluetooth_rxtx.c **** /* LED based spectrum analysis */
2461:bluetooth_rxtx.c **** void led_specan()
2462:bluetooth_rxtx.c **** {
 7060              		.loc 1 2462 0
 7061              		.cfi_startproc
 7062              		@ args = 0, pretend = 0, frame = 16
 7063              		@ frame_needed = 0, uses_anonymous_args = 0
 7064 0000 1FB5     		push	{r0, r1, r2, r3, r4, lr}
 7065              		.cfi_def_cfa_offset 24
 7066              		.cfi_offset 0, -24
 7067              		.cfi_offset 1, -20
 7068              		.cfi_offset 2, -16
 7069              		.cfi_offset 3, -12
 7070              		.cfi_offset 4, -8
 7071              		.cfi_offset 14, -4
 7072              	.LVL779:
2463:bluetooth_rxtx.c **** 	int8_t lvl;
2464:bluetooth_rxtx.c **** 	u8 i = 0;
2465:bluetooth_rxtx.c **** 	u16 channels[3] = {2412, 2437, 2462};
 7073              		.loc 1 2465 0
 7074 0002 444B     		ldr	r3, .L777
2466:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
2467:bluetooth_rxtx.c **** 	//void (*clr[3]) = {TXLED_CLR, RXLED_CLR, USRLED_CLR};
2468:bluetooth_rxtx.c **** 
2469:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2470:bluetooth_rxtx.c **** 	PAEN_SET;
 7075              		.loc 1 2470 0
 7076 0004 8022     		movs	r2, #128
2465:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
 7077              		.loc 1 2465 0
 7078 0006 1868     		ldr	r0, [r3]	@ unaligned
 7079 0008 9B88     		ldrh	r3, [r3, #4]	@ unaligned
 7080 000a 0290     		str	r0, [sp, #8]	@ unaligned
 7081 000c ADF80C30 		strh	r3, [sp, #12]	@ unaligned
 7082              		.loc 1 2470 0
 7083 0010 414B     		ldr	r3, .L777+4
2471:bluetooth_rxtx.c **** 	//HGM_SET;
2472:bluetooth_rxtx.c **** #endif
2473:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 7084              		.loc 1 2473 0
 7085 0012 1220     		movs	r0, #18
2470:bluetooth_rxtx.c **** 	//HGM_SET;
 7086              		.loc 1 2470 0
 7087 0014 1A60     		str	r2, [r3]
 7088              		.loc 1 2473 0
 7089 0016 42F62231 		movw	r1, #11042
 7090 001a FFF7FEFF 		bl	cc2400_set
 7091              	.LVL780:
2474:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 7092              		.loc 1 2474 0
 7093 001e 1420     		movs	r0, #20
 7094 0020 41F24B31 		movw	r1, #4939
 7095 0024 FFF7FEFF 		bl	cc2400_set
 7096              	.LVL781:
2475:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 7097              		.loc 1 2475 0
 7098 0028 2020     		movs	r0, #32
ARM GAS  /tmp/cckWTbJW.s 			page 187


 7099 002a 40F20111 		movw	r1, #257
 7100 002e FFF7FEFF 		bl	cc2400_set
 7101              	.LVL782:
2476:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 7102              		.loc 1 2476 0
 7103 0032 0320     		movs	r0, #3
 7104 0034 2921     		movs	r1, #41
 7105 0036 FFF7FEFF 		bl	cc2400_set
 7106              	.LVL783:
2477:bluetooth_rxtx.c **** 	cc2400_set(RSSI,    0x00F1); // RSSI Sample over 2 symbols
 7107              		.loc 1 2477 0
 7108 003a 0620     		movs	r0, #6
 7109 003c F121     		movs	r1, #241
 7110 003e FFF7FEFF 		bl	cc2400_set
 7111              	.LVL784:
 7112              	.L752:
2478:bluetooth_rxtx.c **** 
2479:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7113              		.loc 1 2479 0 discriminator 1
 7114 0042 FFF7FEFF 		bl	cc2400_status
 7115              	.LVL785:
 7116 0046 4006     		lsls	r0, r0, #25
 7117 0048 FBD5     		bpl	.L752
 7118              	.L754:
2480:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7119              		.loc 1 2480 0
 7120 004a FFF7FEFF 		bl	cc2400_status
 7121              	.LVL786:
 7122 004e 00F00400 		and	r0, r0, #4
 7123 0052 00F0FF04 		and	r4, r0, #255
 7124 0056 0028     		cmp	r0, #0
 7125 0058 F7D1     		bne	.L754
 7126              	.LVL787:
 7127              	.L755:
2481:bluetooth_rxtx.c **** 
2482:bluetooth_rxtx.c **** 	while (requested_mode == MODE_LED_SPECAN) {
 7128              		.loc 1 2482 0 discriminator 1
 7129 005a 304B     		ldr	r3, .L777+8
 7130 005c 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 7131 005e 072B     		cmp	r3, #7
 7132 0060 55D1     		bne	.L776
 7133              	.LBB74:
2483:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 7134              		.loc 1 2483 0
 7135 0062 04AA     		add	r2, sp, #16
 7136 0064 02EB4403 		add	r3, r2, r4, lsl #1
 7137 0068 33F8081C 		ldrh	r1, [r3, #-8]
 7138 006c 0220     		movs	r0, #2
 7139 006e 0139     		subs	r1, r1, #1
 7140 0070 89B2     		uxth	r1, r1
 7141 0072 FFF7FEFF 		bl	cc2400_set
 7142              	.LVL788:
2484:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 7143              		.loc 1 2484 0
 7144 0076 6120     		movs	r0, #97
 7145 0078 FFF7FEFF 		bl	cc2400_strobe
 7146              	.LVL789:
ARM GAS  /tmp/cckWTbJW.s 			page 188


 7147              	.L757:
2485:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 7148              		.loc 1 2485 0 discriminator 1
 7149 007c FFF7FEFF 		bl	cc2400_status
 7150              	.LVL790:
 7151 0080 4107     		lsls	r1, r0, #29
 7152 0082 FBD5     		bpl	.L757
2486:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 7153              		.loc 1 2486 0
 7154 0084 6220     		movs	r0, #98
 7155 0086 FFF7FEFF 		bl	cc2400_strobe
 7156              	.LVL791:
2487:bluetooth_rxtx.c **** 
2488:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
2489:bluetooth_rxtx.c **** 		volatile u32 j = 500; while (--j); //FIXME crude delay
 7157              		.loc 1 2489 0
 7158 008a 4FF4FA73 		mov	r3, #500
 7159 008e 0193     		str	r3, [sp, #4]
 7160              	.L759:
 7161              		.loc 1 2489 0 is_stmt 0 discriminator 1
 7162 0090 019B     		ldr	r3, [sp, #4]
 7163 0092 013B     		subs	r3, r3, #1
 7164 0094 0193     		str	r3, [sp, #4]
 7165 0096 002B     		cmp	r3, #0
 7166 0098 FAD1     		bne	.L759
2490:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
 7167              		.loc 1 2490 0 is_stmt 1
 7168 009a 0620     		movs	r0, #6
 7169 009c FFF7FEFF 		bl	cc2400_get
 7170              	.LVL792:
2491:bluetooth_rxtx.c **** 		if (lvl > rssi_threshold) {
 7171              		.loc 1 2491 0
 7172 00a0 1F4B     		ldr	r3, .L777+12
 7173 00a2 40F30720 		sbfx	r0, r0, #8, #8
 7174              	.LVL793:
 7175 00a6 93F85030 		ldrb	r3, [r3, #80]	@ zero_extendqisi2
 7176 00aa 5BB2     		sxtb	r3, r3
 7177 00ac 9842     		cmp	r0, r3
 7178 00ae 0CDD     		ble	.L760
2492:bluetooth_rxtx.c **** 			switch (i) {
 7179              		.loc 1 2492 0
 7180 00b0 012C     		cmp	r4, #1
 7181 00b2 07D0     		beq	.L762
 7182 00b4 03D3     		bcc	.L763
 7183 00b6 022C     		cmp	r4, #2
 7184 00b8 16D1     		bne	.L761
2493:bluetooth_rxtx.c **** 				case 0:
2494:bluetooth_rxtx.c **** 					TXLED_SET;
2495:bluetooth_rxtx.c **** 					break;
2496:bluetooth_rxtx.c **** 				case 1:
2497:bluetooth_rxtx.c **** 					RXLED_SET;
2498:bluetooth_rxtx.c **** 					break;
2499:bluetooth_rxtx.c **** 				case 2:
2500:bluetooth_rxtx.c **** 					USRLED_SET;
 7185              		.loc 1 2500 0
 7186 00ba 1A4B     		ldr	r3, .L777+16
 7187 00bc 13E0     		b	.L772
ARM GAS  /tmp/cckWTbJW.s 			page 189


 7188              	.L763:
2494:bluetooth_rxtx.c **** 					break;
 7189              		.loc 1 2494 0
 7190 00be 4FF48072 		mov	r2, #256
 7191 00c2 00E0     		b	.L775
 7192              	.L762:
2497:bluetooth_rxtx.c **** 					break;
 7193              		.loc 1 2497 0
 7194 00c4 1022     		movs	r2, #16
 7195              	.L775:
 7196 00c6 174B     		ldr	r3, .L777+16
 7197 00c8 0BE0     		b	.L774
 7198              	.L760:
2501:bluetooth_rxtx.c **** 					break;
2502:bluetooth_rxtx.c **** 			}
2503:bluetooth_rxtx.c **** 		}
2504:bluetooth_rxtx.c **** 		else {
2505:bluetooth_rxtx.c **** 			switch (i) {
 7199              		.loc 1 2505 0
 7200 00ca 012C     		cmp	r4, #1
 7201 00cc 07D0     		beq	.L765
 7202 00ce 03D3     		bcc	.L766
 7203 00d0 022C     		cmp	r4, #2
 7204 00d2 09D1     		bne	.L761
2506:bluetooth_rxtx.c **** 				case 0:
2507:bluetooth_rxtx.c **** 					TXLED_CLR;
2508:bluetooth_rxtx.c **** 					break;
2509:bluetooth_rxtx.c **** 				case 1:
2510:bluetooth_rxtx.c **** 					RXLED_CLR;
2511:bluetooth_rxtx.c **** 					break;
2512:bluetooth_rxtx.c **** 				case 2:
2513:bluetooth_rxtx.c **** 					USRLED_CLR;
 7205              		.loc 1 2513 0
 7206 00d4 144B     		ldr	r3, .L777+20
 7207 00d6 06E0     		b	.L772
 7208              	.L766:
2507:bluetooth_rxtx.c **** 					break;
 7209              		.loc 1 2507 0
 7210 00d8 4FF48072 		mov	r2, #256
 7211 00dc 00E0     		b	.L773
 7212              	.L765:
2510:bluetooth_rxtx.c **** 					break;
 7213              		.loc 1 2510 0
 7214 00de 1022     		movs	r2, #16
 7215              	.L773:
 7216 00e0 114B     		ldr	r3, .L777+20
 7217              	.L774:
 7218 00e2 1A60     		str	r2, [r3]
2511:bluetooth_rxtx.c **** 				case 2:
 7219              		.loc 1 2511 0
 7220 00e4 00E0     		b	.L761
 7221              	.L772:
 7222              		.loc 1 2513 0
 7223 00e6 1C60     		str	r4, [r3]
 7224              	.L761:
2514:bluetooth_rxtx.c **** 					break;
2515:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/cckWTbJW.s 			page 190


2516:bluetooth_rxtx.c **** 		}
2517:bluetooth_rxtx.c **** 
2518:bluetooth_rxtx.c **** 		i = (i+1) % 3;
 7225              		.loc 1 2518 0
 7226 00e8 0323     		movs	r3, #3
 7227 00ea 0134     		adds	r4, r4, #1
 7228              	.LVL794:
 7229 00ec 94FBF3F2 		sdiv	r2, r4, r3
 7230 00f0 03FB1244 		mls	r4, r3, r2, r4
 7231              	.LVL795:
2519:bluetooth_rxtx.c **** 
2520:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7232              		.loc 1 2520 0
 7233 00f4 0D4B     		ldr	r3, .L777+24
2518:bluetooth_rxtx.c **** 
 7234              		.loc 1 2518 0
 7235 00f6 E4B2     		uxtb	r4, r4
 7236              	.LVL796:
 7237              		.loc 1 2520 0
 7238 00f8 1868     		ldr	r0, [r3]
 7239 00fa FFF7FEFF 		bl	handle_usb
 7240              	.LVL797:
2521:bluetooth_rxtx.c **** 
2522:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
 7241              		.loc 1 2522 0
 7242 00fe 6420     		movs	r0, #100
 7243 0100 FFF7FEFF 		bl	cc2400_strobe
 7244              	.LVL798:
 7245              	.L769:
2523:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 7246              		.loc 1 2523 0 discriminator 1
 7247 0104 FFF7FEFF 		bl	cc2400_status
 7248              	.LVL799:
 7249 0108 4207     		lsls	r2, r0, #29
 7250 010a FBD4     		bmi	.L769
 7251 010c A5E7     		b	.L755
 7252              	.L776:
 7253              	.LBE74:
2524:bluetooth_rxtx.c **** 	}
2525:bluetooth_rxtx.c **** }
 7254              		.loc 1 2525 0
 7255 010e 04B0     		add	sp, sp, #16
 7256              		@ sp needed
 7257 0110 10BD     		pop	{r4, pc}
 7258              	.LVL800:
 7259              	.L778:
 7260 0112 00BF     		.align	2
 7261              	.L777:
 7262 0114 BC080000 		.word	.LANCHOR2+2236
 7263 0118 58C00920 		.word	537509976
 7264 011c 00000000 		.word	.LANCHOR0
 7265 0120 00000000 		.word	.LANCHOR1
 7266 0124 38C00920 		.word	537509944
 7267 0128 3CC00920 		.word	537509948
 7268 012c 00000000 		.word	clkn
 7269              		.cfi_endproc
 7270              	.LFE38:
ARM GAS  /tmp/cckWTbJW.s 			page 191


 7272              		.section	.text.startup.main,"ax",%progbits
 7273              		.align	1
 7274              		.global	main
 7275              		.thumb
 7276              		.thumb_func
 7278              	main:
 7279              	.LFB39:
2526:bluetooth_rxtx.c **** 
2527:bluetooth_rxtx.c **** int main()
2528:bluetooth_rxtx.c **** {
 7280              		.loc 1 2528 0
 7281              		.cfi_startproc
 7282              		@ args = 0, pretend = 0, frame = 0
 7283              		@ frame_needed = 0, uses_anonymous_args = 0
 7284 0000 10B5     		push	{r4, lr}
 7285              		.cfi_def_cfa_offset 8
 7286              		.cfi_offset 4, -8
 7287              		.cfi_offset 14, -4
2529:bluetooth_rxtx.c **** 	ubertooth_init();
 7288              		.loc 1 2529 0
 7289 0002 FFF7FEFF 		bl	ubertooth_init
 7290              	.LVL801:
2530:bluetooth_rxtx.c **** 	clkn_init();
 7291              		.loc 1 2530 0
 7292 0006 FFF7FEFF 		bl	clkn_init
 7293              	.LVL802:
2531:bluetooth_rxtx.c **** 	ubertooth_usb_init(vendor_request_handler);
 7294              		.loc 1 2531 0
 7295 000a 3E48     		ldr	r0, .L802
 7296 000c FFF7FEFF 		bl	ubertooth_usb_init
 7297              	.LVL803:
 7298              	.L801:
2532:bluetooth_rxtx.c **** 	cc2400_idle();
 7299              		.loc 1 2532 0
 7300 0010 FFF7FEFF 		bl	cc2400_idle
 7301              	.LVL804:
 7302              	.L780:
2533:bluetooth_rxtx.c **** 
2534:bluetooth_rxtx.c **** 	while (1) {
2535:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7303              		.loc 1 2535 0
 7304 0014 3C4B     		ldr	r3, .L802+4
2536:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 7305              		.loc 1 2536 0
 7306 0016 3D4C     		ldr	r4, .L802+8
2535:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 7307              		.loc 1 2535 0
 7308 0018 1868     		ldr	r0, [r3]
 7309 001a FFF7FEFF 		bl	handle_usb
 7310              	.LVL805:
 7311              		.loc 1 2536 0
 7312 001e A27C     		ldrb	r2, [r4, #18]	@ zero_extendqisi2
 7313 0020 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 7314 0022 9A42     		cmp	r2, r3
 7315 0024 F6D0     		beq	.L780
2537:bluetooth_rxtx.c **** 			switch (requested_mode) {
 7316              		.loc 1 2537 0
ARM GAS  /tmp/cckWTbJW.s 			page 192


 7317 0026 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 7318 0028 102B     		cmp	r3, #16
 7319 002a F3D8     		bhi	.L780
 7320 002c 01A2     		adr	r2, .L783
 7321 002e 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 7322 0032 00BF     		.p2align 2
 7323              	.L783:
 7324 0034 11000000 		.word	.L801+1
 7325 0038 89000000 		.word	.L784+1
 7326 003c 93000000 		.word	.L785+1
 7327 0040 B3000000 		.word	.L786+1
 7328 0044 DD000000 		.word	.L787+1
 7329 0048 C1000000 		.word	.L788+1
 7330 004c D1000000 		.word	.L789+1
 7331 0050 E3000000 		.word	.L790+1
 7332 0054 9D000000 		.word	.L791+1
 7333 0058 A1000000 		.word	.L792+1
 7334 005c A7000000 		.word	.L793+1
 7335 0060 79000000 		.word	.L794+1
 7336 0064 AD000000 		.word	.L795+1
 7337 0068 E9000000 		.word	.L796+1
 7338 006c 85000000 		.word	.L797+1
 7339 0070 F5000000 		.word	.L798+1
 7340 0074 FF000000 		.word	.L799+1
 7341              	.L794:
2538:bluetooth_rxtx.c **** 				case MODE_RESET:
2539:bluetooth_rxtx.c **** 					/* Allow time for the USB command to return correctly */
2540:bluetooth_rxtx.c **** 					wait(1);
 7342              		.loc 1 2540 0
 7343 0078 0120     		movs	r0, #1
 7344 007a FFF7FEFF 		bl	wait
 7345              	.LVL806:
2541:bluetooth_rxtx.c **** 					reset();
 7346              		.loc 1 2541 0
 7347 007e FFF7FEFF 		bl	reset
 7348              	.LVL807:
2542:bluetooth_rxtx.c **** 					break;
 7349              		.loc 1 2542 0
 7350 0082 C7E7     		b	.L780
 7351              	.L797:
2543:bluetooth_rxtx.c **** 				case MODE_AFH:
2544:bluetooth_rxtx.c **** 					mode = MODE_AFH;
 7352              		.loc 1 2544 0
 7353 0084 0E23     		movs	r3, #14
 7354 0086 00E0     		b	.L800
 7355              	.L784:
2545:bluetooth_rxtx.c **** 					bt_stream_rx();
2546:bluetooth_rxtx.c **** 					break;
2547:bluetooth_rxtx.c **** 				case MODE_RX_SYMBOLS:
2548:bluetooth_rxtx.c **** 					mode = MODE_RX_SYMBOLS;
 7356              		.loc 1 2548 0
 7357 0088 0123     		movs	r3, #1
 7358              	.L800:
 7359 008a 6374     		strb	r3, [r4, #17]
2549:bluetooth_rxtx.c **** 					bt_stream_rx();
 7360              		.loc 1 2549 0
 7361 008c FFF7FEFF 		bl	bt_stream_rx
ARM GAS  /tmp/cckWTbJW.s 			page 193


 7362              	.LVL808:
2550:bluetooth_rxtx.c **** 					break;
 7363              		.loc 1 2550 0
 7364 0090 C0E7     		b	.L780
 7365              	.L785:
2551:bluetooth_rxtx.c **** 				case MODE_TX_SYMBOLS:
2552:bluetooth_rxtx.c **** 					mode = MODE_TX_SYMBOLS;
 7366              		.loc 1 2552 0
 7367 0092 0223     		movs	r3, #2
 7368 0094 6374     		strb	r3, [r4, #17]
2553:bluetooth_rxtx.c **** 					br_transmit();
 7369              		.loc 1 2553 0
 7370 0096 FFF7FEFF 		bl	br_transmit
 7371              	.LVL809:
2554:bluetooth_rxtx.c **** 					break;
 7372              		.loc 1 2554 0
 7373 009a BBE7     		b	.L780
 7374              	.L791:
2555:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW:
2556:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW;
 7375              		.loc 1 2556 0
 7376 009c 0823     		movs	r3, #8
 7377 009e F4E7     		b	.L800
 7378              	.L792:
2557:bluetooth_rxtx.c **** 					bt_stream_rx();
2558:bluetooth_rxtx.c **** 					break;
2559:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW_LE:
2560:bluetooth_rxtx.c **** 					bt_follow_le();
 7379              		.loc 1 2560 0
 7380 00a0 FFF7FEFF 		bl	bt_follow_le
 7381              	.LVL810:
2561:bluetooth_rxtx.c **** 					break;
 7382              		.loc 1 2561 0
 7383 00a4 B6E7     		b	.L780
 7384              	.L793:
2562:bluetooth_rxtx.c **** 				case MODE_BT_PROMISC_LE:
2563:bluetooth_rxtx.c **** 					bt_promisc_le();
 7385              		.loc 1 2563 0
 7386 00a6 FFF7FEFF 		bl	bt_promisc_le
 7387              	.LVL811:
2564:bluetooth_rxtx.c **** 					break;
 7388              		.loc 1 2564 0
 7389 00aa B3E7     		b	.L780
 7390              	.L795:
2565:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE:
2566:bluetooth_rxtx.c **** 					bt_slave_le();
 7391              		.loc 1 2566 0
 7392 00ac FFF7FEFF 		bl	bt_slave_le
 7393              	.LVL812:
2567:bluetooth_rxtx.c **** 					break;
 7394              		.loc 1 2567 0
 7395 00b0 B0E7     		b	.L780
 7396              	.L786:
2568:bluetooth_rxtx.c **** 				case MODE_TX_TEST:
2569:bluetooth_rxtx.c **** 					mode = MODE_TX_TEST;
 7397              		.loc 1 2569 0
 7398 00b2 0323     		movs	r3, #3
ARM GAS  /tmp/cckWTbJW.s 			page 194


2570:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 7399              		.loc 1 2570 0
 7400 00b4 1548     		ldr	r0, .L802+8
 7401 00b6 1649     		ldr	r1, .L802+12
2569:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 7402              		.loc 1 2569 0
 7403 00b8 6374     		strb	r3, [r4, #17]
 7404              		.loc 1 2570 0
 7405 00ba FFF7FEFF 		bl	cc2400_txtest
 7406              	.LVL813:
2571:bluetooth_rxtx.c **** 					break;
 7407              		.loc 1 2571 0
 7408 00be A9E7     		b	.L780
 7409              	.L788:
2572:bluetooth_rxtx.c **** 				case MODE_RANGE_TEST:
2573:bluetooth_rxtx.c **** 					mode = MODE_RANGE_TEST;
 7410              		.loc 1 2573 0
 7411 00c0 0523     		movs	r3, #5
2574:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 7412              		.loc 1 2574 0
 7413 00c2 1348     		ldr	r0, .L802+12
2573:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 7414              		.loc 1 2573 0
 7415 00c4 6374     		strb	r3, [r4, #17]
 7416              		.loc 1 2574 0
 7417 00c6 FFF7FEFF 		bl	cc2400_rangetest
 7418              	.LVL814:
2575:bluetooth_rxtx.c **** 					requested_mode = MODE_IDLE;
 7419              		.loc 1 2575 0
 7420 00ca 0023     		movs	r3, #0
 7421 00cc A374     		strb	r3, [r4, #18]
2576:bluetooth_rxtx.c **** 					break;
 7422              		.loc 1 2576 0
 7423 00ce A1E7     		b	.L780
 7424              	.L789:
2577:bluetooth_rxtx.c **** 				case MODE_REPEATER:
2578:bluetooth_rxtx.c **** 					mode = MODE_REPEATER;
 7425              		.loc 1 2578 0
 7426 00d0 0623     		movs	r3, #6
2579:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 7427              		.loc 1 2579 0
 7428 00d2 0F48     		ldr	r0, .L802+12
2578:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 7429              		.loc 1 2578 0
 7430 00d4 6374     		strb	r3, [r4, #17]
 7431              		.loc 1 2579 0
 7432 00d6 FFF7FEFF 		bl	cc2400_repeater
 7433              	.LVL815:
2580:bluetooth_rxtx.c **** 					break;
 7434              		.loc 1 2580 0
 7435 00da 9BE7     		b	.L780
 7436              	.L787:
2581:bluetooth_rxtx.c **** 				case MODE_SPECAN:
2582:bluetooth_rxtx.c **** 					specan();
 7437              		.loc 1 2582 0
 7438 00dc FFF7FEFF 		bl	specan
 7439              	.LVL816:
ARM GAS  /tmp/cckWTbJW.s 			page 195


2583:bluetooth_rxtx.c **** 					break;
 7440              		.loc 1 2583 0
 7441 00e0 98E7     		b	.L780
 7442              	.L790:
2584:bluetooth_rxtx.c **** 				case MODE_LED_SPECAN:
2585:bluetooth_rxtx.c **** 					led_specan();
 7443              		.loc 1 2585 0
 7444 00e2 FFF7FEFF 		bl	led_specan
 7445              	.LVL817:
2586:bluetooth_rxtx.c **** 					break;
 7446              		.loc 1 2586 0
 7447 00e6 95E7     		b	.L780
 7448              	.L796:
2587:bluetooth_rxtx.c **** 				case MODE_EGO:
2588:bluetooth_rxtx.c **** 					mode = MODE_EGO;
 7449              		.loc 1 2588 0
 7450 00e8 0D23     		movs	r3, #13
 7451 00ea 6374     		strb	r3, [r4, #17]
2589:bluetooth_rxtx.c **** 					ego_main(ego_mode);
 7452              		.loc 1 2589 0
 7453 00ec 207D     		ldrb	r0, [r4, #20]	@ zero_extendqisi2
 7454 00ee FFF7FEFF 		bl	ego_main
 7455              	.LVL818:
2590:bluetooth_rxtx.c **** 					break;
 7456              		.loc 1 2590 0
 7457 00f2 8FE7     		b	.L780
 7458              	.L798:
2591:bluetooth_rxtx.c **** 				case MODE_RX_GENERIC:
2592:bluetooth_rxtx.c **** 					mode = MODE_RX_GENERIC;
 7459              		.loc 1 2592 0
 7460 00f4 0F23     		movs	r3, #15
 7461 00f6 6374     		strb	r3, [r4, #17]
2593:bluetooth_rxtx.c **** 					rx_generic();
 7462              		.loc 1 2593 0
 7463 00f8 FFF7FEFF 		bl	rx_generic
 7464              	.LVL819:
2594:bluetooth_rxtx.c **** 					break;
 7465              		.loc 1 2594 0
 7466 00fc 8AE7     		b	.L780
 7467              	.L799:
2595:bluetooth_rxtx.c **** 				case MODE_TX_GENERIC:
2596:bluetooth_rxtx.c **** 					tx_generic();
 7468              		.loc 1 2596 0
 7469 00fe FFF7FEFF 		bl	tx_generic
 7470              	.LVL820:
2597:bluetooth_rxtx.c **** 					break;
 7471              		.loc 1 2597 0
 7472 0102 87E7     		b	.L780
 7473              	.L803:
 7474              		.align	2
 7475              	.L802:
 7476 0104 00000000 		.word	vendor_request_handler
 7477 0108 00000000 		.word	clkn
 7478 010c 00000000 		.word	.LANCHOR0
 7479 0110 00000000 		.word	.LANCHOR1
 7480              		.cfi_endproc
 7481              	.LFE39:
ARM GAS  /tmp/cckWTbJW.s 			page 196


 7483              		.comm	unpacked,800,1
 7484              		.global	packet_cb
 7485              		.global	data_cb
 7486              		.global	le_jam_count
 7487              		.comm	le_promisc,264,4
 7488              		.global	le
 7489              		.global	slave_mac_address
 7490              		.comm	tx_pkt,58,2
 7491              		.global	rssi_threshold
 7492              		.global	high_freq
 7493              		.global	low_freq
 7494              		.global	modulation
 7495              		.global	ego_mode
 7496              		.global	jam_mode
 7497              		.global	requested_mode
 7498              		.global	mode
 7499              		.global	status
 7500              		.global	dma_discard
 7501              		.global	idle_buf_channel
 7502              		.global	idle_buf_clk100ns
 7503              		.global	idle_buf_clkn_high
 7504              		.global	le_adv_channel
 7505              		.global	requested_channel
 7506              		.global	hop_timeout
 7507              		.global	hop_direct_channel
 7508              		.global	channel
 7509              		.global	do_hop
 7510              		.global	hop_mode
 7511              		.global	compile_info
 7512              		.comm	rr,5,1
 7513              		.comm	used_channels,1,1
 7514              		.comm	afh_map,10,1
 7515              		.comm	afh_enabled,1,1
 7516              		.comm	syncword,8,8
 7517              		.comm	target,16,8
 7518              		.comm	clkn_next_drift_fix,4,4
 7519              		.comm	clkn_last_drift_fix,4,4
 7520              		.comm	clk_drift_correction,2,2
 7521              		.comm	clk_drift_ppm,2,2
 7522              		.comm	clk100ns_offset,2,2
 7523              		.comm	clkn_offset,4,4
 7524              		.comm	last_hop,4,4
 7525              		.comm	clkn,4,4
 7526              		.comm	rx_err,4,4
 7527              		.comm	rx_tc,4,4
 7528              		.comm	idle_rxbuf,4,4
 7529              		.comm	active_rxbuf,4,4
 7530              		.comm	rxbuf2,50,1
 7531              		.comm	rxbuf1,50,1
 7532              		.comm	cs_trigger,1,1
 7533              		.comm	cs_threshold_cur,1,1
 7534              		.comm	cs_threshold_req,1,1
 7535              		.comm	cs_no_squelch,1,1
 7536              		.comm	rssi_count,1,1
 7537              		.comm	rssi_min,1,1
 7538              		.comm	rssi_max,1,1
 7539              		.section	.rodata
ARM GAS  /tmp/cckWTbJW.s 			page 197


 7540              		.align	2
 7541              		.set	.LANCHOR2,. + 0
 7544              	whitening_index:
 7545 0000 46       		.byte	70
 7546 0001 3E       		.byte	62
 7547 0002 78       		.byte	120
 7548 0003 6F       		.byte	111
 7549 0004 4D       		.byte	77
 7550 0005 2E       		.byte	46
 7551 0006 0F       		.byte	15
 7552 0007 65       		.byte	101
 7553 0008 42       		.byte	66
 7554 0009 27       		.byte	39
 7555 000a 1F       		.byte	31
 7556 000b 1A       		.byte	26
 7557 000c 50       		.byte	80
 7558 000d 53       		.byte	83
 7559 000e 7D       		.byte	125
 7560 000f 59       		.byte	89
 7561 0010 0A       		.byte	10
 7562 0011 23       		.byte	35
 7563 0012 08       		.byte	8
 7564 0013 36       		.byte	54
 7565 0014 7A       		.byte	122
 7566 0015 11       		.byte	17
 7567 0016 21       		.byte	33
 7568 0017 00       		.byte	0
 7569 0018 3A       		.byte	58
 7570 0019 73       		.byte	115
 7571 001a 06       		.byte	6
 7572 001b 5E       		.byte	94
 7573 001c 56       		.byte	86
 7574 001d 31       		.byte	49
 7575 001e 34       		.byte	52
 7576 001f 14       		.byte	20
 7577 0020 28       		.byte	40
 7578 0021 1B       		.byte	27
 7579 0022 54       		.byte	84
 7580 0023 5A       		.byte	90
 7581 0024 3F       		.byte	63
 7582 0025 70       		.byte	112
 7583 0026 2F       		.byte	47
 7584 0027 66       		.byte	102
 7587              	whitening:
 7588 0028 01       		.byte	1
 7589 0029 01       		.byte	1
 7590 002a 01       		.byte	1
 7591 002b 01       		.byte	1
 7592 002c 00       		.byte	0
 7593 002d 01       		.byte	1
 7594 002e 00       		.byte	0
 7595 002f 01       		.byte	1
 7596 0030 00       		.byte	0
 7597 0031 01       		.byte	1
 7598 0032 00       		.byte	0
 7599 0033 00       		.byte	0
 7600 0034 00       		.byte	0
ARM GAS  /tmp/cckWTbJW.s 			page 198


 7601 0035 00       		.byte	0
 7602 0036 01       		.byte	1
 7603 0037 00       		.byte	0
 7604 0038 01       		.byte	1
 7605 0039 01       		.byte	1
 7606 003a 00       		.byte	0
 7607 003b 01       		.byte	1
 7608 003c 01       		.byte	1
 7609 003d 01       		.byte	1
 7610 003e 01       		.byte	1
 7611 003f 00       		.byte	0
 7612 0040 00       		.byte	0
 7613 0041 01       		.byte	1
 7614 0042 01       		.byte	1
 7615 0043 01       		.byte	1
 7616 0044 00       		.byte	0
 7617 0045 00       		.byte	0
 7618 0046 01       		.byte	1
 7619 0047 00       		.byte	0
 7620 0048 01       		.byte	1
 7621 0049 00       		.byte	0
 7622 004a 01       		.byte	1
 7623 004b 01       		.byte	1
 7624 004c 00       		.byte	0
 7625 004d 00       		.byte	0
 7626 004e 01       		.byte	1
 7627 004f 01       		.byte	1
 7628 0050 00       		.byte	0
 7629 0051 00       		.byte	0
 7630 0052 00       		.byte	0
 7631 0053 00       		.byte	0
 7632 0054 00       		.byte	0
 7633 0055 01       		.byte	1
 7634 0056 01       		.byte	1
 7635 0057 00       		.byte	0
 7636 0058 01       		.byte	1
 7637 0059 01       		.byte	1
 7638 005a 00       		.byte	0
 7639 005b 01       		.byte	1
 7640 005c 00       		.byte	0
 7641 005d 01       		.byte	1
 7642 005e 01       		.byte	1
 7643 005f 01       		.byte	1
 7644 0060 00       		.byte	0
 7645 0061 01       		.byte	1
 7646 0062 00       		.byte	0
 7647 0063 00       		.byte	0
 7648 0064 00       		.byte	0
 7649 0065 01       		.byte	1
 7650 0066 01       		.byte	1
 7651 0067 00       		.byte	0
 7652 0068 00       		.byte	0
 7653 0069 01       		.byte	1
 7654 006a 00       		.byte	0
 7655 006b 00       		.byte	0
 7656 006c 00       		.byte	0
 7657 006d 01       		.byte	1
ARM GAS  /tmp/cckWTbJW.s 			page 199


 7658 006e 00       		.byte	0
 7659 006f 00       		.byte	0
 7660 0070 00       		.byte	0
 7661 0071 00       		.byte	0
 7662 0072 00       		.byte	0
 7663 0073 00       		.byte	0
 7664 0074 01       		.byte	1
 7665 0075 00       		.byte	0
 7666 0076 00       		.byte	0
 7667 0077 01       		.byte	1
 7668 0078 00       		.byte	0
 7669 0079 00       		.byte	0
 7670 007a 01       		.byte	1
 7671 007b 01       		.byte	1
 7672 007c 00       		.byte	0
 7673 007d 01       		.byte	1
 7674 007e 00       		.byte	0
 7675 007f 00       		.byte	0
 7676 0080 01       		.byte	1
 7677 0081 01       		.byte	1
 7678 0082 01       		.byte	1
 7679 0083 01       		.byte	1
 7680 0084 00       		.byte	0
 7681 0085 01       		.byte	1
 7682 0086 01       		.byte	1
 7683 0087 01       		.byte	1
 7684 0088 00       		.byte	0
 7685 0089 00       		.byte	0
 7686 008a 00       		.byte	0
 7687 008b 00       		.byte	0
 7688 008c 01       		.byte	1
 7689 008d 01       		.byte	1
 7690 008e 01       		.byte	1
 7691 008f 01       		.byte	1
 7692 0090 01       		.byte	1
 7693 0091 01       		.byte	1
 7694 0092 01       		.byte	1
 7695 0093 00       		.byte	0
 7696 0094 00       		.byte	0
 7697 0095 00       		.byte	0
 7698 0096 01       		.byte	1
 7699 0097 01       		.byte	1
 7700 0098 01       		.byte	1
 7701 0099 00       		.byte	0
 7702 009a 01       		.byte	1
 7703 009b 01       		.byte	1
 7704 009c 00       		.byte	0
 7705 009d 00       		.byte	0
 7706 009e 00       		.byte	0
 7707 009f 01       		.byte	1
 7708 00a0 00       		.byte	0
 7709 00a1 01       		.byte	1
 7710 00a2 00       		.byte	0
 7711 00a3 00       		.byte	0
 7712 00a4 01       		.byte	1
 7713 00a5 00       		.byte	0
 7714 00a6 01       		.byte	1
ARM GAS  /tmp/cckWTbJW.s 			page 200


 7717              	compile_info:
 7718 00a7 75626572 		.ascii	"ubertooth 2017-03-R2 (mwnl@mwnl-lenovo) 2018. 05. 0"
 7718      746F6F74 
 7718      68203230 
 7718      31372D30 
 7718      332D5232 
 7719 00da 392E2028 		.ascii	"9. (\354\210\230) 10:24:16 KST\000"
 7719      EC889829 
 7719      2031303A 
 7719      32343A31 
 7719      36204B53 
 7722              	whitening_word:
 7723 00f0 40B2BCC3 		.word	-1011043776
 7724 00f4 1F374A5F 		.word	1598699295
 7725 00f8 85F69C9A 		.word	-1700989307
 7726 00fc C1D6C544 		.word	1153816257
 7727 0100 2059DEE1 		.word	-505521888
 7728 0104 8F1BA5AF 		.word	-1348134001
 7729 0108 427B4ECD 		.word	-850494654
 7730 010c 60EB6222 		.word	576908128
 7731 0110 902CEFF0 		.word	-252760944
 7732 0114 C78DD257 		.word	1473416647
 7733 0118 A13DA766 		.word	1722236321
 7734 011c B0753111 		.word	288454064
 7735 0120 8940B2BC 		.word	-1129168759
 7736 0124 C31F374A 		.word	1245126595
 7737 0128 5F85F69C 		.word	-1661565601
 7738 012c 9AC1D6C5 		.word	-975781478
 7739 0130 442059DE 		.word	-564584380
 7740 0134 E18F1BA5 		.word	-1524920351
 7741 0138 AF427B4E 		.word	1316700847
 7742 013c CD60EB62 		.word	1659592909
 7743 0140 22902CEF 		.word	-282292190
 7744 0144 F0C78DD2 		.word	-762460176
 7745 0148 57A13DA7 		.word	-1489133225
 7746 014c 66B07531 		.word	829796454
 7747 0150 D257A13D 		.word	1033983954
 7748 0154 A766B075 		.word	1974494887
 7749 0158 31114896 		.word	-1773661903
 7750 015c 77F8E346 		.word	1189345399
 7751 0160 E9ABD09E 		.word	-1630491671
 7752 0164 5333D8BA 		.word	-1160236205
 7753 0168 980824CB 		.word	-886830952
 7754 016c 3BFC71A3 		.word	-1552810949
 7755 0170 F45568CF 		.word	-815245836
 7756 0174 A9196C5D 		.word	1567365545
 7757 0178 4C0492E5 		.word	-443415476
 7758 017c 1DFEB851 		.word	1371078173
 7759 0180 1BA5AF42 		.word	1118807323
 7760 0184 7B4ECD60 		.word	1624067707
 7761 0188 EB622290 		.word	-1876794645
 7762 018c 2CEFF0C7 		.word	-940511444
 7763 0190 8DD257A1 		.word	-1588079987
 7764 0194 3DA766B0 		.word	-1335449795
 7765 0198 75311148 		.word	1209086325
 7766 019c 9677F8E3 		.word	-470255722
 7767 01a0 46E9ABD0 		.word	-794039994
ARM GAS  /tmp/cckWTbJW.s 			page 201


 7768 01a4 9E5333D8 		.word	-667724898
 7769 01a8 BA980824 		.word	604543162
 7770 01ac CB3BFC71 		.word	1912355787
 7771 01b0 6479873F 		.word	1065843044
 7772 01b4 6E94BE0A 		.word	180261998
 7773 01b8 ED393583 		.word	-2093663763
 7774 01bc AD8B8940 		.word	1082756013
 7775 01c0 B2BCC31F 		.word	532921522
 7776 01c4 374A5F85 		.word	-2057352649
 7777 01c8 F69C9AC1 		.word	-1046831882
 7778 01cc D6C54420 		.word	541378006
 7779 01d0 59DEE18F 		.word	-1881022887
 7780 01d4 1BA5AF42 		.word	1118807323
 7781 01d8 7B4ECD60 		.word	1624067707
 7782 01dc EB622290 		.word	-1876794645
 7783 01e0 AD8B8940 		.word	1082756013
 7784 01e4 B2BCC31F 		.word	532921522
 7785 01e8 374A5F85 		.word	-2057352649
 7786 01ec F69C9AC1 		.word	-1046831882
 7787 01f0 D6C54420 		.word	541378006
 7788 01f4 59DEE18F 		.word	-1881022887
 7789 01f8 1BA5AF42 		.word	1118807323
 7790 01fc 7B4ECD60 		.word	1624067707
 7791 0200 EB622290 		.word	-1876794645
 7792 0204 2CEFF0C7 		.word	-940511444
 7793 0208 8DD257A1 		.word	-1588079987
 7794 020c 3DA766B0 		.word	-1335449795
 7795 0210 F69C9AC1 		.word	-1046831882
 7796 0214 D6C54420 		.word	541378006
 7797 0218 59DEE18F 		.word	-1881022887
 7798 021c 1BA5AF42 		.word	1118807323
 7799 0220 7B4ECD60 		.word	1624067707
 7800 0224 EB622290 		.word	-1876794645
 7801 0228 2CEFF0C7 		.word	-940511444
 7802 022c 8DD257A1 		.word	-1588079987
 7803 0230 3DA766B0 		.word	-1335449795
 7804 0234 75311148 		.word	1209086325
 7805 0238 9677F8E3 		.word	-470255722
 7806 023c 46E9ABD0 		.word	-794039994
 7807 0240 3F6E94BE 		.word	-1097568705
 7808 0244 0AED3935 		.word	892988682
 7809 0248 83AD8B89 		.word	-1987334781
 7810 024c 40B2BCC3 		.word	-1011043776
 7811 0250 1F374A5F 		.word	1598699295
 7812 0254 85F69C9A 		.word	-1700989307
 7813 0258 C1D6C544 		.word	1153816257
 7814 025c 2059DEE1 		.word	-505521888
 7815 0260 8F1BA5AF 		.word	-1348134001
 7816 0264 427B4ECD 		.word	-850494654
 7817 0268 60EB6222 		.word	576908128
 7818 026c 902CEFF0 		.word	-252760944
 7819 0270 0824CB3B 		.word	1003168776
 7820 0274 FC71A3F4 		.word	-190615044
 7821 0278 5568CFA9 		.word	-1446025131
 7822 027c 196C5D4C 		.word	1281190937
 7823 0280 0492E51D 		.word	501584388
 7824 0284 FEB851FA 		.word	-95307522
ARM GAS  /tmp/cckWTbJW.s 			page 202


 7825 0288 2AB4E7D4 		.word	-723012566
 7826 028c 0CB62E26 		.word	640595468
 7827 0290 02C9F20E 		.word	250792194
 7828 0294 7FDC287D 		.word	2099829887
 7829 0298 15DA736A 		.word	1785977365
 7830 029c 065B1713 		.word	320297734
 7831 02a0 C1D6C544 		.word	1153816257
 7832 02a4 2059DEE1 		.word	-505521888
 7833 02a8 8F1BA5AF 		.word	-1348134001
 7834 02ac 427B4ECD 		.word	-850494654
 7835 02b0 60EB6222 		.word	576908128
 7836 02b4 902CEFF0 		.word	-252760944
 7837 02b8 C78DD257 		.word	1473416647
 7838 02bc A13DA766 		.word	1722236321
 7839 02c0 B0753111 		.word	288454064
 7840 02c4 489677F8 		.word	-126380472
 7841 02c8 E346E9AB 		.word	-1410775325
 7842 02cc D09E5333 		.word	861118160
 7843 02d0 9AC1D6C5 		.word	-975781478
 7844 02d4 442059DE 		.word	-564584380
 7845 02d8 E18F1BA5 		.word	-1524920351
 7846 02dc AF427B4E 		.word	1316700847
 7847 02e0 CD60EB62 		.word	1659592909
 7848 02e4 22902CEF 		.word	-282292190
 7849 02e8 F0C78DD2 		.word	-762460176
 7850 02ec 57A13DA7 		.word	-1489133225
 7851 02f0 66B07531 		.word	829796454
 7852 02f4 11489677 		.word	2006337553
 7853 02f8 F8E346E9 		.word	-381230088
 7854 02fc ABD09E53 		.word	1402917035
 7855 0300 5333D8BA 		.word	-1160236205
 7856 0304 980824CB 		.word	-886830952
 7857 0308 3BFC71A3 		.word	-1552810949
 7858 030c F45568CF 		.word	-815245836
 7859 0310 A9196C5D 		.word	1567365545
 7860 0314 4C0492E5 		.word	-443415476
 7861 0318 1DFEB851 		.word	1371078173
 7862 031c FA2AB4E7 		.word	-407622918
 7863 0320 D40CB62E 		.word	783682772
 7864 0324 2602C9F2 		.word	-221707738
 7865 0328 0E7FDC28 		.word	685539086
 7866 032c 7D15DA73 		.word	1943672189
 7867 0330 2CEFF0C7 		.word	-940511444
 7868 0334 8DD257A1 		.word	-1588079987
 7869 0338 3DA766B0 		.word	-1335449795
 7870 033c 75311148 		.word	1209086325
 7871 0340 9677F8E3 		.word	-470255722
 7872 0344 46E9ABD0 		.word	-794039994
 7873 0348 9E5333D8 		.word	-667724898
 7874 034c BA980824 		.word	604543162
 7875 0350 CB3BFC71 		.word	1912355787
 7876 0354 A3F45568 		.word	1750463651
 7877 0358 CFA9196C 		.word	1813621199
 7878 035c 5D4C0492 		.word	-1845212067
 7879 0360 E51DFEB8 		.word	-1191305755
 7880 0364 51FA2AB4 		.word	-1272251823
 7881 0368 E7D40CB6 		.word	-1240673049
ARM GAS  /tmp/cckWTbJW.s 			page 203


 7882 036c 2E2602C9 		.word	-922606034
 7883 0370 F20E7FDC 		.word	-595652878
 7884 0374 287D15DA 		.word	-636125912
 7885 0378 736A065B 		.word	1527147123
 7886 037c 17138164 		.word	1686180631
 7887 0380 79873F6E 		.word	1849657209
 7888 0384 94BE0AED 		.word	-318062956
 7889 0388 393583AD 		.word	-1383910087
 7890 038c 8B8940B2 		.word	-1304393333
 7891 0390 BE0AED39 		.word	971836094
 7892 0394 3583AD8B 		.word	-1951562955
 7893 0398 8940B2BC 		.word	-1129168759
 7894 039c C31F374A 		.word	1245126595
 7895 03a0 5F85F69C 		.word	-1661565601
 7896 03a4 9AC1D6C5 		.word	-975781478
 7897 03a8 442059DE 		.word	-564584380
 7898 03ac E18F1BA5 		.word	-1524920351
 7899 03b0 AF427B4E 		.word	1316700847
 7900 03b4 CD60EB62 		.word	1659592909
 7901 03b8 22902CEF 		.word	-282292190
 7902 03bc F0C78DD2 		.word	-762460176
 7903 03c0 77F8E346 		.word	1189345399
 7904 03c4 E9ABD09E 		.word	-1630491671
 7905 03c8 5333D8BA 		.word	-1160236205
 7906 03cc 980824CB 		.word	-886830952
 7907 03d0 3BFC71A3 		.word	-1552810949
 7908 03d4 F45568CF 		.word	-815245836
 7909 03d8 A9196C5D 		.word	1567365545
 7910 03dc 4C0492E5 		.word	-443415476
 7911 03e0 1DFEB851 		.word	1371078173
 7912 03e4 FA2AB4E7 		.word	-407622918
 7913 03e8 D40CB62E 		.word	783682772
 7914 03ec 2602C9F2 		.word	-221707738
 7915 03f0 D09E5333 		.word	861118160
 7916 03f4 D8BA9808 		.word	144227032
 7917 03f8 24CB3BFC 		.word	-63190236
 7918 03fc 71A3F455 		.word	1442095985
 7919 0400 68CFA919 		.word	430559080
 7920 0404 6C5D4C04 		.word	72113516
 7921 0408 92E51DFE 		.word	-31595118
 7922 040c B851FA2A 		.word	721047992
 7923 0410 B4E7D40C 		.word	215279540
 7924 0414 B62E2602 		.word	36056758
 7925 0418 C9F20E7F 		.word	2131686089
 7926 041c DC287D15 		.word	360523996
 7927 0420 196C5D4C 		.word	1281190937
 7928 0424 0492E51D 		.word	501584388
 7929 0428 FEB851FA 		.word	-95307522
 7930 042c 2AB4E7D4 		.word	-723012566
 7931 0430 0CB62E26 		.word	640595468
 7932 0434 02C9F20E 		.word	250792194
 7933 0438 7FDC287D 		.word	2099829887
 7934 043c 15DA736A 		.word	1785977365
 7935 0440 065B1713 		.word	320297734
 7936 0444 81647987 		.word	-2022087551
 7937 0448 3F6E94BE 		.word	-1097568705
 7938 044c 0AED3935 		.word	892988682
ARM GAS  /tmp/cckWTbJW.s 			page 204


 7939 0450 427B4ECD 		.word	-850494654
 7940 0454 60EB6222 		.word	576908128
 7941 0458 902CEFF0 		.word	-252760944
 7942 045c C78DD257 		.word	1473416647
 7943 0460 A13DA766 		.word	1722236321
 7944 0464 B0753111 		.word	288454064
 7945 0468 489677F8 		.word	-126380472
 7946 046c E346E9AB 		.word	-1410775325
 7947 0470 D09E5333 		.word	861118160
 7948 0474 D8BA9808 		.word	144227032
 7949 0478 24CB3BFC 		.word	-63190236
 7950 047c 71A3F455 		.word	1442095985
 7951 0480 8B8940B2 		.word	-1304393333
 7952 0484 BCC31F37 		.word	924828604
 7953 0488 4A5F85F6 		.word	-159031478
 7954 048c 9C9AC1D6 		.word	-691955044
 7955 0490 C5442059 		.word	1495286981
 7956 0494 DEE18F1B 		.word	462414302
 7957 0498 A5AF427B 		.word	2067967909
 7958 049c 4ECD60EB 		.word	-345977522
 7959 04a0 6222902C 		.word	747643490
 7960 04a4 EFF0C78D 		.word	-1916276497
 7961 04a8 D257A13D 		.word	1033983954
 7962 04ac A766B075 		.word	1974494887
 7963 04b0 F45568CF 		.word	-815245836
 7964 04b4 A9196C5D 		.word	1567365545
 7965 04b8 4C0492E5 		.word	-443415476
 7966 04bc 1DFEB851 		.word	1371078173
 7967 04c0 FA2AB4E7 		.word	-407622918
 7968 04c4 D40CB62E 		.word	783682772
 7969 04c8 2602C9F2 		.word	-221707738
 7970 04cc 0E7FDC28 		.word	685539086
 7971 04d0 7D15DA73 		.word	1943672189
 7972 04d4 6A065B17 		.word	391841386
 7973 04d8 13816479 		.word	2036629779
 7974 04dc 873F6E94 		.word	-1804714105
 7975 04e0 3DA766B0 		.word	-1335449795
 7976 04e4 75311148 		.word	1209086325
 7977 04e8 9677F8E3 		.word	-470255722
 7978 04ec 46E9ABD0 		.word	-794039994
 7979 04f0 9E5333D8 		.word	-667724898
 7980 04f4 BA980824 		.word	604543162
 7981 04f8 CB3BFC71 		.word	1912355787
 7982 04fc A3F45568 		.word	1750463651
 7983 0500 CFA9196C 		.word	1813621199
 7984 0504 5D4C0492 		.word	-1845212067
 7985 0508 E51DFEB8 		.word	-1191305755
 7986 050c 51FA2AB4 		.word	-1272251823
 7987 0510 66B07531 		.word	829796454
 7988 0514 11489677 		.word	2006337553
 7989 0518 F8E346E9 		.word	-381230088
 7990 051c ABD09E53 		.word	1402917035
 7991 0520 33D8BA98 		.word	-1732585421
 7992 0524 0824CB3B 		.word	1003168776
 7993 0528 FC71A3F4 		.word	-190615044
 7994 052c 5568CFA9 		.word	-1446025131
 7995 0530 196C5D4C 		.word	1281190937
ARM GAS  /tmp/cckWTbJW.s 			page 205


 7996 0534 0492E51D 		.word	501584388
 7997 0538 FEB851FA 		.word	-95307522
 7998 053c 2AB4E7D4 		.word	-723012566
 7999 0540 AF427B4E 		.word	1316700847
 8000 0544 CD60EB62 		.word	1659592909
 8001 0548 22902CEF 		.word	-282292190
 8002 054c F0C78DD2 		.word	-762460176
 8003 0550 57A13DA7 		.word	-1489133225
 8004 0554 66B07531 		.word	829796454
 8005 0558 11489677 		.word	2006337553
 8006 055c F8E346E9 		.word	-381230088
 8007 0560 ABD09E53 		.word	1402917035
 8008 0564 33D8BA98 		.word	-1732585421
 8009 0568 0824CB3B 		.word	1003168776
 8010 056c FC71A3F4 		.word	-190615044
 8011 0570 980824CB 		.word	-886830952
 8012 0574 3BFC71A3 		.word	-1552810949
 8013 0578 F45568CF 		.word	-815245836
 8014 057c A9196C5D 		.word	1567365545
 8015 0580 4C0492E5 		.word	-443415476
 8016 0584 1DFEB851 		.word	1371078173
 8017 0588 FA2AB4E7 		.word	-407622918
 8018 058c D40CB62E 		.word	783682772
 8019 0590 2602C9F2 		.word	-221707738
 8020 0594 0E7FDC28 		.word	685539086
 8021 0598 7D15DA73 		.word	1943672189
 8022 059c 6A065B17 		.word	391841386
 8023 05a0 51FA2AB4 		.word	-1272251823
 8024 05a4 E7D40CB6 		.word	-1240673049
 8025 05a8 2E2602C9 		.word	-922606034
 8026 05ac F20E7FDC 		.word	-595652878
 8027 05b0 287D15DA 		.word	-636125912
 8028 05b4 736A065B 		.word	1527147123
 8029 05b8 17138164 		.word	1686180631
 8030 05bc 79873F6E 		.word	1849657209
 8031 05c0 94BE0AED 		.word	-318062956
 8032 05c4 393583AD 		.word	-1383910087
 8033 05c8 8B8940B2 		.word	-1304393333
 8034 05cc BCC31F37 		.word	924828604
 8035 05d0 0AED3935 		.word	892988682
 8036 05d4 83AD8B89 		.word	-1987334781
 8037 05d8 40B2BCC3 		.word	-1011043776
 8038 05dc 1F374A5F 		.word	1598699295
 8039 05e0 85F69C9A 		.word	-1700989307
 8040 05e4 C1D6C544 		.word	1153816257
 8041 05e8 2059DEE1 		.word	-505521888
 8042 05ec 8F1BA5AF 		.word	-1348134001
 8043 05f0 427B4ECD 		.word	-850494654
 8044 05f4 60EB6222 		.word	576908128
 8045 05f8 902CEFF0 		.word	-252760944
 8046 05fc C78DD257 		.word	1473416647
 8047 0600 C31F374A 		.word	1245126595
 8048 0604 5F85F69C 		.word	-1661565601
 8049 0608 9AC1D6C5 		.word	-975781478
 8050 060c 442059DE 		.word	-564584380
 8051 0610 E18F1BA5 		.word	-1524920351
 8052 0614 AF427B4E 		.word	1316700847
ARM GAS  /tmp/cckWTbJW.s 			page 206


 8053 0618 CD60EB62 		.word	1659592909
 8054 061c 22902CEF 		.word	-282292190
 8055 0620 F0C78DD2 		.word	-762460176
 8056 0624 57A13DA7 		.word	-1489133225
 8057 0628 66B07531 		.word	829796454
 8058 062c 11489677 		.word	2006337553
 8059 0630 BCC31F37 		.word	924828604
 8060 0634 4A5F85F6 		.word	-159031478
 8061 0638 9C9AC1D6 		.word	-691955044
 8062 063c C5442059 		.word	1495286981
 8063 0640 DEE18F1B 		.word	462414302
 8064 0644 A5AF427B 		.word	2067967909
 8065 0648 4ECD60EB 		.word	-345977522
 8066 064c 6222902C 		.word	747643490
 8067 0650 EFF0C78D 		.word	-1916276497
 8068 0654 D257A13D 		.word	1033983954
 8069 0658 A766B075 		.word	1974494887
 8070 065c 31114896 		.word	-1773661903
 8071 0660 75311148 		.word	1209086325
 8072 0664 9677F8E3 		.word	-470255722
 8073 0668 46E9ABD0 		.word	-794039994
 8074 066c 9E5333D8 		.word	-667724898
 8075 0670 BA980824 		.word	604543162
 8076 0674 CB3BFC71 		.word	1912355787
 8077 0678 A3F45568 		.word	1750463651
 8078 067c CFA9196C 		.word	1813621199
 8079 0680 5D4C0492 		.word	-1845212067
 8080 0684 E51DFEB8 		.word	-1191305755
 8081 0688 51FA2AB4 		.word	-1272251823
 8082 068c E7D40CB6 		.word	-1240673049
 8083 0690 2E2602C9 		.word	-922606034
 8084 0694 F20E7FDC 		.word	-595652878
 8085 0698 287D15DA 		.word	-636125912
 8086 069c 736A065B 		.word	1527147123
 8087 06a0 17138164 		.word	1686180631
 8088 06a4 79873F6E 		.word	1849657209
 8089 06a8 94BE0AED 		.word	-318062956
 8090 06ac 393583AD 		.word	-1383910087
 8091 06b0 8B8940B2 		.word	-1304393333
 8092 06b4 BCC31F37 		.word	924828604
 8093 06b8 4A5F85F6 		.word	-159031478
 8094 06bc 9C9AC1D6 		.word	-691955044
 8095 06c0 E7D40CB6 		.word	-1240673049
 8096 06c4 2E2602C9 		.word	-922606034
 8097 06c8 F20E7FDC 		.word	-595652878
 8098 06cc 287D15DA 		.word	-636125912
 8099 06d0 736A065B 		.word	1527147123
 8100 06d4 17138164 		.word	1686180631
 8101 06d8 79873F6E 		.word	1849657209
 8102 06dc 94BE0AED 		.word	-318062956
 8103 06e0 393583AD 		.word	-1383910087
 8104 06e4 8B8940B2 		.word	-1304393333
 8105 06e8 BCC31F37 		.word	924828604
 8106 06ec 4A5F85F6 		.word	-159031478
 8107 06f0 60EB6222 		.word	576908128
 8108 06f4 902CEFF0 		.word	-252760944
 8109 06f8 C78DD257 		.word	1473416647
ARM GAS  /tmp/cckWTbJW.s 			page 207


 8110 06fc A13DA766 		.word	1722236321
 8111 0700 B0753111 		.word	288454064
 8112 0704 489677F8 		.word	-126380472
 8113 0708 E346E9AB 		.word	-1410775325
 8114 070c D09E5333 		.word	861118160
 8115 0710 D8BA9808 		.word	144227032
 8116 0714 24CB3BFC 		.word	-63190236
 8117 0718 71A3F455 		.word	1442095985
 8118 071c 68CFA919 		.word	430559080
 8119 0720 A9196C5D 		.word	1567365545
 8120 0724 4C0492E5 		.word	-443415476
 8121 0728 1DFEB851 		.word	1371078173
 8122 072c FA2AB4E7 		.word	-407622918
 8123 0730 D40CB62E 		.word	783682772
 8124 0734 2602C9F2 		.word	-221707738
 8125 0738 0E7FDC28 		.word	685539086
 8126 073c 7D15DA73 		.word	1943672189
 8127 0740 6A065B17 		.word	391841386
 8128 0744 13816479 		.word	2036629779
 8129 0748 873F6E94 		.word	-1804714105
 8130 074c BE0AED39 		.word	971836094
 8131 0750 F20E7FDC 		.word	-595652878
 8132 0754 287D15DA 		.word	-636125912
 8133 0758 736A065B 		.word	1527147123
 8134 075c 17138164 		.word	1686180631
 8135 0760 79873F6E 		.word	1849657209
 8136 0764 94BE0AED 		.word	-318062956
 8137 0768 393583AD 		.word	-1383910087
 8138 076c 8B8940B2 		.word	-1304393333
 8139 0770 BCC31F37 		.word	924828604
 8140 0774 4A5F85F6 		.word	-159031478
 8141 0778 9C9AC1D6 		.word	-691955044
 8142 077c C5442059 		.word	1495286981
 8143 0780 3BFC71A3 		.word	-1552810949
 8144 0784 F45568CF 		.word	-815245836
 8145 0788 A9196C5D 		.word	1567365545
 8146 078c 4C0492E5 		.word	-443415476
 8147 0790 1DFEB851 		.word	1371078173
 8148 0794 FA2AB4E7 		.word	-407622918
 8149 0798 D40CB62E 		.word	783682772
 8150 079c 2602C9F2 		.word	-221707738
 8151 07a0 0E7FDC28 		.word	685539086
 8152 07a4 7D15DA73 		.word	1943672189
 8153 07a8 6A065B17 		.word	391841386
 8154 07ac 13816479 		.word	2036629779
 8155 07b0 442059DE 		.word	-564584380
 8156 07b4 E18F1BA5 		.word	-1524920351
 8157 07b8 AF427B4E 		.word	1316700847
 8158 07bc CD60EB62 		.word	1659592909
 8159 07c0 22902CEF 		.word	-282292190
 8160 07c4 F0C78DD2 		.word	-762460176
 8161 07c8 57A13DA7 		.word	-1489133225
 8162 07cc 66B07531 		.word	829796454
 8163 07d0 11489677 		.word	2006337553
 8164 07d4 F8E346E9 		.word	-381230088
 8165 07d8 ABD09E53 		.word	1402917035
 8166 07dc 33D8BA98 		.word	-1732585421
ARM GAS  /tmp/cckWTbJW.s 			page 208


 8167 07e0 8DD257A1 		.word	-1588079987
 8168 07e4 3DA766B0 		.word	-1335449795
 8169 07e8 75311148 		.word	1209086325
 8170 07ec 9677F8E3 		.word	-470255722
 8171 07f0 46E9ABD0 		.word	-794039994
 8172 07f4 9E5333D8 		.word	-667724898
 8173 07f8 BA980824 		.word	604543162
 8174 07fc CB3BFC71 		.word	1912355787
 8175 0800 A3F45568 		.word	1750463651
 8176 0804 CFA9196C 		.word	1813621199
 8177 0808 5D4C0492 		.word	-1845212067
 8178 080c E51DFEB8 		.word	-1191305755
 8179 0810 D6C54420 		.word	541378006
 8180 0814 59DEE18F 		.word	-1881022887
 8181 0818 1BA5AF42 		.word	1118807323
 8182 081c 7B4ECD60 		.word	1624067707
 8183 0820 EB622290 		.word	-1876794645
 8184 0824 2CEFF0C7 		.word	-940511444
 8185 0828 8DD257A1 		.word	-1588079987
 8186 082c 3DA766B0 		.word	-1335449795
 8187 0830 75311148 		.word	1209086325
 8188 0834 9677F8E3 		.word	-470255722
 8189 0838 46E9ABD0 		.word	-794039994
 8190 083c 9E5333D8 		.word	-667724898
 8191 0840 1F374A5F 		.word	1598699295
 8192 0844 85F69C9A 		.word	-1700989307
 8193 0848 C1D6C544 		.word	1153816257
 8194 084c 2059DEE1 		.word	-505521888
 8195 0850 8F1BA5AF 		.word	-1348134001
 8196 0854 427B4ECD 		.word	-850494654
 8197 0858 60EB6222 		.word	576908128
 8198 085c 902CEFF0 		.word	-252760944
 8199 0860 C78DD257 		.word	1473416647
 8200 0864 A13DA766 		.word	1722236321
 8201 0868 B0753111 		.word	288454064
 8202 086c 489677F8 		.word	-126380472
 8205              	hop_interval_lut:
 8206 0870 00       		.byte	0
 8207 0871 01       		.byte	1
 8208 0872 13       		.byte	19
 8209 0873 19       		.byte	25
 8210 0874 1C       		.byte	28
 8211 0875 0F       		.byte	15
 8212 0876 1F       		.byte	31
 8213 0877 10       		.byte	16
 8214 0878 0E       		.byte	14
 8215 0879 21       		.byte	33
 8216 087a 1A       		.byte	26
 8217 087b 1B       		.byte	27
 8218 087c 22       		.byte	34
 8219 087d 14       		.byte	20
 8220 087e 08       		.byte	8
 8221 087f 05       		.byte	5
 8222 0880 07       		.byte	7
 8223 0881 18       		.byte	24
 8224 0882 23       		.byte	35
 8225 0883 02       		.byte	2
ARM GAS  /tmp/cckWTbJW.s 			page 209


 8226 0884 0D       		.byte	13
 8227 0885 1E       		.byte	30
 8228 0886 20       		.byte	32
 8229 0887 1D       		.byte	29
 8230 0888 11       		.byte	17
 8231 0889 03       		.byte	3
 8232 088a 0A       		.byte	10
 8233 088b 0B       		.byte	11
 8234 088c 04       		.byte	4
 8235 088d 17       		.byte	23
 8236 088e 15       		.byte	21
 8237 088f 06       		.byte	6
 8238 0890 16       		.byte	22
 8239 0891 09       		.byte	9
 8240 0892 0C       		.byte	12
 8241 0893 12       		.byte	18
 8242 0894 24       		.byte	36
 8243 0895 000000   		.space	3
 8244              	.LC0:
 8245 0898 01000000 		.word	1
 8246 089c 01000000 		.word	1
 8247 08a0 01000000 		.word	1
 8248 08a4 01000000 		.word	1
 8249              	.LC1:
 8250 08a8 00       		.byte	0
 8251 08a9 0F       		.byte	15
 8252 08aa FF       		.byte	-1
 8253 08ab FF       		.byte	-1
 8254 08ac FF       		.byte	-1
 8255 08ad FF       		.byte	-1
 8256 08ae FF       		.byte	-1
 8257 08af FF       		.byte	-1
 8258 08b0 05       		.byte	5
 8259 08b1 01       		.byte	1
 8260 08b2 06       		.byte	6
 8261 08b3 13       		.byte	19
 8262 08b4 13       		.byte	19
 8263 08b5 13       		.byte	19
 8264 08b6 13       		.byte	19
 8265 08b7 13       		.byte	19
 8266 08b8 13       		.byte	19
 8267 08b9 FF       		.byte	-1
 8268 08ba FF       		.byte	-1
 8269 08bb FF       		.byte	-1
 8270              	.LC2:
 8271 08bc 6C09     		.short	2412
 8272 08be 8509     		.short	2437
 8273 08c0 9E09     		.short	2462
 8274 08c2 0000     		.section	.rodata.str1.1,"aMS",%progbits,1
 8275              	.LC3:
 8276 0000 32303137 		.ascii	"2017-03-R2\000"
 8276      2D30332D 
 8276      523200
 8277              		.data
 8278              		.align	2
 8279              		.set	.LANCHOR1,. + 0
 8282              	channel:
ARM GAS  /tmp/cckWTbJW.s 			page 210


 8283 0000 8909     		.short	2441
 8284 0002 0000     		.space	2
 8287              	le:
 8288 0004 D6BE898E 		.word	-1903575338
 8289 0008 7D6B     		.short	27517
 8290 000a 7191     		.short	-28303
 8291 000c 55555500 		.word	5592405
 8292 0010 AAAAAA00 		.word	11184810
 8293 0014 00000000 		.word	0
 8294 0018 00       		.byte	0
 8295 0019 000000   		.space	3
 8296 001c 00000000 		.word	0
 8297 0020 00000000 		.space	32
 8297      00000000 
 8297      00000000 
 8297      00000000 
 8297      00000000 
 8298 0040 00000000 		.word	0
 8299 0044 00000000 		.word	0
 8302              	hop_timeout:
 8303 0048 9E00     		.short	158
 8306              	le_adv_channel:
 8307 004a 6209     		.short	2402
 8310              	low_freq:
 8311 004c 6009     		.short	2400
 8314              	high_freq:
 8315 004e B309     		.short	2483
 8318              	rssi_threshold:
 8319 0050 E2       		.byte	-30
 8320 0051 000000   		.bss
 8321              		.align	2
 8322              		.set	.LANCHOR0,. + 0
 8325              	modulation:
 8326 0000 00       		.space	1
 8329              	status:
 8330 0001 00       		.space	1
 8333              	idle_buf_clkn_high:
 8334 0002 00       		.space	1
 8335 0003 00       		.space	1
 8338              	idle_buf_clk100ns:
 8339 0004 00000000 		.space	4
 8342              	idle_buf_channel:
 8343 0008 0000     		.space	2
 8346              	hop_mode:
 8347 000a 00       		.space	1
 8350              	do_hop:
 8351 000b 00       		.space	1
 8354              	hop_direct_channel:
 8355 000c 0000     		.space	2
 8358              	requested_channel:
 8359 000e 0000     		.space	2
 8362              	dma_discard:
 8363 0010 00       		.space	1
 8366              	mode:
 8367 0011 00       		.space	1
 8370              	requested_mode:
 8371 0012 00       		.space	1
ARM GAS  /tmp/cckWTbJW.s 			page 211


 8374              	jam_mode:
 8375 0013 00       		.space	1
 8378              	ego_mode:
 8379 0014 00       		.space	1
 8380 0015 000000   		.space	3
 8383              	packet_cb:
 8384 0018 00000000 		.space	4
 8387              	le_jam_count:
 8388 001c 00000000 		.space	4
 8391              	slave_mac_address:
 8392 0020 00000000 		.space	6
 8392      0000
 8393 0026 0000     		.space	2
 8396              	data_cb:
 8397 0028 00000000 		.space	4
 8400              	restart_jamming.4766:
 8401 002c 00000000 		.space	4
 8404              	first_ts.4863:
 8405 0030 00000000 		.space	4
 8408              	prev_clk.4869:
 8409 0034 00000000 		.space	4
 8410              		.text
 8411              	.Letext0:
 8412              		.file 2 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stddef.h"
 8413              		.file 3 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stdint-gcc.h"
 8414              		.file 4 "../../host/libubertooth/src/ubertooth_interface.h"
 8415              		.file 5 "../common/ubertooth.h"
 8416              		.file 6 "ubertooth_usb.h"
 8417              		.file 7 "bluetooth_le.h"
 8418              		.file 8 "ego.h"
 8419              		.file 9 "ubertooth_rssi.h"
 8420              		.file 10 "ubertooth_cs.h"
 8421              		.file 11 "ubertooth_dma.h"
 8422              		.file 12 "ubertooth_clock.h"
 8423              		.file 13 "bluetooth.h"
 8424              		.file 14 "cc2400_rangetest.h"
 8425              		.file 15 "/usr/include/newlib/string.h"
ARM GAS  /tmp/cckWTbJW.s 			page 212


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_rxtx.c
     /tmp/cckWTbJW.s:19     .text.reverse8:0000000000000000 $t
     /tmp/cckWTbJW.s:23     .text.reverse8:0000000000000000 reverse8
     /tmp/cckWTbJW.s:72     .text.cc2400_rx:0000000000000000 $t
     /tmp/cckWTbJW.s:76     .text.cc2400_rx:0000000000000000 cc2400_rx
     /tmp/cckWTbJW.s:189    .text.cc2400_rx:0000000000000098 $d
     /tmp/cckWTbJW.s:196    .text.cc2400_rx_sync:0000000000000000 $t
     /tmp/cckWTbJW.s:200    .text.cc2400_rx_sync:0000000000000000 cc2400_rx_sync
     /tmp/cckWTbJW.s:325    .text.cc2400_rx_sync:00000000000000a4 $d
     /tmp/cckWTbJW.s:332    .text.enqueue:0000000000000000 $t
     /tmp/cckWTbJW.s:336    .text.enqueue:0000000000000000 enqueue
     /tmp/cckWTbJW.s:446    .text.enqueue:0000000000000084 $d
                            *COM*:0000000000000004 clkn
                            *COM*:0000000000000001 rssi_min
                            *COM*:0000000000000001 rssi_max
                            *COM*:0000000000000001 rssi_count
     /tmp/cckWTbJW.s:456    .text.le_set_access_address:0000000000000000 $t
     /tmp/cckWTbJW.s:460    .text.le_set_access_address:0000000000000000 le_set_access_address
     /tmp/cckWTbJW.s:487    .text.le_set_access_address:0000000000000014 $d
     /tmp/cckWTbJW.s:492    .text.cc2400_idle:0000000000000000 $t
     /tmp/cckWTbJW.s:496    .text.cc2400_idle:0000000000000000 cc2400_idle
     /tmp/cckWTbJW.s:610    .text.cc2400_idle:000000000000009c $d
                            *COM*:0000000000000010 target
     /tmp/cckWTbJW.s:618    .text.cb_follow_le:0000000000000000 $t
     /tmp/cckWTbJW.s:623    .text.cb_follow_le:0000000000000000 cb_follow_le
     /tmp/cckWTbJW.s:837    .text.cb_follow_le:00000000000000ec $d
                            *COM*:0000000000000320 unpacked
                            *COM*:0000000000000004 idle_rxbuf
     /tmp/cckWTbJW.s:847    .text.connection_follow_cb:0000000000000000 $t
     /tmp/cckWTbJW.s:852    .text.connection_follow_cb:0000000000000000 connection_follow_cb
     /tmp/cckWTbJW.s:1123   .text.connection_follow_cb:0000000000000164 $d
     /tmp/cckWTbJW.s:1133   .text.vendor_request_handler:0000000000000000 $t
     /tmp/cckWTbJW.s:1137   .text.vendor_request_handler:0000000000000000 vendor_request_handler
     /tmp/cckWTbJW.s:1163   .text.vendor_request_handler:0000000000000014 $d
     /tmp/cckWTbJW.s:1234   .text.vendor_request_handler:00000000000000a0 $t
     /tmp/cckWTbJW.s:1757   .text.vendor_request_handler:0000000000000334 $d
                            *COM*:0000000000000005 rr
                            *COM*:0000000000000001 cs_threshold_req
     /tmp/cckWTbJW.s:1775   .text.vendor_request_handler:0000000000000370 $t
     /tmp/cckWTbJW.s:2358   .text.vendor_request_handler:0000000000000618 $d
                            *COM*:0000000000000004 clkn_offset
                            *COM*:0000000000000002 clk100ns_offset
                            *COM*:000000000000000a afh_map
                            *COM*:0000000000000001 used_channels
                            *COM*:0000000000000001 afh_enabled
                            *COM*:0000000000000002 clk_drift_ppm
                            *COM*:0000000000000004 clkn_next_drift_fix
                            *COM*:0000000000000002 clk_drift_correction
                            *COM*:0000000000000004 clkn_last_drift_fix
                            *COM*:000000000000003a tx_pkt
     /tmp/cckWTbJW.s:2376   .text.enqueue_with_ts:0000000000000000 $t
     /tmp/cckWTbJW.s:2381   .text.enqueue_with_ts:0000000000000000 enqueue_with_ts
     /tmp/cckWTbJW.s:2457   .text.enqueue_with_ts:0000000000000050 $d
     /tmp/cckWTbJW.s:2463   .text.TIMER0_IRQHandler:0000000000000000 $t
     /tmp/cckWTbJW.s:2468   .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/cckWTbJW.s:2667   .text.TIMER0_IRQHandler:0000000000000110 $d
ARM GAS  /tmp/cckWTbJW.s 			page 213


                            *COM*:0000000000000004 last_hop
     /tmp/cckWTbJW.s:2684   .text.EINT3_IRQHandler:0000000000000000 $t
     /tmp/cckWTbJW.s:2689   .text.EINT3_IRQHandler:0000000000000000 EINT3_IRQHandler
     /tmp/cckWTbJW.s:2720   .text.EINT3_IRQHandler:0000000000000024 $d
                            *COM*:0000000000000001 cs_trigger
     /tmp/cckWTbJW.s:2728   .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/cckWTbJW.s:2733   .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/cckWTbJW.s:2854   .text.DMA_IRQHandler:00000000000000a4 $d
                            *COM*:0000000000000004 active_rxbuf
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
     /tmp/cckWTbJW.s:2872   .text.le_transmit:0000000000000000 $t
     /tmp/cckWTbJW.s:2877   .text.le_transmit:0000000000000000 le_transmit
     /tmp/cckWTbJW.s:3163   .text.le_transmit:0000000000000194 $d
     /tmp/cckWTbJW.s:3173   .text.le_jam:0000000000000000 $t
     /tmp/cckWTbJW.s:3178   .text.le_jam:0000000000000000 le_jam
     /tmp/cckWTbJW.s:3259   .text.le_jam:0000000000000074 $d
     /tmp/cckWTbJW.s:3264   .text.hop:0000000000000000 $t
     /tmp/cckWTbJW.s:3269   .text.hop:0000000000000000 hop
     /tmp/cckWTbJW.s:3516   .text.hop:0000000000000180 $d
     /tmp/cckWTbJW.s:3528   .text.bt_stream_rx:0000000000000000 $t
     /tmp/cckWTbJW.s:3533   .text.bt_stream_rx:0000000000000000 bt_stream_rx
     /tmp/cckWTbJW.s:3753   .text.bt_stream_rx:000000000000012c $d
                            *COM*:0000000000000001 cs_threshold_cur
                            *COM*:0000000000000001 cs_no_squelch
     /tmp/cckWTbJW.s:3769   .text.br_transmit:0000000000000000 $t
     /tmp/cckWTbJW.s:3774   .text.br_transmit:0000000000000000 br_transmit
     /tmp/cckWTbJW.s:4197   .text.br_transmit:000000000000025c $d
     /tmp/cckWTbJW.s:4210   .text.reset_le:0000000000000000 $t
     /tmp/cckWTbJW.s:4215   .text.reset_le:0000000000000000 reset_le
     /tmp/cckWTbJW.s:4277   .text.reset_le:0000000000000040 $d
     /tmp/cckWTbJW.s:4286   .text.reset_le_promisc:0000000000000000 $t
     /tmp/cckWTbJW.s:4291   .text.reset_le_promisc:0000000000000000 reset_le_promisc
     /tmp/cckWTbJW.s:4315   .text.reset_le_promisc:000000000000001c $d
                            *COM*:0000000000000108 le_promisc
     /tmp/cckWTbJW.s:4320   .text.bt_generic_le:0000000000000000 $t
     /tmp/cckWTbJW.s:4325   .text.bt_generic_le:0000000000000000 bt_generic_le
     /tmp/cckWTbJW.s:4664   .text.bt_generic_le:00000000000001ac $d
     /tmp/cckWTbJW.s:4683   .text.bt_le_sync:0000000000000000 $t
     /tmp/cckWTbJW.s:4688   .text.bt_le_sync:0000000000000000 bt_le_sync
     /tmp/cckWTbJW.s:5185   .text.bt_le_sync:00000000000002c4 $d
                            *COM*:0000000000000032 rxbuf1
     /tmp/cckWTbJW.s:5207   .text.bt_le_sync:0000000000000314 $t
     /tmp/cckWTbJW.s:5332   .text.bt_le_sync:00000000000003cc $d
     /tmp/cckWTbJW.s:5339   .text.bt_follow_le:0000000000000000 $t
     /tmp/cckWTbJW.s:5344   .text.bt_follow_le:0000000000000000 bt_follow_le
     /tmp/cckWTbJW.s:5374   .text.bt_follow_le:0000000000000018 $d
     /tmp/cckWTbJW.s:5380   .text.le_promisc_state:0000000000000000 $t
     /tmp/cckWTbJW.s:5385   .text.le_promisc_state:0000000000000000 le_promisc_state
     /tmp/cckWTbJW.s:5439   .text.promisc_recover_hop_increment:0000000000000000 $t
     /tmp/cckWTbJW.s:5444   .text.promisc_recover_hop_increment:0000000000000000 promisc_recover_hop_increment
     /tmp/cckWTbJW.s:5597   .text.promisc_recover_hop_increment:00000000000000c8 $d
     /tmp/cckWTbJW.s:5607   .text.promisc_recover_hop_interval:0000000000000000 $t
     /tmp/cckWTbJW.s:5612   .text.promisc_recover_hop_interval:0000000000000000 promisc_recover_hop_interval
     /tmp/cckWTbJW.s:5735   .text.promisc_recover_hop_interval:0000000000000098 $d
     /tmp/cckWTbJW.s:5746   .text.promisc_follow_cb:0000000000000000 $t
     /tmp/cckWTbJW.s:5751   .text.promisc_follow_cb:0000000000000000 promisc_follow_cb
ARM GAS  /tmp/cckWTbJW.s 			page 214


     /tmp/cckWTbJW.s:5847   .text.promisc_follow_cb:0000000000000064 $d
     /tmp/cckWTbJW.s:5858   .text.see_aa:0000000000000000 $t
     /tmp/cckWTbJW.s:5863   .text.see_aa:0000000000000000 see_aa
     /tmp/cckWTbJW.s:5942   .text.see_aa:0000000000000058 $d
     /tmp/cckWTbJW.s:5947   .text.cb_le_promisc:0000000000000000 $t
     /tmp/cckWTbJW.s:5952   .text.cb_le_promisc:0000000000000000 cb_le_promisc
     /tmp/cckWTbJW.s:6267   .text.cb_le_promisc:000000000000017c $d
     /tmp/cckWTbJW.s:6280   .text.bt_promisc_le:0000000000000000 $t
     /tmp/cckWTbJW.s:6285   .text.bt_promisc_le:0000000000000000 bt_promisc_le
     /tmp/cckWTbJW.s:6364   .text.bt_promisc_le:000000000000005c $d
     /tmp/cckWTbJW.s:6373   .text.bt_slave_le:0000000000000000 $t
     /tmp/cckWTbJW.s:6378   .text.bt_slave_le:0000000000000000 bt_slave_le
     /tmp/cckWTbJW.s:6501   .text.bt_slave_le:0000000000000094 $d
     /tmp/cckWTbJW.s:6513   .text.rx_generic_sync:0000000000000000 $t
     /tmp/cckWTbJW.s:6518   .text.rx_generic_sync:0000000000000000 rx_generic_sync
     /tmp/cckWTbJW.s:6630   .text.rx_generic_sync:0000000000000094 $d
     /tmp/cckWTbJW.s:6637   .text.rx_generic:0000000000000000 $t
     /tmp/cckWTbJW.s:6642   .text.rx_generic:0000000000000000 rx_generic
     /tmp/cckWTbJW.s:6673   .text.rx_generic:000000000000001c $d
     /tmp/cckWTbJW.s:6678   .text.tx_generic:0000000000000000 $t
     /tmp/cckWTbJW.s:6683   .text.tx_generic:0000000000000000 tx_generic
     /tmp/cckWTbJW.s:6841   .text.tx_generic:00000000000000dc $d
     /tmp/cckWTbJW.s:6851   .text.specan:0000000000000000 $t
     /tmp/cckWTbJW.s:6856   .text.specan:0000000000000000 specan
     /tmp/cckWTbJW.s:7043   .text.specan:00000000000000fc $d
     /tmp/cckWTbJW.s:7053   .text.led_specan:0000000000000000 $t
     /tmp/cckWTbJW.s:7058   .text.led_specan:0000000000000000 led_specan
     /tmp/cckWTbJW.s:7262   .text.led_specan:0000000000000114 $d
     /tmp/cckWTbJW.s:7273   .text.startup.main:0000000000000000 $t
     /tmp/cckWTbJW.s:7278   .text.startup.main:0000000000000000 main
     /tmp/cckWTbJW.s:7324   .text.startup.main:0000000000000034 $d
     /tmp/cckWTbJW.s:7343   .text.startup.main:0000000000000078 $t
     /tmp/cckWTbJW.s:7476   .text.startup.main:0000000000000104 $d
     /tmp/cckWTbJW.s:8383   .bss:0000000000000018 packet_cb
     /tmp/cckWTbJW.s:8396   .bss:0000000000000028 data_cb
     /tmp/cckWTbJW.s:8387   .bss:000000000000001c le_jam_count
     /tmp/cckWTbJW.s:8287   .data:0000000000000004 le
     /tmp/cckWTbJW.s:8391   .bss:0000000000000020 slave_mac_address
     /tmp/cckWTbJW.s:8318   .data:0000000000000050 rssi_threshold
     /tmp/cckWTbJW.s:8314   .data:000000000000004e high_freq
     /tmp/cckWTbJW.s:8310   .data:000000000000004c low_freq
     /tmp/cckWTbJW.s:8325   .bss:0000000000000000 modulation
     /tmp/cckWTbJW.s:8378   .bss:0000000000000014 ego_mode
     /tmp/cckWTbJW.s:8374   .bss:0000000000000013 jam_mode
     /tmp/cckWTbJW.s:8370   .bss:0000000000000012 requested_mode
     /tmp/cckWTbJW.s:8366   .bss:0000000000000011 mode
     /tmp/cckWTbJW.s:8329   .bss:0000000000000001 status
     /tmp/cckWTbJW.s:8362   .bss:0000000000000010 dma_discard
     /tmp/cckWTbJW.s:8342   .bss:0000000000000008 idle_buf_channel
     /tmp/cckWTbJW.s:8338   .bss:0000000000000004 idle_buf_clk100ns
     /tmp/cckWTbJW.s:8333   .bss:0000000000000002 idle_buf_clkn_high
     /tmp/cckWTbJW.s:8306   .data:000000000000004a le_adv_channel
     /tmp/cckWTbJW.s:8358   .bss:000000000000000e requested_channel
     /tmp/cckWTbJW.s:8302   .data:0000000000000048 hop_timeout
     /tmp/cckWTbJW.s:8354   .bss:000000000000000c hop_direct_channel
     /tmp/cckWTbJW.s:8282   .data:0000000000000000 channel
     /tmp/cckWTbJW.s:8350   .bss:000000000000000b do_hop
ARM GAS  /tmp/cckWTbJW.s 			page 215


     /tmp/cckWTbJW.s:8346   .bss:000000000000000a hop_mode
     /tmp/cckWTbJW.s:7717   .rodata:00000000000000a7 compile_info
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000032 rxbuf2
     /tmp/cckWTbJW.s:7540   .rodata:0000000000000000 $d
     /tmp/cckWTbJW.s:7544   .rodata:0000000000000000 whitening_index
     /tmp/cckWTbJW.s:7587   .rodata:0000000000000028 whitening
     /tmp/cckWTbJW.s:7722   .rodata:00000000000000f0 whitening_word
     /tmp/cckWTbJW.s:8205   .rodata:0000000000000870 hop_interval_lut
     /tmp/cckWTbJW.s:8278   .data:0000000000000000 $d
     /tmp/cckWTbJW.s:8321   .bss:0000000000000000 $d
     /tmp/cckWTbJW.s:8400   .bss:000000000000002c restart_jamming.4766
     /tmp/cckWTbJW.s:8404   .bss:0000000000000030 first_ts.4863
     /tmp/cckWTbJW.s:8408   .bss:0000000000000034 prev_clk.4869
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
cc2400_set
cs_threshold_calc_and_set
clkn_start
cc2400_status
cc2400_strobe
usb_enqueue
rssi_get_avg
memcpy
rbit
clkn_stop
dio_ssp_stop
cs_reset
rssi_reset
btle_channel_index
btle_crcgen_lut
memcmp
__aeabi_llsl
get_part_num
get_device_serial
cc2400_get
set_isp
strlen
precalc
bootloader_ctrl
dequeue
queue_init
cc2400_fifo_write
next_hop
btle_next_hop
dio_ssp_init
dma_init
dio_ssp_start
cs_trigger_enable
rssi_add
handle_usb
rssi_iir_update
cs_trigger_disable
memset
dma_init_le
btle_reverse_crc
ARM GAS  /tmp/cckWTbJW.s 			page 216


btle_calc_crc
cc2400_fifo_read
ubertooth_init
clkn_init
ubertooth_usb_init
wait
reset
cc2400_txtest
cc2400_rangetest
cc2400_repeater
ego_main
