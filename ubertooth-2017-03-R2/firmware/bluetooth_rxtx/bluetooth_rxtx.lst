ARM GAS  /tmp/ccwLngFB.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"bluetooth_rxtx.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.reverse8,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	reverse8:
  24              	.LFB16:
  25              		.file 1 "bluetooth_rxtx.c"
   1:bluetooth_rxtx.c **** /*
   2:bluetooth_rxtx.c ****  * Copyright 2010-2013 Michael Ossmann
   3:bluetooth_rxtx.c ****  * Copyright 2011-2013 Dominic Spill
   4:bluetooth_rxtx.c ****  *
   5:bluetooth_rxtx.c ****  * This file is part of Project Ubertooth.
   6:bluetooth_rxtx.c ****  *
   7:bluetooth_rxtx.c ****  * This program is free software; you can redistribute it and/or modify
   8:bluetooth_rxtx.c ****  * it under the terms of the GNU General Public License as published by
   9:bluetooth_rxtx.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:bluetooth_rxtx.c ****  * any later version.
  11:bluetooth_rxtx.c ****  *
  12:bluetooth_rxtx.c ****  * This program is distributed in the hope that it will be useful,
  13:bluetooth_rxtx.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:bluetooth_rxtx.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:bluetooth_rxtx.c ****  * GNU General Public License for more details.
  16:bluetooth_rxtx.c ****  *
  17:bluetooth_rxtx.c ****  * You should have received a copy of the GNU General Public License
  18:bluetooth_rxtx.c ****  * along with this program; see the file COPYING.  If not, write to
  19:bluetooth_rxtx.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:bluetooth_rxtx.c ****  * Boston, MA 02110-1301, USA.
  21:bluetooth_rxtx.c ****  */
  22:bluetooth_rxtx.c **** 
  23:bluetooth_rxtx.c **** #include <string.h>
  24:bluetooth_rxtx.c **** #include <stdlib.h>
  25:bluetooth_rxtx.c **** 
  26:bluetooth_rxtx.c **** #include "ubertooth.h"
  27:bluetooth_rxtx.c **** #include "ubertooth_usb.h"
  28:bluetooth_rxtx.c **** #include "ubertooth_interface.h"
  29:bluetooth_rxtx.c **** #include "ubertooth_rssi.h"
  30:bluetooth_rxtx.c **** #include "ubertooth_cs.h"
  31:bluetooth_rxtx.c **** #include "ubertooth_dma.h"
  32:bluetooth_rxtx.c **** #include "ubertooth_clock.h"
  33:bluetooth_rxtx.c **** #include "bluetooth.h"
ARM GAS  /tmp/ccwLngFB.s 			page 2


  34:bluetooth_rxtx.c **** #include "bluetooth_le.h"
  35:bluetooth_rxtx.c **** #include "cc2400_rangetest.h"
  36:bluetooth_rxtx.c **** #include "ego.h"
  37:bluetooth_rxtx.c **** 
  38:bluetooth_rxtx.c **** #define MIN(x,y)	((x)<(y)?(x):(y))
  39:bluetooth_rxtx.c **** #define MAX(x,y)	((x)>(y)?(x):(y))
  40:bluetooth_rxtx.c **** 
  41:bluetooth_rxtx.c **** /* build info */
  42:bluetooth_rxtx.c **** const char compile_info[] =
  43:bluetooth_rxtx.c **** 	"ubertooth " GIT_REVISION " (" COMPILE_BY "@" COMPILE_HOST ") " TIMESTAMP;
  44:bluetooth_rxtx.c **** 
  45:bluetooth_rxtx.c **** /* hopping stuff */
  46:bluetooth_rxtx.c **** volatile uint8_t  hop_mode = HOP_NONE;
  47:bluetooth_rxtx.c **** volatile uint8_t  do_hop = 0;                  // set by timer interrupt
  48:bluetooth_rxtx.c **** volatile uint16_t channel = 2441;
  49:bluetooth_rxtx.c **** volatile uint16_t hop_direct_channel = 0;      // for hopping directly to a channel
  50:bluetooth_rxtx.c **** volatile uint16_t hop_timeout = 158;
  51:bluetooth_rxtx.c **** volatile uint16_t requested_channel = 0;
  52:bluetooth_rxtx.c **** volatile uint16_t le_adv_channel = 2402;
  53:bluetooth_rxtx.c **** 
  54:bluetooth_rxtx.c **** /* bulk USB stuff */
  55:bluetooth_rxtx.c **** volatile uint8_t  idle_buf_clkn_high = 0;
  56:bluetooth_rxtx.c **** volatile uint32_t idle_buf_clk100ns = 0;
  57:bluetooth_rxtx.c **** volatile uint16_t idle_buf_channel = 0;
  58:bluetooth_rxtx.c **** volatile uint8_t  dma_discard = 0;
  59:bluetooth_rxtx.c **** volatile uint8_t  status = 0;
  60:bluetooth_rxtx.c **** 
  61:bluetooth_rxtx.c **** /* operation mode */
  62:bluetooth_rxtx.c **** volatile uint8_t mode = MODE_IDLE;
  63:bluetooth_rxtx.c **** volatile uint8_t requested_mode = MODE_IDLE;
  64:bluetooth_rxtx.c **** volatile uint8_t jam_mode = JAM_NONE;
  65:bluetooth_rxtx.c **** volatile uint8_t ego_mode = EGO_FOLLOW;
  66:bluetooth_rxtx.c **** 
  67:bluetooth_rxtx.c **** volatile uint8_t modulation = MOD_BT_BASIC_RATE;
  68:bluetooth_rxtx.c **** 
  69:bluetooth_rxtx.c **** /* specan stuff */
  70:bluetooth_rxtx.c **** volatile uint16_t low_freq = 2400;
  71:bluetooth_rxtx.c **** volatile uint16_t high_freq = 2483;
  72:bluetooth_rxtx.c **** volatile int8_t rssi_threshold = -30;  // -54dBm - 30 = -84dBm
  73:bluetooth_rxtx.c **** 
  74:bluetooth_rxtx.c **** /* Generic TX stuff */
  75:bluetooth_rxtx.c **** generic_tx_packet tx_pkt;
  76:bluetooth_rxtx.c **** 
  77:bluetooth_rxtx.c **** /* le stuff */
  78:bluetooth_rxtx.c **** int dlen = 0;
  79:bluetooth_rxtx.c **** uint8_t *slave_mac_address_data;
  80:bluetooth_rxtx.c **** uint8_t slave_mac_address[6] = { 0, };
  81:bluetooth_rxtx.c **** 
  82:bluetooth_rxtx.c **** le_state_t le = {
  83:bluetooth_rxtx.c **** 	.access_address = 0x8e89bed6,           // advertising channel access address
  84:bluetooth_rxtx.c **** 	.synch = 0x6b7d,                        // bit-reversed adv channel AA
  85:bluetooth_rxtx.c **** 	.syncl = 0x9171,
  86:bluetooth_rxtx.c **** 	.crc_init  = 0x555555,                  // advertising channel CRCInit
  87:bluetooth_rxtx.c **** 	.crc_init_reversed = 0xAAAAAA,
  88:bluetooth_rxtx.c **** 	.crc_verify = 0,
  89:bluetooth_rxtx.c **** 
  90:bluetooth_rxtx.c **** 	.link_state = LINK_INACTIVE,
ARM GAS  /tmp/ccwLngFB.s 			page 3


  91:bluetooth_rxtx.c **** 	.conn_epoch = 0,
  92:bluetooth_rxtx.c **** 	.target_set = 0,
  93:bluetooth_rxtx.c **** 	.last_packet = 0,
  94:bluetooth_rxtx.c **** };
  95:bluetooth_rxtx.c **** 
  96:bluetooth_rxtx.c **** typedef struct _le_promisc_active_aa_t {
  97:bluetooth_rxtx.c **** 	u32 aa;
  98:bluetooth_rxtx.c **** 	int count;
  99:bluetooth_rxtx.c **** } le_promisc_active_aa_t;
 100:bluetooth_rxtx.c **** 
 101:bluetooth_rxtx.c **** typedef struct _le_promisc_state_t {
 102:bluetooth_rxtx.c **** 	// LFU cache of recently seen AA's
 103:bluetooth_rxtx.c **** 	le_promisc_active_aa_t active_aa[32];
 104:bluetooth_rxtx.c **** 
 105:bluetooth_rxtx.c **** 	// recovering hop interval
 106:bluetooth_rxtx.c **** 	u32 smallest_hop_interval;
 107:bluetooth_rxtx.c **** 	int consec_intervals;
 108:bluetooth_rxtx.c **** } le_promisc_state_t;
 109:bluetooth_rxtx.c **** le_promisc_state_t le_promisc;
 110:bluetooth_rxtx.c **** #define AA_LIST_SIZE (int)(sizeof(le_promisc.active_aa) / sizeof(le_promisc_active_aa_t))
 111:bluetooth_rxtx.c **** 
 112:bluetooth_rxtx.c **** /* LE jamming */
 113:bluetooth_rxtx.c **** #define JAM_COUNT_DEFAULT 40
 114:bluetooth_rxtx.c **** int le_jam_count = 0;
 115:bluetooth_rxtx.c **** 
 116:bluetooth_rxtx.c **** /* set LE access address */
 117:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa);
 118:bluetooth_rxtx.c **** 
 119:bluetooth_rxtx.c **** typedef int (*data_cb_t)(char *);
 120:bluetooth_rxtx.c **** data_cb_t data_cb = NULL;
 121:bluetooth_rxtx.c **** 
 122:bluetooth_rxtx.c **** typedef void (*packet_cb_t)(u8 *);
 123:bluetooth_rxtx.c **** packet_cb_t packet_cb = NULL;
 124:bluetooth_rxtx.c **** 
 125:bluetooth_rxtx.c **** /* Unpacked symbol buffers (two rxbufs) */
 126:bluetooth_rxtx.c **** char unpacked[DMA_SIZE*8*2];
 127:bluetooth_rxtx.c **** 
 128:bluetooth_rxtx.c **** static int enqueue(uint8_t type, uint8_t* buf)
 129:bluetooth_rxtx.c **** {
 130:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 131:bluetooth_rxtx.c **** 
 132:bluetooth_rxtx.c **** 	/* fail if queue is full */
 133:bluetooth_rxtx.c **** 	if (f == NULL) {
 134:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 135:bluetooth_rxtx.c **** 		return 0;
 136:bluetooth_rxtx.c **** 	}
 137:bluetooth_rxtx.c **** 
 138:bluetooth_rxtx.c **** 	f->pkt_type = type;
 139:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 140:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 141:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 142:bluetooth_rxtx.c **** 	} else {
 143:bluetooth_rxtx.c **** 		f->clkn_high = idle_buf_clkn_high;
 144:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 145:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 146:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 147:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
ARM GAS  /tmp/ccwLngFB.s 			page 4


 148:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 149:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 150:bluetooth_rxtx.c **** 	}
 151:bluetooth_rxtx.c **** 
 152:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 153:bluetooth_rxtx.c **** 
 154:bluetooth_rxtx.c **** 	f->status = status;
 155:bluetooth_rxtx.c **** 	status = 0;
 156:bluetooth_rxtx.c **** 
 157:bluetooth_rxtx.c **** 	return 1;
 158:bluetooth_rxtx.c **** }
 159:bluetooth_rxtx.c **** 
 160:bluetooth_rxtx.c **** //JWHUR usb_time_rx
 161:bluetooth_rxtx.c **** static int enqueue_time(uint8_t* buf)
 162:bluetooth_rxtx.c **** {
 163:bluetooth_rxtx.c **** 	usb_time_rx* f = usb_enqueue_time();
 164:bluetooth_rxtx.c **** 	if  (f == NULL) {
 165:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 166:bluetooth_rxtx.c **** 		return 0;
 167:bluetooth_rxtx.c **** 	}
 168:bluetooth_rxtx.c **** 	memcpy(f->time, buf, 16 * sizeof(long));
 169:bluetooth_rxtx.c **** 	return 1;
 170:bluetooth_rxtx.c **** }
 171:bluetooth_rxtx.c **** //
 172:bluetooth_rxtx.c **** 
 173:bluetooth_rxtx.c **** int enqueue_with_ts(uint8_t type, uint8_t* buf, uint32_t ts)
 174:bluetooth_rxtx.c **** {
 175:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 176:bluetooth_rxtx.c **** 
 177:bluetooth_rxtx.c **** 	/* fail if queue is full */
 178:bluetooth_rxtx.c **** 	if (f == NULL) {
 179:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 180:bluetooth_rxtx.c **** 		return 0;
 181:bluetooth_rxtx.c **** 	}
 182:bluetooth_rxtx.c **** 
 183:bluetooth_rxtx.c **** 	f->pkt_type = type;
 184:bluetooth_rxtx.c **** 
 185:bluetooth_rxtx.c **** 	f->clkn_high = 0;
 186:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 187:bluetooth_rxtx.c **** 
 188:bluetooth_rxtx.c **** 	f->channel = (uint8_t)((channel - 2402) & 0xff);
 189:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 190:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 191:bluetooth_rxtx.c **** 
 192:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 193:bluetooth_rxtx.c **** 
 194:bluetooth_rxtx.c **** 	f->status = status;
 195:bluetooth_rxtx.c **** 	status = 0;
 196:bluetooth_rxtx.c **** 
 197:bluetooth_rxtx.c **** 	return 1;
 198:bluetooth_rxtx.c **** }
 199:bluetooth_rxtx.c **** 
 200:bluetooth_rxtx.c **** static int vendor_request_handler(uint8_t request, uint16_t* request_params, uint8_t* data, int* da
 201:bluetooth_rxtx.c **** {
 202:bluetooth_rxtx.c **** 	uint32_t clock;
 203:bluetooth_rxtx.c **** 	size_t length; // string length
 204:bluetooth_rxtx.c **** 	usb_pkt_rx* p = NULL;
ARM GAS  /tmp/ccwLngFB.s 			page 5


 205:bluetooth_rxtx.c **** 	uint16_t reg_val;
 206:bluetooth_rxtx.c **** 	uint8_t i;
 207:bluetooth_rxtx.c **** 	dlen = *data_len;
 208:bluetooth_rxtx.c **** 
 209:bluetooth_rxtx.c **** 	switch (request) {
 210:bluetooth_rxtx.c **** 
 211:bluetooth_rxtx.c **** 	case UBERTOOTH_PING:
 212:bluetooth_rxtx.c **** 		*data_len = 0;
 213:bluetooth_rxtx.c **** 		break;
 214:bluetooth_rxtx.c **** 
 215:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_SYMBOLS:
 216:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_SYMBOLS;
 217:bluetooth_rxtx.c **** 		*data_len = 0;
 218:bluetooth_rxtx.c **** 		break;
 219:bluetooth_rxtx.c **** 
 220:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_SYMBOLS:
 221:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 222:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 223:bluetooth_rxtx.c **** 		*data_len = 0;
 224:bluetooth_rxtx.c **** 		break;
 225:bluetooth_rxtx.c **** 
 226:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_USRLED:
 227:bluetooth_rxtx.c **** 		data[0] = (USRLED) ? 1 : 0;
 228:bluetooth_rxtx.c **** 		*data_len = 1;
 229:bluetooth_rxtx.c **** 		break;
 230:bluetooth_rxtx.c **** 
 231:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_USRLED:
 232:bluetooth_rxtx.c **** 		if (request_params[0])
 233:bluetooth_rxtx.c **** 			USRLED_SET;
 234:bluetooth_rxtx.c **** 		else
 235:bluetooth_rxtx.c **** 			USRLED_CLR;
 236:bluetooth_rxtx.c **** 		break;
 237:bluetooth_rxtx.c **** 
 238:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_RXLED:
 239:bluetooth_rxtx.c **** 		data[0] = (RXLED) ? 1 : 0;
 240:bluetooth_rxtx.c **** 		*data_len = 1;
 241:bluetooth_rxtx.c **** 		break;
 242:bluetooth_rxtx.c **** 
 243:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_RXLED:
 244:bluetooth_rxtx.c **** 		if (request_params[0])
 245:bluetooth_rxtx.c **** 			RXLED_SET;
 246:bluetooth_rxtx.c **** 		else
 247:bluetooth_rxtx.c **** 			RXLED_CLR;
 248:bluetooth_rxtx.c **** 		break;
 249:bluetooth_rxtx.c **** 
 250:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_TXLED:
 251:bluetooth_rxtx.c **** 		data[0] = (TXLED) ? 1 : 0;
 252:bluetooth_rxtx.c **** 		*data_len = 1;
 253:bluetooth_rxtx.c **** 		break;
 254:bluetooth_rxtx.c **** 
 255:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_TXLED:
 256:bluetooth_rxtx.c **** 		if (request_params[0])
 257:bluetooth_rxtx.c **** 			TXLED_SET;
 258:bluetooth_rxtx.c **** 		else
 259:bluetooth_rxtx.c **** 			TXLED_CLR;
 260:bluetooth_rxtx.c **** 		break;
 261:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 6


 262:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_1V8:
 263:bluetooth_rxtx.c **** 		data[0] = (CC1V8) ? 1 : 0;
 264:bluetooth_rxtx.c **** 		*data_len = 1;
 265:bluetooth_rxtx.c **** 		break;
 266:bluetooth_rxtx.c **** 
 267:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_1V8:
 268:bluetooth_rxtx.c **** 		if (request_params[0])
 269:bluetooth_rxtx.c **** 			CC1V8_SET;
 270:bluetooth_rxtx.c **** 		else
 271:bluetooth_rxtx.c **** 			CC1V8_CLR;
 272:bluetooth_rxtx.c **** 		break;
 273:bluetooth_rxtx.c **** 
 274:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PARTNUM:
 275:bluetooth_rxtx.c **** 		get_part_num(data, data_len);
 276:bluetooth_rxtx.c **** 		break;
 277:bluetooth_rxtx.c **** 
 278:bluetooth_rxtx.c **** 	case UBERTOOTH_RESET:
 279:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 280:bluetooth_rxtx.c **** 		break;
 281:bluetooth_rxtx.c **** 
 282:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SERIAL:
 283:bluetooth_rxtx.c **** 		get_device_serial(data, data_len);
 284:bluetooth_rxtx.c **** 		break;
 285:bluetooth_rxtx.c **** 
 286:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 287:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PAEN:
 288:bluetooth_rxtx.c **** 		data[0] = (PAEN) ? 1 : 0;
 289:bluetooth_rxtx.c **** 		*data_len = 1;
 290:bluetooth_rxtx.c **** 		break;
 291:bluetooth_rxtx.c **** 
 292:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PAEN:
 293:bluetooth_rxtx.c **** 		if (request_params[0])
 294:bluetooth_rxtx.c **** 			PAEN_SET;
 295:bluetooth_rxtx.c **** 		else
 296:bluetooth_rxtx.c **** 			PAEN_CLR;
 297:bluetooth_rxtx.c **** 		break;
 298:bluetooth_rxtx.c **** 
 299:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_HGM:
 300:bluetooth_rxtx.c **** 		data[0] = (HGM) ? 1 : 0;
 301:bluetooth_rxtx.c **** 		*data_len = 1;
 302:bluetooth_rxtx.c **** 		break;
 303:bluetooth_rxtx.c **** 
 304:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HGM:
 305:bluetooth_rxtx.c **** 		if (request_params[0])
 306:bluetooth_rxtx.c **** 			HGM_SET;
 307:bluetooth_rxtx.c **** 		else
 308:bluetooth_rxtx.c **** 			HGM_CLR;
 309:bluetooth_rxtx.c **** 		break;
 310:bluetooth_rxtx.c **** #endif
 311:bluetooth_rxtx.c **** 
 312:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 313:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_TEST:
 314:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_TEST;
 315:bluetooth_rxtx.c **** 		break;
 316:bluetooth_rxtx.c **** 
 317:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PALEVEL:
 318:bluetooth_rxtx.c **** 		data[0] = cc2400_get(FREND) & 0x7;
ARM GAS  /tmp/ccwLngFB.s 			page 7


 319:bluetooth_rxtx.c **** 		*data_len = 1;
 320:bluetooth_rxtx.c **** 		break;
 321:bluetooth_rxtx.c **** 
 322:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PALEVEL:
 323:bluetooth_rxtx.c **** 		if( request_params[0] < 8 ) {
 324:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 325:bluetooth_rxtx.c **** 		} else {
 326:bluetooth_rxtx.c **** 			return 0;
 327:bluetooth_rxtx.c **** 		}
 328:bluetooth_rxtx.c **** 		break;
 329:bluetooth_rxtx.c **** 
 330:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_TEST:
 331:bluetooth_rxtx.c **** 		requested_mode = MODE_RANGE_TEST;
 332:bluetooth_rxtx.c **** 		break;
 333:bluetooth_rxtx.c **** 
 334:bluetooth_rxtx.c **** 	case UBERTOOTH_REPEATER:
 335:bluetooth_rxtx.c **** 		requested_mode = MODE_REPEATER;
 336:bluetooth_rxtx.c **** 		break;
 337:bluetooth_rxtx.c **** #endif
 338:bluetooth_rxtx.c **** 
 339:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_CHECK:
 340:bluetooth_rxtx.c **** 		data[0] = rr.valid;
 341:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 342:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 343:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 344:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 345:bluetooth_rxtx.c **** 		*data_len = 5;
 346:bluetooth_rxtx.c **** 		break;
 347:bluetooth_rxtx.c **** 
 348:bluetooth_rxtx.c **** 	case UBERTOOTH_STOP:
 349:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 350:bluetooth_rxtx.c **** 		break;
 351:bluetooth_rxtx.c **** 
 352:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_MOD:
 353:bluetooth_rxtx.c **** 		data[0] = modulation;
 354:bluetooth_rxtx.c **** 		*data_len = 1;
 355:bluetooth_rxtx.c **** 		break;
 356:bluetooth_rxtx.c **** 
 357:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_MOD:
 358:bluetooth_rxtx.c **** 		modulation = request_params[0];
 359:bluetooth_rxtx.c **** 		break;
 360:bluetooth_rxtx.c **** 
 361:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CHANNEL:
 362:bluetooth_rxtx.c **** 		data[0] = channel & 0xFF;
 363:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 364:bluetooth_rxtx.c **** 		*data_len = 2;
 365:bluetooth_rxtx.c **** 		break;
 366:bluetooth_rxtx.c **** 
 367:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CHANNEL:
 368:bluetooth_rxtx.c **** 		requested_channel = request_params[0];
 369:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 370:bluetooth_rxtx.c **** 		if (requested_channel > MAX_FREQ) {
 371:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 372:bluetooth_rxtx.c **** 			requested_channel = 2402;
 373:bluetooth_rxtx.c **** 		}
 374:bluetooth_rxtx.c **** 		/* fixed channel mode, can be outside bluetooth band */
 375:bluetooth_rxtx.c **** 		else {
ARM GAS  /tmp/ccwLngFB.s 			page 8


 376:bluetooth_rxtx.c **** 			hop_mode = HOP_NONE;
 377:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 378:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 379:bluetooth_rxtx.c **** 		}
 380:bluetooth_rxtx.c **** 
 381:bluetooth_rxtx.c **** 		le_adv_channel = requested_channel;
 382:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 383:bluetooth_rxtx.c **** 			channel = requested_channel;
 384:bluetooth_rxtx.c **** 			requested_channel = 0;
 385:bluetooth_rxtx.c **** 
 386:bluetooth_rxtx.c **** 			/* CS threshold is mode-dependent. Update it after
 387:bluetooth_rxtx.c **** 			 * possible mode change. TODO - kludgy. */
 388:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 389:bluetooth_rxtx.c **** 		}
 390:bluetooth_rxtx.c **** 		break;
 391:bluetooth_rxtx.c **** 
 392:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ISP:
 393:bluetooth_rxtx.c **** 		set_isp();
 394:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 395:bluetooth_rxtx.c **** 		break;
 396:bluetooth_rxtx.c **** 
 397:bluetooth_rxtx.c **** 	case UBERTOOTH_FLASH:
 398:bluetooth_rxtx.c **** 		bootloader_ctrl = DFU_MODE;
 399:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 400:bluetooth_rxtx.c **** 		break;
 401:bluetooth_rxtx.c **** 
 402:bluetooth_rxtx.c **** 	case UBERTOOTH_SPECAN:
 403:bluetooth_rxtx.c **** 		if (request_params[0] < 2049 || request_params[0] > 3072 ||
 404:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 405:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 406:bluetooth_rxtx.c **** 			return 0;
 407:bluetooth_rxtx.c **** 		low_freq = request_params[0];
 408:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 409:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 410:bluetooth_rxtx.c **** 		*data_len = 0;
 411:bluetooth_rxtx.c **** 		break;
 412:bluetooth_rxtx.c **** 
 413:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_GENERIC:
 414:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_GENERIC;
 415:bluetooth_rxtx.c **** 		*data_len = 0;
 416:bluetooth_rxtx.c **** 		break;
 417:bluetooth_rxtx.c **** 
 418:bluetooth_rxtx.c **** 	case UBERTOOTH_LED_SPECAN:
 419:bluetooth_rxtx.c **** 		if (request_params[0] > 256)
 420:bluetooth_rxtx.c **** 			return 0;
 421:bluetooth_rxtx.c **** 		rssi_threshold = 54 - request_params[0];
 422:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 423:bluetooth_rxtx.c **** 		*data_len = 0;
 424:bluetooth_rxtx.c **** 		break;
 425:bluetooth_rxtx.c **** 
 426:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_REV_NUM:
 427:bluetooth_rxtx.c **** 		data[0] = 0x00;
 428:bluetooth_rxtx.c **** 		data[1] = 0x00;
 429:bluetooth_rxtx.c **** 
 430:bluetooth_rxtx.c **** 		length = (u8)strlen(GIT_REVISION);
 431:bluetooth_rxtx.c **** 		data[2] = length;
 432:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 9


 433:bluetooth_rxtx.c **** 		memcpy(&data[3], GIT_REVISION, length);
 434:bluetooth_rxtx.c **** 
 435:bluetooth_rxtx.c **** 		*data_len = 2 + 1 + length;
 436:bluetooth_rxtx.c **** 		break;
 437:bluetooth_rxtx.c **** 
 438:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_COMPILE_INFO:
 439:bluetooth_rxtx.c **** 		length = (u8)strlen(compile_info);
 440:bluetooth_rxtx.c **** 		data[0] = length;
 441:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 442:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 443:bluetooth_rxtx.c **** 		break;
 444:bluetooth_rxtx.c **** 
 445:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_BOARD_ID:
 446:bluetooth_rxtx.c **** 		data[0] = BOARD_ID;
 447:bluetooth_rxtx.c **** 		*data_len = 1;
 448:bluetooth_rxtx.c **** 		break;
 449:bluetooth_rxtx.c **** 
 450:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_SQUELCH:
 451:bluetooth_rxtx.c **** 		cs_threshold_req = (int8_t)request_params[0];
 452:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 453:bluetooth_rxtx.c **** 		break;
 454:bluetooth_rxtx.c **** 
 455:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SQUELCH:
 456:bluetooth_rxtx.c **** 		data[0] = cs_threshold_req;
 457:bluetooth_rxtx.c **** 		*data_len = 1;
 458:bluetooth_rxtx.c **** 		break;
 459:bluetooth_rxtx.c **** 
 460:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_BDADDR:
 461:bluetooth_rxtx.c **** 		target.address = 0;
 462:bluetooth_rxtx.c **** 		target.syncword = 0;
 463:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 464:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 465:bluetooth_rxtx.c **** 		}
 466:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 467:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 468:bluetooth_rxtx.c **** 		}
 469:bluetooth_rxtx.c **** 		precalc();
 470:bluetooth_rxtx.c **** 		break;
 471:bluetooth_rxtx.c **** 
 472:bluetooth_rxtx.c **** 	case UBERTOOTH_START_HOPPING:
 473:bluetooth_rxtx.c **** 		clkn_offset = 0;
 474:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 475:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 476:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 477:bluetooth_rxtx.c **** 		}
 478:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 479:bluetooth_rxtx.c **** 		dma_discard = 1;
 480:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 481:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 482:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 483:bluetooth_rxtx.c **** 		break;
 484:bluetooth_rxtx.c **** 
 485:bluetooth_rxtx.c **** 	case UBERTOOTH_AFH:
 486:bluetooth_rxtx.c **** 		hop_mode = HOP_AFH;
 487:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 488:bluetooth_rxtx.c **** 
 489:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
ARM GAS  /tmp/ccwLngFB.s 			page 10


 490:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 491:bluetooth_rxtx.c **** 		}
 492:bluetooth_rxtx.c **** 		used_channels = 0;
 493:bluetooth_rxtx.c **** 		afh_enabled = 1;
 494:bluetooth_rxtx.c **** 		break;
 495:bluetooth_rxtx.c **** 
 496:bluetooth_rxtx.c **** 	case UBERTOOTH_HOP:
 497:bluetooth_rxtx.c **** 		do_hop = 1;
 498:bluetooth_rxtx.c **** 		break;
 499:bluetooth_rxtx.c **** 
 500:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CLOCK:
 501:bluetooth_rxtx.c **** 		clock = data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24;
 502:bluetooth_rxtx.c **** 		clkn = clock;
 503:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 504:bluetooth_rxtx.c **** 		break;
 505:bluetooth_rxtx.c **** 
 506:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_AFHMAP:
 507:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 508:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 509:bluetooth_rxtx.c **** 		}
 510:bluetooth_rxtx.c **** 		afh_enabled = 1;
 511:bluetooth_rxtx.c **** 		*data_len = 10;
 512:bluetooth_rxtx.c **** 		break;
 513:bluetooth_rxtx.c **** 
 514:bluetooth_rxtx.c **** 	case UBERTOOTH_CLEAR_AFHMAP:
 515:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 516:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 517:bluetooth_rxtx.c **** 		}
 518:bluetooth_rxtx.c **** 		afh_enabled = 0;
 519:bluetooth_rxtx.c **** 		*data_len = 10;
 520:bluetooth_rxtx.c **** 		break;
 521:bluetooth_rxtx.c **** 
 522:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CLOCK:
 523:bluetooth_rxtx.c **** 		clock = clkn;
 524:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 525:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 526:bluetooth_rxtx.c **** 		}
 527:bluetooth_rxtx.c **** 		*data_len = 4;
 528:bluetooth_rxtx.c **** 		break;
 529:bluetooth_rxtx.c **** 
 530:bluetooth_rxtx.c **** 	case UBERTOOTH_TRIM_CLOCK:
 531:bluetooth_rxtx.c **** 		clk100ns_offset = (data[0] << 8) | (data[1] << 0);
 532:bluetooth_rxtx.c **** 		break;
 533:bluetooth_rxtx.c **** 
 534:bluetooth_rxtx.c **** 	case UBERTOOTH_FIX_CLOCK_DRIFT:
 535:bluetooth_rxtx.c **** 		clk_drift_ppm += (int16_t)(data[0] << 8) | (data[1] << 0);
 536:bluetooth_rxtx.c **** 
 537:bluetooth_rxtx.c **** 		// Too slow
 538:bluetooth_rxtx.c **** 		if (clk_drift_ppm < 0) {
 539:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 540:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 541:bluetooth_rxtx.c **** 		}
 542:bluetooth_rxtx.c **** 		// Too fast
 543:bluetooth_rxtx.c **** 		else if (clk_drift_ppm > 0) {
 544:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 545:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 546:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccwLngFB.s 			page 11


 547:bluetooth_rxtx.c **** 		// Don't trim
 548:bluetooth_rxtx.c **** 		else {
 549:bluetooth_rxtx.c **** 			clk_drift_correction = 0;
 550:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 551:bluetooth_rxtx.c **** 		}
 552:bluetooth_rxtx.c **** 
 553:bluetooth_rxtx.c **** 		break;
 554:bluetooth_rxtx.c **** 
 555:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SNIFFING:
 556:bluetooth_rxtx.c **** 		*data_len = 0;
 557:bluetooth_rxtx.c **** 
 558:bluetooth_rxtx.c **** 		do_hop = 0;
 559:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 560:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 561:bluetooth_rxtx.c **** 
 562:bluetooth_rxtx.c **** 		queue_init();
 563:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 564:bluetooth_rxtx.c **** 		break;
 565:bluetooth_rxtx.c **** 	
 566:bluetooth_rxtx.c **** 	// JWHUR cfo estimation tracking
 567:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_CFO:
 568:bluetooth_rxtx.c **** 		do_hop = 0;
 569:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 570:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_CFO_LE;
 571:bluetooth_rxtx.c **** 
 572:bluetooth_rxtx.c **** 		queue_init();
 573:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 574:bluetooth_rxtx.c **** 		break;
 575:bluetooth_rxtx.c **** 
 576:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_RSSI:
 577:bluetooth_rxtx.c **** 		do_hop = 0;
 578:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 579:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_RSSI_LE;
 580:bluetooth_rxtx.c **** 
 581:bluetooth_rxtx.c **** 		queue_init();
 582:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 583:bluetooth_rxtx.c **** 		break;
 584:bluetooth_rxtx.c **** 
 585:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_ACCESS_ADDRESS:
 586:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 587:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 588:bluetooth_rxtx.c **** 		}
 589:bluetooth_rxtx.c **** 		*data_len = 4;
 590:bluetooth_rxtx.c **** 		break;
 591:bluetooth_rxtx.c **** 
 592:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ACCESS_ADDRESS:
 593:bluetooth_rxtx.c **** 		le_set_access_address(data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24);
 594:bluetooth_rxtx.c **** 		le.target_set = 1;
 595:bluetooth_rxtx.c **** 		break;
 596:bluetooth_rxtx.c **** 
 597:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING:
 598:bluetooth_rxtx.c **** 		// do something! just don't commit anything here
 599:bluetooth_rxtx.c **** 		break;
 600:bluetooth_rxtx.c **** 
 601:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING_REPLY:
 602:bluetooth_rxtx.c **** 		// after you do something, tell me what you did!
 603:bluetooth_rxtx.c **** 		// don't commit here please
ARM GAS  /tmp/ccwLngFB.s 			page 12


 604:bluetooth_rxtx.c **** 		data[0] = 0x13;
 605:bluetooth_rxtx.c **** 		data[1] = 0x37;
 606:bluetooth_rxtx.c **** 		*data_len = 2;
 607:bluetooth_rxtx.c **** 		break;
 608:bluetooth_rxtx.c **** 
 609:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CRC_VERIFY:
 610:bluetooth_rxtx.c **** 		data[0] = le.crc_verify ? 1 : 0;
 611:bluetooth_rxtx.c **** 		*data_len = 1;
 612:bluetooth_rxtx.c **** 		break;
 613:bluetooth_rxtx.c **** 
 614:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CRC_VERIFY:
 615:bluetooth_rxtx.c **** 		le.crc_verify = request_params[0] ? 1 : 0;
 616:bluetooth_rxtx.c **** 		break;
 617:bluetooth_rxtx.c **** 
 618:bluetooth_rxtx.c **** 	case UBERTOOTH_POLL:
 619:bluetooth_rxtx.c **** 		p = dequeue();
 620:bluetooth_rxtx.c **** 		if (p != NULL) {
 621:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 622:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 623:bluetooth_rxtx.c **** 		} else {
 624:bluetooth_rxtx.c **** 			data[0] = 0;
 625:bluetooth_rxtx.c **** 			*data_len = 1;
 626:bluetooth_rxtx.c **** 		}
 627:bluetooth_rxtx.c **** 		break;
 628:bluetooth_rxtx.c **** 
 629:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_PROMISC:
 630:bluetooth_rxtx.c **** 		*data_len = 0;
 631:bluetooth_rxtx.c **** 
 632:bluetooth_rxtx.c **** 		hop_mode = HOP_NONE;
 633:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 634:bluetooth_rxtx.c **** 
 635:bluetooth_rxtx.c **** 		queue_init();
 636:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 637:bluetooth_rxtx.c **** 		break;
 638:bluetooth_rxtx.c **** 
 639:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_REGISTER:
 640:bluetooth_rxtx.c **** 		reg_val = cc2400_get(request_params[0]);
 641:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 642:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 643:bluetooth_rxtx.c **** 		*data_len = 2;
 644:bluetooth_rxtx.c **** 		break;
 645:bluetooth_rxtx.c **** 
 646:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTER:
 647:bluetooth_rxtx.c **** 		cc2400_set(request_params[0] & 0xff, request_params[1]);
 648:bluetooth_rxtx.c **** 		break;
 649:bluetooth_rxtx.c **** 
 650:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTERS:
 651:bluetooth_rxtx.c **** 		for(i=0; i<request_params[0]; i++) {
 652:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 653:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 654:bluetooth_rxtx.c **** 		}
 655:bluetooth_rxtx.c **** 		break;
 656:bluetooth_rxtx.c **** 
 657:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_ALL_REGISTERS:
 658:bluetooth_rxtx.c **** 		#define MAX_READ_REG 0x2d
 659:bluetooth_rxtx.c **** 		for(i=0; i<=MAX_READ_REG; i++) {
 660:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
ARM GAS  /tmp/ccwLngFB.s 			page 13


 661:bluetooth_rxtx.c **** 			data[i*3] = i;
 662:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 663:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 664:bluetooth_rxtx.c **** 		}
 665:bluetooth_rxtx.c **** 		*data_len = MAX_READ_REG*3;
 666:bluetooth_rxtx.c **** 		break;
 667:bluetooth_rxtx.c **** 
 668:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_GENERIC_PACKET:
 669:bluetooth_rxtx.c **** 		i = 7 + data[6];
 670:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 671:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 672:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_GENERIC;
 673:bluetooth_rxtx.c **** 		*data_len = 0;
 674:bluetooth_rxtx.c **** 		break;
 675:bluetooth_rxtx.c **** 
 676:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE:
 677:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 678:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 679:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 680:bluetooth_rxtx.c **** 		break;
 681:bluetooth_rxtx.c **** 	
 682:bluetooth_rxtx.c **** 	// WJHUR Power control
 683:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P0:
 684:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 685:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 686:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P0;
 687:bluetooth_rxtx.c **** 		break;
 688:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P1:
 689:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 690:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, dlen);
 691:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P1;
 692:bluetooth_rxtx.c **** 		break;
 693:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P2:
 694:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 695:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 696:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P2;
 697:bluetooth_rxtx.c **** 		break;
 698:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P3:
 699:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 700:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 701:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P3;
 702:bluetooth_rxtx.c **** 		break;
 703:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P4:
 704:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 705:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 706:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P4;
 707:bluetooth_rxtx.c **** 		break;
 708:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P5:
 709:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 710:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 711:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P5;
 712:bluetooth_rxtx.c **** 		break;
 713:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P6:
 714:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 715:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 716:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P6;
 717:bluetooth_rxtx.c **** 		break;
ARM GAS  /tmp/ccwLngFB.s 			page 14


 718:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P7:
 719:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 720:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 721:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P7;
 722:bluetooth_rxtx.c **** 		break;
 723:bluetooth_rxtx.c **** 
 724:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SET_TARGET:
 725:bluetooth_rxtx.c **** 		// Addresses appear in packets in reverse-octet order.
 726:bluetooth_rxtx.c **** 		// Store the target address in reverse order so that we can do a simple memcmp later
 727:bluetooth_rxtx.c **** 		le.target[0] = data[5];
 728:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 729:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 730:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 731:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 732:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 733:bluetooth_rxtx.c **** 		le.target_set = 1;
 734:bluetooth_rxtx.c **** 		break;
 735:bluetooth_rxtx.c **** 
 736:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 737:bluetooth_rxtx.c **** 	case UBERTOOTH_JAM_MODE:
 738:bluetooth_rxtx.c **** 		jam_mode = request_params[0];
 739:bluetooth_rxtx.c **** 		break;
 740:bluetooth_rxtx.c **** #endif
 741:bluetooth_rxtx.c **** 
 742:bluetooth_rxtx.c **** 	case UBERTOOTH_EGO:
 743:bluetooth_rxtx.c **** #ifndef TX_ENABLE
 744:bluetooth_rxtx.c **** 		if (ego_mode == EGO_JAM)
 745:bluetooth_rxtx.c **** 			return 0;
 746:bluetooth_rxtx.c **** #endif
 747:bluetooth_rxtx.c **** 		requested_mode = MODE_EGO;
 748:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 749:bluetooth_rxtx.c **** 		break;
 750:bluetooth_rxtx.c **** 
 751:bluetooth_rxtx.c **** 	default:
 752:bluetooth_rxtx.c **** 		return 0;
 753:bluetooth_rxtx.c **** 	}
 754:bluetooth_rxtx.c **** 	return 1;
 755:bluetooth_rxtx.c **** }
 756:bluetooth_rxtx.c **** 
 757:bluetooth_rxtx.c **** /* Update CLKN. */
 758:bluetooth_rxtx.c **** void TIMER0_IRQHandler()
 759:bluetooth_rxtx.c **** {
 760:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 761:bluetooth_rxtx.c **** 
 762:bluetooth_rxtx.c **** 		clkn += clkn_offset + 1;
 763:bluetooth_rxtx.c **** 		clkn_offset = 0;
 764:bluetooth_rxtx.c **** 
 765:bluetooth_rxtx.c **** 		uint32_t le_clk = (clkn - le.conn_epoch) & 0x03;
 766:bluetooth_rxtx.c **** 
 767:bluetooth_rxtx.c **** 		/* Trigger hop based on mode */
 768:bluetooth_rxtx.c **** 
 769:bluetooth_rxtx.c **** 		/* NONE or SWEEP -> 25 Hz */
 770:bluetooth_rxtx.c **** 		if (hop_mode == HOP_NONE || hop_mode == HOP_SWEEP) {
 771:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 772:bluetooth_rxtx.c **** 				do_hop = 1;
 773:bluetooth_rxtx.c **** 		}
 774:bluetooth_rxtx.c **** 		/* BLUETOOTH -> 1600 Hz */
ARM GAS  /tmp/ccwLngFB.s 			page 15


 775:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BLUETOOTH) {
 776:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 777:bluetooth_rxtx.c **** 				do_hop = 1;
 778:bluetooth_rxtx.c **** 		}
 779:bluetooth_rxtx.c **** 		/* BLUETOOTH Low Energy -> 7.5ms - 4.0s in multiples of 1.25 ms */
 780:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BTLE) {
 781:bluetooth_rxtx.c **** 			// Only hop if connected
 782:bluetooth_rxtx.c **** 			if (le.link_state == LINK_CONNECTED && le_clk == 0) {
 783:bluetooth_rxtx.c **** 				--le.interval_timer;
 784:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 785:bluetooth_rxtx.c **** 					do_hop = 1;
 786:bluetooth_rxtx.c **** 					++le.conn_count;
 787:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 788:bluetooth_rxtx.c **** 				} else {
 789:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 790:bluetooth_rxtx.c **** 				}
 791:bluetooth_rxtx.c **** 			}
 792:bluetooth_rxtx.c **** 		}
 793:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_AFH) {
 794:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 795:bluetooth_rxtx.c **** 				do_hop = 1;
 796:bluetooth_rxtx.c **** 			}
 797:bluetooth_rxtx.c **** 		}
 798:bluetooth_rxtx.c **** 
 799:bluetooth_rxtx.c **** 		// Fix linear clock drift deviation
 800:bluetooth_rxtx.c **** 		if(clkn_next_drift_fix != 0 && clk100ns_offset == 0) {
 801:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 802:bluetooth_rxtx.c **** 
 803:bluetooth_rxtx.c **** 				// Too fast
 804:bluetooth_rxtx.c **** 				if(clk_drift_ppm >= 0) {
 805:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 806:bluetooth_rxtx.c **** 				}
 807:bluetooth_rxtx.c **** 
 808:bluetooth_rxtx.c **** 				// Too slow
 809:bluetooth_rxtx.c **** 				else {
 810:bluetooth_rxtx.c **** 					clk100ns_offset = 6249;
 811:bluetooth_rxtx.c **** 				}
 812:bluetooth_rxtx.c **** 				clkn_last_drift_fix = clkn;
 813:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 814:bluetooth_rxtx.c **** 			}
 815:bluetooth_rxtx.c **** 		}
 816:bluetooth_rxtx.c **** 
 817:bluetooth_rxtx.c **** 		// Negative clock correction
 818:bluetooth_rxtx.c **** 		if(clk100ns_offset > 3124)
 819:bluetooth_rxtx.c **** 			clkn += 2;
 820:bluetooth_rxtx.c **** 
 821:bluetooth_rxtx.c **** 		T0MR0 = 3124 + clk100ns_offset;
 822:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 823:bluetooth_rxtx.c **** 
 824:bluetooth_rxtx.c **** 		/* Ack interrupt */
 825:bluetooth_rxtx.c **** 		T0IR = TIR_MR0_Interrupt;
 826:bluetooth_rxtx.c **** 	}
 827:bluetooth_rxtx.c **** }
 828:bluetooth_rxtx.c **** 
 829:bluetooth_rxtx.c **** /* EINT3 handler is also defined in ubertooth.c for TC13BADGE. */
 830:bluetooth_rxtx.c **** #ifndef TC13BADGE
 831:bluetooth_rxtx.c **** void EINT3_IRQHandler()
ARM GAS  /tmp/ccwLngFB.s 			page 16


 832:bluetooth_rxtx.c **** {
 833:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 834:bluetooth_rxtx.c **** 	IO2IntClr   = PIN_GIO6; // clear interrupt
 835:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 836:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 837:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 838:bluetooth_rxtx.c **** 		dma_discard = 0;
 839:bluetooth_rxtx.c **** 
 840:bluetooth_rxtx.c **** }
 841:bluetooth_rxtx.c **** #endif // TC13BADGE
 842:bluetooth_rxtx.c **** 
 843:bluetooth_rxtx.c **** /*
 844:bluetooth_rxtx.c ****  * Sleep (busy wait) for 'millis' milliseconds
 845:bluetooth_rxtx.c ****  * Needs clkn. Be sure to call clkn_init() before using it.
 846:bluetooth_rxtx.c ****  */
 847:bluetooth_rxtx.c **** static void msleep(uint32_t millis)
 848:bluetooth_rxtx.c **** {
 849:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
 850:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 851:bluetooth_rxtx.c **** 
 852:bluetooth_rxtx.c **** 	// handle clkn overflow
 853:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
 854:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
 855:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now || (clkn & 0xffffff) < stop_at);
 856:bluetooth_rxtx.c **** 	} else {
 857:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) < stop_at);
 858:bluetooth_rxtx.c **** 	}
 859:bluetooth_rxtx.c **** }
 860:bluetooth_rxtx.c **** 
 861:bluetooth_rxtx.c **** void DMA_IRQHandler()
 862:bluetooth_rxtx.c **** {
 863:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 864:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 865:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 866:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 867:bluetooth_rxtx.c **** 	   || mode == MODE_BT_CFO_LE
 868:bluetooth_rxtx.c **** 	   || mode == MODE_BT_RSSI_LE
 869:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 870:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 871:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P0
 872:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P1
 873:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P2
 874:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P3
 875:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P4
 876:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P5
 877:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P6
 878:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P7
 879:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 880:bluetooth_rxtx.c **** 	{
 881:bluetooth_rxtx.c **** 		/* interrupt on channel 0 */
 882:bluetooth_rxtx.c **** 		if (DMACIntStat & (1 << 0)) {
 883:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 884:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 885:bluetooth_rxtx.c **** 
 886:bluetooth_rxtx.c **** 				if (hop_mode == HOP_BLUETOOTH)
 887:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 888:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 17


 889:bluetooth_rxtx.c **** 				idle_buf_clk100ns  = CLK100NS;
 890:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 891:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 892:bluetooth_rxtx.c **** 
 893:bluetooth_rxtx.c **** 				/* Keep buffer swapping in sync with DMA. */
 894:bluetooth_rxtx.c **** 				volatile uint8_t* tmp = active_rxbuf;
 895:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 896:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 897:bluetooth_rxtx.c **** 
 898:bluetooth_rxtx.c **** 				++rx_tc;
 899:bluetooth_rxtx.c **** 			}
 900:bluetooth_rxtx.c **** 			if (DMACIntErrStat & (1 << 0)) {
 901:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 902:bluetooth_rxtx.c **** 				++rx_err;
 903:bluetooth_rxtx.c **** 			}
 904:bluetooth_rxtx.c **** 		}
 905:bluetooth_rxtx.c **** 	}
 906:bluetooth_rxtx.c **** }
 907:bluetooth_rxtx.c **** 
 908:bluetooth_rxtx.c **** static void cc2400_idle()
 909:bluetooth_rxtx.c **** {
 910:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 911:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 912:bluetooth_rxtx.c **** 
 913:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 914:bluetooth_rxtx.c **** 	PAEN_CLR;
 915:bluetooth_rxtx.c **** 	HGM_CLR;
 916:bluetooth_rxtx.c **** #endif
 917:bluetooth_rxtx.c **** 
 918:bluetooth_rxtx.c **** 	RXLED_CLR;
 919:bluetooth_rxtx.c **** 	TXLED_CLR;
 920:bluetooth_rxtx.c **** 	USRLED_CLR;
 921:bluetooth_rxtx.c **** 
 922:bluetooth_rxtx.c **** 	clkn_stop();
 923:bluetooth_rxtx.c **** 	dio_ssp_stop();
 924:bluetooth_rxtx.c **** 	cs_reset();
 925:bluetooth_rxtx.c **** 	rssi_reset();
 926:bluetooth_rxtx.c **** 
 927:bluetooth_rxtx.c **** 	/* hopping stuff */
 928:bluetooth_rxtx.c **** 	hop_mode = HOP_NONE;
 929:bluetooth_rxtx.c **** 	do_hop = 0;
 930:bluetooth_rxtx.c **** 	channel = 2441;
 931:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 932:bluetooth_rxtx.c **** 	hop_timeout = 158;
 933:bluetooth_rxtx.c **** 	requested_channel = 0;
 934:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 935:bluetooth_rxtx.c **** 
 936:bluetooth_rxtx.c **** 
 937:bluetooth_rxtx.c **** 	/* bulk USB stuff */
 938:bluetooth_rxtx.c **** 	idle_buf_clkn_high = 0;
 939:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 940:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 941:bluetooth_rxtx.c **** 	dma_discard = 0;
 942:bluetooth_rxtx.c **** 	status = 0;
 943:bluetooth_rxtx.c **** 
 944:bluetooth_rxtx.c **** 	/* operation mode */
 945:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
ARM GAS  /tmp/ccwLngFB.s 			page 18


 946:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 947:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 948:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 949:bluetooth_rxtx.c **** 
 950:bluetooth_rxtx.c **** 	modulation = MOD_BT_BASIC_RATE;
 951:bluetooth_rxtx.c **** 
 952:bluetooth_rxtx.c **** 	/* specan stuff */
 953:bluetooth_rxtx.c **** 	low_freq = 2400;
 954:bluetooth_rxtx.c **** 	high_freq = 2483;
 955:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 956:bluetooth_rxtx.c **** 
 957:bluetooth_rxtx.c **** 	target.address = 0;
 958:bluetooth_rxtx.c **** 	target.syncword = 0;
 959:bluetooth_rxtx.c **** }
 960:bluetooth_rxtx.c **** 
 961:bluetooth_rxtx.c **** /* start un-buffered rx */
 962:bluetooth_rxtx.c **** static void cc2400_rx()
 963:bluetooth_rxtx.c **** {
 964:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 965:bluetooth_rxtx.c **** 
 966:bluetooth_rxtx.c **** 	if((modulation == MOD_BT_BASIC_RATE) || (modulation == MOD_BT_LOW_ENERGY)) {
 967:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 968:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 969:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 970:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 971:bluetooth_rxtx.c **** 		}
 972:bluetooth_rxtx.c **** 		cc2400_set(MANAND,  0x7fff);
 973:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 974:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG 16 MAX MIN PAIRS
 975:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 976:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 977:bluetooth_rxtx.c **** 		//      |  | |   |  +--------> CRC off
 978:bluetooth_rxtx.c **** 		//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
 979:bluetooth_rxtx.c **** 		//      |  | +---------------> 2 preamble bytes of 01010101
 980:bluetooth_rxtx.c **** 		//      |  +-----------------> not packet mode
 981:bluetooth_rxtx.c **** 			//      +--------------------> un-buffered mode
 982:bluetooth_rxtx.c **** 		cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 983:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 984:bluetooth_rxtx.c **** 	}
 985:bluetooth_rxtx.c **** 
 986:bluetooth_rxtx.c **** 	// Set up CS register
 987:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
 988:bluetooth_rxtx.c **** 
 989:bluetooth_rxtx.c **** 	clkn_start();
 990:bluetooth_rxtx.c **** 
 991:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 992:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 993:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 994:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 995:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 996:bluetooth_rxtx.c **** 	PAEN_SET;
 997:bluetooth_rxtx.c **** 	HGM_SET;
 998:bluetooth_rxtx.c **** #endif
 999:bluetooth_rxtx.c **** }
1000:bluetooth_rxtx.c **** 
1001:bluetooth_rxtx.c **** /* start un-buffered rx */
1002:bluetooth_rxtx.c **** static void cc2400_rx_sync(u32 sync)
ARM GAS  /tmp/ccwLngFB.s 			page 19


1003:bluetooth_rxtx.c **** {
1004:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
1005:bluetooth_rxtx.c **** 
1006:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
1007:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
1008:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
1009:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
1010:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
1011:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
1012:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 0 preamble bytes of 01010101
1013:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
1014:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
1015:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
1016:bluetooth_rxtx.c **** 
1017:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1018:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
1019:bluetooth_rxtx.c **** 		grmdm = 0x6561; // un-buffered mode, packet w/ sync word detection
1020:bluetooth_rxtx.c **** 		// 0 11 00 1 010 11 0 00 0 1
1021:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
1022:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
1023:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 2 preamble bytes of 01010101
1024:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
1025:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
1026:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 3
1027:bluetooth_rxtx.c **** 
1028:bluetooth_rxtx.c **** 	} else {
1029:bluetooth_rxtx.c **** 		/* oops */
1030:bluetooth_rxtx.c **** 		return;
1031:bluetooth_rxtx.c **** 	}
1032:bluetooth_rxtx.c **** 
1033:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1034:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
1035:bluetooth_rxtx.c **** 
1036:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x104b); //JWHUR AFC settling = 2 maxmin pairs
1037:bluetooth_rxtx.c **** 	//cc2400_set(MDMTST0, 0x124b);
1038:bluetooth_rxtx.c **** 	// 1      2      4b
1039:bluetooth_rxtx.c **** 	// 00 0 1 0 0 10 01001011
1040:bluetooth_rxtx.c **** 	//    | | | | |  +---------> AFC_DELTA = ??
1041:bluetooth_rxtx.c **** 	//    | | | | +------------> AFC settling = 4 pairs (8 bit preamble)
1042:bluetooth_rxtx.c **** 	//    | | | +--------------> no AFC adjust on packet
1043:bluetooth_rxtx.c **** 	//    | | +----------------> do not invert data
1044:bluetooth_rxtx.c **** 	//    | +------------------> TX IF freq 1 0Hz
1045:bluetooth_rxtx.c **** 	//    +--------------------> PRNG off
1046:bluetooth_rxtx.c **** 	//
1047:bluetooth_rxtx.c **** 	// ref: CC2400 datasheet page 67
1048:bluetooth_rxtx.c **** 	// AFC settling explained page 41/42
1049:bluetooth_rxtx.c **** 
1050:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   grmdm);
1051:bluetooth_rxtx.c **** 
1052:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1053:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1054:bluetooth_rxtx.c **** 
1055:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
1056:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
1057:bluetooth_rxtx.c **** 
1058:bluetooth_rxtx.c **** 	//JWHUR RSSI sampling symbols
1059:bluetooth_rxtx.c **** 	cc2400_set(RSSI, 0x003f);
ARM GAS  /tmp/ccwLngFB.s 			page 20


1060:bluetooth_rxtx.c **** 
1061:bluetooth_rxtx.c **** 	// Set up CS register
1062:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
1063:bluetooth_rxtx.c **** 
1064:bluetooth_rxtx.c **** 	clkn_start();
1065:bluetooth_rxtx.c **** 
1066:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1067:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1068:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1069:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
1070:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1071:bluetooth_rxtx.c **** 	PAEN_SET;
1072:bluetooth_rxtx.c **** 	HGM_SET;
1073:bluetooth_rxtx.c **** #endif
1074:bluetooth_rxtx.c **** }
1075:bluetooth_rxtx.c **** 
1076:bluetooth_rxtx.c **** /* start buffered tx */
1077:bluetooth_rxtx.c **** static void cc2400_tx_sync(uint32_t sync)
1078:bluetooth_rxtx.c **** {
1079:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1080:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1081:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1082:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1083:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1084:bluetooth_rxtx.c **** 
1085:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1086:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1087:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1088:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1089:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1090:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1091:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1092:bluetooth_rxtx.c **** 
1093:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1094:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1095:bluetooth_rxtx.c **** 
1096:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1097:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1098:bluetooth_rxtx.c **** 
1099:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
1100:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
1101:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1102:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1103:bluetooth_rxtx.c **** 	} else {
1104:bluetooth_rxtx.c **** 		/* oops */
1105:bluetooth_rxtx.c **** 		return;
1106:bluetooth_rxtx.c **** 	}
1107:bluetooth_rxtx.c **** 
1108:bluetooth_rxtx.c **** 	clkn_start();
1109:bluetooth_rxtx.c **** 
1110:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1111:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1112:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1113:bluetooth_rxtx.c **** 
1114:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1115:bluetooth_rxtx.c **** 	PAEN_SET;
1116:bluetooth_rxtx.c **** #endif
ARM GAS  /tmp/ccwLngFB.s 			page 21


1117:bluetooth_rxtx.c **** 
1118:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1119:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1120:bluetooth_rxtx.c **** 
1121:bluetooth_rxtx.c **** #endif
1122:bluetooth_rxtx.c **** }
1123:bluetooth_rxtx.c **** 
1124:bluetooth_rxtx.c **** /*
1125:bluetooth_rxtx.c ****  * Transmit a BTLE packet with the specified access address.
1126:bluetooth_rxtx.c ****  *
1127:bluetooth_rxtx.c ****  * All modulation parameters are set within this function. The data
1128:bluetooth_rxtx.c ****  * should not be pre-whitened, but the CRC should be calculated and
1129:bluetooth_rxtx.c ****  * included in the data length.
1130:bluetooth_rxtx.c ****  */
1131:bluetooth_rxtx.c **** void le_transmit(u32 aa, u8 len, u8 *data, u16 tx_pwr, u16 ch)
1132:bluetooth_rxtx.c **** {
1133:bluetooth_rxtx.c **** 	unsigned i, j;
1134:bluetooth_rxtx.c **** 	int bit;
1135:bluetooth_rxtx.c **** 	uint16_t jw_channel = 2402;
1136:bluetooth_rxtx.c **** 	jw_channel = ch;
1137:bluetooth_rxtx.c **** 	u8 txbuf[64];
1138:bluetooth_rxtx.c **** 	u8 tx_len;
1139:bluetooth_rxtx.c **** 	u8 byte;
1140:bluetooth_rxtx.c **** 	u16 gio_save;
1141:bluetooth_rxtx.c **** 	//JWHUR tx power control
1142:bluetooth_rxtx.c **** 	tx_pwr = (tx_pwr & 0x000f);
1143:bluetooth_rxtx.c **** 
1144:bluetooth_rxtx.c **** 	// first four bytes: AA
1145:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
1146:bluetooth_rxtx.c **** 		byte = aa & 0xff;
1147:bluetooth_rxtx.c **** 		aa >>= 8;
1148:bluetooth_rxtx.c **** 		txbuf[i] = 0;
1149:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1150:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
1151:bluetooth_rxtx.c **** 			byte >>= 1;
1152:bluetooth_rxtx.c **** 		}
1153:bluetooth_rxtx.c **** 	}
1154:bluetooth_rxtx.c **** 
1155:bluetooth_rxtx.c **** 	// whiten the data and copy it into the txbuf
1156:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(jw_channel-2402)];
1157:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
1158:bluetooth_rxtx.c **** 		byte = data[i];
1159:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
1160:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1161:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
1162:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
1163:bluetooth_rxtx.c **** 			//bit = (byte & 1);
1164:bluetooth_rxtx.c **** 			byte >>= 1;
1165:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
1166:bluetooth_rxtx.c **** 		}
1167:bluetooth_rxtx.c **** 	}
1168:bluetooth_rxtx.c **** 
1169:bluetooth_rxtx.c **** 	len += 4; // include the AA in len
1170:bluetooth_rxtx.c **** 
1171:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1172:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1173:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
ARM GAS  /tmp/ccwLngFB.s 			page 22


1174:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1175:bluetooth_rxtx.c **** 
1176:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1177:bluetooth_rxtx.c **** 	// 0 00 01 1 001 00 0 00 0 1
1178:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1179:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1180:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1181:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1182:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1183:bluetooth_rxtx.c **** 
1184:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   jw_channel);
1185:bluetooth_rxtx.c **** 	// JWHUR cc2400 data sheet about power control
1186:bluetooth_rxtx.c **** 	// lsb 3 bit : dbm
1187:bluetooth_rxtx.c **** 	// 000 : -25
1188:bluetooth_rxtx.c **** 	// 001 : -15
1189:bluetooth_rxtx.c **** 	// 010 : -10
1190:bluetooth_rxtx.c **** 	// 011 : -7
1191:bluetooth_rxtx.c **** 	// 100 : -4.6
1192:bluetooth_rxtx.c **** 	// 101 : -2.8
1193:bluetooth_rxtx.c **** 	// 110 : -1.3
1194:bluetooth_rxtx.c **** 	// 111 : 0
1195:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pwr);
1196:bluetooth_rxtx.c **** 	//cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1197:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1198:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1199:bluetooth_rxtx.c **** 
1200:bluetooth_rxtx.c **** 	// sync byte depends on the first transmitted bit of the AA
1201:bluetooth_rxtx.c **** 	if (aa & 1)
1202:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
1203:bluetooth_rxtx.c **** 	else
1204:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0x5555);
1205:bluetooth_rxtx.c **** 
1206:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1207:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1208:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1209:bluetooth_rxtx.c **** 
1210:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1211:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1212:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1213:bluetooth_rxtx.c **** 	TXLED_SET;
1214:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1215:bluetooth_rxtx.c **** 	PAEN_SET;
1216:bluetooth_rxtx.c **** #endif
1217:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1218:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1219:bluetooth_rxtx.c **** 
1220:bluetooth_rxtx.c **** 	// put the packet into the FIFO
1221:bluetooth_rxtx.c **** 	/*
1222:bluetooth_rxtx.c **** 	for (i = 0; i < len; i += 16) {
1223:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
1224:bluetooth_rxtx.c **** 		tx_len = len - i;
1225:bluetooth_rxtx.c **** 		if (tx_len >16)
1226:bluetooth_rxtx.c **** 			tx_len = 16;
1227:bluetooth_rxtx.c **** 		cc2400_fifo_write(tx_len, txbuf + i);
1228:bluetooth_rxtx.c **** 	}*/
1229:bluetooth_rxtx.c **** 
1230:bluetooth_rxtx.c **** 	//JWHUR cc2400 fifo write
ARM GAS  /tmp/ccwLngFB.s 			page 23


1231:bluetooth_rxtx.c **** 	while (GIO6) ;
1232:bluetooth_rxtx.c **** 	if (len > 46) len = 46;
1233:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
1234:bluetooth_rxtx.c **** 
1235:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1236:bluetooth_rxtx.c **** 	TXLED_CLR;
1237:bluetooth_rxtx.c **** 
1238:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1239:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
1240:bluetooth_rxtx.c **** 
1241:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1242:bluetooth_rxtx.c **** 	PAEN_CLR;
1243:bluetooth_rxtx.c **** #endif
1244:bluetooth_rxtx.c **** 
1245:bluetooth_rxtx.c **** 	// reset GIO
1246:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1247:bluetooth_rxtx.c **** }
1248:bluetooth_rxtx.c **** 
1249:bluetooth_rxtx.c **** void le_jam(void) {
1250:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1251:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1252:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1253:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
1254:bluetooth_rxtx.c **** 
1255:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1256:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1257:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1258:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1259:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1260:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1261:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1262:bluetooth_rxtx.c **** 
1263:bluetooth_rxtx.c **** 	// cc2400_set(FSDIV,   channel);
1264:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1265:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1266:bluetooth_rxtx.c **** 
1267:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1268:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1269:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1270:bluetooth_rxtx.c **** 	TXLED_SET;
1271:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1272:bluetooth_rxtx.c **** 	PAEN_SET;
1273:bluetooth_rxtx.c **** #endif
1274:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1275:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1276:bluetooth_rxtx.c **** #endif
1277:bluetooth_rxtx.c **** }
1278:bluetooth_rxtx.c **** 
1279:bluetooth_rxtx.c **** /* TODO - return whether hop happened, or should caller have to keep
1280:bluetooth_rxtx.c ****  * track of this? */
1281:bluetooth_rxtx.c **** void hop(void)
1282:bluetooth_rxtx.c **** {
1283:bluetooth_rxtx.c **** 	do_hop = 0;
1284:bluetooth_rxtx.c **** 	last_hop = clkn;
1285:bluetooth_rxtx.c **** 
1286:bluetooth_rxtx.c **** 	// No hopping, if channel is set correctly, do nothing
1287:bluetooth_rxtx.c **** 	if (hop_mode == HOP_NONE) {
ARM GAS  /tmp/ccwLngFB.s 			page 24


1288:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
1289:bluetooth_rxtx.c **** 			return;
1290:bluetooth_rxtx.c **** 	}
1291:bluetooth_rxtx.c **** 	/* Slow sweep (100 hops/sec)
1292:bluetooth_rxtx.c **** 	 * only hop to currently used channels if AFH is enabled
1293:bluetooth_rxtx.c **** 	 */
1294:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_SWEEP) {
1295:bluetooth_rxtx.c **** 		do {
1296:bluetooth_rxtx.c **** 			channel += 32;
1297:bluetooth_rxtx.c **** 			if (channel > 2480)
1298:bluetooth_rxtx.c **** 				channel -= 79;
1299:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
1300:bluetooth_rxtx.c **** 	}
1301:bluetooth_rxtx.c **** 
1302:bluetooth_rxtx.c **** 	/* AFH detection
1303:bluetooth_rxtx.c **** 	 * only hop to currently unused channesl
1304:bluetooth_rxtx.c **** 	 */
1305:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_AFH) {
1306:bluetooth_rxtx.c **** 		do {
1307:bluetooth_rxtx.c **** 			channel += 32;
1308:bluetooth_rxtx.c **** 			if (channel > 2480)
1309:bluetooth_rxtx.c **** 				channel -= 79;
1310:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
1311:bluetooth_rxtx.c **** 	}
1312:bluetooth_rxtx.c **** 
1313:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BLUETOOTH) {
1314:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
1315:bluetooth_rxtx.c **** 	}
1316:bluetooth_rxtx.c **** 
1317:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BTLE) {
1318:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
1319:bluetooth_rxtx.c **** 	}
1320:bluetooth_rxtx.c **** 
1321:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_DIRECT) {
1322:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
1323:bluetooth_rxtx.c **** 	}
1324:bluetooth_rxtx.c **** 	/* IDLE mode, but leave amp on, so don't call cc2400_idle(). */
1325:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1326:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1327:bluetooth_rxtx.c **** 
1328:bluetooth_rxtx.c **** 	/* Retune */
1329:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1330:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
1331:bluetooth_rxtx.c **** 	else
1332:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel - 1);
1333:bluetooth_rxtx.c **** 
1334:bluetooth_rxtx.c **** 	/* Update CS register if hopping.  */
1335:bluetooth_rxtx.c **** 	if (hop_mode > 0) {
1336:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
1337:bluetooth_rxtx.c **** 	}
1338:bluetooth_rxtx.c **** 
1339:bluetooth_rxtx.c **** 	/* Wait for lock */
1340:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1341:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1342:bluetooth_rxtx.c **** 
1343:bluetooth_rxtx.c **** 	dma_discard = 1;
1344:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 25


1345:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1346:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1347:bluetooth_rxtx.c **** 	else
1348:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
1349:bluetooth_rxtx.c **** }
1350:bluetooth_rxtx.c **** 
1351:bluetooth_rxtx.c **** /* Bluetooth packet monitoring */
1352:bluetooth_rxtx.c **** void bt_stream_rx()
1353:bluetooth_rxtx.c **** {
1354:bluetooth_rxtx.c **** 	int8_t rssi;
1355:bluetooth_rxtx.c **** 	int8_t rssi_at_trigger;
1356:bluetooth_rxtx.c **** 
1357:bluetooth_rxtx.c **** 	RXLED_CLR;
1358:bluetooth_rxtx.c **** 
1359:bluetooth_rxtx.c **** 	queue_init();
1360:bluetooth_rxtx.c **** 	dio_ssp_init();
1361:bluetooth_rxtx.c **** 	dma_init();
1362:bluetooth_rxtx.c **** 	dio_ssp_start();
1363:bluetooth_rxtx.c **** 
1364:bluetooth_rxtx.c **** 	cc2400_rx();
1365:bluetooth_rxtx.c **** 
1366:bluetooth_rxtx.c **** 	cs_trigger_enable();
1367:bluetooth_rxtx.c **** 
1368:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_RX_SYMBOLS || requested_mode == MODE_BT_FOLLOW )
1369:bluetooth_rxtx.c **** 	{
1370:bluetooth_rxtx.c **** 
1371:bluetooth_rxtx.c **** 		RXLED_CLR;
1372:bluetooth_rxtx.c **** 
1373:bluetooth_rxtx.c **** 		/* Wait for DMA transfer. TODO - need more work on
1374:bluetooth_rxtx.c **** 		 * RSSI. Should send RSSI indications to host even
1375:bluetooth_rxtx.c **** 		 * when not transferring data. That would also keep
1376:bluetooth_rxtx.c **** 		 * the USB stream going. This loop runs 50-80 times
1377:bluetooth_rxtx.c **** 		 * while waiting for DMA, but RSSI sampling does not
1378:bluetooth_rxtx.c **** 		 * cover all the symbols in a DMA transfer. Can not do
1379:bluetooth_rxtx.c **** 		 * RSSI sampling in CS interrupt, but could log time
1380:bluetooth_rxtx.c **** 		 * at multiple trigger points there. The MAX() below
1381:bluetooth_rxtx.c **** 		 * helps with statistics in the case that cs_trigger
1382:bluetooth_rxtx.c **** 		 * happened before the loop started. */
1383:bluetooth_rxtx.c **** 		rssi_reset();
1384:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1385:bluetooth_rxtx.c **** 		while (!rx_tc) {
1386:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1387:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1388:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1389:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1390:bluetooth_rxtx.c **** 			}
1391:bluetooth_rxtx.c **** 			rssi_add(rssi);
1392:bluetooth_rxtx.c **** 
1393:bluetooth_rxtx.c **** 			handle_usb(clkn);
1394:bluetooth_rxtx.c **** 
1395:bluetooth_rxtx.c **** 			/* If timer says time to hop, do it. */
1396:bluetooth_rxtx.c **** 			if (do_hop) {
1397:bluetooth_rxtx.c **** 				hop();
1398:bluetooth_rxtx.c **** 			} else {
1399:bluetooth_rxtx.c **** 				TXLED_CLR;
1400:bluetooth_rxtx.c **** 			}
1401:bluetooth_rxtx.c **** 			/* TODO - set per-channel carrier sense threshold.
ARM GAS  /tmp/ccwLngFB.s 			page 26


1402:bluetooth_rxtx.c **** 			 * Set by firmware or host. */
1403:bluetooth_rxtx.c **** 		}
1404:bluetooth_rxtx.c **** 
1405:bluetooth_rxtx.c **** 		RXLED_SET;
1406:bluetooth_rxtx.c **** 
1407:bluetooth_rxtx.c **** 		if (rx_err) {
1408:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1409:bluetooth_rxtx.c **** 		}
1410:bluetooth_rxtx.c **** 
1411:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1412:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1413:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1414:bluetooth_rxtx.c **** 
1415:bluetooth_rxtx.c **** 		if (dma_discard) {
1416:bluetooth_rxtx.c **** 			status |= DISCARD;
1417:bluetooth_rxtx.c **** 			dma_discard = 0;
1418:bluetooth_rxtx.c **** 		}
1419:bluetooth_rxtx.c **** 
1420:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1421:bluetooth_rxtx.c **** 
1422:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1423:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1424:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1425:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1426:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1427:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1428:bluetooth_rxtx.c **** 			cs_trigger = 0;
1429:bluetooth_rxtx.c **** 		}
1430:bluetooth_rxtx.c **** 
1431:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1432:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1433:bluetooth_rxtx.c **** 		}
1434:bluetooth_rxtx.c **** 
1435:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, (uint8_t*)idle_rxbuf);
1436:bluetooth_rxtx.c **** 
1437:bluetooth_rxtx.c **** 		handle_usb(clkn);
1438:bluetooth_rxtx.c **** 		rx_tc = 0;
1439:bluetooth_rxtx.c **** 		rx_err = 0;
1440:bluetooth_rxtx.c **** 	}
1441:bluetooth_rxtx.c **** 
1442:bluetooth_rxtx.c **** 	/* This call is a nop so far. Since bt_rx_stream() starts the
1443:bluetooth_rxtx.c **** 	 * stream, it makes sense that it would stop it. TODO - how
1444:bluetooth_rxtx.c **** 	 * should setup/teardown be handled? Should every new mode be
1445:bluetooth_rxtx.c **** 	 * starting from scratch? */
1446:bluetooth_rxtx.c **** 	dio_ssp_stop();
1447:bluetooth_rxtx.c **** 	cs_trigger_disable();
1448:bluetooth_rxtx.c **** }
1449:bluetooth_rxtx.c **** 
1450:bluetooth_rxtx.c **** static uint8_t reverse8(uint8_t data)
1451:bluetooth_rxtx.c **** {
  26              		.loc 1 1451 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              	.LVL0:
  31 0000 10B5     		push	{r4, lr}
  32              		.cfi_def_cfa_offset 8
ARM GAS  /tmp/ccwLngFB.s 			page 27


  33              		.cfi_offset 4, -8
  34              		.cfi_offset 14, -4
  35              	.LVL1:
  36              	.LBB4:
1452:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
1453:bluetooth_rxtx.c **** 
1454:bluetooth_rxtx.c **** 	for(size_t i=0; i<8; i++)
  37              		.loc 1 1454 0
  38 0002 0023     		movs	r3, #0
  39              	.LBE4:
1452:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
  40              		.loc 1 1452 0
  41 0004 1A46     		mov	r2, r3
  42              	.LVL2:
  43              	.L3:
  44              	.LBB5:
1455:bluetooth_rxtx.c **** 	{
1456:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (7-i);
  45              		.loc 1 1456 0 discriminator 2
  46 0006 40FA03F1 		asr	r1, r0, r3
  47 000a C3F10704 		rsb	r4, r3, #7
  48 000e 01F00101 		and	r1, r1, #1
  49 0012 A140     		lsls	r1, r1, r4
1454:bluetooth_rxtx.c **** 	{
  50              		.loc 1 1454 0 discriminator 2
  51 0014 0133     		adds	r3, r3, #1
  52              	.LVL3:
  53              		.loc 1 1456 0 discriminator 2
  54 0016 0A43     		orrs	r2, r2, r1
  55              	.LVL4:
1454:bluetooth_rxtx.c **** 	{
  56              		.loc 1 1454 0 discriminator 2
  57 0018 082B     		cmp	r3, #8
  58              		.loc 1 1456 0 discriminator 2
  59 001a D2B2     		uxtb	r2, r2
  60              	.LVL5:
1454:bluetooth_rxtx.c **** 	{
  61              		.loc 1 1454 0 discriminator 2
  62 001c F3D1     		bne	.L3
  63              	.LBE5:
1457:bluetooth_rxtx.c **** 	}
1458:bluetooth_rxtx.c **** 
1459:bluetooth_rxtx.c **** 	return reversed;
1460:bluetooth_rxtx.c **** }
  64              		.loc 1 1460 0
  65 001e 1046     		mov	r0, r2
  66              	.LVL6:
  67 0020 10BD     		pop	{r4, pc}
  68              		.cfi_endproc
  69              	.LFE16:
  71              		.section	.text.cc2400_rx,"ax",%progbits
  72              		.align	1
  73              		.thumb
  74              		.thumb_func
  76              	cc2400_rx:
  77              	.LFB9:
 963:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
ARM GAS  /tmp/ccwLngFB.s 			page 28


  78              		.loc 1 963 0
  79              		.cfi_startproc
  80              		@ args = 0, pretend = 0, frame = 0
  81              		@ frame_needed = 0, uses_anonymous_args = 0
  82 0000 38B5     		push	{r3, r4, r5, lr}
  83              		.cfi_def_cfa_offset 16
  84              		.cfi_offset 3, -16
  85              		.cfi_offset 4, -12
  86              		.cfi_offset 5, -8
  87              		.cfi_offset 14, -4
  88              	.LVL7:
 966:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
  89              		.loc 1 966 0
  90 0002 254B     		ldr	r3, .L19
  91 0004 254C     		ldr	r4, .L19+4
  92 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  93 0008 12B1     		cbz	r2, .L7
 966:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
  94              		.loc 1 966 0 is_stmt 0 discriminator 1
  95 000a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  96 000c 012A     		cmp	r2, #1
  97 000e 28D1     		bne	.L8
  98              	.L7:
 967:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
  99              		.loc 1 967 0 is_stmt 1
 100 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 101 0012 33B1     		cbz	r3, .L14
 969:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 102              		.loc 1 969 0
 103 0014 204B     		ldr	r3, .L19
 104 0016 1D78     		ldrb	r5, [r3]	@ zero_extendqisi2
 964:bluetooth_rxtx.c **** 
 105              		.loc 1 964 0
 106 0018 012D     		cmp	r5, #1
 107 001a 0CBF     		ite	eq
 108 001c 4025     		moveq	r5, #64
 109 001e 0025     		movne	r5, #0
 110 0020 00E0     		b	.L9
 111              	.L14:
 968:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 112              		.loc 1 968 0
 113 0022 2925     		movs	r5, #41
 114              	.L9:
 115              	.LVL8:
 972:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 116              		.loc 1 972 0
 117 0024 0D20     		movs	r0, #13
 118 0026 47F6FF71 		movw	r1, #32767
 119 002a FFF7FEFF 		bl	cc2400_set
 120              	.LVL9:
 973:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG 16 MAX MIN PAIRS
 121              		.loc 1 973 0
 122 002e 1220     		movs	r0, #18
 123 0030 42F62231 		movw	r1, #11042
 124 0034 FFF7FEFF 		bl	cc2400_set
 125              	.LVL10:
 974:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
ARM GAS  /tmp/ccwLngFB.s 			page 29


 126              		.loc 1 974 0
 127 0038 1420     		movs	r0, #20
 128 003a 41F24B31 		movw	r1, #4939
 129 003e FFF7FEFF 		bl	cc2400_set
 130              	.LVL11:
 975:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 131              		.loc 1 975 0
 132 0042 2020     		movs	r0, #32
 133 0044 40F20111 		movw	r1, #257
 134 0048 FFF7FEFF 		bl	cc2400_set
 135              	.LVL12:
 982:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 136              		.loc 1 982 0
 137 004c 2188     		ldrh	r1, [r4]
 138 004e 0220     		movs	r0, #2
 139 0050 89B2     		uxth	r1, r1
 140 0052 0139     		subs	r1, r1, #1
 141 0054 89B2     		uxth	r1, r1
 142 0056 FFF7FEFF 		bl	cc2400_set
 143              	.LVL13:
 983:bluetooth_rxtx.c **** 	}
 144              		.loc 1 983 0
 145 005a 0320     		movs	r0, #3
 146 005c 2946     		mov	r1, r5
 147 005e FFF7FEFF 		bl	cc2400_set
 148              	.LVL14:
 149              	.L8:
 987:bluetooth_rxtx.c **** 
 150              		.loc 1 987 0
 151 0062 2088     		ldrh	r0, [r4]
 152 0064 80B2     		uxth	r0, r0
 153 0066 FFF7FEFF 		bl	cs_threshold_calc_and_set
 154              	.LVL15:
 989:bluetooth_rxtx.c **** 
 155              		.loc 1 989 0
 156 006a FFF7FEFF 		bl	clkn_start
 157              	.LVL16:
 158              	.L11:
 991:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 159              		.loc 1 991 0 discriminator 1
 160 006e FFF7FEFF 		bl	cc2400_status
 161              	.LVL17:
 162 0072 4206     		lsls	r2, r0, #25
 163 0074 FBD5     		bpl	.L11
 992:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 164              		.loc 1 992 0
 165 0076 6120     		movs	r0, #97
 166 0078 FFF7FEFF 		bl	cc2400_strobe
 167              	.LVL18:
 168              	.L13:
 993:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 169              		.loc 1 993 0 discriminator 1
 170 007c FFF7FEFF 		bl	cc2400_status
 171              	.LVL19:
 172 0080 4307     		lsls	r3, r0, #29
 173 0082 FBD5     		bpl	.L13
 994:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
ARM GAS  /tmp/ccwLngFB.s 			page 30


 174              		.loc 1 994 0
 175 0084 6220     		movs	r0, #98
 176 0086 FFF7FEFF 		bl	cc2400_strobe
 177              	.LVL20:
 996:bluetooth_rxtx.c **** 	HGM_SET;
 178              		.loc 1 996 0
 179 008a 054B     		ldr	r3, .L19+8
 180 008c 8022     		movs	r2, #128
 181 008e 1A60     		str	r2, [r3]
 997:bluetooth_rxtx.c **** #endif
 182              		.loc 1 997 0
 183 0090 4FF48072 		mov	r2, #256
 184 0094 1A60     		str	r2, [r3]
 185 0096 38BD     		pop	{r3, r4, r5, pc}
 186              	.L20:
 187              		.align	2
 188              	.L19:
 189 0098 00000000 		.word	.LANCHOR0
 190 009c 00000000 		.word	.LANCHOR1
 191 00a0 58C00920 		.word	537509976
 192              		.cfi_endproc
 193              	.LFE9:
 195              		.section	.text.cc2400_rx_sync,"ax",%progbits
 196              		.align	1
 197              		.thumb
 198              		.thumb_func
 200              	cc2400_rx_sync:
 201              	.LFB10:
1003:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 202              		.loc 1 1003 0
 203              		.cfi_startproc
 204              		@ args = 0, pretend = 0, frame = 0
 205              		@ frame_needed = 0, uses_anonymous_args = 0
 206              	.LVL21:
 207 0000 70B5     		push	{r4, r5, r6, lr}
 208              		.cfi_def_cfa_offset 16
 209              		.cfi_offset 4, -16
 210              		.cfi_offset 5, -12
 211              		.cfi_offset 6, -8
 212              		.cfi_offset 14, -4
1006:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 213              		.loc 1 1006 0
 214 0002 2A4B     		ldr	r3, .L29
1003:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 215              		.loc 1 1003 0
 216 0004 0446     		mov	r4, r0
1006:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 217              		.loc 1 1006 0
 218 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 219 0008 32B1     		cbz	r2, .L28
1017:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 220              		.loc 1 1017 0
 221 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 222 000c 012B     		cmp	r3, #1
 223 000e 4BD1     		bne	.L21
1018:bluetooth_rxtx.c **** 		grmdm = 0x6561; // un-buffered mode, packet w/ sync word detection
 224              		.loc 1 1018 0
ARM GAS  /tmp/ccwLngFB.s 			page 31


 225 0010 4025     		movs	r5, #64
1019:bluetooth_rxtx.c **** 		// 0 11 00 1 010 11 0 00 0 1
 226              		.loc 1 1019 0
 227 0012 46F26156 		movw	r6, #25953
 228 0016 02E0     		b	.L22
 229              	.L28:
1007:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 230              		.loc 1 1007 0
 231 0018 2925     		movs	r5, #41
1008:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 232              		.loc 1 1008 0
 233 001a 40F26146 		movw	r6, #1121
 234              	.L22:
 235              	.LVL22:
1033:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 236              		.loc 1 1033 0
 237 001e 0D20     		movs	r0, #13
 238              	.LVL23:
 239 0020 47F6FF71 		movw	r1, #32767
 240 0024 FFF7FEFF 		bl	cc2400_set
 241              	.LVL24:
1034:bluetooth_rxtx.c **** 
 242              		.loc 1 1034 0
 243 0028 1220     		movs	r0, #18
 244 002a 42F62231 		movw	r1, #11042
 245 002e FFF7FEFF 		bl	cc2400_set
 246              	.LVL25:
1036:bluetooth_rxtx.c **** 	//cc2400_set(MDMTST0, 0x124b);
 247              		.loc 1 1036 0
 248 0032 1420     		movs	r0, #20
 249 0034 41F24B01 		movw	r1, #4171
 250 0038 FFF7FEFF 		bl	cc2400_set
 251              	.LVL26:
1050:bluetooth_rxtx.c **** 
 252              		.loc 1 1050 0
 253 003c 2020     		movs	r0, #32
 254 003e 3146     		mov	r1, r6
 255 0040 FFF7FEFF 		bl	cc2400_set
 256              	.LVL27:
1052:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 257              		.loc 1 1052 0
 258 0044 A1B2     		uxth	r1, r4
 259 0046 2C20     		movs	r0, #44
 260 0048 FFF7FEFF 		bl	cc2400_set
 261              	.LVL28:
1053:bluetooth_rxtx.c **** 
 262              		.loc 1 1053 0
 263 004c 210C     		lsrs	r1, r4, #16
1055:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 264              		.loc 1 1055 0
 265 004e 184C     		ldr	r4, .L29+4
 266              	.LVL29:
1053:bluetooth_rxtx.c **** 
 267              		.loc 1 1053 0
 268 0050 2D20     		movs	r0, #45
 269 0052 FFF7FEFF 		bl	cc2400_set
 270              	.LVL30:
ARM GAS  /tmp/ccwLngFB.s 			page 32


1055:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 271              		.loc 1 1055 0
 272 0056 2188     		ldrh	r1, [r4]
 273 0058 0220     		movs	r0, #2
 274 005a 89B2     		uxth	r1, r1
 275 005c 0139     		subs	r1, r1, #1
 276 005e 89B2     		uxth	r1, r1
 277 0060 FFF7FEFF 		bl	cc2400_set
 278              	.LVL31:
1056:bluetooth_rxtx.c **** 
 279              		.loc 1 1056 0
 280 0064 0320     		movs	r0, #3
 281 0066 2946     		mov	r1, r5
 282 0068 FFF7FEFF 		bl	cc2400_set
 283              	.LVL32:
1059:bluetooth_rxtx.c **** 
 284              		.loc 1 1059 0
 285 006c 0620     		movs	r0, #6
 286 006e 3F21     		movs	r1, #63
 287 0070 FFF7FEFF 		bl	cc2400_set
 288              	.LVL33:
1062:bluetooth_rxtx.c **** 
 289              		.loc 1 1062 0
 290 0074 2088     		ldrh	r0, [r4]
 291 0076 80B2     		uxth	r0, r0
 292 0078 FFF7FEFF 		bl	cs_threshold_calc_and_set
 293              	.LVL34:
1064:bluetooth_rxtx.c **** 
 294              		.loc 1 1064 0
 295 007c FFF7FEFF 		bl	clkn_start
 296              	.LVL35:
 297              	.L25:
1066:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 298              		.loc 1 1066 0 discriminator 1
 299 0080 FFF7FEFF 		bl	cc2400_status
 300              	.LVL36:
 301 0084 4006     		lsls	r0, r0, #25
 302 0086 FBD5     		bpl	.L25
1067:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 303              		.loc 1 1067 0
 304 0088 6120     		movs	r0, #97
 305 008a FFF7FEFF 		bl	cc2400_strobe
 306              	.LVL37:
 307              	.L27:
1068:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 308              		.loc 1 1068 0 discriminator 1
 309 008e FFF7FEFF 		bl	cc2400_status
 310              	.LVL38:
 311 0092 4107     		lsls	r1, r0, #29
 312 0094 FBD5     		bpl	.L27
1069:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 313              		.loc 1 1069 0
 314 0096 6220     		movs	r0, #98
 315 0098 FFF7FEFF 		bl	cc2400_strobe
 316              	.LVL39:
1071:bluetooth_rxtx.c **** 	HGM_SET;
 317              		.loc 1 1071 0
ARM GAS  /tmp/ccwLngFB.s 			page 33


 318 009c 054B     		ldr	r3, .L29+8
 319 009e 8022     		movs	r2, #128
 320 00a0 1A60     		str	r2, [r3]
1072:bluetooth_rxtx.c **** #endif
 321              		.loc 1 1072 0
 322 00a2 4FF48072 		mov	r2, #256
 323 00a6 1A60     		str	r2, [r3]
 324              	.LVL40:
 325              	.L21:
 326 00a8 70BD     		pop	{r4, r5, r6, pc}
 327              	.L30:
 328 00aa 00BF     		.align	2
 329              	.L29:
 330 00ac 00000000 		.word	.LANCHOR0
 331 00b0 00000000 		.word	.LANCHOR1
 332 00b4 58C00920 		.word	537509976
 333              		.cfi_endproc
 334              	.LFE10:
 336              		.section	.text.enqueue,"ax",%progbits
 337              		.align	1
 338              		.thumb
 339              		.thumb_func
 341              	enqueue:
 342              	.LFB0:
 129:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 343              		.loc 1 129 0
 344              		.cfi_startproc
 345              		@ args = 0, pretend = 0, frame = 0
 346              		@ frame_needed = 0, uses_anonymous_args = 0
 347              	.LVL41:
 348 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 349              		.cfi_def_cfa_offset 24
 350              		.cfi_offset 3, -24
 351              		.cfi_offset 4, -20
 352              		.cfi_offset 5, -16
 353              		.cfi_offset 6, -12
 354              		.cfi_offset 7, -8
 355              		.cfi_offset 14, -4
 129:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 356              		.loc 1 129 0
 357 0002 0646     		mov	r6, r0
 358 0004 0F46     		mov	r7, r1
 130:bluetooth_rxtx.c **** 
 359              		.loc 1 130 0
 360 0006 FFF7FEFF 		bl	usb_enqueue
 361              	.LVL42:
 362 000a 1E4D     		ldr	r5, .L36
 133:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 363              		.loc 1 133 0
 364 000c 0446     		mov	r4, r0
 365 000e 20B9     		cbnz	r0, .L32
 134:bluetooth_rxtx.c **** 		return 0;
 366              		.loc 1 134 0
 367 0010 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 368 0012 43F00403 		orr	r3, r3, #4
 369 0016 6B70     		strb	r3, [r5, #1]
 135:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/ccwLngFB.s 			page 34


 370              		.loc 1 135 0
 371 0018 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 372              	.LVL43:
 373              	.L32:
 139:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 374              		.loc 1 139 0
 375 001a 042E     		cmp	r6, #4
 138:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 376              		.loc 1 138 0
 377 001c 0670     		strb	r6, [r0]
 139:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 378              		.loc 1 139 0
 379 001e 0ED1     		bne	.L34
 140:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 380              		.loc 1 140 0
 381 0020 194B     		ldr	r3, .L36+4
 141:bluetooth_rxtx.c **** 	} else {
 382              		.loc 1 141 0
 383 0022 40F63541 		movw	r1, #3125
 140:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 384              		.loc 1 140 0
 385 0026 1A68     		ldr	r2, [r3]
 386 0028 120D     		lsrs	r2, r2, #20
 387 002a C270     		strb	r2, [r0, #3]
 141:bluetooth_rxtx.c **** 	} else {
 388              		.loc 1 141 0
 389 002c 174A     		ldr	r2, .L36+8
 390 002e 1B68     		ldr	r3, [r3]
 391 0030 1268     		ldr	r2, [r2]
 392 0032 C3F31303 		ubfx	r3, r3, #0, #20
 393 0036 01FB0323 		mla	r3, r1, r3, r2
 394 003a 4360     		str	r3, [r0, #4]
 395 003c 15E0     		b	.L35
 396              	.L34:
 143:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 397              		.loc 1 143 0
 398 003e AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 399 0040 C370     		strb	r3, [r0, #3]
 144:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 400              		.loc 1 144 0
 401 0042 6B68     		ldr	r3, [r5, #4]
 402 0044 4360     		str	r3, [r0, #4]
 145:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 403              		.loc 1 145 0
 404 0046 2B89     		ldrh	r3, [r5, #8]
 405 0048 9BB2     		uxth	r3, r3
 406 004a 623B     		subs	r3, r3, #98
 407 004c 8370     		strb	r3, [r0, #2]
 146:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 408              		.loc 1 146 0
 409 004e 104B     		ldr	r3, .L36+12
 410 0050 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 411 0052 4372     		strb	r3, [r0, #9]
 147:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 412              		.loc 1 147 0
 413 0054 0F4B     		ldr	r3, .L36+16
 414 0056 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 35


 415 0058 0372     		strb	r3, [r0, #8]
 148:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 416              		.loc 1 148 0
 417 005a 2889     		ldrh	r0, [r5, #8]
 418              	.LVL44:
 419 005c 80B2     		uxth	r0, r0
 420 005e FFF7FEFF 		bl	rssi_get_avg
 421              	.LVL45:
 149:bluetooth_rxtx.c **** 	}
 422              		.loc 1 149 0
 423 0062 0D4B     		ldr	r3, .L36+20
 148:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 424              		.loc 1 148 0
 425 0064 A072     		strb	r0, [r4, #10]
 149:bluetooth_rxtx.c **** 	}
 426              		.loc 1 149 0
 427 0066 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 428 0068 E372     		strb	r3, [r4, #11]
 429              	.L35:
 152:bluetooth_rxtx.c **** 
 430              		.loc 1 152 0
 431 006a 04F10E00 		add	r0, r4, #14
 432 006e 3946     		mov	r1, r7
 433 0070 3222     		movs	r2, #50
 434 0072 FFF7FEFF 		bl	memcpy
 435              	.LVL46:
 154:bluetooth_rxtx.c **** 	status = 0;
 436              		.loc 1 154 0
 437 0076 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 157:bluetooth_rxtx.c **** }
 438              		.loc 1 157 0
 439 0078 0120     		movs	r0, #1
 154:bluetooth_rxtx.c **** 	status = 0;
 440              		.loc 1 154 0
 441 007a 6370     		strb	r3, [r4, #1]
 155:bluetooth_rxtx.c **** 
 442              		.loc 1 155 0
 443 007c 0023     		movs	r3, #0
 444 007e 6B70     		strb	r3, [r5, #1]
 158:bluetooth_rxtx.c **** 
 445              		.loc 1 158 0
 446 0080 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 447              	.LVL47:
 448              	.L37:
 449 0082 00BF     		.align	2
 450              	.L36:
 451 0084 00000000 		.word	.LANCHOR0
 452 0088 00000000 		.word	clkn
 453 008c 08400040 		.word	1073758216
 454 0090 00000000 		.word	rssi_min
 455 0094 00000000 		.word	rssi_max
 456 0098 00000000 		.word	rssi_count
 457              		.cfi_endproc
 458              	.LFE0:
 460              		.section	.text.le_set_access_address,"ax",%progbits
 461              		.align	1
 462              		.thumb
ARM GAS  /tmp/ccwLngFB.s 			page 36


 463              		.thumb_func
 465              	le_set_access_address:
 466              	.LFB19:
1461:bluetooth_rxtx.c **** 
1462:bluetooth_rxtx.c **** static uint16_t reverse16(uint16_t data)
1463:bluetooth_rxtx.c **** {
1464:bluetooth_rxtx.c **** 	uint16_t reversed = 0;
1465:bluetooth_rxtx.c **** 
1466:bluetooth_rxtx.c **** 	for(size_t i=0; i<16; i++)
1467:bluetooth_rxtx.c **** 	{
1468:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (15-i);
1469:bluetooth_rxtx.c **** 	}
1470:bluetooth_rxtx.c **** 
1471:bluetooth_rxtx.c **** 	return reversed;
1472:bluetooth_rxtx.c **** }
1473:bluetooth_rxtx.c **** 
1474:bluetooth_rxtx.c **** /*
1475:bluetooth_rxtx.c ****  * Transmit a BTBR packet with the specified access code.
1476:bluetooth_rxtx.c ****  *
1477:bluetooth_rxtx.c ****  * All modulation parameters are set within this function.
1478:bluetooth_rxtx.c ****  */
1479:bluetooth_rxtx.c **** void br_transmit()
1480:bluetooth_rxtx.c **** {
1481:bluetooth_rxtx.c **** 	uint16_t gio_save;
1482:bluetooth_rxtx.c **** 
1483:bluetooth_rxtx.c **** 	uint32_t clkn_saved = 0;
1484:bluetooth_rxtx.c **** 
1485:bluetooth_rxtx.c **** 	uint16_t preamble = (target.syncword & 1) == 1 ? 0x5555 : 0xaaaa;
1486:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
1487:bluetooth_rxtx.c **** 
1488:bluetooth_rxtx.c **** 	uint8_t data[16] = {
1489:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
1491:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
1492:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
1493:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
1494:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
1495:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
1496:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
1497:bluetooth_rxtx.c **** 		reverse8(trailer),
1498:bluetooth_rxtx.c **** 		reverse8(0x77),
1499:bluetooth_rxtx.c **** 		reverse8(0x66),
1500:bluetooth_rxtx.c **** 		reverse8(0x55),
1501:bluetooth_rxtx.c **** 		reverse8(0x44),
1502:bluetooth_rxtx.c **** 		reverse8(0x33),
1503:bluetooth_rxtx.c **** 		reverse8(0x22),
1504:bluetooth_rxtx.c **** 		reverse8(0x11)
1505:bluetooth_rxtx.c **** 	};
1506:bluetooth_rxtx.c **** 
1507:bluetooth_rxtx.c **** 	cc2400_tx_sync(reverse16(preamble));
1508:bluetooth_rxtx.c **** 
1509:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1510:bluetooth_rxtx.c **** 
1511:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1512:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1513:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1514:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 37


1515:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_TX_SYMBOLS )
1516:bluetooth_rxtx.c **** 	{
1517:bluetooth_rxtx.c **** 
1518:bluetooth_rxtx.c **** 		while ((clkn >> 1) == (clkn_saved >> 1) || T0TC < 2250) {
1519:bluetooth_rxtx.c **** 
1520:bluetooth_rxtx.c **** 			// If timer says time to hop, do it.
1521:bluetooth_rxtx.c **** 			if (do_hop) {
1522:bluetooth_rxtx.c **** 				hop();
1523:bluetooth_rxtx.c **** 			}
1524:bluetooth_rxtx.c **** 		}
1525:bluetooth_rxtx.c **** 
1526:bluetooth_rxtx.c **** 		clkn_saved = clkn;
1527:bluetooth_rxtx.c **** 
1528:bluetooth_rxtx.c **** 		TXLED_SET;
1529:bluetooth_rxtx.c **** 
1530:bluetooth_rxtx.c **** 		cc2400_fifo_write(16, data);
1531:bluetooth_rxtx.c **** 
1532:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1533:bluetooth_rxtx.c **** 		TXLED_CLR;
1534:bluetooth_rxtx.c **** 
1535:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
1536:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
1537:bluetooth_rxtx.c **** 
1538:bluetooth_rxtx.c **** 		while (!(cc2400_status() & XOSC16M_STABLE));
1539:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1540:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
1541:bluetooth_rxtx.c **** 
1542:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1543:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1544:bluetooth_rxtx.c **** 
1545:bluetooth_rxtx.c **** 		handle_usb(clkn);
1546:bluetooth_rxtx.c **** 	}
1547:bluetooth_rxtx.c **** 
1548:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1549:bluetooth_rxtx.c **** 	PAEN_CLR;
1550:bluetooth_rxtx.c **** #endif
1551:bluetooth_rxtx.c **** 
1552:bluetooth_rxtx.c **** 	// reset GIO
1553:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1554:bluetooth_rxtx.c **** }
1555:bluetooth_rxtx.c **** 
1556:bluetooth_rxtx.c **** /* set LE access address */
1557:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa) {
 467              		.loc 1 1557 0
 468              		.cfi_startproc
 469              		@ args = 0, pretend = 0, frame = 0
 470              		@ frame_needed = 0, uses_anonymous_args = 0
 471              	.LVL48:
 472 0000 10B5     		push	{r4, lr}
 473              		.cfi_def_cfa_offset 8
 474              		.cfi_offset 4, -8
 475              		.cfi_offset 14, -4
1558:bluetooth_rxtx.c **** 	u32 aa_rev;
1559:bluetooth_rxtx.c **** 
1560:bluetooth_rxtx.c **** 	le.access_address = aa;
 476              		.loc 1 1560 0
 477 0002 044C     		ldr	r4, .L39
ARM GAS  /tmp/ccwLngFB.s 			page 38


 478 0004 6060     		str	r0, [r4, #4]
1561:bluetooth_rxtx.c **** 	aa_rev = rbit(aa);
 479              		.loc 1 1561 0
 480 0006 FFF7FEFF 		bl	rbit
 481              	.LVL49:
1562:bluetooth_rxtx.c **** 	le.syncl = aa_rev & 0xffff;
 482              		.loc 1 1562 0
 483 000a 6081     		strh	r0, [r4, #10]	@ movhi
1563:bluetooth_rxtx.c **** 	le.synch = aa_rev >> 16;
 484              		.loc 1 1563 0
 485 000c 000C     		lsrs	r0, r0, #16
 486              	.LVL50:
 487 000e 2081     		strh	r0, [r4, #8]	@ movhi
 488 0010 10BD     		pop	{r4, pc}
 489              	.L40:
 490 0012 00BF     		.align	2
 491              	.L39:
 492 0014 00000000 		.word	.LANCHOR1
 493              		.cfi_endproc
 494              	.LFE19:
 496              		.section	.text.cc2400_idle,"ax",%progbits
 497              		.align	1
 498              		.thumb
 499              		.thumb_func
 501              	cc2400_idle:
 502              	.LFB8:
 909:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 503              		.loc 1 909 0
 504              		.cfi_startproc
 505              		@ args = 0, pretend = 0, frame = 0
 506              		@ frame_needed = 0, uses_anonymous_args = 0
 507 0000 10B5     		push	{r4, lr}
 508              		.cfi_def_cfa_offset 8
 509              		.cfi_offset 4, -8
 510              		.cfi_offset 14, -4
 910:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 511              		.loc 1 910 0
 512 0002 6420     		movs	r0, #100
 513 0004 FFF7FEFF 		bl	cc2400_strobe
 514              	.LVL51:
 515              	.L43:
 911:bluetooth_rxtx.c **** 
 516              		.loc 1 911 0 discriminator 1
 517 0008 FFF7FEFF 		bl	cc2400_status
 518              	.LVL52:
 519 000c 00F00400 		and	r0, r0, #4
 520 0010 00F0FF04 		and	r4, r0, #255
 521 0014 0028     		cmp	r0, #0
 522 0016 F7D1     		bne	.L43
 914:bluetooth_rxtx.c **** 	HGM_CLR;
 523              		.loc 1 914 0
 524 0018 204B     		ldr	r3, .L44
 525 001a 8022     		movs	r2, #128
 526 001c 1A60     		str	r2, [r3]
 918:bluetooth_rxtx.c **** 	TXLED_CLR;
 527              		.loc 1 918 0
 528 001e 1021     		movs	r1, #16
ARM GAS  /tmp/ccwLngFB.s 			page 39


 915:bluetooth_rxtx.c **** #endif
 529              		.loc 1 915 0
 530 0020 4FF48072 		mov	r2, #256
 531 0024 1A60     		str	r2, [r3]
 918:bluetooth_rxtx.c **** 	TXLED_CLR;
 532              		.loc 1 918 0
 533 0026 43F8201C 		str	r1, [r3, #-32]
 919:bluetooth_rxtx.c **** 	USRLED_CLR;
 534              		.loc 1 919 0
 535 002a 43F8202C 		str	r2, [r3, #-32]
 920:bluetooth_rxtx.c **** 
 536              		.loc 1 920 0
 537 002e 0222     		movs	r2, #2
 538 0030 43F8202C 		str	r2, [r3, #-32]
 922:bluetooth_rxtx.c **** 	dio_ssp_stop();
 539              		.loc 1 922 0
 540 0034 FFF7FEFF 		bl	clkn_stop
 541              	.LVL53:
 923:bluetooth_rxtx.c **** 	cs_reset();
 542              		.loc 1 923 0
 543 0038 FFF7FEFF 		bl	dio_ssp_stop
 544              	.LVL54:
 924:bluetooth_rxtx.c **** 	rssi_reset();
 545              		.loc 1 924 0
 546 003c FFF7FEFF 		bl	cs_reset
 547              	.LVL55:
 925:bluetooth_rxtx.c **** 
 548              		.loc 1 925 0
 549 0040 FFF7FEFF 		bl	rssi_reset
 550              	.LVL56:
 928:bluetooth_rxtx.c **** 	do_hop = 0;
 551              		.loc 1 928 0
 552 0044 164B     		ldr	r3, .L44+4
 930:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 553              		.loc 1 930 0
 554 0046 174A     		ldr	r2, .L44+8
 555 0048 40F68911 		movw	r1, #2441
 928:bluetooth_rxtx.c **** 	do_hop = 0;
 556              		.loc 1 928 0
 557 004c 9C72     		strb	r4, [r3, #10]
 929:bluetooth_rxtx.c **** 	channel = 2441;
 558              		.loc 1 929 0
 559 004e DC72     		strb	r4, [r3, #11]
 930:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 560              		.loc 1 930 0
 561 0050 1180     		strh	r1, [r2]	@ movhi
 932:bluetooth_rxtx.c **** 	requested_channel = 0;
 562              		.loc 1 932 0
 563 0052 9E21     		movs	r1, #158
 931:bluetooth_rxtx.c **** 	hop_timeout = 158;
 564              		.loc 1 931 0
 565 0054 9C81     		strh	r4, [r3, #12]	@ movhi
 932:bluetooth_rxtx.c **** 	requested_channel = 0;
 566              		.loc 1 932 0
 567 0056 A2F84810 		strh	r1, [r2, #72]	@ movhi
 934:bluetooth_rxtx.c **** 
 568              		.loc 1 934 0
ARM GAS  /tmp/ccwLngFB.s 			page 40


 569 005a 40F66211 		movw	r1, #2402
 933:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 570              		.loc 1 933 0
 571 005e DC81     		strh	r4, [r3, #14]	@ movhi
 934:bluetooth_rxtx.c **** 
 572              		.loc 1 934 0
 573 0060 A2F84A10 		strh	r1, [r2, #74]	@ movhi
 938:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 574              		.loc 1 938 0
 575 0064 9C70     		strb	r4, [r3, #2]
 939:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 576              		.loc 1 939 0
 577 0066 5C60     		str	r4, [r3, #4]
 940:bluetooth_rxtx.c **** 	dma_discard = 0;
 578              		.loc 1 940 0
 579 0068 1C81     		strh	r4, [r3, #8]	@ movhi
 941:bluetooth_rxtx.c **** 	status = 0;
 580              		.loc 1 941 0
 581 006a 1C74     		strb	r4, [r3, #16]
 942:bluetooth_rxtx.c **** 
 582              		.loc 1 942 0
 583 006c 5C70     		strb	r4, [r3, #1]
 945:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 584              		.loc 1 945 0
 585 006e 5C74     		strb	r4, [r3, #17]
 946:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 586              		.loc 1 946 0
 587 0070 9C74     		strb	r4, [r3, #18]
 947:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 588              		.loc 1 947 0
 589 0072 DC74     		strb	r4, [r3, #19]
 948:bluetooth_rxtx.c **** 
 590              		.loc 1 948 0
 591 0074 1C75     		strb	r4, [r3, #20]
 950:bluetooth_rxtx.c **** 
 592              		.loc 1 950 0
 593 0076 1C70     		strb	r4, [r3]
 953:bluetooth_rxtx.c **** 	high_freq = 2483;
 594              		.loc 1 953 0
 595 0078 4FF41663 		mov	r3, #2400
 596 007c A2F84C30 		strh	r3, [r2, #76]	@ movhi
 954:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 597              		.loc 1 954 0
 598 0080 5333     		adds	r3, r3, #83
 599 0082 A2F84E30 		strh	r3, [r2, #78]	@ movhi
 957:bluetooth_rxtx.c **** 	target.syncword = 0;
 600              		.loc 1 957 0
 601 0086 0849     		ldr	r1, .L44+12
 955:bluetooth_rxtx.c **** 
 602              		.loc 1 955 0
 603 0088 E223     		movs	r3, #226
 604 008a 82F85030 		strb	r3, [r2, #80]
 957:bluetooth_rxtx.c **** 	target.syncword = 0;
 605              		.loc 1 957 0
 606 008e 0022     		movs	r2, #0
 607 0090 0023     		movs	r3, #0
 608 0092 C1E90023 		strd	r2, [r1]
ARM GAS  /tmp/ccwLngFB.s 			page 41


 958:bluetooth_rxtx.c **** }
 609              		.loc 1 958 0
 610 0096 C1E90223 		strd	r2, [r1, #8]
 611 009a 10BD     		pop	{r4, pc}
 612              	.L45:
 613              		.align	2
 614              	.L44:
 615 009c 5CC00920 		.word	537509980
 616 00a0 00000000 		.word	.LANCHOR0
 617 00a4 00000000 		.word	.LANCHOR1
 618 00a8 00000000 		.word	target
 619              		.cfi_endproc
 620              	.LFE8:
 622              		.section	.text.cb_follow_le,"ax",%progbits
 623              		.align	1
 624              		.global	cb_follow_le
 625              		.thumb
 626              		.thumb_func
 628              	cb_follow_le:
 629              	.LFB26:
1564:bluetooth_rxtx.c **** }
1565:bluetooth_rxtx.c **** 
1566:bluetooth_rxtx.c **** /* reset le state, called by bt_generic_le and bt_follow_le() */
1567:bluetooth_rxtx.c **** void reset_le() {
1568:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
1569:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
1570:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
1571:bluetooth_rxtx.c **** 	//JWHUR crc verify on
1572:bluetooth_rxtx.c **** 	le.crc_verify = 1;
1573:bluetooth_rxtx.c **** 	le.last_packet = 0;
1574:bluetooth_rxtx.c **** 
1575:bluetooth_rxtx.c **** 	le.link_state = LINK_INACTIVE;
1576:bluetooth_rxtx.c **** 
1577:bluetooth_rxtx.c **** 	le.channel_idx = 0;
1578:bluetooth_rxtx.c **** 	le.channel_increment = 0;
1579:bluetooth_rxtx.c **** 
1580:bluetooth_rxtx.c **** 	le.conn_epoch = 0;
1581:bluetooth_rxtx.c **** 	le.interval_timer = 0;
1582:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1583:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1584:bluetooth_rxtx.c **** 	le.conn_count = 0;
1585:bluetooth_rxtx.c **** 
1586:bluetooth_rxtx.c **** 	le.win_size = 0;
1587:bluetooth_rxtx.c **** 	le.win_offset = 0;
1588:bluetooth_rxtx.c **** 
1589:bluetooth_rxtx.c **** 	le.update_pending = 0;
1590:bluetooth_rxtx.c **** 	le.update_instant = 0;
1591:bluetooth_rxtx.c **** 	le.interval_update = 0;
1592:bluetooth_rxtx.c **** 	le.win_size_update = 0;
1593:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
1594:bluetooth_rxtx.c **** 
1595:bluetooth_rxtx.c **** 	do_hop = 0;
1596:bluetooth_rxtx.c **** }
1597:bluetooth_rxtx.c **** 
1598:bluetooth_rxtx.c **** // reset LE Promisc state
1599:bluetooth_rxtx.c **** void reset_le_promisc(void) {
1600:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
ARM GAS  /tmp/ccwLngFB.s 			page 42


1601:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
1602:bluetooth_rxtx.c **** }
1603:bluetooth_rxtx.c **** 
1604:bluetooth_rxtx.c **** /* generic le mode */
1605:bluetooth_rxtx.c **** void bt_generic_le(u8 active_mode)
1606:bluetooth_rxtx.c **** {
1607:bluetooth_rxtx.c **** 	u8 hold;
1608:bluetooth_rxtx.c **** 	int i, j;
1609:bluetooth_rxtx.c **** 	int8_t rssi, rssi_at_trigger;
1610:bluetooth_rxtx.c **** 
1611:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1612:bluetooth_rxtx.c **** 	mode = active_mode;
1613:bluetooth_rxtx.c **** 
1614:bluetooth_rxtx.c **** 	reset_le();
1615:bluetooth_rxtx.c **** 
1616:bluetooth_rxtx.c **** 	// enable USB interrupts
1617:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1618:bluetooth_rxtx.c **** 
1619:bluetooth_rxtx.c **** 	RXLED_CLR;
1620:bluetooth_rxtx.c **** 
1621:bluetooth_rxtx.c **** 	queue_init();
1622:bluetooth_rxtx.c **** 	dio_ssp_init();
1623:bluetooth_rxtx.c **** 	dma_init();
1624:bluetooth_rxtx.c **** 	dio_ssp_start();
1625:bluetooth_rxtx.c **** 	cc2400_rx();
1626:bluetooth_rxtx.c **** 
1627:bluetooth_rxtx.c **** 	cs_trigger_enable();
1628:bluetooth_rxtx.c **** 
1629:bluetooth_rxtx.c **** 	hold = 0;
1630:bluetooth_rxtx.c **** 
1631:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1632:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1633:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1634:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1635:bluetooth_rxtx.c **** 
1636:bluetooth_rxtx.c **** 			/* Retune */
1637:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1638:bluetooth_rxtx.c **** 
1639:bluetooth_rxtx.c **** 			/* Wait for lock */
1640:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1641:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1642:bluetooth_rxtx.c **** 
1643:bluetooth_rxtx.c **** 			/* RX mode */
1644:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1645:bluetooth_rxtx.c **** 
1646:bluetooth_rxtx.c **** 			requested_channel = 0;
1647:bluetooth_rxtx.c **** 		}
1648:bluetooth_rxtx.c **** 
1649:bluetooth_rxtx.c **** 		if (do_hop) {
1650:bluetooth_rxtx.c **** 			hop();
1651:bluetooth_rxtx.c **** 		} else {
1652:bluetooth_rxtx.c **** 			TXLED_CLR;
1653:bluetooth_rxtx.c **** 		}
1654:bluetooth_rxtx.c **** 
1655:bluetooth_rxtx.c **** 		RXLED_CLR;
1656:bluetooth_rxtx.c **** 
1657:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
ARM GAS  /tmp/ccwLngFB.s 			page 43


1658:bluetooth_rxtx.c **** 		rssi_reset();
1659:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1660:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
1661:bluetooth_rxtx.c **** 		{
1662:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1663:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1664:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1665:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1666:bluetooth_rxtx.c **** 			}
1667:bluetooth_rxtx.c **** 			rssi_add(rssi);
1668:bluetooth_rxtx.c **** 		}
1669:bluetooth_rxtx.c **** 
1670:bluetooth_rxtx.c **** 		if (rx_err) {
1671:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1672:bluetooth_rxtx.c **** 		}
1673:bluetooth_rxtx.c **** 
1674:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1675:bluetooth_rxtx.c **** 		if (!rx_tc)
1676:bluetooth_rxtx.c **** 			goto rx_continue;
1677:bluetooth_rxtx.c **** 
1678:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1679:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1680:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1681:bluetooth_rxtx.c **** 
1682:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1683:bluetooth_rxtx.c **** 
1684:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1685:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1686:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1687:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1688:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1689:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1690:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1691:bluetooth_rxtx.c **** 			cs_trigger = 0;
1692:bluetooth_rxtx.c **** 		}
1693:bluetooth_rxtx.c **** 
1694:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1695:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1696:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1697:bluetooth_rxtx.c **** 		}
1698:bluetooth_rxtx.c **** 
1699:bluetooth_rxtx.c **** 		/* Hold expired? Ignore data. */
1700:bluetooth_rxtx.c **** 		if (hold == 0) {
1701:bluetooth_rxtx.c **** 			goto rx_continue;
1702:bluetooth_rxtx.c **** 		}
1703:bluetooth_rxtx.c **** 		hold--;
1704:bluetooth_rxtx.c **** 
1705:bluetooth_rxtx.c **** 		// copy the previously unpacked symbols to the front of the buffer
1706:bluetooth_rxtx.c **** 		memcpy(unpacked, unpacked + DMA_SIZE*8, DMA_SIZE*8);
1707:bluetooth_rxtx.c **** 
1708:bluetooth_rxtx.c **** 		// unpack the new packet to the end of the buffer
1709:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; ++i) {
1710:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
1711:bluetooth_rxtx.c **** 			for (j = 0; j < 8; ++j) {
1712:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
1713:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
1714:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/ccwLngFB.s 			page 44


1715:bluetooth_rxtx.c **** 		}
1716:bluetooth_rxtx.c **** 
1717:bluetooth_rxtx.c **** 		int ret = data_cb(unpacked);
1718:bluetooth_rxtx.c **** 		if (!ret) break;
1719:bluetooth_rxtx.c **** 
1720:bluetooth_rxtx.c **** 	rx_continue:
1721:bluetooth_rxtx.c **** 		rx_tc = 0;
1722:bluetooth_rxtx.c **** 		rx_err = 0;
1723:bluetooth_rxtx.c **** 	}
1724:bluetooth_rxtx.c **** 
1725:bluetooth_rxtx.c **** 	// disable USB interrupts
1726:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1727:bluetooth_rxtx.c **** 
1728:bluetooth_rxtx.c **** 	// reset the radio completely
1729:bluetooth_rxtx.c **** 	cc2400_idle();
1730:bluetooth_rxtx.c **** 	dio_ssp_stop();
1731:bluetooth_rxtx.c **** 	cs_trigger_disable();
1732:bluetooth_rxtx.c **** }
1733:bluetooth_rxtx.c **** 
1734:bluetooth_rxtx.c **** 
1735:bluetooth_rxtx.c **** void bt_le_sync(u8 active_mode)
1736:bluetooth_rxtx.c **** {
1737:bluetooth_rxtx.c **** 	int i;
1738:bluetooth_rxtx.c **** 	int8_t rssi;
1739:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1740:bluetooth_rxtx.c **** 
1741:bluetooth_rxtx.c **** 	// rssi sampling for only 100 ms
1742:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
1743:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 1000 * 10000 / 3125; // millis -> clkn ticks
1744:bluetooth_rxtx.c **** 	int overflow = 0;
1745:bluetooth_rxtx.c **** 	// handle clkn overflow
1746:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
1747:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
1748:bluetooth_rxtx.c **** 		overflow = 1;
1749:bluetooth_rxtx.c **** 	}
1750:bluetooth_rxtx.c **** 
1751:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1752:bluetooth_rxtx.c **** 	mode = active_mode;
1753:bluetooth_rxtx.c **** 
1754:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1755:bluetooth_rxtx.c **** 
1756:bluetooth_rxtx.c **** 	// enable USB interrupts
1757:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1758:bluetooth_rxtx.c **** 
1759:bluetooth_rxtx.c **** 	RXLED_CLR;
1760:bluetooth_rxtx.c **** 
1761:bluetooth_rxtx.c **** 	queue_init();
1762:bluetooth_rxtx.c **** 	dio_ssp_init();
1763:bluetooth_rxtx.c **** 	dma_init_le();
1764:bluetooth_rxtx.c **** 	dio_ssp_start();
1765:bluetooth_rxtx.c **** 
1766:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address)); // bit-reversed access address
1767:bluetooth_rxtx.c **** 
1768:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1769:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1770:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1771:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
ARM GAS  /tmp/ccwLngFB.s 			page 45


1772:bluetooth_rxtx.c **** 
1773:bluetooth_rxtx.c **** 			/* Retune */
1774:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1775:bluetooth_rxtx.c **** 
1776:bluetooth_rxtx.c **** 			/* Wait for lock */
1777:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1778:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1779:bluetooth_rxtx.c **** 
1780:bluetooth_rxtx.c **** 			/* RX mode */
1781:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1782:bluetooth_rxtx.c **** 
1783:bluetooth_rxtx.c **** 			requested_channel = 0;
1784:bluetooth_rxtx.c **** 		}
1785:bluetooth_rxtx.c **** 
1786:bluetooth_rxtx.c **** 		RXLED_CLR;
1787:bluetooth_rxtx.c **** 
1788:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1789:bluetooth_rxtx.c **** 		rssi_reset();
1790:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)	;
1791:bluetooth_rxtx.c **** 
1792:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1793:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
1794:bluetooth_rxtx.c **** 
1795:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
1796:bluetooth_rxtx.c **** 			goto cleanup;
1797:bluetooth_rxtx.c **** 		}
1798:bluetooth_rxtx.c **** 
1799:bluetooth_rxtx.c **** 		if (rx_err) {
1800:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1801:bluetooth_rxtx.c **** 		}
1802:bluetooth_rxtx.c **** 
1803:bluetooth_rxtx.c **** 		if (do_hop)
1804:bluetooth_rxtx.c **** 			goto rx_flush;
1805:bluetooth_rxtx.c **** 
1806:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1807:bluetooth_rxtx.c **** 		if (!rx_tc)
1808:bluetooth_rxtx.c **** 			continue;
1809:bluetooth_rxtx.c **** 
1810:bluetooth_rxtx.c **** 		/////////////////////
1811:bluetooth_rxtx.c **** 		// process the packet
1812:bluetooth_rxtx.c **** 
1813:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = { 0, };
1814:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
1815:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
1816:bluetooth_rxtx.c **** 
1817:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel-2402)];
1818:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
1819:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1820:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1821:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1822:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1823:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1824:bluetooth_rxtx.c **** 		}
1825:bluetooth_rxtx.c **** 
1826:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
1827:bluetooth_rxtx.c **** 		if (len > 39)
1828:bluetooth_rxtx.c **** 			goto rx_flush;
ARM GAS  /tmp/ccwLngFB.s 			page 46


1829:bluetooth_rxtx.c **** 
1830:bluetooth_rxtx.c **** 		// transfer the minimum number of bytes from the CC2400
1831:bluetooth_rxtx.c **** 		// this allows us enough time to resume RX for subsequent packets on the same channel
1832:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
1833:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
1834:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
1835:bluetooth_rxtx.c **** 				;
1836:bluetooth_rxtx.c **** 		} else { // max transfers? just wait till DMA's done
1837:bluetooth_rxtx.c **** 			while (DMACC0Config & DMACCxConfig_E && rx_err == 0)
1838:bluetooth_rxtx.c **** 				;
1839:bluetooth_rxtx.c **** 		}
1840:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1841:bluetooth_rxtx.c **** 
1842:bluetooth_rxtx.c **** 		// strobe SFSON to allow the resync to occur while we process the packet
1843:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1844:bluetooth_rxtx.c **** 
1845:bluetooth_rxtx.c **** 		// unwhiten the rest of the packet
1846:bluetooth_rxtx.c **** 		for (i = 4; i < 44; i += 4) {
1847:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1848:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1849:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1850:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1851:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1852:bluetooth_rxtx.c **** 		}
1853:bluetooth_rxtx.c **** 
1854:bluetooth_rxtx.c **** 		if (le.crc_verify) {
1855:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
1856:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
1857:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
1858:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
1859:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
1860:bluetooth_rxtx.c **** 				goto rx_flush;
1861:bluetooth_rxtx.c **** 		}
1862:bluetooth_rxtx.c **** 
1863:bluetooth_rxtx.c **** 
1864:bluetooth_rxtx.c **** 		RXLED_SET;
1865:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
1866:bluetooth_rxtx.c **** 
1867:bluetooth_rxtx.c **** 		// disable USB interrupts while we touch USB data structures
1868:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
1869:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
1870:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
1871:bluetooth_rxtx.c **** 
1872:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
1873:bluetooth_rxtx.c **** 	
1874:bluetooth_rxtx.c **** 		// JWHUR beacon receiving time
1875:bluetooth_rxtx.c **** 		if (overflow == 0) {
1876:bluetooth_rxtx.c **** 			if ((clkn & 0xffffff) > stop_at)
1877:bluetooth_rxtx.c **** 				goto cleanup;
1878:bluetooth_rxtx.c **** 		} else {
1879:bluetooth_rxtx.c **** 			if ((clkn & 0xffffff) < now && (clkn & 0xffffff) > stop_at)
1880:bluetooth_rxtx.c **** 				goto cleanup;
1881:bluetooth_rxtx.c **** 		}
1882:bluetooth_rxtx.c **** 
1883:bluetooth_rxtx.c **** 	rx_flush:
1884:bluetooth_rxtx.c **** 		// this might happen twice, but it's safe to do so
1885:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
ARM GAS  /tmp/ccwLngFB.s 			page 47


1886:bluetooth_rxtx.c **** 
1887:bluetooth_rxtx.c **** 		// flush any excess bytes from the SSP's buffer
1888:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1889:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
1890:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
1891:bluetooth_rxtx.c **** 		}
1892:bluetooth_rxtx.c **** 
1893:bluetooth_rxtx.c **** 		// timeout - FIXME this is an ugly hack
1894:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
1895:bluetooth_rxtx.c **** 		if (now < le.last_packet)
1896:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
1897:bluetooth_rxtx.c **** 		if  ( // timeout
1898:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
1899:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
1900:bluetooth_rxtx.c **** 			// jam finished
1901:bluetooth_rxtx.c **** 			|| (le_jam_count == 1)
1902:bluetooth_rxtx.c **** 			)
1903:bluetooth_rxtx.c **** 		{
1904:bluetooth_rxtx.c **** 			reset_le();
1905:bluetooth_rxtx.c **** 			le_jam_count = 0;
1906:bluetooth_rxtx.c **** 			TXLED_CLR;
1907:bluetooth_rxtx.c **** 
1908:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
1909:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
1910:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
1911:bluetooth_rxtx.c **** 				goto cleanup;
1912:bluetooth_rxtx.c **** 			}
1913:bluetooth_rxtx.c **** 
1914:bluetooth_rxtx.c **** 			// go back to promisc if the connection dies
1915:bluetooth_rxtx.c **** 			if (active_mode == MODE_BT_PROMISC_LE)
1916:bluetooth_rxtx.c **** 				goto cleanup;
1917:bluetooth_rxtx.c **** 
1918:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
1919:bluetooth_rxtx.c **** 
1920:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1921:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1922:bluetooth_rxtx.c **** 
1923:bluetooth_rxtx.c **** 			/* Retune */
1924:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
1925:bluetooth_rxtx.c **** 			restart_jamming = 1;
1926:bluetooth_rxtx.c **** 		}
1927:bluetooth_rxtx.c **** 
1928:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
1929:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
1930:bluetooth_rxtx.c **** 
1931:bluetooth_rxtx.c **** 		if (do_hop)
1932:bluetooth_rxtx.c **** 			hop();
1933:bluetooth_rxtx.c **** 
1934:bluetooth_rxtx.c **** 		// ♪ you can jam but you keep turning off the light ♪
1935:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
1936:bluetooth_rxtx.c **** 			le_jam();
1937:bluetooth_rxtx.c **** 			--le_jam_count;
1938:bluetooth_rxtx.c **** 		} else {
1939:bluetooth_rxtx.c **** 			/* RX mode */
1940:bluetooth_rxtx.c **** 			dma_init_le();
1941:bluetooth_rxtx.c **** 			dio_ssp_start();
1942:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 48


1943:bluetooth_rxtx.c **** 			if (restart_jamming) {
1944:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
1945:bluetooth_rxtx.c **** 				restart_jamming = 0;
1946:bluetooth_rxtx.c **** 			} else {
1947:bluetooth_rxtx.c **** 				// wait till we're in FSLOCK before strobing RX
1948:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
1949:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
1950:bluetooth_rxtx.c **** 			}
1951:bluetooth_rxtx.c **** 		}
1952:bluetooth_rxtx.c **** 
1953:bluetooth_rxtx.c **** 		rx_tc = 0;
1954:bluetooth_rxtx.c **** 		rx_err = 0;
1955:bluetooth_rxtx.c **** 	}
1956:bluetooth_rxtx.c **** 
1957:bluetooth_rxtx.c **** cleanup:
1958:bluetooth_rxtx.c **** 
1959:bluetooth_rxtx.c **** 	// disable USB interrupts
1960:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1961:bluetooth_rxtx.c **** 
1962:bluetooth_rxtx.c **** 	// reset the radio completely
1963:bluetooth_rxtx.c **** 	cc2400_idle();
1964:bluetooth_rxtx.c **** 	dio_ssp_stop();
1965:bluetooth_rxtx.c **** 	cs_trigger_disable();
1966:bluetooth_rxtx.c **** }
1967:bluetooth_rxtx.c **** 
1968:bluetooth_rxtx.c **** //JWHUR cfo estimation tracking
1969:bluetooth_rxtx.c **** void bt_le_sync_cfo(u8 active_mode) 
1970:bluetooth_rxtx.c **** {
1971:bluetooth_rxtx.c **** 	int i;
1972:bluetooth_rxtx.c **** 	int8_t rssi;
1973:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1974:bluetooth_rxtx.c **** 	u8 cfo_buf[DMA_SIZE] = {0, };
1975:bluetooth_rxtx.c **** 
1976:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1977:bluetooth_rxtx.c **** 	mode = active_mode;
1978:bluetooth_rxtx.c **** 
1979:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1980:bluetooth_rxtx.c **** 
1981:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1982:bluetooth_rxtx.c **** 	RXLED_CLR;
1983:bluetooth_rxtx.c **** 	queue_init();
1984:bluetooth_rxtx.c **** 	dio_ssp_init();
1985:bluetooth_rxtx.c **** 	dma_init_le();
1986:bluetooth_rxtx.c **** 	dio_ssp_start();
1987:bluetooth_rxtx.c **** 
1988:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address));
1989:bluetooth_rxtx.c **** 
1990:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1991:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1992:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1993:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1994:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1995:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1996:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1997:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1998:bluetooth_rxtx.c **** 			requested_channel = 0;
1999:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccwLngFB.s 			page 49


2000:bluetooth_rxtx.c **** 		RXLED_CLR;
2001:bluetooth_rxtx.c **** 		rssi_reset();
2002:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode) ;
2003:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
2004:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
2005:bluetooth_rxtx.c **** 
2006:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
2007:bluetooth_rxtx.c **** 			goto cleanup;
2008:bluetooth_rxtx.c **** 		}
2009:bluetooth_rxtx.c **** 		if (rx_err) {
2010:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
2011:bluetooth_rxtx.c **** 		}
2012:bluetooth_rxtx.c **** 		if (do_hop)
2013:bluetooth_rxtx.c **** 			goto rx_flush;
2014:bluetooth_rxtx.c **** 		if (!rx_tc)
2015:bluetooth_rxtx.c **** 			continue;
2016:bluetooth_rxtx.c **** 		
2017:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = {0, };
2018:bluetooth_rxtx.c **** 		uint32_t whiten_packet[48/4+1] = {0, };
2019:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
2020:bluetooth_rxtx.c **** 
2021:bluetooth_rxtx.c **** 		//JWHUR buffering carrier frequency offset estimation
2022:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; i++) {
2023:bluetooth_rxtx.c **** 			cfo_buf[i] = cc2400_get_rev(FREQEST);
2024:bluetooth_rxtx.c **** 		}
2025:bluetooth_rxtx.c **** 
2026:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
2027:bluetooth_rxtx.c **** 		
2028:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel-2402)];
2029:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
2030:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
2031:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
2032:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
2033:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
2034:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
2035:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
2036:bluetooth_rxtx.c **** 		}
2037:bluetooth_rxtx.c **** 
2038:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
2039:bluetooth_rxtx.c **** 		cfo_buf[DMA_SIZE - 1] = p[5];
2040:bluetooth_rxtx.c **** 
2041:bluetooth_rxtx.c **** 		if (len > 39)
2042:bluetooth_rxtx.c **** 			goto rx_flush;
2043:bluetooth_rxtx.c **** 
2044:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
2045:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
2046:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0) ;
2047:bluetooth_rxtx.c **** 		} else { while (DMACC0Config & DMACCxConfig_E && rx_err == 0) ;
2048:bluetooth_rxtx.c **** 		}
2049:bluetooth_rxtx.c **** 
2050:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
2051:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
2052:bluetooth_rxtx.c **** 
2053:bluetooth_rxtx.c **** 		for (i=4; i<44; i+=4) {
2054:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
2055:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
2056:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
ARM GAS  /tmp/ccwLngFB.s 			page 50


2057:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
2058:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
2059:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
2060:bluetooth_rxtx.c **** 		}
2061:bluetooth_rxtx.c **** 
2062:bluetooth_rxtx.c **** 		if (le.crc_verify) {
2063:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
2064:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
2065:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
2066:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
2067:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc)
2068:bluetooth_rxtx.c **** 				goto rx_flush;
2069:bluetooth_rxtx.c **** 		}
2070:bluetooth_rxtx.c **** 
2071:bluetooth_rxtx.c **** 		RXLED_SET;
2072:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
2073:bluetooth_rxtx.c **** 
2074:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
2075:bluetooth_rxtx.c **** 		if (p[10] == 0x55 && p[11] == 0xec) {
2076:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t *)packet);
2077:bluetooth_rxtx.c **** 			enqueue(CFO_TRACK, (uint8_t *)cfo_buf);
2078:bluetooth_rxtx.c **** 			//enqueue(MESSAGE, (uint8_t *)whiten_packet);
2079:bluetooth_rxtx.c **** 		}
2080:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
2081:bluetooth_rxtx.c **** 
2082:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
2083:bluetooth_rxtx.c **** 
2084:bluetooth_rxtx.c **** 	rx_flush:
2085:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
2086:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
2087:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
2088:bluetooth_rxtx.c **** 			u8 tmp = (u8) DIO_SSP_DR;
2089:bluetooth_rxtx.c **** 		}
2090:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
2091:bluetooth_rxtx.c **** 		if (now <le.last_packet)
2092:bluetooth_rxtx.c **** 			now += 3276800000;
2093:bluetooth_rxtx.c **** 		if ( ((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING) && (now - le.last_p
2094:bluetooth_rxtx.c **** 			reset_le();
2095:bluetooth_rxtx.c **** 			le_jam_count = 0;
2096:bluetooth_rxtx.c **** 			TXLED_CLR;
2097:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
2098:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
2099:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
2100:bluetooth_rxtx.c **** 				goto cleanup;
2101:bluetooth_rxtx.c **** 			}
2102:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
2103:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
2104:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
2105:bluetooth_rxtx.c **** 
2106:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
2107:bluetooth_rxtx.c **** 			restart_jamming = 1;
2108:bluetooth_rxtx.c **** 		}
2109:bluetooth_rxtx.c **** 
2110:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
2111:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
2112:bluetooth_rxtx.c **** 
2113:bluetooth_rxtx.c **** 		if (do_hop)
ARM GAS  /tmp/ccwLngFB.s 			page 51


2114:bluetooth_rxtx.c **** 			hop();
2115:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
2116:bluetooth_rxtx.c **** 			le_jam();
2117:bluetooth_rxtx.c **** 			--le_jam_count;
2118:bluetooth_rxtx.c **** 		} else {
2119:bluetooth_rxtx.c **** 			dma_init_le();
2120:bluetooth_rxtx.c **** 			dio_ssp_start();
2121:bluetooth_rxtx.c **** 
2122:bluetooth_rxtx.c **** 			if (restart_jamming) {
2123:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
2124:bluetooth_rxtx.c **** 				restart_jamming = 0;
2125:bluetooth_rxtx.c **** 			} else {
2126:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
2127:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
2128:bluetooth_rxtx.c **** 			}
2129:bluetooth_rxtx.c **** 		}
2130:bluetooth_rxtx.c **** 		rx_tc = 0;
2131:bluetooth_rxtx.c **** 		rx_err = 0;
2132:bluetooth_rxtx.c **** 
2133:bluetooth_rxtx.c **** 	}
2134:bluetooth_rxtx.c **** 	goto cleanup;
2135:bluetooth_rxtx.c **** 
2136:bluetooth_rxtx.c **** cleanup:
2137:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
2138:bluetooth_rxtx.c **** 	cc2400_idle();
2139:bluetooth_rxtx.c **** 	dio_ssp_stop ();
2140:bluetooth_rxtx.c **** 	cs_trigger_disable();
2141:bluetooth_rxtx.c **** }
2142:bluetooth_rxtx.c **** 
2143:bluetooth_rxtx.c **** //JWHUR rssi tracking
2144:bluetooth_rxtx.c **** void bt_le_sync_rssi(u8 active_mode) 
2145:bluetooth_rxtx.c **** {
2146:bluetooth_rxtx.c **** 	int i;
2147:bluetooth_rxtx.c **** 	int8_t rssi;
2148:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
2149:bluetooth_rxtx.c **** 	u8 rssi_buf[DMA_SIZE] = {0, };
2150:bluetooth_rxtx.c **** 
2151:bluetooth_rxtx.c **** 	// rssi sampling for only 100 ms
2152:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
2153:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 100 * 10000 / 3125; // millis -> clkn ticks
2154:bluetooth_rxtx.c **** 	int overflow = 0;
2155:bluetooth_rxtx.c **** 	// handle clkn overflow
2156:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
2157:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
2158:bluetooth_rxtx.c **** 		overflow = 1;
2159:bluetooth_rxtx.c **** 	}
2160:bluetooth_rxtx.c **** 
2161:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
2162:bluetooth_rxtx.c **** 	mode = active_mode;
2163:bluetooth_rxtx.c **** 
2164:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
2165:bluetooth_rxtx.c **** 
2166:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
2167:bluetooth_rxtx.c **** 	RXLED_CLR;
2168:bluetooth_rxtx.c **** 	queue_init();
2169:bluetooth_rxtx.c **** 	dio_ssp_init();
2170:bluetooth_rxtx.c **** 	dma_init_le();
ARM GAS  /tmp/ccwLngFB.s 			page 52


2171:bluetooth_rxtx.c **** 	dio_ssp_start();
2172:bluetooth_rxtx.c **** 
2173:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address));
2174:bluetooth_rxtx.c **** 
2175:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
2176:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
2177:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
2178:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
2179:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
2180:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
2181:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
2182:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
2183:bluetooth_rxtx.c **** 			requested_channel = 0;
2184:bluetooth_rxtx.c **** 		}
2185:bluetooth_rxtx.c **** 		RXLED_CLR;
2186:bluetooth_rxtx.c **** 		
2187:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
2188:bluetooth_rxtx.c **** 			goto cleanup;
2189:bluetooth_rxtx.c **** 		}
2190:bluetooth_rxtx.c **** 
2191:bluetooth_rxtx.c **** 		//JWHUR buffering time information
2192:bluetooth_rxtx.c **** 		u32 time_buf1[16] = {0, };
2193:bluetooth_rxtx.c **** 		u32 time_buf2[16] = {0, };
2194:bluetooth_rxtx.c **** 		u32 time_buf3[16] = {0, };
2195:bluetooth_rxtx.c **** 		u32 time_buf4[16] = {0, };
2196:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; i++) {
2197:bluetooth_rxtx.c **** 			if (i<16) time_buf1[i] = CLK100NS;
2198:bluetooth_rxtx.c **** 			if (15<i && i<32) time_buf2[i-16] = CLK100NS;
2199:bluetooth_rxtx.c **** 			if (31<i && i<48) time_buf3[i-32] = CLK100NS;
2200:bluetooth_rxtx.c **** 			if (47<i) time_buf4[i-48] = CLK100NS;
2201:bluetooth_rxtx.c **** 			rssi_buf[i] = (u8)(cc2400_get(RSSI) >> 8);
2202:bluetooth_rxtx.c **** 			volatile u32 j = 598; while (--j); // empty for loop ~= 70ns, 598 empty while loop ~= 41.8us
2203:bluetooth_rxtx.c **** 		}
2204:bluetooth_rxtx.c **** 
2205:bluetooth_rxtx.c **** 		RXLED_SET;
2206:bluetooth_rxtx.c **** 
2207:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
2208:bluetooth_rxtx.c **** 		enqueue_with_ts(RSSI_TRACK, (uint8_t *)rssi_buf, CLK100NS);
2209:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf1);
2210:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf2);
2211:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf3);
2212:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf4);
2213:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
2214:bluetooth_rxtx.c **** 		
2215:bluetooth_rxtx.c **** 		if (overflow == 0) {
2216:bluetooth_rxtx.c **** 			if ((clkn & 0xffffff) > stop_at)
2217:bluetooth_rxtx.c **** 				goto cleanup;
2218:bluetooth_rxtx.c **** 		} else {
2219:bluetooth_rxtx.c **** 			if ((clkn & 0xffffff) < now && (clkn & 0xffffff) > stop_at)
2220:bluetooth_rxtx.c **** 				goto cleanup;
2221:bluetooth_rxtx.c **** 		}
2222:bluetooth_rxtx.c **** 		
2223:bluetooth_rxtx.c **** 	}
2224:bluetooth_rxtx.c **** cleanup:
2225:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
2226:bluetooth_rxtx.c **** 	cc2400_idle();
2227:bluetooth_rxtx.c **** 	dio_ssp_stop ();
ARM GAS  /tmp/ccwLngFB.s 			page 53


2228:bluetooth_rxtx.c **** 	cs_trigger_disable();
2229:bluetooth_rxtx.c **** }
2230:bluetooth_rxtx.c **** 
2231:bluetooth_rxtx.c **** /* low energy connection following
2232:bluetooth_rxtx.c ****  * follows a known AA around */
2233:bluetooth_rxtx.c **** int cb_follow_le() {
 630              		.loc 1 2233 0
 631              		.cfi_startproc
 632              		@ args = 0, pretend = 0, frame = 0
 633              		@ frame_needed = 0, uses_anonymous_args = 0
 634 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 635              		.cfi_def_cfa_offset 32
 636              		.cfi_offset 3, -32
 637              		.cfi_offset 4, -28
 638              		.cfi_offset 5, -24
 639              		.cfi_offset 6, -20
 640              		.cfi_offset 7, -16
 641              		.cfi_offset 8, -12
 642              		.cfi_offset 9, -8
 643              		.cfi_offset 14, -4
2234:bluetooth_rxtx.c **** 	int i, j, k;
2235:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
 644              		.loc 1 2235 0
 645 0004 394C     		ldr	r4, .L67
 646 0006 2088     		ldrh	r0, [r4]
 647 0008 2646     		mov	r6, r4
 648 000a 80B2     		uxth	r0, r0
 649 000c 6238     		subs	r0, r0, #98
 650 000e C0B2     		uxtb	r0, r0
 651 0010 FFF7FEFF 		bl	btle_channel_index
 652              	.LVL57:
 653 0014 3649     		ldr	r1, .L67+4
2236:bluetooth_rxtx.c **** 
2237:bluetooth_rxtx.c **** 	u32 access_address = 0;
 654              		.loc 1 2237 0
 655 0016 0022     		movs	r2, #0
2235:bluetooth_rxtx.c **** 
 656              		.loc 1 2235 0
 657 0018 0D5C     		ldrb	r5, [r1, r0]	@ zero_extendqisi2
 658              	.LVL58:
2238:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 659              		.loc 1 2238 0
 660 001a 1346     		mov	r3, r2
 661 001c 8C46     		mov	ip, r1
 662              	.LVL59:
 663              	.L48:
2239:bluetooth_rxtx.c **** 		access_address >>= 1;
2240:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 664              		.loc 1 2240 0 discriminator 2
 665 001e 354F     		ldr	r7, .L67+8
 666 0020 D95D     		ldrb	r1, [r3, r7]	@ zero_extendqisi2
2238:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 667              		.loc 1 2238 0 discriminator 2
 668 0022 0133     		adds	r3, r3, #1
 669              	.LVL60:
 670              		.loc 1 2240 0 discriminator 2
 671 0024 C907     		lsls	r1, r1, #31
ARM GAS  /tmp/ccwLngFB.s 			page 54


2238:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 672              		.loc 1 2238 0 discriminator 2
 673 0026 1F2B     		cmp	r3, #31
 674              		.loc 1 2240 0 discriminator 2
 675 0028 41EA5202 		orr	r2, r1, r2, lsr #1
 676              	.LVL61:
2238:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 677              		.loc 1 2238 0 discriminator 2
 678 002c F7D1     		bne	.L48
2241:bluetooth_rxtx.c **** 	}
2242:bluetooth_rxtx.c **** 
2243:bluetooth_rxtx.c **** 	for (i = 31; i < DMA_SIZE * 8 + 32; i++) {
2244:bluetooth_rxtx.c **** 		access_address >>= 1;
2245:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
2246:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 679              		.loc 1 2246 0
 680 002e 7168     		ldr	r1, [r6, #4]
 681              	.L60:
 682              	.LVL62:
2245:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 683              		.loc 1 2245 0
 684 0030 F85C     		ldrb	r0, [r7, r3]	@ zero_extendqisi2
 685 0032 C007     		lsls	r0, r0, #31
 686 0034 40EA5202 		orr	r2, r0, r2, lsr #1
 687              	.LVL63:
 688              		.loc 1 2246 0
 689 0038 8A42     		cmp	r2, r1
 690 003a 4FD1     		bne	.L49
 691 003c 0022     		movs	r2, #0
 692              	.LVL64:
 693              	.L50:
 694 003e 07EB0308 		add	r8, r7, r3
2238:bluetooth_rxtx.c **** 		access_address >>= 1;
 695              		.loc 1 2238 0 discriminator 1
 696 0042 0020     		movs	r0, #0
 697 0044 08EBC208 		add	r8, r8, r2, lsl #3
 698 0048 0146     		mov	r1, r0
 699              	.LVL65:
 700              	.L55:
 701 004a 08EB0104 		add	r4, r8, r1
 702              	.LBB6:
 703              	.LBB7:
2247:bluetooth_rxtx.c **** 			for (j = 0; j < 46; ++j) {
2248:bluetooth_rxtx.c **** 				u8 byte = 0;
2249:bluetooth_rxtx.c **** 				for (k = 0; k < 8; k++) {
2250:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
2251:bluetooth_rxtx.c **** 					if (offset >= DMA_SIZE*8*2) break;
2252:bluetooth_rxtx.c **** 					int bit = unpacked[offset];
2253:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 704              		.loc 1 2253 0
 705 004e 032A     		cmp	r2, #3
2252:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 706              		.loc 1 2252 0
 707 0050 14F81F4C 		ldrb	r4, [r4, #-31]	@ zero_extendqisi2
 708              	.LVL66:
 709              		.loc 1 2253 0
 710 0054 0CDD     		ble	.L52
ARM GAS  /tmp/ccwLngFB.s 			page 55


2254:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 711              		.loc 1 2254 0
 712 0056 0CEB050E 		add	lr, ip, r5
 713 005a 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
2255:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 714              		.loc 1 2255 0
 715 005e 0135     		adds	r5, r5, #1
 716              	.LVL67:
2254:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 717              		.loc 1 2254 0
 718 0060 84EA0E04 		eor	r4, r4, lr
 719              	.LVL68:
 720              		.loc 1 2255 0
 721 0064 4FF07F0E 		mov	lr, #127
 722 0068 B5FBFEF9 		udiv	r9, r5, lr
 723 006c 0EFB1955 		mls	r5, lr, r9, r5
 724              	.LVL69:
 725              	.L52:
2256:bluetooth_rxtx.c **** 					}
2257:bluetooth_rxtx.c **** 					byte |= bit << k;
 726              		.loc 1 2257 0
 727 0070 8C40     		lsls	r4, r4, r1
 728              	.LVL70:
 729              	.LBE7:
2249:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 730              		.loc 1 2249 0
 731 0072 0131     		adds	r1, r1, #1
 732              	.LVL71:
 733              	.LBB8:
 734              		.loc 1 2257 0
 735 0074 2043     		orrs	r0, r0, r4
 736              	.LVL72:
 737              	.LBE8:
2249:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 738              		.loc 1 2249 0
 739 0076 0829     		cmp	r1, #8
 740              	.LBB9:
 741              		.loc 1 2257 0
 742 0078 C0B2     		uxtb	r0, r0
 743              	.LVL73:
 744              	.LBE9:
2249:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 745              		.loc 1 2249 0
 746 007a E6D1     		bne	.L55
2258:bluetooth_rxtx.c **** 				}
2259:bluetooth_rxtx.c **** 				idle_rxbuf[j] = byte;
 747              		.loc 1 2259 0
 748 007c 1E4C     		ldr	r4, .L67+12
 749 007e 2168     		ldr	r1, [r4]
 750              	.LVL74:
 751 0080 8854     		strb	r0, [r1, r2]
 752              	.LBE6:
2247:bluetooth_rxtx.c **** 				u8 byte = 0;
 753              		.loc 1 2247 0
 754 0082 0132     		adds	r2, r2, #1
 755              	.LVL75:
 756 0084 2E2A     		cmp	r2, #46
ARM GAS  /tmp/ccwLngFB.s 			page 56


 757 0086 DAD1     		bne	.L50
2260:bluetooth_rxtx.c **** 			}
2261:bluetooth_rxtx.c **** 
2262:bluetooth_rxtx.c **** 			// verify CRC
2263:bluetooth_rxtx.c **** 			if (le.crc_verify) {
 758              		.loc 1 2263 0
 759 0088 7369     		ldr	r3, [r6, #20]
 760              	.LVL76:
 761 008a 5BB9     		cbnz	r3, .L56
 762              	.LVL77:
 763              	.L58:
2264:bluetooth_rxtx.c **** 				int len		 = (idle_rxbuf[5] & 0x3f) + 2;
2265:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
2266:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
2267:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
2268:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
2269:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
2270:bluetooth_rxtx.c **** 					break;
2271:bluetooth_rxtx.c **** 			}
2272:bluetooth_rxtx.c **** 
2273:bluetooth_rxtx.c **** 			// send to PC
2274:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 764              		.loc 1 2274 0
 765 008c 2168     		ldr	r1, [r4]
 766 008e 0120     		movs	r0, #1
 767 0090 FFF7FEFF 		bl	enqueue
 768              	.LVL78:
2275:bluetooth_rxtx.c **** 			RXLED_SET;
 769              		.loc 1 2275 0
 770 0094 194B     		ldr	r3, .L67+16
 771 0096 1022     		movs	r2, #16
 772 0098 1A60     		str	r2, [r3]
2276:bluetooth_rxtx.c **** 
2277:bluetooth_rxtx.c **** 			packet_cb((uint8_t*)idle_rxbuf);
 773              		.loc 1 2277 0
 774 009a 194B     		ldr	r3, .L67+20
 775 009c 2068     		ldr	r0, [r4]
 776 009e 9B69     		ldr	r3, [r3, #24]
 777 00a0 9847     		blx	r3
 778              	.LVL79:
2278:bluetooth_rxtx.c **** 
2279:bluetooth_rxtx.c **** 			break;
 779              		.loc 1 2279 0
 780 00a2 1FE0     		b	.L57
 781              	.LVL80:
 782              	.L56:
 783              	.LBB10:
2264:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 784              		.loc 1 2264 0
 785 00a4 2368     		ldr	r3, [r4]
 786 00a6 5D79     		ldrb	r5, [r3, #5]	@ zero_extendqisi2
 787              	.LVL81:
2265:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 788              		.loc 1 2265 0
 789 00a8 104B     		ldr	r3, .L67
 790 00aa 2168     		ldr	r1, [r4]
2264:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
ARM GAS  /tmp/ccwLngFB.s 			page 57


 791              		.loc 1 2264 0
 792 00ac 05F03F05 		and	r5, r5, #63
 793              	.LVL82:
2265:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 794              		.loc 1 2265 0
 795 00b0 AA1C     		adds	r2, r5, #2
 796              	.LVL83:
 797 00b2 1869     		ldr	r0, [r3, #16]
 798              	.LVL84:
 799 00b4 0431     		adds	r1, r1, #4
 800 00b6 FFF7FEFF 		bl	btle_crcgen_lut
 801              	.LVL85:
2266:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
 802              		.loc 1 2266 0
 803 00ba 2268     		ldr	r2, [r4]
 804 00bc 05F10803 		add	r3, r5, #8
 805 00c0 D15C     		ldrb	r1, [r2, r3]	@ zero_extendqisi2
2267:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 806              		.loc 1 2267 0
 807 00c2 2268     		ldr	r2, [r4]
 808 00c4 EB1D     		adds	r3, r5, #7
 809 00c6 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
2268:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 810              		.loc 1 2268 0
 811 00c8 2268     		ldr	r2, [r4]
 812 00ca 0635     		adds	r5, r5, #6
 813              	.LVL86:
 814 00cc 525D     		ldrb	r2, [r2, r5]	@ zero_extendqisi2
 815              	.LVL87:
2267:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 816              		.loc 1 2267 0
 817 00ce 1B02     		lsls	r3, r3, #8
 818              	.LVL88:
 819 00d0 43EA0143 		orr	r3, r3, r1, lsl #16
2268:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 820              		.loc 1 2268 0
 821 00d4 1343     		orrs	r3, r3, r2
2269:bluetooth_rxtx.c **** 					break;
 822              		.loc 1 2269 0
 823 00d6 9842     		cmp	r0, r3
 824 00d8 04D1     		bne	.L57
 825 00da D7E7     		b	.L58
 826              	.LVL89:
 827              	.L49:
 828              	.LBE10:
2243:bluetooth_rxtx.c **** 		access_address >>= 1;
 829              		.loc 1 2243 0
 830 00dc 0133     		adds	r3, r3, #1
 831              	.LVL90:
 832 00de B3F5D87F 		cmp	r3, #432
 833 00e2 A5D1     		bne	.L60
 834              	.LVL91:
 835              	.L57:
2280:bluetooth_rxtx.c **** 		}
2281:bluetooth_rxtx.c **** 	}
2282:bluetooth_rxtx.c **** 
2283:bluetooth_rxtx.c **** 	return 1;
ARM GAS  /tmp/ccwLngFB.s 			page 58


2284:bluetooth_rxtx.c **** }
 836              		.loc 1 2284 0
 837 00e4 0120     		movs	r0, #1
 838 00e6 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 839              	.L68:
 840 00ea 00BF     		.align	2
 841              	.L67:
 842 00ec 00000000 		.word	.LANCHOR1
 843 00f0 00000000 		.word	.LANCHOR2
 844 00f4 00000000 		.word	unpacked
 845 00f8 00000000 		.word	idle_rxbuf
 846 00fc 38C00920 		.word	537509944
 847 0100 00000000 		.word	.LANCHOR0
 848              		.cfi_endproc
 849              	.LFE26:
 851              		.section	.text.connection_follow_cb,"ax",%progbits
 852              		.align	1
 853              		.global	connection_follow_cb
 854              		.thumb
 855              		.thumb_func
 857              	connection_follow_cb:
 858              	.LFB27:
2285:bluetooth_rxtx.c **** 
2286:bluetooth_rxtx.c **** /**
2287:bluetooth_rxtx.c ****  * Called when we receive a packet in connection following mode.
2288:bluetooth_rxtx.c ****  */
2289:bluetooth_rxtx.c **** void connection_follow_cb(u8 *packet) {
 859              		.loc 1 2289 0
 860              		.cfi_startproc
 861              		@ args = 0, pretend = 0, frame = 0
 862              		@ frame_needed = 0, uses_anonymous_args = 0
 863              	.LVL92:
 864 0000 38B5     		push	{r3, r4, r5, lr}
 865              		.cfi_def_cfa_offset 16
 866              		.cfi_offset 3, -16
 867              		.cfi_offset 4, -12
 868              		.cfi_offset 5, -8
 869              		.cfi_offset 14, -4
 870              	.LVL93:
2290:bluetooth_rxtx.c **** 	int i;
2291:bluetooth_rxtx.c **** 	u32 aa = 0;
2292:bluetooth_rxtx.c **** 
2293:bluetooth_rxtx.c **** #define ADV_ADDRESS_IDX 0
2294:bluetooth_rxtx.c **** #define HEADER_IDX 4
2295:bluetooth_rxtx.c **** #define DATA_LEN_IDX 5
2296:bluetooth_rxtx.c **** #define DATA_START_IDX 6
2297:bluetooth_rxtx.c **** 
2298:bluetooth_rxtx.c **** 	// u8 *adv_addr = &packet[ADV_ADDRESS_IDX];
2299:bluetooth_rxtx.c **** 	u8 header = packet[HEADER_IDX];
2300:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
2301:bluetooth_rxtx.c **** 	u8 *data = &packet[DATA_START_IDX];
2302:bluetooth_rxtx.c **** 	// u8 *crc = &packet[DATA_START_IDX + *data_len];
2303:bluetooth_rxtx.c **** 
2304:bluetooth_rxtx.c **** 	if (le.link_state == LINK_CONN_PENDING) {
 871              		.loc 1 2304 0
 872 0002 584B     		ldr	r3, .L87
2289:bluetooth_rxtx.c **** 	int i;
ARM GAS  /tmp/ccwLngFB.s 			page 59


 873              		.loc 1 2289 0
 874 0004 0546     		mov	r5, r0
 875              		.loc 1 2304 0
 876 0006 1A7E     		ldrb	r2, [r3, #24]	@ zero_extendqisi2
2299:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
 877              		.loc 1 2299 0
 878 0008 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
 879              	.LVL94:
 880              		.loc 1 2304 0
 881 000a 022A     		cmp	r2, #2
 882 000c 1C46     		mov	r4, r3
 883 000e 13D1     		bne	.L70
2305:bluetooth_rxtx.c **** 		// We received a packet in the connection pending state, so now the device *should* be connected
2306:bluetooth_rxtx.c **** 		le.link_state = LINK_CONNECTED;
 884              		.loc 1 2306 0
 885 0010 0322     		movs	r2, #3
 886 0012 1A76     		strb	r2, [r3, #24]
 887              	.LVL95:
2307:bluetooth_rxtx.c **** 		le.conn_epoch = clkn;
 888              		.loc 1 2307 0
 889 0014 544A     		ldr	r2, .L87+4
 890 0016 1268     		ldr	r2, [r2]
 891 0018 DA61     		str	r2, [r3, #28]
2308:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval - 1;
 892              		.loc 1 2308 0
 893 001a 5A8C     		ldrh	r2, [r3, #34]
 894 001c 013A     		subs	r2, r2, #1
 895 001e 92B2     		uxth	r2, r2
 896 0020 1A84     		strh	r2, [r3, #32]	@ movhi
2309:bluetooth_rxtx.c **** 		le.conn_count = 0;
 897              		.loc 1 2309 0
 898 0022 0022     		movs	r2, #0
 899 0024 9A84     		strh	r2, [r3, #36]	@ movhi
2310:bluetooth_rxtx.c **** 		le.update_pending = 0;
 900              		.loc 1 2310 0
 901 0026 DA62     		str	r2, [r3, #44]
2311:bluetooth_rxtx.c **** 
2312:bluetooth_rxtx.c **** 		// hue hue hue
2313:bluetooth_rxtx.c **** 		if (jam_mode != JAM_NONE)
 902              		.loc 1 2313 0
 903 0028 504B     		ldr	r3, .L87+8
 904 002a DA7C     		ldrb	r2, [r3, #19]	@ zero_extendqisi2
 905 002c 002A     		cmp	r2, #0
 906 002e 00F09880 		beq	.L69
2314:bluetooth_rxtx.c **** 			le_jam_count = JAM_COUNT_DEFAULT;
 907              		.loc 1 2314 0
 908 0032 2822     		movs	r2, #40
 909 0034 DA61     		str	r2, [r3, #28]
 910 0036 38BD     		pop	{r3, r4, r5, pc}
 911              	.LVL96:
 912              	.L70:
2315:bluetooth_rxtx.c **** 
2316:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_CONNECTED) {
 913              		.loc 1 2316 0
 914 0038 032A     		cmp	r2, #3
 915 003a 3BD1     		bne	.L73
 916              	.LBB11:
ARM GAS  /tmp/ccwLngFB.s 			page 60


2317:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
2318:bluetooth_rxtx.c **** 
2319:bluetooth_rxtx.c **** 		// Apply any connection parameter update if necessary
2320:bluetooth_rxtx.c **** 		if (le.update_pending && le.conn_count == le.update_instant) {
 917              		.loc 1 2320 0
 918 003c DB6A     		ldr	r3, [r3, #44]
2317:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
 919              		.loc 1 2317 0
 920 003e 01F00301 		and	r1, r1, #3
 921              	.LVL97:
 922              		.loc 1 2320 0
 923 0042 A3B1     		cbz	r3, .L74
 924              		.loc 1 2320 0 is_stmt 0 discriminator 1
 925 0044 A38C     		ldrh	r3, [r4, #36]
 926 0046 228E     		ldrh	r2, [r4, #48]
 927 0048 9BB2     		uxth	r3, r3
 928 004a 9A42     		cmp	r2, r3
 929 004c 0FD1     		bne	.L74
2321:bluetooth_rxtx.c **** 			// This is the first packet received in the connection interval for which the new parameters app
2322:bluetooth_rxtx.c **** 			le.conn_epoch = clkn;
 930              		.loc 1 2322 0 is_stmt 1
 931 004e 464B     		ldr	r3, .L87+4
 932 0050 1B68     		ldr	r3, [r3]
 933 0052 E361     		str	r3, [r4, #28]
 934              	.LVL98:
2323:bluetooth_rxtx.c **** 			le.conn_interval = le.interval_update;
 935              		.loc 1 2323 0
 936 0054 638E     		ldrh	r3, [r4, #50]
 937 0056 6384     		strh	r3, [r4, #34]	@ movhi
2324:bluetooth_rxtx.c **** 			le.interval_timer = le.interval_update - 1;
 938              		.loc 1 2324 0
 939 0058 013B     		subs	r3, r3, #1
 940 005a 9BB2     		uxth	r3, r3
 941 005c 2384     		strh	r3, [r4, #32]	@ movhi
2325:bluetooth_rxtx.c **** 			le.win_size = le.win_size_update;
 942              		.loc 1 2325 0
 943 005e 94F83430 		ldrb	r3, [r4, #52]	@ zero_extendqisi2
 944 0062 84F82630 		strb	r3, [r4, #38]
2326:bluetooth_rxtx.c **** 			le.win_offset = le.win_offset_update;
 945              		.loc 1 2326 0
 946 0066 E38E     		ldrh	r3, [r4, #54]
 947 0068 2385     		strh	r3, [r4, #40]	@ movhi
2327:bluetooth_rxtx.c **** 			le.update_pending = 0;
 948              		.loc 1 2327 0
 949 006a 0023     		movs	r3, #0
 950 006c E362     		str	r3, [r4, #44]
 951              	.L74:
2328:bluetooth_rxtx.c **** 		}
2329:bluetooth_rxtx.c **** 
2330:bluetooth_rxtx.c **** 		if (llid == 0x03 && data[0] == 0x00) {
 952              		.loc 1 2330 0
 953 006e 0329     		cmp	r1, #3
 954 0070 77D1     		bne	.L69
 955              		.loc 1 2330 0 is_stmt 0 discriminator 1
 956 0072 AB79     		ldrb	r3, [r5, #6]	@ zero_extendqisi2
 957 0074 002B     		cmp	r3, #0
 958 0076 74D1     		bne	.L69
ARM GAS  /tmp/ccwLngFB.s 			page 61


2331:bluetooth_rxtx.c **** 			// This is a CONNECTION_UPDATE_REQ.
2332:bluetooth_rxtx.c **** 			// The host is changing the connection parameters.
2333:bluetooth_rxtx.c **** 			le.win_size_update = packet[7];
 959              		.loc 1 2333 0 is_stmt 1
 960 0078 EB79     		ldrb	r3, [r5, #7]	@ zero_extendqisi2
 961 007a 84F83430 		strb	r3, [r4, #52]
2334:bluetooth_rxtx.c **** 			le.win_offset_update = packet[8] + ((u16)packet[9] << 8);
 962              		.loc 1 2334 0
 963 007e 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 964 0080 2B7A     		ldrb	r3, [r5, #8]	@ zero_extendqisi2
 965 0082 03EB0223 		add	r3, r3, r2, lsl #8
 966 0086 E386     		strh	r3, [r4, #54]	@ movhi
2335:bluetooth_rxtx.c **** 			le.interval_update = packet[10] + ((u16)packet[11] << 8);
 967              		.loc 1 2335 0
 968 0088 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 969 008a AB7A     		ldrb	r3, [r5, #10]	@ zero_extendqisi2
 970 008c 03EB0223 		add	r3, r3, r2, lsl #8
 971 0090 6386     		strh	r3, [r4, #50]	@ movhi
2336:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 972              		.loc 1 2336 0
 973 0092 6A7C     		ldrb	r2, [r5, #17]	@ zero_extendqisi2
 974 0094 2B7C     		ldrb	r3, [r5, #16]	@ zero_extendqisi2
 975 0096 03EB0223 		add	r3, r3, r2, lsl #8
2337:bluetooth_rxtx.c **** 			if (le.update_instant - le.conn_count < 32767)
 976              		.loc 1 2337 0
 977 009a A28C     		ldrh	r2, [r4, #36]
2336:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 978              		.loc 1 2336 0
 979 009c 9BB2     		uxth	r3, r3
 980              		.loc 1 2337 0
 981 009e 92B2     		uxth	r2, r2
2336:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 982              		.loc 1 2336 0
 983 00a0 2386     		strh	r3, [r4, #48]	@ movhi
 984              		.loc 1 2337 0
 985 00a2 9B1A     		subs	r3, r3, r2
 986 00a4 47F6FE72 		movw	r2, #32766
 987 00a8 9342     		cmp	r3, r2
 988 00aa 5ADC     		bgt	.L69
2338:bluetooth_rxtx.c **** 				le.update_pending = 1;
 989              		.loc 1 2338 0
 990 00ac 2D4B     		ldr	r3, .L87
 991 00ae 0122     		movs	r2, #1
 992 00b0 DA62     		str	r2, [r3, #44]
 993 00b2 38BD     		pop	{r3, r4, r5, pc}
 994              	.LVL99:
 995              	.L73:
 996              	.LBE11:
2339:bluetooth_rxtx.c **** 		}
2340:bluetooth_rxtx.c **** 
2341:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_LISTENING) {
 997              		.loc 1 2341 0
 998 00b4 012A     		cmp	r2, #1
 999 00b6 54D1     		bne	.L69
 1000              	.LVL100:
 1001              	.LBB12:
2342:bluetooth_rxtx.c **** 		u8 pkt_type = packet[4] & 0x0F;
ARM GAS  /tmp/ccwLngFB.s 			page 62


2343:bluetooth_rxtx.c **** 		if (pkt_type == 0x05) {
 1002              		.loc 1 2343 0
 1003 00b8 01F00F01 		and	r1, r1, #15
 1004              	.LVL101:
 1005 00bc 0529     		cmp	r1, #5
 1006 00be 50D1     		bne	.L69
 1007              	.LBB13:
2344:bluetooth_rxtx.c **** 			uint16_t conn_interval;
2345:bluetooth_rxtx.c **** 
2346:bluetooth_rxtx.c **** 			// ignore packets with incorrect length
2347:bluetooth_rxtx.c **** 			if (*data_len != 34)
 1008              		.loc 1 2347 0
 1009 00c0 4379     		ldrb	r3, [r0, #5]	@ zero_extendqisi2
 1010 00c2 222B     		cmp	r3, #34
 1011 00c4 4DD1     		bne	.L69
 1012              	.LVL102:
2348:bluetooth_rxtx.c **** 				return;
2349:bluetooth_rxtx.c **** 
2350:bluetooth_rxtx.c **** 			// conn interval must be [7.5 ms, 4.0s] in units of 1.25 ms
2351:bluetooth_rxtx.c **** 			conn_interval = (packet[29] << 8) | packet[28];
 1013              		.loc 1 2351 0
 1014 00c6 037F     		ldrb	r3, [r0, #28]	@ zero_extendqisi2
 1015 00c8 427F     		ldrb	r2, [r0, #29]	@ zero_extendqisi2
 1016 00ca 43EA0222 		orr	r2, r3, r2, lsl #8
2352:bluetooth_rxtx.c **** 			if (conn_interval < 6 || conn_interval > 3200)
 1017              		.loc 1 2352 0
 1018 00ce 063A     		subs	r2, r2, #6
 1019 00d0 92B2     		uxth	r2, r2
 1020 00d2 40F67A43 		movw	r3, #3194
 1021 00d6 9A42     		cmp	r2, r3
 1022 00d8 43D8     		bhi	.L69
2353:bluetooth_rxtx.c **** 				return;
2354:bluetooth_rxtx.c **** 
2355:bluetooth_rxtx.c **** 			// This is a connect packet
2356:bluetooth_rxtx.c **** 			// if we have a target, see if InitA or AdvA matches
2357:bluetooth_rxtx.c **** 			if (le.target_set &&
 1023              		.loc 1 2357 0
 1024 00da 236C     		ldr	r3, [r4, #64]
 1025 00dc 2BB9     		cbnz	r3, .L76
 1026              	.LVL103:
 1027              	.L78:
2358:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
2359:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
2360:bluetooth_rxtx.c **** 				return;
2361:bluetooth_rxtx.c **** 			}
2362:bluetooth_rxtx.c **** 
2363:bluetooth_rxtx.c **** 			le.link_state = LINK_CONN_PENDING;
 1028              		.loc 1 2363 0
 1029 00de 0223     		movs	r3, #2
2364:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1030              		.loc 1 2364 0
 1031 00e0 0020     		movs	r0, #0
2363:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1032              		.loc 1 2363 0
 1033 00e2 2376     		strb	r3, [r4, #24]
 1034              		.loc 1 2364 0
 1035 00e4 6061     		str	r0, [r4, #20]
ARM GAS  /tmp/ccwLngFB.s 			page 63


 1036              	.LVL104:
2365:bluetooth_rxtx.c **** 
2366:bluetooth_rxtx.c **** 			for (i = 0; i < 4; ++i)
 1037              		.loc 1 2366 0
 1038 00e6 0346     		mov	r3, r0
 1039 00e8 11E0     		b	.L77
 1040              	.LVL105:
 1041              	.L76:
2358:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1042              		.loc 1 2358 0 discriminator 1
 1043 00ea 04F13800 		add	r0, r4, #56
 1044              	.LVL106:
 1045 00ee A91D     		adds	r1, r5, #6
 1046 00f0 0622     		movs	r2, #6
 1047 00f2 FFF7FEFF 		bl	memcmp
 1048              	.LVL107:
2357:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
 1049              		.loc 1 2357 0 discriminator 1
 1050 00f6 0028     		cmp	r0, #0
 1051 00f8 F1D0     		beq	.L78
2359:bluetooth_rxtx.c **** 				return;
 1052              		.loc 1 2359 0
 1053 00fa 04F13800 		add	r0, r4, #56
 1054 00fe 05F10C01 		add	r1, r5, #12
 1055 0102 0622     		movs	r2, #6
 1056 0104 FFF7FEFF 		bl	memcmp
 1057              	.LVL108:
2358:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1058              		.loc 1 2358 0
 1059 0108 0028     		cmp	r0, #0
 1060 010a E8D0     		beq	.L78
 1061 010c 38BD     		pop	{r3, r4, r5, pc}
 1062              	.LVL109:
 1063              	.L77:
 1064 010e EA18     		adds	r2, r5, r3
2367:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1065              		.loc 1 2367 0 discriminator 2
 1066 0110 917C     		ldrb	r1, [r2, #18]	@ zero_extendqisi2
 1067 0112 DA00     		lsls	r2, r3, #3
 1068 0114 01FA02F2 		lsl	r2, r1, r2
2366:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1069              		.loc 1 2366 0 discriminator 2
 1070 0118 0133     		adds	r3, r3, #1
 1071              	.LVL110:
 1072 011a 042B     		cmp	r3, #4
 1073              		.loc 1 2367 0 discriminator 2
 1074 011c 40EA0200 		orr	r0, r0, r2
 1075              	.LVL111:
2366:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1076              		.loc 1 2366 0 discriminator 2
 1077 0120 F5D1     		bne	.L77
2368:bluetooth_rxtx.c **** 			le_set_access_address(aa);
 1078              		.loc 1 2368 0
 1079 0122 FFF7FEFF 		bl	le_set_access_address
 1080              	.LVL112:
2369:bluetooth_rxtx.c **** 
2370:bluetooth_rxtx.c **** #define CRC_INIT (2+4+6+6+4)
ARM GAS  /tmp/ccwLngFB.s 			page 64


2371:bluetooth_rxtx.c **** 			le.crc_init = (packet[CRC_INIT+2] << 16)
2372:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1081              		.loc 1 2372 0
 1082 0126 E87D     		ldrb	r0, [r5, #23]	@ zero_extendqisi2
2371:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1083              		.loc 1 2371 0
 1084 0128 2B7E     		ldrb	r3, [r5, #24]	@ zero_extendqisi2
 1085              		.loc 1 2372 0
 1086 012a 0002     		lsls	r0, r0, #8
 1087 012c 40EA0340 		orr	r0, r0, r3, lsl #16
2373:bluetooth_rxtx.c **** 						|  packet[CRC_INIT+0];
 1088              		.loc 1 2373 0
 1089 0130 AB7D     		ldrb	r3, [r5, #22]	@ zero_extendqisi2
 1090 0132 1843     		orrs	r0, r0, r3
2371:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1091              		.loc 1 2371 0
 1092 0134 E060     		str	r0, [r4, #12]
2374:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1093              		.loc 1 2374 0
 1094 0136 FFF7FEFF 		bl	rbit
 1095              	.LVL113:
2375:bluetooth_rxtx.c **** 
2376:bluetooth_rxtx.c **** #define WIN_SIZE (2+4+6+6+4+3)
2377:bluetooth_rxtx.c **** 			le.win_size = packet[WIN_SIZE];
 1096              		.loc 1 2377 0
 1097 013a 6B7E     		ldrb	r3, [r5, #25]	@ zero_extendqisi2
2374:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1098              		.loc 1 2374 0
 1099 013c 2061     		str	r0, [r4, #16]
 1100              		.loc 1 2377 0
 1101 013e 84F82630 		strb	r3, [r4, #38]
2378:bluetooth_rxtx.c **** 
2379:bluetooth_rxtx.c **** #define WIN_OFFSET (2+4+6+6+4+3+1)
2380:bluetooth_rxtx.c **** 			le.win_offset = packet[WIN_OFFSET];
 1102              		.loc 1 2380 0
 1103 0142 AB7E     		ldrb	r3, [r5, #26]	@ zero_extendqisi2
 1104 0144 2385     		strh	r3, [r4, #40]	@ movhi
2381:bluetooth_rxtx.c **** 
2382:bluetooth_rxtx.c **** #define CONN_INTERVAL (2+4+6+6+4+3+1+2)
2383:bluetooth_rxtx.c **** 			le.conn_interval = (packet[CONN_INTERVAL+1] << 8)
 1105              		.loc 1 2383 0
 1106 0146 6A7F     		ldrb	r2, [r5, #29]	@ zero_extendqisi2
 1107 0148 2B7F     		ldrb	r3, [r5, #28]	@ zero_extendqisi2
 1108 014a 43EA0223 		orr	r3, r3, r2, lsl #8
 1109 014e 6384     		strh	r3, [r4, #34]	@ movhi
2384:bluetooth_rxtx.c **** 							 |  packet[CONN_INTERVAL+0];
2385:bluetooth_rxtx.c **** 
2386:bluetooth_rxtx.c **** #define CHANNEL_INC (2+4+6+6+4+3+1+2+2+2+2+5)
2387:bluetooth_rxtx.c **** 			le.channel_increment = packet[CHANNEL_INC] & 0x1f;
 1110              		.loc 1 2387 0
 1111 0150 95F82730 		ldrb	r3, [r5, #39]	@ zero_extendqisi2
2388:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
2389:bluetooth_rxtx.c **** 
2390:bluetooth_rxtx.c **** 			// Hop to the initial channel immediately
2391:bluetooth_rxtx.c **** 			do_hop = 1;
 1112              		.loc 1 2391 0
 1113 0154 0122     		movs	r2, #1
ARM GAS  /tmp/ccwLngFB.s 			page 65


2387:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1114              		.loc 1 2387 0
 1115 0156 03F01F03 		and	r3, r3, #31
 1116 015a A376     		strb	r3, [r4, #26]
2388:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1117              		.loc 1 2388 0
 1118 015c 6376     		strb	r3, [r4, #25]
 1119              		.loc 1 2391 0
 1120 015e 034B     		ldr	r3, .L87+8
 1121 0160 DA72     		strb	r2, [r3, #11]
 1122              	.L69:
 1123 0162 38BD     		pop	{r3, r4, r5, pc}
 1124              	.LVL114:
 1125              	.L88:
 1126              		.align	2
 1127              	.L87:
 1128 0164 00000000 		.word	.LANCHOR1
 1129 0168 00000000 		.word	clkn
 1130 016c 00000000 		.word	.LANCHOR0
 1131              	.LBE13:
 1132              	.LBE12:
 1133              		.cfi_endproc
 1134              	.LFE27:
 1136              		.global	__aeabi_llsl
 1137              		.section	.text.vendor_request_handler,"ax",%progbits
 1138              		.align	1
 1139              		.thumb
 1140              		.thumb_func
 1142              	vendor_request_handler:
 1143              	.LFB3:
 201:bluetooth_rxtx.c **** 	uint32_t clock;
 1144              		.loc 1 201 0
 1145              		.cfi_startproc
 1146              		@ args = 0, pretend = 0, frame = 0
 1147              		@ frame_needed = 0, uses_anonymous_args = 0
 1148              	.LVL115:
 1149 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1150              		.cfi_def_cfa_offset 24
 1151              		.cfi_offset 4, -24
 1152              		.cfi_offset 5, -20
 1153              		.cfi_offset 6, -16
 1154              		.cfi_offset 7, -12
 1155              		.cfi_offset 8, -8
 1156              		.cfi_offset 14, -4
 1157              	.LVL116:
 207:bluetooth_rxtx.c **** 
 1158              		.loc 1 207 0
 1159 0004 8B4C     		ldr	r4, .L251
 201:bluetooth_rxtx.c **** 	uint32_t clock;
 1160              		.loc 1 201 0
 1161 0006 1D46     		mov	r5, r3
 207:bluetooth_rxtx.c **** 
 1162              		.loc 1 207 0
 1163 0008 1B68     		ldr	r3, [r3]
 1164              	.LVL117:
 201:bluetooth_rxtx.c **** 	uint32_t clock;
 1165              		.loc 1 201 0
ARM GAS  /tmp/ccwLngFB.s 			page 66


 1166 000a 0F46     		mov	r7, r1
 1167 000c 1646     		mov	r6, r2
 207:bluetooth_rxtx.c **** 
 1168              		.loc 1 207 0
 1169 000e 2362     		str	r3, [r4, #32]
 209:bluetooth_rxtx.c **** 
 1170              		.loc 1 209 0
 1171 0010 4F28     		cmp	r0, #79
 1172 0012 00F27F83 		bhi	.L211
 1173 0016 DFE810F0 		tbh	[pc, r0, lsl #1]
 1174              	.LVL118:
 1175              	.L92:
 1176 001a 0601     		.2byte	(.L228-.L92)/2
 1177 001c 5200     		.2byte	(.L93-.L92)/2
 1178 001e 5600     		.2byte	(.L94-.L92)/2
 1179 0020 5900     		.2byte	(.L95-.L92)/2
 1180 0022 5E00     		.2byte	(.L96-.L92)/2
 1181 0024 6100     		.2byte	(.L97-.L92)/2
 1182 0026 6600     		.2byte	(.L98-.L92)/2
 1183 0028 6900     		.2byte	(.L99-.L92)/2
 1184 002a 6B00     		.2byte	(.L100-.L92)/2
 1185 002c 6F00     		.2byte	(.L101-.L92)/2
 1186 002e 7400     		.2byte	(.L102-.L92)/2
 1187 0030 C600     		.2byte	(.L103-.L92)/2
 1188 0032 CD00     		.2byte	(.L104-.L92)/2
 1189 0034 0B01     		.2byte	(.L247-.L92)/2
 1190 0036 8200     		.2byte	(.L106-.L92)/2
 1191 0038 7D00     		.2byte	(.L107-.L92)/2
 1192 003a 8700     		.2byte	(.L108-.L92)/2
 1193 003c 8C00     		.2byte	(.L109-.L92)/2
 1194 003e 8F00     		.2byte	(.L110-.L92)/2
 1195 0040 9400     		.2byte	(.L111-.L92)/2
 1196 0042 9C00     		.2byte	(.L112-.L92)/2
 1197 0044 BF00     		.2byte	(.L113-.L92)/2
 1198 0046 C100     		.2byte	(.L114-.L92)/2
 1199 0048 C300     		.2byte	(.L115-.L92)/2
 1200 004a 0401     		.2byte	(.L116-.L92)/2
 1201 004c 0801     		.2byte	(.L117-.L92)/2
 1202 004e 7D03     		.2byte	(.L211-.L92)/2
 1203 0050 2301     		.2byte	(.L118-.L92)/2
 1204 0052 9E00     		.2byte	(.L119-.L92)/2
 1205 0054 A500     		.2byte	(.L120-.L92)/2
 1206 0056 AF00     		.2byte	(.L121-.L92)/2
 1207 0058 AD00     		.2byte	(.L122-.L92)/2
 1208 005a B100     		.2byte	(.L123-.L92)/2
 1209 005c 5001     		.2byte	(.L124-.L92)/2
 1210 005e 4201     		.2byte	(.L125-.L92)/2
 1211 0060 6D01     		.2byte	(.L126-.L92)/2
 1212 0062 7001     		.2byte	(.L127-.L92)/2
 1213 0064 7401     		.2byte	(.L128-.L92)/2
 1214 0066 7801     		.2byte	(.L129-.L92)/2
 1215 0068 AB01     		.2byte	(.L130-.L92)/2
 1216 006a E001     		.2byte	(.L131-.L92)/2
 1217 006c 0402     		.2byte	(.L132-.L92)/2
 1218 006e 4402     		.2byte	(.L133-.L92)/2
 1219 0070 5702     		.2byte	(.L134-.L92)/2
 1220 0072 6202     		.2byte	(.L135-.L92)/2
ARM GAS  /tmp/ccwLngFB.s 			page 67


 1221 0074 7A03     		.2byte	(.L204-.L92)/2
 1222 0076 7102     		.2byte	(.L137-.L92)/2
 1223 0078 7602     		.2byte	(.L138-.L92)/2
 1224 007a 7C02     		.2byte	(.L139-.L92)/2
 1225 007c 8302     		.2byte	(.L140-.L92)/2
 1226 007e B302     		.2byte	(.L141-.L92)/2
 1227 0080 ED01     		.2byte	(.L142-.L92)/2
 1228 0082 FA01     		.2byte	(.L143-.L92)/2
 1229 0084 C002     		.2byte	(.L144-.L92)/2
 1230 0086 F702     		.2byte	(.L145-.L92)/2
 1231 0088 5F01     		.2byte	(.L146-.L92)/2
 1232 008a 5C03     		.2byte	(.L147-.L92)/2
 1233 008c 7D03     		.2byte	(.L211-.L92)/2
 1234 008e C802     		.2byte	(.L148-.L92)/2
 1235 0090 7303     		.2byte	(.L149-.L92)/2
 1236 0092 7603     		.2byte	(.L150-.L92)/2
 1237 0094 CA01     		.2byte	(.L151-.L92)/2
 1238 0096 DC01     		.2byte	(.L152-.L92)/2
 1239 0098 0F02     		.2byte	(.L153-.L92)/2
 1240 009a 7D03     		.2byte	(.L211-.L92)/2
 1241 009c 5000     		.2byte	(.L154-.L92)/2
 1242 009e DE02     		.2byte	(.L155-.L92)/2
 1243 00a0 4001     		.2byte	(.L156-.L92)/2
 1244 00a2 EE02     		.2byte	(.L157-.L92)/2
 1245 00a4 1602     		.2byte	(.L158-.L92)/2
 1246 00a6 0203     		.2byte	(.L159-.L92)/2
 1247 00a8 0D03     		.2byte	(.L160-.L92)/2
 1248 00aa 1903     		.2byte	(.L161-.L92)/2
 1249 00ac 2403     		.2byte	(.L162-.L92)/2
 1250 00ae 2F03     		.2byte	(.L163-.L92)/2
 1251 00b0 3A03     		.2byte	(.L164-.L92)/2
 1252 00b2 4503     		.2byte	(.L165-.L92)/2
 1253 00b4 5003     		.2byte	(.L166-.L92)/2
 1254 00b6 4B02     		.2byte	(.L167-.L92)/2
 1255 00b8 5102     		.2byte	(.L168-.L92)/2
 1256              	.L154:
 1257 00ba 0024     		movs	r4, #0
 1258 00bc 7AE2     		b	.L169
 1259              	.L93:
 216:bluetooth_rxtx.c **** 		*data_len = 0;
 1260              		.loc 1 216 0
 1261 00be 0120     		movs	r0, #1
 1262              	.LVL119:
 1263 00c0 A074     		strb	r0, [r4, #18]
 217:bluetooth_rxtx.c **** 		break;
 1264              		.loc 1 217 0
 1265 00c2 0023     		movs	r3, #0
 1266 00c4 A0E1     		b	.L221
 1267              	.LVL120:
 1268              	.L94:
 221:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 1269              		.loc 1 221 0
 1270 00c6 0223     		movs	r3, #2
 1271 00c8 A372     		strb	r3, [r4, #10]
 1272 00ca F4E0     		b	.L243
 1273              	.L95:
 227:bluetooth_rxtx.c **** 		*data_len = 1;
ARM GAS  /tmp/ccwLngFB.s 			page 68


 1274              		.loc 1 227 0
 1275 00cc 5A4B     		ldr	r3, .L251+4
 1276 00ce 1B68     		ldr	r3, [r3]
 1277 00d0 C3F34003 		ubfx	r3, r3, #1, #1
 1278 00d4 17E1     		b	.L222
 1279              	.L96:
 232:bluetooth_rxtx.c **** 			USRLED_SET;
 1280              		.loc 1 232 0
 1281 00d6 0A88     		ldrh	r2, [r1]
 1282 00d8 0223     		movs	r3, #2
 1283 00da 15E0     		b	.L240
 1284              	.L97:
 239:bluetooth_rxtx.c **** 		*data_len = 1;
 1285              		.loc 1 239 0
 1286 00dc 564B     		ldr	r3, .L251+4
 1287 00de 1B68     		ldr	r3, [r3]
 1288 00e0 C3F30013 		ubfx	r3, r3, #4, #1
 1289 00e4 0FE1     		b	.L222
 1290              	.L98:
 244:bluetooth_rxtx.c **** 			RXLED_SET;
 1291              		.loc 1 244 0
 1292 00e6 0A88     		ldrh	r2, [r1]
 1293 00e8 1023     		movs	r3, #16
 1294 00ea 0DE0     		b	.L240
 1295              	.L99:
 251:bluetooth_rxtx.c **** 		*data_len = 1;
 1296              		.loc 1 251 0
 1297 00ec 524B     		ldr	r3, .L251+4
 1298 00ee 24E0     		b	.L245
 1299              	.L100:
 256:bluetooth_rxtx.c **** 			TXLED_SET;
 1300              		.loc 1 256 0
 1301 00f0 0A88     		ldrh	r2, [r1]
 1302 00f2 4FF48073 		mov	r3, #256
 1303 00f6 07E0     		b	.L240
 1304              	.L101:
 263:bluetooth_rxtx.c **** 		*data_len = 1;
 1305              		.loc 1 263 0
 1306 00f8 4F4B     		ldr	r3, .L251+4
 1307 00fa 1B68     		ldr	r3, [r3]
 1308 00fc C3F34023 		ubfx	r3, r3, #9, #1
 1309 0100 01E1     		b	.L222
 1310              	.L102:
 268:bluetooth_rxtx.c **** 			CC1V8_SET;
 1311              		.loc 1 268 0
 1312 0102 0A88     		ldrh	r2, [r1]
 1313 0104 4FF40073 		mov	r3, #512
 1314              	.L240:
 1315 0108 12B9     		cbnz	r2, .L250
 259:bluetooth_rxtx.c **** 		break;
 1316              		.loc 1 259 0
 1317 010a 4C4A     		ldr	r2, .L251+8
 1318              	.L224:
 1319 010c 1360     		str	r3, [r2]
 1320 010e FEE2     		b	.L204
 1321              	.L250:
 269:bluetooth_rxtx.c **** 		else
ARM GAS  /tmp/ccwLngFB.s 			page 69


 1322              		.loc 1 269 0
 1323 0110 4B4A     		ldr	r2, .L251+12
 1324 0112 FBE7     		b	.L224
 1325              	.L107:
 275:bluetooth_rxtx.c **** 		break;
 1326              		.loc 1 275 0
 1327 0114 3046     		mov	r0, r6
 1328              	.LVL121:
 1329 0116 2946     		mov	r1, r5
 1330              	.LVL122:
 1331 0118 FFF7FEFF 		bl	get_part_num
 1332              	.LVL123:
 1333 011c F7E2     		b	.L204
 1334              	.LVL124:
 1335              	.L106:
 283:bluetooth_rxtx.c **** 		break;
 1336              		.loc 1 283 0
 1337 011e 3046     		mov	r0, r6
 1338              	.LVL125:
 1339 0120 2946     		mov	r1, r5
 1340              	.LVL126:
 1341 0122 FFF7FEFF 		bl	get_device_serial
 1342              	.LVL127:
 1343 0126 F2E2     		b	.L204
 1344              	.LVL128:
 1345              	.L108:
 288:bluetooth_rxtx.c **** 		*data_len = 1;
 1346              		.loc 1 288 0
 1347 0128 464B     		ldr	r3, .L251+16
 1348 012a 1B68     		ldr	r3, [r3]
 1349 012c C3F3C013 		ubfx	r3, r3, #7, #1
 1350 0130 E9E0     		b	.L222
 1351              	.L109:
 293:bluetooth_rxtx.c **** 			PAEN_SET;
 1352              		.loc 1 293 0
 1353 0132 0A88     		ldrh	r2, [r1]
 1354 0134 8023     		movs	r3, #128
 1355 0136 07E0     		b	.L242
 1356              	.L110:
 300:bluetooth_rxtx.c **** 		*data_len = 1;
 1357              		.loc 1 300 0
 1358 0138 424B     		ldr	r3, .L251+16
 1359              	.L245:
 1360 013a 1B68     		ldr	r3, [r3]
 1361 013c C3F30023 		ubfx	r3, r3, #8, #1
 1362 0140 E1E0     		b	.L222
 1363              	.L111:
 305:bluetooth_rxtx.c **** 			HGM_SET;
 1364              		.loc 1 305 0
 1365 0142 0A88     		ldrh	r2, [r1]
 1366 0144 4FF48073 		mov	r3, #256
 1367              	.L242:
 1368 0148 0AB1     		cbz	r2, .L175
 306:bluetooth_rxtx.c **** 		else
 1369              		.loc 1 306 0
 1370 014a 3F4A     		ldr	r2, .L251+20
 1371 014c DEE7     		b	.L224
ARM GAS  /tmp/ccwLngFB.s 			page 70


 1372              	.L175:
 308:bluetooth_rxtx.c **** 		break;
 1373              		.loc 1 308 0
 1374 014e 3F4A     		ldr	r2, .L251+24
 1375 0150 DCE7     		b	.L224
 1376              	.L112:
 314:bluetooth_rxtx.c **** 		break;
 1377              		.loc 1 314 0
 1378 0152 0323     		movs	r3, #3
 1379 0154 BBE2     		b	.L227
 1380              	.L119:
 318:bluetooth_rxtx.c **** 		*data_len = 1;
 1381              		.loc 1 318 0
 1382 0156 0520     		movs	r0, #5
 1383              	.LVL129:
 1384 0158 FFF7FEFF 		bl	cc2400_get
 1385              	.LVL130:
 1386 015c 00F00700 		and	r0, r0, #7
 1387 0160 3070     		strb	r0, [r6]
 1388 0162 E8E1     		b	.L218
 1389              	.LVL131:
 1390              	.L120:
 323:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 1391              		.loc 1 323 0
 1392 0164 0988     		ldrh	r1, [r1]
 1393              	.LVL132:
 1394 0166 0729     		cmp	r1, #7
 1395 0168 00F2D482 		bhi	.L211
 324:bluetooth_rxtx.c **** 		} else {
 1396              		.loc 1 324 0
 1397 016c 0520     		movs	r0, #5
 1398              	.LVL133:
 1399 016e 41F00801 		orr	r1, r1, #8
 1400 0172 1CE2     		b	.L232
 1401              	.LVL134:
 1402              	.L122:
 331:bluetooth_rxtx.c **** 		break;
 1403              		.loc 1 331 0
 1404 0174 0523     		movs	r3, #5
 1405 0176 AAE2     		b	.L227
 1406              	.L121:
 335:bluetooth_rxtx.c **** 		break;
 1407              		.loc 1 335 0
 1408 0178 0623     		movs	r3, #6
 1409 017a A8E2     		b	.L227
 1410              	.L123:
 340:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 1411              		.loc 1 340 0
 1412 017c 344B     		ldr	r3, .L251+28
 1413 017e 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1414 0180 3270     		strb	r2, [r6]
 341:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 1415              		.loc 1 341 0
 1416 0182 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1417 0184 7270     		strb	r2, [r6, #1]
 342:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 1418              		.loc 1 342 0
ARM GAS  /tmp/ccwLngFB.s 			page 71


 1419 0186 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1420 0188 B270     		strb	r2, [r6, #2]
 343:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 1421              		.loc 1 343 0
 1422 018a DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 1423 018c F270     		strb	r2, [r6, #3]
 344:bluetooth_rxtx.c **** 		*data_len = 5;
 1424              		.loc 1 344 0
 1425 018e 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 1426 0190 3371     		strb	r3, [r6, #4]
 345:bluetooth_rxtx.c **** 		break;
 1427              		.loc 1 345 0
 1428 0192 0523     		movs	r3, #5
 1429              	.LVL135:
 1430              	.L230:
 1431 0194 2B60     		str	r3, [r5]
 1432 0196 BAE2     		b	.L204
 1433              	.LVL136:
 1434              	.L113:
 349:bluetooth_rxtx.c **** 		break;
 1435              		.loc 1 349 0
 1436 0198 0023     		movs	r3, #0
 1437 019a 98E2     		b	.L227
 1438              	.L114:
 353:bluetooth_rxtx.c **** 		*data_len = 1;
 1439              		.loc 1 353 0
 1440 019c 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 1441 019e B2E0     		b	.L222
 1442              	.L115:
 358:bluetooth_rxtx.c **** 		break;
 1443              		.loc 1 358 0
 1444 01a0 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 1445 01a2 2370     		strb	r3, [r4]
 1446 01a4 B3E2     		b	.L204
 1447              	.L103:
 362:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 1448              		.loc 1 362 0
 1449 01a6 2B4B     		ldr	r3, .L251+32
 1450 01a8 1A88     		ldrh	r2, [r3]
 1451 01aa 3270     		strb	r2, [r6]
 363:bluetooth_rxtx.c **** 		*data_len = 2;
 1452              		.loc 1 363 0
 1453 01ac 1B88     		ldrh	r3, [r3]
 1454 01ae C3F30723 		ubfx	r3, r3, #8, #8
 1455 01b2 A6E1     		b	.L249
 1456              	.L104:
 368:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1457              		.loc 1 368 0
 1458 01b4 0A88     		ldrh	r2, [r1]
 1459 01b6 1F4B     		ldr	r3, .L251
 1460 01b8 E281     		strh	r2, [r4, #14]	@ movhi
 370:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1461              		.loc 1 370 0
 1462 01ba E189     		ldrh	r1, [r4, #14]
 1463              	.LVL137:
 1464 01bc 40F6EA22 		movw	r2, #2794
 1465 01c0 89B2     		uxth	r1, r1
ARM GAS  /tmp/ccwLngFB.s 			page 72


 1466 01c2 9142     		cmp	r1, r2
 1467 01c4 05D9     		bls	.L176
 371:bluetooth_rxtx.c **** 			requested_channel = 2402;
 1468              		.loc 1 371 0
 1469 01c6 0122     		movs	r2, #1
 1470 01c8 9A72     		strb	r2, [r3, #10]
 372:bluetooth_rxtx.c **** 		}
 1471              		.loc 1 372 0
 1472 01ca 40F66212 		movw	r2, #2402
 1473 01ce DA81     		strh	r2, [r3, #14]	@ movhi
 1474 01d0 17E0     		b	.L177
 1475              	.L176:
 376:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 1476              		.loc 1 376 0
 1477 01d2 0022     		movs	r2, #0
 1478 01d4 9A72     		strb	r2, [r3, #10]
 377:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1479              		.loc 1 377 0
 1480 01d6 D989     		ldrh	r1, [r3, #14]
 1481 01d8 40F6DC02 		movw	r2, #2268
 1482 01dc 89B2     		uxth	r1, r1
 1483 01de 9142     		cmp	r1, r2
 1484 01e0 8ABF     		itet	hi
 1485 01e2 DB89     		ldrhhi	r3, [r3, #14]
 1486 01e4 1346     		movls	r3, r2
 1487 01e6 9BB2     		uxthhi	r3, r3
 1488 01e8 E381     		strh	r3, [r4, #14]	@ movhi
 378:bluetooth_rxtx.c **** 		}
 1489              		.loc 1 378 0
 1490 01ea E289     		ldrh	r2, [r4, #14]
 1491 01ec 40F6E923 		movw	r3, #2793
 1492 01f0 92B2     		uxth	r2, r2
 1493 01f2 9A42     		cmp	r2, r3
 1494 01f4 97BF     		itett	ls
 1495 01f6 0F4B     		ldrls	r3, .L251
 1496 01f8 40F6EA23 		movwhi	r3, #2794
 1497 01fc DB89     		ldrhls	r3, [r3, #14]
 1498 01fe 9BB2     		uxthls	r3, r3
 1499 0200 E381     		strh	r3, [r4, #14]	@ movhi
 1500              	.L177:
 381:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1501              		.loc 1 381 0
 1502 0202 E189     		ldrh	r1, [r4, #14]
 1503 0204 134B     		ldr	r3, .L251+32
 1504 0206 89B2     		uxth	r1, r1
 1505 0208 A3F84A10 		strh	r1, [r3, #74]	@ movhi
 382:bluetooth_rxtx.c **** 			channel = requested_channel;
 1506              		.loc 1 382 0
 1507 020c 617C     		ldrb	r1, [r4, #17]	@ zero_extendqisi2
 381:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1508              		.loc 1 381 0
 1509 020e 094A     		ldr	r2, .L251
 382:bluetooth_rxtx.c **** 			channel = requested_channel;
 1510              		.loc 1 382 0
 1511 0210 0929     		cmp	r1, #9
 1512 0212 00F07C82 		beq	.L204
 383:bluetooth_rxtx.c **** 			requested_channel = 0;
ARM GAS  /tmp/ccwLngFB.s 			page 73


 1513              		.loc 1 383 0
 1514 0216 D189     		ldrh	r1, [r2, #14]
 1515 0218 89B2     		uxth	r1, r1
 1516 021a 1980     		strh	r1, [r3]	@ movhi
 384:bluetooth_rxtx.c **** 
 1517              		.loc 1 384 0
 1518 021c 0021     		movs	r1, #0
 1519 021e D181     		strh	r1, [r2, #14]	@ movhi
 1520 0220 B6E1     		b	.L234
 1521              	.LVL138:
 1522              	.L116:
 393:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 1523              		.loc 1 393 0
 1524 0222 FFF7FEFF 		bl	set_isp
 1525              	.LVL139:
 1526              	.L228:
 394:bluetooth_rxtx.c **** 		break;
 1527              		.loc 1 394 0
 1528 0226 0023     		movs	r3, #0
 1529 0228 B4E7     		b	.L230
 1530              	.LVL140:
 1531              	.L117:
 398:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 1532              		.loc 1 398 0
 1533 022a 0B4A     		ldr	r2, .L251+36
 1534 022c 0B4B     		ldr	r3, .L251+40
 1535 022e 1A60     		str	r2, [r3]
 1536              	.L247:
 399:bluetooth_rxtx.c **** 		break;
 1537              		.loc 1 399 0
 1538 0230 0B23     		movs	r3, #11
 1539 0232 4CE2     		b	.L227
 1540              	.L252:
 1541              		.align	2
 1542              	.L251:
 1543 0234 00000000 		.word	.LANCHOR0
 1544 0238 34C00920 		.word	537509940
 1545 023c 3CC00920 		.word	537509948
 1546 0240 38C00920 		.word	537509944
 1547 0244 54C00920 		.word	537509972
 1548 0248 58C00920 		.word	537509976
 1549 024c 5CC00920 		.word	537509980
 1550 0250 00000000 		.word	rr
 1551 0254 00000000 		.word	.LANCHOR1
 1552 0258 21BB0543 		.word	1124449057
 1553 025c 00000000 		.word	bootloader_ctrl
 1554              	.L118:
 403:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1555              		.loc 1 403 0
 1556 0260 0A88     		ldrh	r2, [r1]
 1557 0262 6FF4006C 		mvn	ip, #2048
 1558 0266 02EB0C03 		add	r3, r2, ip
 1559 026a 40F2FF31 		movw	r1, #1023
 1560              	.LVL141:
 1561 026e 9BB2     		uxth	r3, r3
 1562 0270 8B42     		cmp	r3, r1
 1563 0272 00F24F82 		bhi	.L211
ARM GAS  /tmp/ccwLngFB.s 			page 74


 404:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1564              		.loc 1 404 0 discriminator 1
 1565 0276 7B88     		ldrh	r3, [r7, #2]
 403:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1566              		.loc 1 403 0 discriminator 1
 1567 0278 6FF40066 		mvn	r6, #2048
 1568              	.LVL142:
 1569 027c 9819     		adds	r0, r3, r6
 1570              	.LVL143:
 1571 027e 80B2     		uxth	r0, r0
 1572 0280 8842     		cmp	r0, r1
 1573 0282 00F24782 		bhi	.L211
 404:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1574              		.loc 1 404 0 discriminator 1
 1575 0286 9342     		cmp	r3, r2
 1576 0288 C0F04482 		bcc	.L211
 407:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 1577              		.loc 1 407 0
 1578 028c AC49     		ldr	r1, .L253
 1579 028e A1F84C20 		strh	r2, [r1, #76]	@ movhi
 408:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 1580              		.loc 1 408 0
 1581 0292 A1F84E30 		strh	r3, [r1, #78]	@ movhi
 409:bluetooth_rxtx.c **** 		*data_len = 0;
 1582              		.loc 1 409 0
 1583 0296 0423     		movs	r3, #4
 1584 0298 0DE0     		b	.L243
 1585              	.LVL144:
 1586              	.L156:
 414:bluetooth_rxtx.c **** 		*data_len = 0;
 1587              		.loc 1 414 0
 1588 029a 0F23     		movs	r3, #15
 1589 029c 0BE0     		b	.L243
 1590              	.L125:
 419:bluetooth_rxtx.c **** 			return 0;
 1591              		.loc 1 419 0
 1592 029e 0B88     		ldrh	r3, [r1]
 1593 02a0 B3F5807F 		cmp	r3, #256
 1594 02a4 00F23682 		bhi	.L211
 421:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 1595              		.loc 1 421 0
 1596 02a8 C3F13603 		rsb	r3, r3, #54
 1597 02ac A44A     		ldr	r2, .L253
 1598 02ae DBB2     		uxtb	r3, r3
 1599 02b0 82F85030 		strb	r3, [r2, #80]
 422:bluetooth_rxtx.c **** 		*data_len = 0;
 1600              		.loc 1 422 0
 1601 02b4 0723     		movs	r3, #7
 1602              	.LVL145:
 1603              	.L243:
 1604 02b6 A374     		strb	r3, [r4, #18]
 1605 02b8 B5E7     		b	.L228
 1606              	.LVL146:
 1607              	.L124:
 427:bluetooth_rxtx.c **** 		data[1] = 0x00;
 1608              		.loc 1 427 0
 1609 02ba 0023     		movs	r3, #0
ARM GAS  /tmp/ccwLngFB.s 			page 75


 1610 02bc 3370     		strb	r3, [r6]
 428:bluetooth_rxtx.c **** 
 1611              		.loc 1 428 0
 1612 02be 7370     		strb	r3, [r6, #1]
 430:bluetooth_rxtx.c **** 		data[2] = length;
 1613              		.loc 1 430 0
 1614 02c0 A048     		ldr	r0, .L253+4
 1615              	.LVL147:
 1616 02c2 FFF7FEFF 		bl	strlen
 1617              	.LVL148:
 1618 02c6 C4B2     		uxtb	r4, r0
 1619              	.LVL149:
 431:bluetooth_rxtx.c **** 
 1620              		.loc 1 431 0
 1621 02c8 B470     		strb	r4, [r6, #2]
 433:bluetooth_rxtx.c **** 
 1622              		.loc 1 433 0
 1623 02ca 2246     		mov	r2, r4
 1624 02cc F01C     		adds	r0, r6, #3
 1625 02ce 9D49     		ldr	r1, .L253+4
 1626 02d0 FFF7FEFF 		bl	memcpy
 1627              	.LVL150:
 435:bluetooth_rxtx.c **** 		break;
 1628              		.loc 1 435 0
 1629 02d4 0334     		adds	r4, r4, #3
 1630              	.LVL151:
 1631 02d6 0BE0     		b	.L233
 1632              	.LVL152:
 1633              	.L146:
 439:bluetooth_rxtx.c **** 		data[0] = length;
 1634              		.loc 1 439 0
 1635 02d8 9B48     		ldr	r0, .L253+8
 1636              	.LVL153:
 1637 02da FFF7FEFF 		bl	strlen
 1638              	.LVL154:
 1639 02de C4B2     		uxtb	r4, r0
 1640              	.LVL155:
 440:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 1641              		.loc 1 440 0
 1642 02e0 3046     		mov	r0, r6
 1643 02e2 00F8014B 		strb	r4, [r0], #1
 441:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 1644              		.loc 1 441 0
 1645 02e6 2246     		mov	r2, r4
 1646 02e8 9749     		ldr	r1, .L253+8
 1647 02ea FFF7FEFF 		bl	memcpy
 1648              	.LVL156:
 442:bluetooth_rxtx.c **** 		break;
 1649              		.loc 1 442 0
 1650 02ee 0134     		adds	r4, r4, #1
 1651              	.LVL157:
 1652              	.L233:
 1653 02f0 2C60     		str	r4, [r5]
 1654 02f2 0CE2     		b	.L204
 1655              	.LVL158:
 1656              	.L126:
 446:bluetooth_rxtx.c **** 		*data_len = 1;
ARM GAS  /tmp/ccwLngFB.s 			page 76


 1657              		.loc 1 446 0
 1658 02f4 0120     		movs	r0, #1
 1659              	.LVL159:
 1660 02f6 3070     		strb	r0, [r6]
 1661 02f8 1EE1     		b	.L219
 1662              	.LVL160:
 1663              	.L127:
 451:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1664              		.loc 1 451 0
 1665 02fa 0A88     		ldrh	r2, [r1]
 1666 02fc 934B     		ldr	r3, .L253+12
 1667 02fe 1A70     		strb	r2, [r3]
 1668 0300 45E1     		b	.L231
 1669              	.L128:
 456:bluetooth_rxtx.c **** 		*data_len = 1;
 1670              		.loc 1 456 0
 1671 0302 924B     		ldr	r3, .L253+12
 1672 0304 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1673              	.L222:
 1674 0306 3370     		strb	r3, [r6]
 1675 0308 15E1     		b	.L218
 1676              	.L129:
 461:bluetooth_rxtx.c **** 		target.syncword = 0;
 1677              		.loc 1 461 0
 1678 030a 914F     		ldr	r7, .L253+16
 1679 030c 0024     		movs	r4, #0
 1680 030e 0025     		movs	r5, #0
 1681              	.LVL161:
 1682 0310 C7E90045 		strd	r4, [r7]
 462:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 1683              		.loc 1 462 0
 1684 0314 C7E90245 		strd	r4, [r7, #8]
 1685              	.LVL162:
 1686              	.LBB14:
 463:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1687              		.loc 1 463 0
 1688 0318 4FF00008 		mov	r8, #0
 1689              	.LVL163:
 1690              	.L182:
 464:bluetooth_rxtx.c **** 		}
 1691              		.loc 1 464 0 discriminator 2
 1692 031c 16F80800 		ldrb	r0, [r6, r8]	@ zero_extendqisi2
 1693 0320 4FEAC802 		lsl	r2, r8, #3
 1694 0324 0021     		movs	r1, #0
 1695 0326 FFF7FEFF 		bl	__aeabi_llsl
 1696              	.LVL164:
 1697 032a D7E90045 		ldrd	r4, [r7]
 463:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1698              		.loc 1 463 0 discriminator 2
 1699 032e 08F10108 		add	r8, r8, #1
 1700              	.LVL165:
 464:bluetooth_rxtx.c **** 		}
 1701              		.loc 1 464 0 discriminator 2
 1702 0332 2043     		orrs	r0, r0, r4
 1703 0334 2943     		orrs	r1, r1, r5
 463:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1704              		.loc 1 463 0 discriminator 2
ARM GAS  /tmp/ccwLngFB.s 			page 77


 1705 0336 B8F1080F 		cmp	r8, #8
 464:bluetooth_rxtx.c **** 		}
 1706              		.loc 1 464 0 discriminator 2
 1707 033a C7E90001 		strd	r0, [r7]
 463:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1708              		.loc 1 463 0 discriminator 2
 1709 033e EDD1     		bne	.L182
 463:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1710              		.loc 1 463 0 is_stmt 0
 1711 0340 4FF00008 		mov	r8, #0
 1712              	.LVL166:
 1713              	.L184:
 1714 0344 06EB0803 		add	r3, r6, r8
 1715              	.LBE14:
 1716              	.LBB15:
 467:bluetooth_rxtx.c **** 		}
 1717              		.loc 1 467 0 is_stmt 1 discriminator 2
 1718 0348 187A     		ldrb	r0, [r3, #8]	@ zero_extendqisi2
 1719 034a 4FEAC802 		lsl	r2, r8, #3
 1720 034e 0021     		movs	r1, #0
 1721 0350 FFF7FEFF 		bl	__aeabi_llsl
 1722              	.LVL167:
 1723 0354 D7E90245 		ldrd	r4, [r7, #8]
 466:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1724              		.loc 1 466 0 discriminator 2
 1725 0358 08F10108 		add	r8, r8, #1
 1726              	.LVL168:
 467:bluetooth_rxtx.c **** 		}
 1727              		.loc 1 467 0 discriminator 2
 1728 035c 2043     		orrs	r0, r0, r4
 1729 035e 2943     		orrs	r1, r1, r5
 466:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1730              		.loc 1 466 0 discriminator 2
 1731 0360 B8F1080F 		cmp	r8, #8
 467:bluetooth_rxtx.c **** 		}
 1732              		.loc 1 467 0 discriminator 2
 1733 0364 C7E90201 		strd	r0, [r7, #8]
 466:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1734              		.loc 1 466 0 discriminator 2
 1735 0368 ECD1     		bne	.L184
 1736              	.LBE15:
 469:bluetooth_rxtx.c **** 		break;
 1737              		.loc 1 469 0
 1738 036a FFF7FEFF 		bl	precalc
 1739              	.LVL169:
 1740 036e CEE1     		b	.L204
 1741              	.LVL170:
 1742              	.L130:
 473:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1743              		.loc 1 473 0
 1744 0370 784A     		ldr	r2, .L253+20
 1745 0372 0023     		movs	r3, #0
 1746 0374 1360     		str	r3, [r2]
 1747              	.LVL171:
 1748              	.L186:
 1749              	.LBB16:
 475:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
ARM GAS  /tmp/ccwLngFB.s 			page 78


 1750              		.loc 1 475 0 discriminator 2
 1751 0376 1168     		ldr	r1, [r2]
 1752 0378 0902     		lsls	r1, r1, #8
 1753 037a 1160     		str	r1, [r2]
 476:bluetooth_rxtx.c **** 		}
 1754              		.loc 1 476 0 discriminator 2
 1755 037c F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 1756 037e 1168     		ldr	r1, [r2]
 474:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1757              		.loc 1 474 0 discriminator 2
 1758 0380 0133     		adds	r3, r3, #1
 1759              	.LVL172:
 476:bluetooth_rxtx.c **** 		}
 1760              		.loc 1 476 0 discriminator 2
 1761 0382 0143     		orrs	r1, r1, r0
 474:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1762              		.loc 1 474 0 discriminator 2
 1763 0384 042B     		cmp	r3, #4
 476:bluetooth_rxtx.c **** 		}
 1764              		.loc 1 476 0 discriminator 2
 1765 0386 1160     		str	r1, [r2]
 474:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1766              		.loc 1 474 0 discriminator 2
 1767 0388 F5D1     		bne	.L186
 1768              	.LBE16:
 478:bluetooth_rxtx.c **** 		dma_discard = 1;
 1769              		.loc 1 478 0
 1770 038a 0223     		movs	r3, #2
 1771              	.LVL173:
 1772 038c A372     		strb	r3, [r4, #10]
 480:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1773              		.loc 1 480 0
 1774 038e 724B     		ldr	r3, .L253+24
 479:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1775              		.loc 1 479 0
 1776 0390 0120     		movs	r0, #1
 480:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1777              		.loc 1 480 0
 1778 0392 4FF08052 		mov	r2, #268435456
 479:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1779              		.loc 1 479 0
 1780 0396 2074     		strb	r0, [r4, #16]
 480:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1781              		.loc 1 480 0
 1782 0398 1A60     		str	r2, [r3]
 481:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 1783              		.loc 1 481 0
 1784 039a 7379     		ldrb	r3, [r6, #5]	@ zero_extendqisi2
 1785 039c 3279     		ldrb	r2, [r6, #4]	@ zero_extendqisi2
 1786 039e 43EA0222 		orr	r2, r3, r2, lsl #8
 1787 03a2 6E4B     		ldr	r3, .L253+28
 1788 03a4 1A80     		strh	r2, [r3]	@ movhi
 482:bluetooth_rxtx.c **** 		break;
 1789              		.loc 1 482 0
 1790 03a6 0823     		movs	r3, #8
 1791 03a8 A374     		strb	r3, [r4, #18]
 483:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 79


 1792              		.loc 1 483 0
 1793 03aa BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1794              	.LVL174:
 1795              	.L151:
 486:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 1796              		.loc 1 486 0
 1797 03ae 0523     		movs	r3, #5
 1798 03b0 A372     		strb	r3, [r4, #10]
 487:bluetooth_rxtx.c **** 
 1799              		.loc 1 487 0
 1800 03b2 0E23     		movs	r3, #14
 1801 03b4 A374     		strb	r3, [r4, #18]
 1802              	.LVL175:
 1803              	.LBB17:
 489:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1804              		.loc 1 489 0
 1805 03b6 0023     		movs	r3, #0
 1806              	.LVL176:
 1807              	.L188:
 490:bluetooth_rxtx.c **** 		}
 1808              		.loc 1 490 0 discriminator 2
 1809 03b8 6949     		ldr	r1, .L253+32
 1810 03ba 0022     		movs	r2, #0
 1811 03bc 5A54     		strb	r2, [r3, r1]
 489:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1812              		.loc 1 489 0 discriminator 2
 1813 03be 0133     		adds	r3, r3, #1
 1814              	.LVL177:
 1815 03c0 0A2B     		cmp	r3, #10
 1816 03c2 F9D1     		bne	.L188
 1817              	.LBE17:
 492:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1818              		.loc 1 492 0
 1819 03c4 674B     		ldr	r3, .L253+36
 1820              	.LVL178:
 493:bluetooth_rxtx.c **** 		break;
 1821              		.loc 1 493 0
 1822 03c6 0120     		movs	r0, #1
 1823              	.LVL179:
 492:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1824              		.loc 1 492 0
 1825 03c8 1A70     		strb	r2, [r3]
 493:bluetooth_rxtx.c **** 		break;
 1826              		.loc 1 493 0
 1827 03ca 674B     		ldr	r3, .L253+40
 1828 03cc 1870     		strb	r0, [r3]
 494:bluetooth_rxtx.c **** 
 1829              		.loc 1 494 0
 1830 03ce BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1831              	.LVL180:
 1832              	.L152:
 497:bluetooth_rxtx.c **** 		break;
 1833              		.loc 1 497 0
 1834 03d2 0120     		movs	r0, #1
 1835              	.LVL181:
 1836 03d4 E072     		strb	r0, [r4, #11]
 498:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 80


 1837              		.loc 1 498 0
 1838 03d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1839              	.LVL182:
 1840              	.L131:
 501:bluetooth_rxtx.c **** 		clkn = clock;
 1841              		.loc 1 501 0
 1842 03da B278     		ldrb	r2, [r6, #2]	@ zero_extendqisi2
 1843 03dc 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 1844 03de 1204     		lsls	r2, r2, #16
 1845 03e0 42EA0322 		orr	r2, r2, r3, lsl #8
 1846 03e4 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 1847 03e6 1A43     		orrs	r2, r2, r3
 1848 03e8 F378     		ldrb	r3, [r6, #3]	@ zero_extendqisi2
 1849 03ea 42EA0362 		orr	r2, r2, r3, lsl #24
 1850              	.LVL183:
 502:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1851              		.loc 1 502 0
 1852 03ee 5F4B     		ldr	r3, .L253+44
 1853 03f0 1A60     		str	r2, [r3]
 1854 03f2 CCE0     		b	.L231
 1855              	.LVL184:
 1856              	.L142:
 209:bluetooth_rxtx.c **** 
 1857              		.loc 1 209 0
 1858 03f4 0023     		movs	r3, #0
 1859              	.LVL185:
 1860              	.L190:
 1861              	.LBB18:
 508:bluetooth_rxtx.c **** 		}
 1862              		.loc 1 508 0 discriminator 2
 1863 03f6 F15C     		ldrb	r1, [r6, r3]	@ zero_extendqisi2
 1864 03f8 594A     		ldr	r2, .L253+32
 1865 03fa 9954     		strb	r1, [r3, r2]
 507:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 1866              		.loc 1 507 0 discriminator 2
 1867 03fc 0133     		adds	r3, r3, #1
 1868              	.LVL186:
 1869 03fe 0A2B     		cmp	r3, #10
 1870 0400 F9D1     		bne	.L190
 1871              	.LBE18:
 510:bluetooth_rxtx.c **** 		*data_len = 10;
 1872              		.loc 1 510 0
 1873 0402 594A     		ldr	r2, .L253+40
 1874 0404 0120     		movs	r0, #1
 1875              	.LVL187:
 1876 0406 1070     		strb	r0, [r2]
 1877              	.LVL188:
 1878              	.L221:
 511:bluetooth_rxtx.c **** 		break;
 1879              		.loc 1 511 0
 1880 0408 2B60     		str	r3, [r5]
 512:bluetooth_rxtx.c **** 
 1881              		.loc 1 512 0
 1882 040a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1883              	.LVL189:
 1884              	.L143:
 209:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 81


 1885              		.loc 1 209 0
 1886 040e 0023     		movs	r3, #0
 1887              	.LVL190:
 1888              	.L192:
 1889              	.LBB19:
 516:bluetooth_rxtx.c **** 		}
 1890              		.loc 1 516 0 discriminator 2
 1891 0410 5349     		ldr	r1, .L253+32
 1892 0412 0022     		movs	r2, #0
 1893 0414 5A54     		strb	r2, [r3, r1]
 515:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1894              		.loc 1 515 0 discriminator 2
 1895 0416 0133     		adds	r3, r3, #1
 1896              	.LVL191:
 1897 0418 0A2B     		cmp	r3, #10
 1898 041a F9D1     		bne	.L192
 1899              	.LBE19:
 518:bluetooth_rxtx.c **** 		*data_len = 10;
 1900              		.loc 1 518 0
 1901 041c 5249     		ldr	r1, .L253+40
 1902 041e 0A70     		strb	r2, [r1]
 1903 0420 B8E6     		b	.L230
 1904              	.LVL192:
 1905              	.L132:
 523:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1906              		.loc 1 523 0
 1907 0422 524B     		ldr	r3, .L253+44
 1908 0424 1968     		ldr	r1, [r3]
 1909              	.LVL193:
 1910              	.LBB20:
 524:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1911              		.loc 1 524 0
 1912 0426 0023     		movs	r3, #0
 1913              	.LVL194:
 1914              	.L194:
 1915 0428 DA00     		lsls	r2, r3, #3
 525:bluetooth_rxtx.c **** 		}
 1916              		.loc 1 525 0 discriminator 2
 1917 042a 21FA02F2 		lsr	r2, r1, r2
 1918 042e F254     		strb	r2, [r6, r3]
 524:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1919              		.loc 1 524 0 discriminator 2
 1920 0430 0133     		adds	r3, r3, #1
 1921              	.LVL195:
 1922 0432 042B     		cmp	r3, #4
 1923 0434 F8D1     		bne	.L194
 1924 0436 ADE6     		b	.L230
 1925              	.LVL196:
 1926              	.L153:
 1927              	.LBE20:
 531:bluetooth_rxtx.c **** 		break;
 1928              		.loc 1 531 0
 1929 0438 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 1930 043a 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 1931 043c 43EA0222 		orr	r2, r3, r2, lsl #8
 1932 0440 464B     		ldr	r3, .L253+28
 1933 0442 1A80     		strh	r2, [r3]	@ movhi
ARM GAS  /tmp/ccwLngFB.s 			page 82


 1934 0444 63E1     		b	.L204
 1935              	.L158:
 535:bluetooth_rxtx.c **** 
 1936              		.loc 1 535 0
 1937 0446 4A4B     		ldr	r3, .L253+48
 1938 0448 3078     		ldrb	r0, [r6]	@ zero_extendqisi2
 1939              	.LVL197:
 1940 044a 1988     		ldrh	r1, [r3]
 1941              	.LVL198:
 1942 044c 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 1943 044e 89B2     		uxth	r1, r1
 1944 0450 42EA0022 		orr	r2, r2, r0, lsl #8
 1945 0454 0A44     		add	r2, r2, r1
 1946 0456 92B2     		uxth	r2, r2
 1947 0458 1A80     		strh	r2, [r3]	@ movhi
 538:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 1948              		.loc 1 538 0
 1949 045a 1A88     		ldrh	r2, [r3]
 1950 045c 4549     		ldr	r1, .L253+52
 1951 045e 12B2     		sxth	r2, r2
 1952 0460 002A     		cmp	r2, #0
 1953 0462 454A     		ldr	r2, .L253+56
 1954 0464 07DA     		bge	.L195
 539:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1955              		.loc 1 539 0
 1956 0466 1B88     		ldrh	r3, [r3]
 1957 0468 4FF4A070 		mov	r0, #320
 1958 046c 5B42     		negs	r3, r3
 1959 046e 9BB2     		uxth	r3, r3
 1960 0470 90FBF3F3 		sdiv	r3, r0, r3
 1961 0474 0AE0     		b	.L246
 1962              	.L195:
 543:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 1963              		.loc 1 543 0
 1964 0476 1888     		ldrh	r0, [r3]
 1965 0478 00B2     		sxth	r0, r0
 1966 047a 0028     		cmp	r0, #0
 1967 047c 0DDD     		ble	.L196
 544:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1968              		.loc 1 544 0
 1969 047e 1B88     		ldrh	r3, [r3]
 1970 0480 4FF4A070 		mov	r0, #320
 1971 0484 1BB2     		sxth	r3, r3
 1972 0486 90FBF3F3 		sdiv	r3, r0, r3
 1973 048a 9BB2     		uxth	r3, r3
 1974              	.L246:
 1975 048c 1380     		strh	r3, [r2]	@ movhi
 545:bluetooth_rxtx.c **** 		}
 1976              		.loc 1 545 0
 1977 048e 3B4B     		ldr	r3, .L253+60
 1978 0490 1868     		ldr	r0, [r3]
 1979 0492 1388     		ldrh	r3, [r2]
 1980 0494 9BB2     		uxth	r3, r3
 1981 0496 0344     		add	r3, r3, r0
 1982 0498 01E0     		b	.L225
 1983              	.L196:
 549:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
ARM GAS  /tmp/ccwLngFB.s 			page 83


 1984              		.loc 1 549 0
 1985 049a 0023     		movs	r3, #0
 1986 049c 1380     		strh	r3, [r2]	@ movhi
 1987              	.L225:
 550:bluetooth_rxtx.c **** 		}
 1988              		.loc 1 550 0
 1989 049e 0B60     		str	r3, [r1]
 1990 04a0 35E1     		b	.L204
 1991              	.LVL199:
 1992              	.L133:
 556:bluetooth_rxtx.c **** 
 1993              		.loc 1 556 0
 1994 04a2 0023     		movs	r3, #0
 1995 04a4 2B60     		str	r3, [r5]
 558:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 1996              		.loc 1 558 0
 1997 04a6 E372     		strb	r3, [r4, #11]
 559:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 1998              		.loc 1 559 0
 1999 04a8 0323     		movs	r3, #3
 2000 04aa A372     		strb	r3, [r4, #10]
 560:bluetooth_rxtx.c **** 
 2001              		.loc 1 560 0
 2002 04ac 0923     		movs	r3, #9
 2003 04ae 6BE0     		b	.L229
 2004              	.L167:
 568:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2005              		.loc 1 568 0
 2006 04b0 0023     		movs	r3, #0
 2007 04b2 E372     		strb	r3, [r4, #11]
 569:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_CFO_LE;
 2008              		.loc 1 569 0
 2009 04b4 0323     		movs	r3, #3
 2010 04b6 A372     		strb	r3, [r4, #10]
 570:bluetooth_rxtx.c **** 
 2011              		.loc 1 570 0
 2012 04b8 1923     		movs	r3, #25
 2013 04ba 65E0     		b	.L229
 2014              	.L168:
 577:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2015              		.loc 1 577 0
 2016 04bc 0023     		movs	r3, #0
 2017 04be E372     		strb	r3, [r4, #11]
 578:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_RSSI_LE;
 2018              		.loc 1 578 0
 2019 04c0 0323     		movs	r3, #3
 2020 04c2 A372     		strb	r3, [r4, #10]
 579:bluetooth_rxtx.c **** 
 2021              		.loc 1 579 0
 2022 04c4 1A23     		movs	r3, #26
 2023 04c6 5FE0     		b	.L229
 2024              	.L134:
 209:bluetooth_rxtx.c **** 
 2025              		.loc 1 209 0
 2026 04c8 0023     		movs	r3, #0
 2027              	.LVL200:
 2028              	.L198:
ARM GAS  /tmp/ccwLngFB.s 			page 84


 2029              	.LBB21:
 587:bluetooth_rxtx.c **** 		}
 2030              		.loc 1 587 0 discriminator 2
 2031 04ca 1D49     		ldr	r1, .L253
 2032 04cc DA00     		lsls	r2, r3, #3
 2033 04ce 4968     		ldr	r1, [r1, #4]
 2034 04d0 21FA02F2 		lsr	r2, r1, r2
 2035 04d4 F254     		strb	r2, [r6, r3]
 586:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 2036              		.loc 1 586 0 discriminator 2
 2037 04d6 0133     		adds	r3, r3, #1
 2038              	.LVL201:
 2039 04d8 042B     		cmp	r3, #4
 2040 04da F6D1     		bne	.L198
 2041 04dc 5AE6     		b	.L230
 2042              	.LVL202:
 2043              	.L135:
 2044              	.LBE21:
 593:bluetooth_rxtx.c **** 		le.target_set = 1;
 2045              		.loc 1 593 0
 2046 04de B378     		ldrb	r3, [r6, #2]	@ zero_extendqisi2
 2047 04e0 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 2048 04e2 1B04     		lsls	r3, r3, #16
 2049 04e4 43EA0223 		orr	r3, r3, r2, lsl #8
 2050 04e8 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2051 04ea F078     		ldrb	r0, [r6, #3]	@ zero_extendqisi2
 2052              	.LVL203:
 2053 04ec 1343     		orrs	r3, r3, r2
 2054 04ee 43EA0060 		orr	r0, r3, r0, lsl #24
 2055 04f2 FFF7FEFF 		bl	le_set_access_address
 2056              	.LVL204:
 594:bluetooth_rxtx.c **** 		break;
 2057              		.loc 1 594 0
 2058 04f6 0120     		movs	r0, #1
 2059 04f8 114B     		ldr	r3, .L253
 2060 04fa FEE0     		b	.L220
 2061              	.LVL205:
 2062              	.L137:
 604:bluetooth_rxtx.c **** 		data[1] = 0x37;
 2063              		.loc 1 604 0
 2064 04fc 1323     		movs	r3, #19
 2065 04fe 3370     		strb	r3, [r6]
 605:bluetooth_rxtx.c **** 		*data_len = 2;
 2066              		.loc 1 605 0
 2067 0500 3723     		movs	r3, #55
 2068              	.L249:
 2069 0502 7370     		strb	r3, [r6, #1]
 2070 0504 4FE0     		b	.L244
 2071              	.L138:
 610:bluetooth_rxtx.c **** 		*data_len = 1;
 2072              		.loc 1 610 0
 2073 0506 0E4B     		ldr	r3, .L253
 2074 0508 5B69     		ldr	r3, [r3, #20]
 2075 050a 0033     		adds	r3, r3, #0
 2076 050c 18BF     		it	ne
 2077 050e 0123     		movne	r3, #1
 2078 0510 F9E6     		b	.L222
ARM GAS  /tmp/ccwLngFB.s 			page 85


 2079              	.L139:
 615:bluetooth_rxtx.c **** 		break;
 2080              		.loc 1 615 0
 2081 0512 0A88     		ldrh	r2, [r1]
 2082 0514 0A4B     		ldr	r3, .L253
 2083 0516 0032     		adds	r2, r2, #0
 2084 0518 18BF     		it	ne
 2085 051a 0122     		movne	r2, #1
 2086 051c 5A61     		str	r2, [r3, #20]
 2087 051e F6E0     		b	.L204
 2088              	.L140:
 619:bluetooth_rxtx.c **** 		if (p != NULL) {
 2089              		.loc 1 619 0
 2090 0520 FFF7FEFF 		bl	dequeue
 2091              	.LVL206:
 620:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 2092              		.loc 1 620 0
 2093 0524 0146     		mov	r1, r0
 2094 0526 28B1     		cbz	r0, .L199
 621:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 2095              		.loc 1 621 0
 2096 0528 3046     		mov	r0, r6
 2097              	.LVL207:
 2098 052a 4022     		movs	r2, #64
 2099 052c FFF7FEFF 		bl	memcpy
 2100              	.LVL208:
 622:bluetooth_rxtx.c **** 		} else {
 2101              		.loc 1 622 0
 2102 0530 4023     		movs	r3, #64
 2103 0532 2FE6     		b	.L230
 2104              	.LVL209:
 2105              	.L199:
 624:bluetooth_rxtx.c **** 			*data_len = 1;
 2106              		.loc 1 624 0
 2107 0534 3070     		strb	r0, [r6]
 2108              	.LVL210:
 2109              	.L218:
 625:bluetooth_rxtx.c **** 		}
 2110              		.loc 1 625 0
 2111 0536 0120     		movs	r0, #1
 2112              	.L219:
 2113 0538 2860     		str	r0, [r5]
 2114 053a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2115              	.LVL211:
 2116              	.L254:
 2117 053e 00BF     		.align	2
 2118              	.L253:
 2119 0540 00000000 		.word	.LANCHOR1
 2120 0544 00000000 		.word	.LC4
 2121 0548 A7000000 		.word	.LANCHOR2+167
 2122 054c 00000000 		.word	cs_threshold_req
 2123 0550 00000000 		.word	target
 2124 0554 00000000 		.word	clkn_offset
 2125 0558 98C00920 		.word	537510040
 2126 055c 00000000 		.word	clk100ns_offset
 2127 0560 00000000 		.word	afh_map
 2128 0564 00000000 		.word	used_channels
ARM GAS  /tmp/ccwLngFB.s 			page 86


 2129 0568 00000000 		.word	afh_enabled
 2130 056c 00000000 		.word	clkn
 2131 0570 00000000 		.word	clk_drift_ppm
 2132 0574 00000000 		.word	clkn_next_drift_fix
 2133 0578 00000000 		.word	clk_drift_correction
 2134 057c 00000000 		.word	clkn_last_drift_fix
 2135              	.LVL212:
 2136              	.L141:
 630:bluetooth_rxtx.c **** 
 2137              		.loc 1 630 0
 2138 0580 0023     		movs	r3, #0
 2139 0582 2B60     		str	r3, [r5]
 632:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2140              		.loc 1 632 0
 2141 0584 A372     		strb	r3, [r4, #10]
 633:bluetooth_rxtx.c **** 
 2142              		.loc 1 633 0
 2143 0586 0A23     		movs	r3, #10
 2144              	.L229:
 2145 0588 A374     		strb	r3, [r4, #18]
 635:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 2146              		.loc 1 635 0
 2147 058a FFF7FEFF 		bl	queue_init
 2148              	.LVL213:
 2149              	.L231:
 636:bluetooth_rxtx.c **** 		break;
 2150              		.loc 1 636 0
 2151 058e 634B     		ldr	r3, .L255
 2152              	.L234:
 2153 0590 1888     		ldrh	r0, [r3]
 2154 0592 80B2     		uxth	r0, r0
 2155 0594 FFF7FEFF 		bl	cs_threshold_calc_and_set
 2156              	.LVL214:
 2157 0598 B9E0     		b	.L204
 2158              	.LVL215:
 2159              	.L144:
 640:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 2160              		.loc 1 640 0
 2161 059a 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2162              	.LVL216:
 2163 059c FFF7FEFF 		bl	cc2400_get
 2164              	.LVL217:
 641:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 2165              		.loc 1 641 0
 2166 05a0 030A     		lsrs	r3, r0, #8
 2167 05a2 3370     		strb	r3, [r6]
 642:bluetooth_rxtx.c **** 		*data_len = 2;
 2168              		.loc 1 642 0
 2169 05a4 7070     		strb	r0, [r6, #1]
 2170              	.LVL218:
 2171              	.L244:
 643:bluetooth_rxtx.c **** 		break;
 2172              		.loc 1 643 0
 2173 05a6 0223     		movs	r3, #2
 2174 05a8 F4E5     		b	.L230
 2175              	.LVL219:
 2176              	.L148:
ARM GAS  /tmp/ccwLngFB.s 			page 87


 647:bluetooth_rxtx.c **** 		break;
 2177              		.loc 1 647 0
 2178 05aa 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2179              	.LVL220:
 2180 05ac 4988     		ldrh	r1, [r1, #2]
 2181              	.LVL221:
 2182              	.L232:
 2183 05ae FFF7FEFF 		bl	cc2400_set
 2184              	.LVL222:
 2185 05b2 ACE0     		b	.L204
 2186              	.L169:
 2187              	.LVL223:
 651:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2188              		.loc 1 651 0 discriminator 1
 2189 05b4 3B88     		ldrh	r3, [r7]
 2190 05b6 A342     		cmp	r3, r4
 2191 05b8 40F2A980 		bls	.L204
 652:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 2192              		.loc 1 652 0 discriminator 2
 2193 05bc 0323     		movs	r3, #3
 2194 05be 6343     		muls	r3, r4, r3
 2195              	.LVL224:
 2196 05c0 F218     		adds	r2, r6, r3
 2197              	.LVL225:
 2198 05c2 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 2199 05c4 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 2200              	.LVL226:
 653:bluetooth_rxtx.c **** 		}
 2201              		.loc 1 653 0 discriminator 2
 2202 05c6 F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 2203 05c8 42EA0121 		orr	r1, r2, r1, lsl #8
 651:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2204              		.loc 1 651 0 discriminator 2
 2205 05cc 0134     		adds	r4, r4, #1
 2206              	.LVL227:
 653:bluetooth_rxtx.c **** 		}
 2207              		.loc 1 653 0 discriminator 2
 2208 05ce FFF7FEFF 		bl	cc2400_set
 2209              	.LVL228:
 651:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2210              		.loc 1 651 0 discriminator 2
 2211 05d2 E4B2     		uxtb	r4, r4
 2212              	.LVL229:
 2213 05d4 EEE7     		b	.L169
 2214              	.LVL230:
 2215              	.L155:
 209:bluetooth_rxtx.c **** 
 2216              		.loc 1 209 0
 2217 05d6 0024     		movs	r4, #0
 2218              	.LVL231:
 2219              	.L203:
 660:bluetooth_rxtx.c **** 			data[i*3] = i;
 2220              		.loc 1 660 0 discriminator 2
 2221 05d8 2046     		mov	r0, r4
 2222 05da FFF7FEFF 		bl	cc2400_get
 2223              	.LVL232:
 661:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
ARM GAS  /tmp/ccwLngFB.s 			page 88


 2224              		.loc 1 661 0 discriminator 2
 2225 05de 3470     		strb	r4, [r6]
 659:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2226              		.loc 1 659 0 discriminator 2
 2227 05e0 0134     		adds	r4, r4, #1
 2228              	.LVL233:
 2229 05e2 E4B2     		uxtb	r4, r4
 2230              	.LVL234:
 662:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2231              		.loc 1 662 0 discriminator 2
 2232 05e4 030A     		lsrs	r3, r0, #8
 659:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2233              		.loc 1 659 0 discriminator 2
 2234 05e6 2E2C     		cmp	r4, #46
 662:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2235              		.loc 1 662 0 discriminator 2
 2236 05e8 7370     		strb	r3, [r6, #1]
 663:bluetooth_rxtx.c **** 		}
 2237              		.loc 1 663 0 discriminator 2
 2238 05ea B070     		strb	r0, [r6, #2]
 2239 05ec 06F10306 		add	r6, r6, #3
 659:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2240              		.loc 1 659 0 discriminator 2
 2241 05f0 F2D1     		bne	.L203
 665:bluetooth_rxtx.c **** 		break;
 2242              		.loc 1 665 0
 2243 05f2 8723     		movs	r3, #135
 2244 05f4 CEE5     		b	.L230
 2245              	.LVL235:
 2246              	.L157:
 669:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2247              		.loc 1 669 0
 2248 05f6 B279     		ldrb	r2, [r6, #6]	@ zero_extendqisi2
 670:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2249              		.loc 1 670 0
 2250 05f8 4948     		ldr	r0, .L255+4
 2251              	.LVL236:
 669:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2252              		.loc 1 669 0
 2253 05fa 0732     		adds	r2, r2, #7
 670:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2254              		.loc 1 670 0
 2255 05fc 3146     		mov	r1, r6
 2256              	.LVL237:
 2257 05fe D2B2     		uxtb	r2, r2
 2258 0600 FFF7FEFF 		bl	memcpy
 2259              	.LVL238:
 672:bluetooth_rxtx.c **** 		*data_len = 0;
 2260              		.loc 1 672 0
 2261 0604 1023     		movs	r3, #16
 2262 0606 56E6     		b	.L243
 2263              	.LVL239:
 2264              	.L145:
 677:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2265              		.loc 1 677 0
 2266 0608 1846     		mov	r0, r3
 2267              	.LVL240:
ARM GAS  /tmp/ccwLngFB.s 			page 89


 2268 060a FFF7FEFF 		bl	malloc
 2269              	.LVL241:
 2270 060e 454B     		ldr	r3, .L255+8
 678:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2271              		.loc 1 678 0
 2272 0610 3146     		mov	r1, r6
 2273 0612 226A     		ldr	r2, [r4, #32]
 677:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2274              		.loc 1 677 0
 2275 0614 1860     		str	r0, [r3]
 678:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2276              		.loc 1 678 0
 2277 0616 FFF7FEFF 		bl	memcpy
 2278              	.LVL242:
 679:bluetooth_rxtx.c **** 		break;
 2279              		.loc 1 679 0
 2280 061a 0C23     		movs	r3, #12
 2281 061c 57E0     		b	.L227
 2282              	.LVL243:
 2283              	.L159:
 684:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2284              		.loc 1 684 0
 2285 061e 1846     		mov	r0, r3
 2286              	.LVL244:
 2287 0620 FFF7FEFF 		bl	malloc
 2288              	.LVL245:
 2289 0624 3F4B     		ldr	r3, .L255+8
 685:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P0;
 2290              		.loc 1 685 0
 2291 0626 3146     		mov	r1, r6
 2292 0628 226A     		ldr	r2, [r4, #32]
 684:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2293              		.loc 1 684 0
 2294 062a 1860     		str	r0, [r3]
 685:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P0;
 2295              		.loc 1 685 0
 2296 062c FFF7FEFF 		bl	memcpy
 2297              	.LVL246:
 686:bluetooth_rxtx.c **** 		break;
 2298              		.loc 1 686 0
 2299 0630 1123     		movs	r3, #17
 2300 0632 4CE0     		b	.L227
 2301              	.LVL247:
 2302              	.L160:
 689:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, dlen);
 2303              		.loc 1 689 0
 2304 0634 1846     		mov	r0, r3
 2305              	.LVL248:
 2306 0636 FFF7FEFF 		bl	malloc
 2307              	.LVL249:
 2308 063a 3A4B     		ldr	r3, .L255+8
 690:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P1;
 2309              		.loc 1 690 0
 2310 063c 3146     		mov	r1, r6
 689:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, dlen);
 2311              		.loc 1 689 0
 2312 063e 1860     		str	r0, [r3]
ARM GAS  /tmp/ccwLngFB.s 			page 90


 690:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P1;
 2313              		.loc 1 690 0
 2314 0640 226A     		ldr	r2, [r4, #32]
 2315 0642 3948     		ldr	r0, .L255+12
 2316 0644 FFF7FEFF 		bl	memcpy
 2317              	.LVL250:
 691:bluetooth_rxtx.c **** 		break;
 2318              		.loc 1 691 0
 2319 0648 1223     		movs	r3, #18
 2320 064a 40E0     		b	.L227
 2321              	.LVL251:
 2322              	.L161:
 694:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2323              		.loc 1 694 0
 2324 064c 1846     		mov	r0, r3
 2325              	.LVL252:
 2326 064e FFF7FEFF 		bl	malloc
 2327              	.LVL253:
 2328 0652 344B     		ldr	r3, .L255+8
 695:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P2;
 2329              		.loc 1 695 0
 2330 0654 3146     		mov	r1, r6
 2331 0656 226A     		ldr	r2, [r4, #32]
 694:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2332              		.loc 1 694 0
 2333 0658 1860     		str	r0, [r3]
 695:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P2;
 2334              		.loc 1 695 0
 2335 065a FFF7FEFF 		bl	memcpy
 2336              	.LVL254:
 696:bluetooth_rxtx.c **** 		break;
 2337              		.loc 1 696 0
 2338 065e 1323     		movs	r3, #19
 2339 0660 35E0     		b	.L227
 2340              	.LVL255:
 2341              	.L162:
 699:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2342              		.loc 1 699 0
 2343 0662 1846     		mov	r0, r3
 2344              	.LVL256:
 2345 0664 FFF7FEFF 		bl	malloc
 2346              	.LVL257:
 2347 0668 2E4B     		ldr	r3, .L255+8
 700:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P3;
 2348              		.loc 1 700 0
 2349 066a 3146     		mov	r1, r6
 2350 066c 226A     		ldr	r2, [r4, #32]
 699:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2351              		.loc 1 699 0
 2352 066e 1860     		str	r0, [r3]
 700:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P3;
 2353              		.loc 1 700 0
 2354 0670 FFF7FEFF 		bl	memcpy
 2355              	.LVL258:
 701:bluetooth_rxtx.c **** 		break;
 2356              		.loc 1 701 0
 2357 0674 1423     		movs	r3, #20
ARM GAS  /tmp/ccwLngFB.s 			page 91


 2358 0676 2AE0     		b	.L227
 2359              	.LVL259:
 2360              	.L163:
 704:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2361              		.loc 1 704 0
 2362 0678 1846     		mov	r0, r3
 2363              	.LVL260:
 2364 067a FFF7FEFF 		bl	malloc
 2365              	.LVL261:
 2366 067e 294B     		ldr	r3, .L255+8
 705:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P4;
 2367              		.loc 1 705 0
 2368 0680 3146     		mov	r1, r6
 2369 0682 226A     		ldr	r2, [r4, #32]
 704:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2370              		.loc 1 704 0
 2371 0684 1860     		str	r0, [r3]
 705:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P4;
 2372              		.loc 1 705 0
 2373 0686 FFF7FEFF 		bl	memcpy
 2374              	.LVL262:
 706:bluetooth_rxtx.c **** 		break;
 2375              		.loc 1 706 0
 2376 068a 1523     		movs	r3, #21
 2377 068c 1FE0     		b	.L227
 2378              	.LVL263:
 2379              	.L164:
 709:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2380              		.loc 1 709 0
 2381 068e 1846     		mov	r0, r3
 2382              	.LVL264:
 2383 0690 FFF7FEFF 		bl	malloc
 2384              	.LVL265:
 2385 0694 234B     		ldr	r3, .L255+8
 710:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P5;
 2386              		.loc 1 710 0
 2387 0696 3146     		mov	r1, r6
 2388 0698 226A     		ldr	r2, [r4, #32]
 709:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2389              		.loc 1 709 0
 2390 069a 1860     		str	r0, [r3]
 710:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P5;
 2391              		.loc 1 710 0
 2392 069c FFF7FEFF 		bl	memcpy
 2393              	.LVL266:
 711:bluetooth_rxtx.c **** 		break;
 2394              		.loc 1 711 0
 2395 06a0 1623     		movs	r3, #22
 2396 06a2 14E0     		b	.L227
 2397              	.LVL267:
 2398              	.L165:
 714:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2399              		.loc 1 714 0
 2400 06a4 1846     		mov	r0, r3
 2401              	.LVL268:
 2402 06a6 FFF7FEFF 		bl	malloc
 2403              	.LVL269:
ARM GAS  /tmp/ccwLngFB.s 			page 92


 2404 06aa 1E4B     		ldr	r3, .L255+8
 715:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P6;
 2405              		.loc 1 715 0
 2406 06ac 3146     		mov	r1, r6
 2407 06ae 226A     		ldr	r2, [r4, #32]
 714:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2408              		.loc 1 714 0
 2409 06b0 1860     		str	r0, [r3]
 715:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P6;
 2410              		.loc 1 715 0
 2411 06b2 FFF7FEFF 		bl	memcpy
 2412              	.LVL270:
 716:bluetooth_rxtx.c **** 		break;
 2413              		.loc 1 716 0
 2414 06b6 1723     		movs	r3, #23
 2415 06b8 09E0     		b	.L227
 2416              	.LVL271:
 2417              	.L166:
 719:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2418              		.loc 1 719 0
 2419 06ba 1846     		mov	r0, r3
 2420              	.LVL272:
 2421 06bc FFF7FEFF 		bl	malloc
 2422              	.LVL273:
 2423 06c0 184B     		ldr	r3, .L255+8
 720:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P7;
 2424              		.loc 1 720 0
 2425 06c2 3146     		mov	r1, r6
 2426 06c4 226A     		ldr	r2, [r4, #32]
 719:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2427              		.loc 1 719 0
 2428 06c6 1860     		str	r0, [r3]
 720:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P7;
 2429              		.loc 1 720 0
 2430 06c8 FFF7FEFF 		bl	memcpy
 2431              	.LVL274:
 721:bluetooth_rxtx.c **** 		break;
 2432              		.loc 1 721 0
 2433 06cc 1823     		movs	r3, #24
 2434              	.L227:
 2435 06ce A374     		strb	r3, [r4, #18]
 2436 06d0 1DE0     		b	.L204
 2437              	.LVL275:
 2438              	.L147:
 727:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2439              		.loc 1 727 0
 2440 06d2 7279     		ldrb	r2, [r6, #5]	@ zero_extendqisi2
 2441 06d4 114B     		ldr	r3, .L255
 733:bluetooth_rxtx.c **** 		break;
 2442              		.loc 1 733 0
 2443 06d6 0120     		movs	r0, #1
 2444              	.LVL276:
 727:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2445              		.loc 1 727 0
 2446 06d8 83F83820 		strb	r2, [r3, #56]
 728:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 2447              		.loc 1 728 0
ARM GAS  /tmp/ccwLngFB.s 			page 93


 2448 06dc 3279     		ldrb	r2, [r6, #4]	@ zero_extendqisi2
 2449 06de 83F83920 		strb	r2, [r3, #57]
 729:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 2450              		.loc 1 729 0
 2451 06e2 F278     		ldrb	r2, [r6, #3]	@ zero_extendqisi2
 2452 06e4 83F83A20 		strb	r2, [r3, #58]
 730:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 2453              		.loc 1 730 0
 2454 06e8 B278     		ldrb	r2, [r6, #2]	@ zero_extendqisi2
 2455 06ea 83F83B20 		strb	r2, [r3, #59]
 731:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 2456              		.loc 1 731 0
 2457 06ee 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 2458 06f0 83F83C20 		strb	r2, [r3, #60]
 732:bluetooth_rxtx.c **** 		le.target_set = 1;
 2459              		.loc 1 732 0
 2460 06f4 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2461 06f6 83F83D20 		strb	r2, [r3, #61]
 2462              	.LVL277:
 2463              	.L220:
 733:bluetooth_rxtx.c **** 		break;
 2464              		.loc 1 733 0
 2465 06fa 1864     		str	r0, [r3, #64]
 734:bluetooth_rxtx.c **** 
 2466              		.loc 1 734 0
 2467 06fc BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2468              	.LVL278:
 2469              	.L149:
 738:bluetooth_rxtx.c **** 		break;
 2470              		.loc 1 738 0
 2471 0700 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 2472 0702 E374     		strb	r3, [r4, #19]
 2473 0704 03E0     		b	.L204
 2474              	.L150:
 747:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 2475              		.loc 1 747 0
 2476 0706 0D23     		movs	r3, #13
 2477 0708 A374     		strb	r3, [r4, #18]
 748:bluetooth_rxtx.c **** 		break;
 2478              		.loc 1 748 0
 2479 070a 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 2480 070c 2375     		strb	r3, [r4, #20]
 2481              	.LVL279:
 2482              	.L204:
 754:bluetooth_rxtx.c **** }
 2483              		.loc 1 754 0
 2484 070e 0120     		movs	r0, #1
 2485 0710 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2486              	.LVL280:
 2487              	.L211:
 326:bluetooth_rxtx.c **** 		}
 2488              		.loc 1 326 0
 2489 0714 0020     		movs	r0, #0
 755:bluetooth_rxtx.c **** 
 2490              		.loc 1 755 0
 2491 0716 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2492              	.LVL281:
ARM GAS  /tmp/ccwLngFB.s 			page 94


 2493              	.L256:
 2494 071a 00BF     		.align	2
 2495              	.L255:
 2496 071c 00000000 		.word	.LANCHOR1
 2497 0720 00000000 		.word	tx_pkt
 2498 0724 00000000 		.word	slave_mac_address_data
 2499 0728 24000000 		.word	.LANCHOR0+36
 2500              		.cfi_endproc
 2501              	.LFE3:
 2503              		.section	.text.enqueue_time,"ax",%progbits
 2504              		.align	1
 2505              		.thumb
 2506              		.thumb_func
 2508              	enqueue_time:
 2509              	.LFB1:
 162:bluetooth_rxtx.c **** 	usb_time_rx* f = usb_enqueue_time();
 2510              		.loc 1 162 0
 2511              		.cfi_startproc
 2512              		@ args = 0, pretend = 0, frame = 0
 2513              		@ frame_needed = 0, uses_anonymous_args = 0
 2514              	.LVL282:
 2515 0000 10B5     		push	{r4, lr}
 2516              		.cfi_def_cfa_offset 8
 2517              		.cfi_offset 4, -8
 2518              		.cfi_offset 14, -4
 162:bluetooth_rxtx.c **** 	usb_time_rx* f = usb_enqueue_time();
 2519              		.loc 1 162 0
 2520 0002 0446     		mov	r4, r0
 163:bluetooth_rxtx.c **** 	if  (f == NULL) {
 2521              		.loc 1 163 0
 2522 0004 FFF7FEFF 		bl	usb_enqueue_time
 2523              	.LVL283:
 164:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2524              		.loc 1 164 0
 2525 0008 28B9     		cbnz	r0, .L258
 2526              	.LVL284:
 2527              	.LBB24:
 2528              	.LBB25:
 165:bluetooth_rxtx.c **** 		return 0;
 2529              		.loc 1 165 0
 2530 000a 064B     		ldr	r3, .L260
 2531 000c 5978     		ldrb	r1, [r3, #1]	@ zero_extendqisi2
 2532 000e 41F00401 		orr	r1, r1, #4
 2533 0012 5970     		strb	r1, [r3, #1]
 2534 0014 10BD     		pop	{r4, pc}
 2535              	.LVL285:
 2536              	.L258:
 2537              	.LBE25:
 2538              	.LBE24:
 168:bluetooth_rxtx.c **** 	return 1;
 2539              		.loc 1 168 0
 2540 0016 2146     		mov	r1, r4
 2541 0018 4022     		movs	r2, #64
 2542 001a FFF7FEFF 		bl	memcpy
 2543              	.LVL286:
 169:bluetooth_rxtx.c **** }
 2544              		.loc 1 169 0
ARM GAS  /tmp/ccwLngFB.s 			page 95


 2545 001e 0120     		movs	r0, #1
 170:bluetooth_rxtx.c **** //
 2546              		.loc 1 170 0
 2547 0020 10BD     		pop	{r4, pc}
 2548              	.LVL287:
 2549              	.L261:
 2550 0022 00BF     		.align	2
 2551              	.L260:
 2552 0024 00000000 		.word	.LANCHOR0
 2553              		.cfi_endproc
 2554              	.LFE1:
 2556              		.section	.text.enqueue_with_ts,"ax",%progbits
 2557              		.align	1
 2558              		.global	enqueue_with_ts
 2559              		.thumb
 2560              		.thumb_func
 2562              	enqueue_with_ts:
 2563              	.LFB2:
 174:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2564              		.loc 1 174 0
 2565              		.cfi_startproc
 2566              		@ args = 0, pretend = 0, frame = 0
 2567              		@ frame_needed = 0, uses_anonymous_args = 0
 2568              	.LVL288:
 2569 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2570              		.cfi_def_cfa_offset 24
 2571              		.cfi_offset 4, -24
 2572              		.cfi_offset 5, -20
 2573              		.cfi_offset 6, -16
 2574              		.cfi_offset 7, -12
 2575              		.cfi_offset 8, -8
 2576              		.cfi_offset 14, -4
 174:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2577              		.loc 1 174 0
 2578 0004 0646     		mov	r6, r0
 2579 0006 0F46     		mov	r7, r1
 2580 0008 9046     		mov	r8, r2
 175:bluetooth_rxtx.c **** 
 2581              		.loc 1 175 0
 2582 000a FFF7FEFF 		bl	usb_enqueue
 2583              	.LVL289:
 2584 000e 104D     		ldr	r5, .L265
 178:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2585              		.loc 1 178 0
 2586 0010 0446     		mov	r4, r0
 2587 0012 28B9     		cbnz	r0, .L263
 179:bluetooth_rxtx.c **** 		return 0;
 2588              		.loc 1 179 0
 2589 0014 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 2590 0016 43F00403 		orr	r3, r3, #4
 2591 001a 6B70     		strb	r3, [r5, #1]
 180:bluetooth_rxtx.c **** 	}
 2592              		.loc 1 180 0
 2593 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2594              	.LVL290:
 2595              	.L263:
 188:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
ARM GAS  /tmp/ccwLngFB.s 			page 96


 2596              		.loc 1 188 0
 2597 0020 0C4B     		ldr	r3, .L265+4
 183:bluetooth_rxtx.c **** 
 2598              		.loc 1 183 0
 2599 0022 0670     		strb	r6, [r0]
 188:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2600              		.loc 1 188 0
 2601 0024 1B88     		ldrh	r3, [r3]
 185:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2602              		.loc 1 185 0
 2603 0026 0026     		movs	r6, #0
 188:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2604              		.loc 1 188 0
 2605 0028 9BB2     		uxth	r3, r3
 2606 002a 623B     		subs	r3, r3, #98
 185:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2607              		.loc 1 185 0
 2608 002c C670     		strb	r6, [r0, #3]
 186:bluetooth_rxtx.c **** 
 2609              		.loc 1 186 0
 2610 002e C0F80480 		str	r8, [r0, #4]
 188:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2611              		.loc 1 188 0
 2612 0032 8370     		strb	r3, [r0, #2]
 189:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 2613              		.loc 1 189 0
 2614 0034 8672     		strb	r6, [r0, #10]
 190:bluetooth_rxtx.c **** 
 2615              		.loc 1 190 0
 2616 0036 C672     		strb	r6, [r0, #11]
 192:bluetooth_rxtx.c **** 
 2617              		.loc 1 192 0
 2618 0038 3946     		mov	r1, r7
 2619 003a 3222     		movs	r2, #50
 2620 003c 0E30     		adds	r0, r0, #14
 2621              	.LVL291:
 2622 003e FFF7FEFF 		bl	memcpy
 2623              	.LVL292:
 194:bluetooth_rxtx.c **** 	status = 0;
 2624              		.loc 1 194 0
 2625 0042 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 195:bluetooth_rxtx.c **** 
 2626              		.loc 1 195 0
 2627 0044 6E70     		strb	r6, [r5, #1]
 194:bluetooth_rxtx.c **** 	status = 0;
 2628              		.loc 1 194 0
 2629 0046 6370     		strb	r3, [r4, #1]
 197:bluetooth_rxtx.c **** }
 2630              		.loc 1 197 0
 2631 0048 0120     		movs	r0, #1
 198:bluetooth_rxtx.c **** 
 2632              		.loc 1 198 0
 2633 004a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2634              	.LVL293:
 2635              	.L266:
 2636 004e 00BF     		.align	2
 2637              	.L265:
ARM GAS  /tmp/ccwLngFB.s 			page 97


 2638 0050 00000000 		.word	.LANCHOR0
 2639 0054 00000000 		.word	.LANCHOR1
 2640              		.cfi_endproc
 2641              	.LFE2:
 2643              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 2644              		.align	1
 2645              		.global	TIMER0_IRQHandler
 2646              		.thumb
 2647              		.thumb_func
 2649              	TIMER0_IRQHandler:
 2650              	.LFB4:
 759:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 2651              		.loc 1 759 0
 2652              		.cfi_startproc
 2653              		@ args = 0, pretend = 0, frame = 0
 2654              		@ frame_needed = 0, uses_anonymous_args = 0
 2655 0000 70B5     		push	{r4, r5, r6, lr}
 2656              		.cfi_def_cfa_offset 16
 2657              		.cfi_offset 4, -16
 2658              		.cfi_offset 5, -12
 2659              		.cfi_offset 6, -8
 2660              		.cfi_offset 14, -4
 760:bluetooth_rxtx.c **** 
 2661              		.loc 1 760 0
 2662 0002 4FF04023 		mov	r3, #1073758208
 2663 0006 1B68     		ldr	r3, [r3]
 2664 0008 DB07     		lsls	r3, r3, #31
 2665 000a 7FD5     		bpl	.L267
 2666              	.LBB26:
 762:bluetooth_rxtx.c **** 		clkn_offset = 0;
 2667              		.loc 1 762 0
 2668 000c 4049     		ldr	r1, .L290
 2669 000e 414B     		ldr	r3, .L290+4
 2670 0010 0868     		ldr	r0, [r1]
 2671 0012 1A68     		ldr	r2, [r3]
 2672 0014 0244     		add	r2, r2, r0
 2673 0016 0132     		adds	r2, r2, #1
 2674 0018 0A60     		str	r2, [r1]
 763:bluetooth_rxtx.c **** 
 2675              		.loc 1 763 0
 2676 001a 0022     		movs	r2, #0
 2677 001c 1A60     		str	r2, [r3]
 770:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2678              		.loc 1 770 0
 2679 001e 3E4A     		ldr	r2, .L290+8
 765:bluetooth_rxtx.c **** 
 2680              		.loc 1 765 0
 2681 0020 0C68     		ldr	r4, [r1]
 2682 0022 3E4B     		ldr	r3, .L290+12
 770:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2683              		.loc 1 770 0
 2684 0024 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 765:bluetooth_rxtx.c **** 
 2685              		.loc 1 765 0
 2686 0026 D869     		ldr	r0, [r3, #28]
 2687              	.LVL294:
 2688 0028 1546     		mov	r5, r2
ARM GAS  /tmp/ccwLngFB.s 			page 98


 770:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2689              		.loc 1 770 0
 2690 002a 16B1     		cbz	r6, .L269
 770:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2691              		.loc 1 770 0 is_stmt 0 discriminator 1
 2692 002c 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 2693 002e 012E     		cmp	r6, #1
 2694 0030 05D1     		bne	.L270
 2695              	.L269:
 771:bluetooth_rxtx.c **** 				do_hop = 1;
 2696              		.loc 1 771 0 is_stmt 1
 2697 0032 0B68     		ldr	r3, [r1]
 2698 0034 5E06     		lsls	r6, r3, #25
 2699 0036 37D1     		bne	.L271
 772:bluetooth_rxtx.c **** 		}
 2700              		.loc 1 772 0
 2701 0038 0123     		movs	r3, #1
 2702 003a EB72     		strb	r3, [r5, #11]
 2703 003c 34E0     		b	.L271
 2704              	.L270:
 775:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 2705              		.loc 1 775 0
 2706 003e 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2707 0040 022D     		cmp	r5, #2
 2708 0042 03D1     		bne	.L272
 776:bluetooth_rxtx.c **** 				do_hop = 1;
 2709              		.loc 1 776 0
 2710 0044 0B68     		ldr	r3, [r1]
 2711 0046 DC07     		lsls	r4, r3, #31
 2712              	.LVL295:
 2713 0048 2ED4     		bmi	.L271
 2714 004a 2BE0     		b	.L288
 2715              	.LVL296:
 2716              	.L272:
 780:bluetooth_rxtx.c **** 			// Only hop if connected
 2717              		.loc 1 780 0
 2718 004c 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2719 004e 032D     		cmp	r5, #3
 2720 0050 1CD1     		bne	.L273
 782:bluetooth_rxtx.c **** 				--le.interval_timer;
 2721              		.loc 1 782 0
 2722 0052 1D7E     		ldrb	r5, [r3, #24]	@ zero_extendqisi2
 2723 0054 032D     		cmp	r5, #3
 2724 0056 27D1     		bne	.L271
 765:bluetooth_rxtx.c **** 
 2725              		.loc 1 765 0 discriminator 1
 2726 0058 201A     		subs	r0, r4, r0
 2727              	.LVL297:
 782:bluetooth_rxtx.c **** 				--le.interval_timer;
 2728              		.loc 1 782 0 discriminator 1
 2729 005a 8007     		lsls	r0, r0, #30
 2730 005c 24D1     		bne	.L271
 783:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 2731              		.loc 1 783 0
 2732 005e 188C     		ldrh	r0, [r3, #32]
 2733 0060 80B2     		uxth	r0, r0
 2734 0062 0138     		subs	r0, r0, #1
ARM GAS  /tmp/ccwLngFB.s 			page 99


 2735 0064 80B2     		uxth	r0, r0
 2736 0066 1884     		strh	r0, [r3, #32]	@ movhi
 784:bluetooth_rxtx.c **** 					do_hop = 1;
 2737              		.loc 1 784 0
 2738 0068 188C     		ldrh	r0, [r3, #32]
 2739 006a 80B2     		uxth	r0, r0
 2740 006c 48B9     		cbnz	r0, .L274
 785:bluetooth_rxtx.c **** 					++le.conn_count;
 2741              		.loc 1 785 0
 2742 006e 0120     		movs	r0, #1
 2743 0070 D072     		strb	r0, [r2, #11]
 786:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 2744              		.loc 1 786 0
 2745 0072 9A8C     		ldrh	r2, [r3, #36]
 2746 0074 92B2     		uxth	r2, r2
 2747 0076 0244     		add	r2, r2, r0
 2748 0078 92B2     		uxth	r2, r2
 2749 007a 9A84     		strh	r2, [r3, #36]	@ movhi
 787:bluetooth_rxtx.c **** 				} else {
 2750              		.loc 1 787 0
 2751 007c 5A8C     		ldrh	r2, [r3, #34]
 2752 007e 1A84     		strh	r2, [r3, #32]	@ movhi
 2753 0080 12E0     		b	.L271
 2754              	.L274:
 789:bluetooth_rxtx.c **** 				}
 2755              		.loc 1 789 0
 2756 0082 274B     		ldr	r3, .L290+16
 2757 0084 4FF48072 		mov	r2, #256
 2758 0088 1A60     		str	r2, [r3]
 2759 008a 0DE0     		b	.L271
 2760              	.LVL298:
 2761              	.L273:
 793:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 2762              		.loc 1 793 0
 2763 008c 907A     		ldrb	r0, [r2, #10]	@ zero_extendqisi2
 2764              	.LVL299:
 2765 008e 0528     		cmp	r0, #5
 2766 0090 0AD1     		bne	.L271
 794:bluetooth_rxtx.c **** 				do_hop = 1;
 2767              		.loc 1 794 0
 2768 0092 2448     		ldr	r0, .L290+20
 2769 0094 0468     		ldr	r4, [r0]
 2770              	.LVL300:
 2771 0096 B3F84800 		ldrh	r0, [r3, #72]
 2772 009a 0B68     		ldr	r3, [r1]
 2773 009c 80B2     		uxth	r0, r0
 2774 009e 2044     		add	r0, r0, r4
 2775 00a0 9842     		cmp	r0, r3
 2776 00a2 01D1     		bne	.L271
 2777              	.L288:
 795:bluetooth_rxtx.c **** 			}
 2778              		.loc 1 795 0
 2779 00a4 0123     		movs	r3, #1
 2780 00a6 D372     		strb	r3, [r2, #11]
 2781              	.L271:
 800:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2782              		.loc 1 800 0
ARM GAS  /tmp/ccwLngFB.s 			page 100


 2783 00a8 1F4A     		ldr	r2, .L290+24
 2784 00aa 204B     		ldr	r3, .L290+28
 2785 00ac 1068     		ldr	r0, [r2]
 2786 00ae C0B1     		cbz	r0, .L275
 800:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2787              		.loc 1 800 0 is_stmt 0 discriminator 1
 2788 00b0 1888     		ldrh	r0, [r3]
 2789 00b2 80B2     		uxth	r0, r0
 2790 00b4 A8B9     		cbnz	r0, .L275
 801:bluetooth_rxtx.c **** 
 2791              		.loc 1 801 0 is_stmt 1
 2792 00b6 0C68     		ldr	r4, [r1]
 2793 00b8 1068     		ldr	r0, [r2]
 2794 00ba 8442     		cmp	r4, r0
 2795 00bc 11D3     		bcc	.L275
 804:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 2796              		.loc 1 804 0
 2797 00be 1C48     		ldr	r0, .L290+32
 2798 00c0 0088     		ldrh	r0, [r0]
 2799 00c2 00B2     		sxth	r0, r0
 2800 00c4 0028     		cmp	r0, #0
 805:bluetooth_rxtx.c **** 				}
 2801              		.loc 1 805 0
 2802 00c6 ACBF     		ite	ge
 2803 00c8 0120     		movge	r0, #1
 810:bluetooth_rxtx.c **** 				}
 2804              		.loc 1 810 0
 2805 00ca 41F66900 		movwlt	r0, #6249
 2806 00ce 1880     		strh	r0, [r3]	@ movhi
 812:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2807              		.loc 1 812 0
 2808 00d0 0C68     		ldr	r4, [r1]
 2809 00d2 1848     		ldr	r0, .L290+36
 2810 00d4 0460     		str	r4, [r0]
 813:bluetooth_rxtx.c **** 			}
 2811              		.loc 1 813 0
 2812 00d6 0468     		ldr	r4, [r0]
 2813 00d8 1748     		ldr	r0, .L290+40
 2814 00da 0088     		ldrh	r0, [r0]
 2815 00dc 80B2     		uxth	r0, r0
 2816 00de 2044     		add	r0, r0, r4
 2817 00e0 1060     		str	r0, [r2]
 2818              	.L275:
 818:bluetooth_rxtx.c **** 			clkn += 2;
 2819              		.loc 1 818 0
 2820 00e2 1888     		ldrh	r0, [r3]
 2821 00e4 40F63442 		movw	r2, #3124
 2822 00e8 80B2     		uxth	r0, r0
 2823 00ea 9042     		cmp	r0, r2
 2824 00ec 02D9     		bls	.L278
 819:bluetooth_rxtx.c **** 
 2825              		.loc 1 819 0
 2826 00ee 0A68     		ldr	r2, [r1]
 2827 00f0 0232     		adds	r2, r2, #2
 2828 00f2 0A60     		str	r2, [r1]
 2829              	.L278:
 821:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
ARM GAS  /tmp/ccwLngFB.s 			page 101


 2830              		.loc 1 821 0
 2831 00f4 1988     		ldrh	r1, [r3]
 2832 00f6 114A     		ldr	r2, .L290+44
 2833 00f8 89B2     		uxth	r1, r1
 2834 00fa 01F63441 		addw	r1, r1, #3124
 2835 00fe 1160     		str	r1, [r2]
 822:bluetooth_rxtx.c **** 
 2836              		.loc 1 822 0
 2837 0100 0022     		movs	r2, #0
 2838 0102 1A80     		strh	r2, [r3]	@ movhi
 825:bluetooth_rxtx.c **** 	}
 2839              		.loc 1 825 0
 2840 0104 0122     		movs	r2, #1
 2841 0106 4FF04023 		mov	r3, #1073758208
 2842 010a 1A60     		str	r2, [r3]
 2843              	.L267:
 2844 010c 70BD     		pop	{r4, r5, r6, pc}
 2845              	.L291:
 2846 010e 00BF     		.align	2
 2847              	.L290:
 2848 0110 00000000 		.word	clkn
 2849 0114 00000000 		.word	clkn_offset
 2850 0118 00000000 		.word	.LANCHOR0
 2851 011c 00000000 		.word	.LANCHOR1
 2852 0120 3CC00920 		.word	537509948
 2853 0124 00000000 		.word	last_hop
 2854 0128 00000000 		.word	clkn_next_drift_fix
 2855 012c 00000000 		.word	clk100ns_offset
 2856 0130 00000000 		.word	clk_drift_ppm
 2857 0134 00000000 		.word	clkn_last_drift_fix
 2858 0138 00000000 		.word	clk_drift_correction
 2859 013c 18400040 		.word	1073758232
 2860              	.LBE26:
 2861              		.cfi_endproc
 2862              	.LFE4:
 2864              		.section	.text.EINT3_IRQHandler,"ax",%progbits
 2865              		.align	1
 2866              		.global	EINT3_IRQHandler
 2867              		.thumb
 2868              		.thumb_func
 2870              	EINT3_IRQHandler:
 2871              	.LFB5:
 832:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 2872              		.loc 1 832 0
 2873              		.cfi_startproc
 2874              		@ args = 0, pretend = 0, frame = 0
 2875              		@ frame_needed = 0, uses_anonymous_args = 0
 2876              		@ link register save eliminated.
 834:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 2877              		.loc 1 834 0
 2878 0000 084B     		ldr	r3, .L294
 2879 0002 0422     		movs	r2, #4
 2880 0004 1A60     		str	r2, [r3]
 835:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 2881              		.loc 1 835 0
 2882 0006 084B     		ldr	r3, .L294+4
 2883 0008 4FF08052 		mov	r2, #268435456
ARM GAS  /tmp/ccwLngFB.s 			page 102


 2884 000c 1A60     		str	r2, [r3]
 836:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 2885              		.loc 1 836 0
 2886 000e 074B     		ldr	r3, .L294+8
 2887 0010 0122     		movs	r2, #1
 2888 0012 1A70     		strb	r2, [r3]
 837:bluetooth_rxtx.c **** 		dma_discard = 0;
 2889              		.loc 1 837 0
 2890 0014 064B     		ldr	r3, .L294+12
 2891 0016 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2892 0018 022A     		cmp	r2, #2
 838:bluetooth_rxtx.c **** 
 2893              		.loc 1 838 0
 2894 001a 04BF     		itt	eq
 2895 001c 0022     		moveq	r2, #0
 2896 001e 1A74     		strbeq	r2, [r3, #16]
 2897 0020 7047     		bx	lr
 2898              	.L295:
 2899 0022 00BF     		.align	2
 2900              	.L294:
 2901 0024 AC800240 		.word	1073905836
 2902 0028 9CC00920 		.word	537510044
 2903 002c 00000000 		.word	cs_trigger
 2904 0030 00000000 		.word	.LANCHOR0
 2905              		.cfi_endproc
 2906              	.LFE5:
 2908              		.section	.text.DMA_IRQHandler,"ax",%progbits
 2909              		.align	1
 2910              		.global	DMA_IRQHandler
 2911              		.thumb
 2912              		.thumb_func
 2914              	DMA_IRQHandler:
 2915              	.LFB7:
 862:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 2916              		.loc 1 862 0
 2917              		.cfi_startproc
 2918              		@ args = 0, pretend = 0, frame = 0
 2919              		@ frame_needed = 0, uses_anonymous_args = 0
 2920 0000 10B5     		push	{r4, lr}
 2921              		.cfi_def_cfa_offset 8
 2922              		.cfi_offset 4, -8
 2923              		.cfi_offset 14, -4
 863:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 2924              		.loc 1 863 0
 2925 0002 374B     		ldr	r3, .L362
 2926 0004 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2927 0006 012A     		cmp	r2, #1
 2928 0008 2FD0     		beq	.L297
 864:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 2929              		.loc 1 864 0
 2930 000a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2931 000c 082A     		cmp	r2, #8
 2932 000e 2CD0     		beq	.L297
 865:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 2933              		.loc 1 865 0
 2934 0010 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2935 0012 042A     		cmp	r2, #4
ARM GAS  /tmp/ccwLngFB.s 			page 103


 2936 0014 29D0     		beq	.L297
 866:bluetooth_rxtx.c **** 	   || mode == MODE_BT_CFO_LE
 2937              		.loc 1 866 0
 2938 0016 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2939 0018 092A     		cmp	r2, #9
 2940 001a 26D0     		beq	.L297
 867:bluetooth_rxtx.c **** 	   || mode == MODE_BT_RSSI_LE
 2941              		.loc 1 867 0
 2942 001c 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2943 001e 192A     		cmp	r2, #25
 2944 0020 23D0     		beq	.L297
 868:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 2945              		.loc 1 868 0
 2946 0022 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2947 0024 1A2A     		cmp	r2, #26
 2948 0026 20D0     		beq	.L297
 869:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 2949              		.loc 1 869 0
 2950 0028 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2951 002a 0A2A     		cmp	r2, #10
 2952 002c 1DD0     		beq	.L297
 870:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P0
 2953              		.loc 1 870 0
 2954 002e 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2955 0030 0C2A     		cmp	r2, #12
 2956 0032 1AD0     		beq	.L297
 871:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P1
 2957              		.loc 1 871 0
 2958 0034 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2959 0036 112A     		cmp	r2, #17
 2960 0038 17D0     		beq	.L297
 872:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P2
 2961              		.loc 1 872 0
 2962 003a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2963 003c 122A     		cmp	r2, #18
 2964 003e 14D0     		beq	.L297
 873:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P3
 2965              		.loc 1 873 0
 2966 0040 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2967 0042 1329     		cmp	r1, #19
 2968 0044 11D0     		beq	.L297
 874:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P4
 2969              		.loc 1 874 0
 2970 0046 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2971 0048 1429     		cmp	r1, #20
 2972 004a 0ED0     		beq	.L297
 875:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P5
 2973              		.loc 1 875 0
 2974 004c 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2975 004e 1529     		cmp	r1, #21
 2976 0050 0BD0     		beq	.L297
 876:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P6
 2977              		.loc 1 876 0
 2978 0052 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2979 0054 1629     		cmp	r1, #22
 2980 0056 08D0     		beq	.L297
 877:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P7
ARM GAS  /tmp/ccwLngFB.s 			page 104


 2981              		.loc 1 877 0
 2982 0058 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2983 005a 1729     		cmp	r1, #23
 2984 005c 05D0     		beq	.L297
 878:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 2985              		.loc 1 878 0
 2986 005e 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2987 0060 1829     		cmp	r1, #24
 2988 0062 02D0     		beq	.L297
 879:bluetooth_rxtx.c **** 	{
 2989              		.loc 1 879 0
 2990 0064 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2991 0066 0F2A     		cmp	r2, #15
 2992 0068 39D1     		bne	.L296
 2993              	.L297:
 882:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 2994              		.loc 1 882 0
 2995 006a 1E4A     		ldr	r2, .L362+4
 2996 006c 1268     		ldr	r2, [r2]
 2997 006e D007     		lsls	r0, r2, #31
 2998 0070 35D5     		bpl	.L296
 883:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 2999              		.loc 1 883 0
 3000 0072 1D4A     		ldr	r2, .L362+8
 3001 0074 1268     		ldr	r2, [r2]
 3002 0076 D107     		lsls	r1, r2, #31
 3003 0078 26D5     		bpl	.L300
 3004              	.LBB27:
 884:bluetooth_rxtx.c **** 
 3005              		.loc 1 884 0
 3006 007a 1C4A     		ldr	r2, .L362+12
 3007 007c 0121     		movs	r1, #1
 3008 007e 1160     		str	r1, [r2]
 886:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 3009              		.loc 1 886 0
 3010 0080 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 3011 0082 022A     		cmp	r2, #2
 3012 0084 03D1     		bne	.L301
 887:bluetooth_rxtx.c **** 
 3013              		.loc 1 887 0
 3014 0086 1A4A     		ldr	r2, .L362+16
 3015 0088 4FF08051 		mov	r1, #268435456
 3016 008c 1160     		str	r1, [r2]
 3017              	.L301:
 889:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 3018              		.loc 1 889 0
 3019 008e 194A     		ldr	r2, .L362+20
 3020 0090 1948     		ldr	r0, .L362+24
 3021 0092 1168     		ldr	r1, [r2]
 3022 0094 0068     		ldr	r0, [r0]
 3023 0096 C1F31301 		ubfx	r1, r1, #0, #20
 3024 009a 40F63544 		movw	r4, #3125
 3025 009e 04FB0101 		mla	r1, r4, r1, r0
 3026 00a2 5960     		str	r1, [r3, #4]
 890:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 3027              		.loc 1 890 0
 3028 00a4 1268     		ldr	r2, [r2]
ARM GAS  /tmp/ccwLngFB.s 			page 105


 3029 00a6 C2F30752 		ubfx	r2, r2, #20, #8
 3030 00aa 9A70     		strb	r2, [r3, #2]
 891:bluetooth_rxtx.c **** 
 3031              		.loc 1 891 0
 3032 00ac 134A     		ldr	r2, .L362+28
 3033 00ae 1288     		ldrh	r2, [r2]
 3034 00b0 92B2     		uxth	r2, r2
 3035 00b2 1A81     		strh	r2, [r3, #8]	@ movhi
 894:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 3036              		.loc 1 894 0
 3037 00b4 124A     		ldr	r2, .L362+32
 895:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 3038              		.loc 1 895 0
 3039 00b6 134B     		ldr	r3, .L362+36
 894:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 3040              		.loc 1 894 0
 3041 00b8 1168     		ldr	r1, [r2]
 3042              	.LVL301:
 895:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 3043              		.loc 1 895 0
 3044 00ba 1868     		ldr	r0, [r3]
 3045 00bc 1060     		str	r0, [r2]
 896:bluetooth_rxtx.c **** 
 3046              		.loc 1 896 0
 3047 00be 1960     		str	r1, [r3]
 898:bluetooth_rxtx.c **** 			}
 3048              		.loc 1 898 0
 3049 00c0 114B     		ldr	r3, .L362+40
 3050 00c2 1A68     		ldr	r2, [r3]
 3051 00c4 0132     		adds	r2, r2, #1
 3052 00c6 1A60     		str	r2, [r3]
 3053              	.LVL302:
 3054              	.L300:
 3055              	.LBE27:
 900:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 3056              		.loc 1 900 0
 3057 00c8 104B     		ldr	r3, .L362+44
 3058 00ca 1B68     		ldr	r3, [r3]
 3059 00cc DA07     		lsls	r2, r3, #31
 3060 00ce 06D5     		bpl	.L296
 901:bluetooth_rxtx.c **** 				++rx_err;
 3061              		.loc 1 901 0
 3062 00d0 0F4B     		ldr	r3, .L362+48
 3063 00d2 0122     		movs	r2, #1
 3064 00d4 1A60     		str	r2, [r3]
 902:bluetooth_rxtx.c **** 			}
 3065              		.loc 1 902 0
 3066 00d6 0F4B     		ldr	r3, .L362+52
 3067 00d8 1A68     		ldr	r2, [r3]
 3068 00da 0132     		adds	r2, r2, #1
 3069 00dc 1A60     		str	r2, [r3]
 3070              	.L296:
 3071 00de 10BD     		pop	{r4, pc}
 3072              	.L363:
 3073              		.align	2
 3074              	.L362:
 3075 00e0 00000000 		.word	.LANCHOR0
ARM GAS  /tmp/ccwLngFB.s 			page 106


 3076 00e4 00400050 		.word	1342193664
 3077 00e8 04400050 		.word	1342193668
 3078 00ec 08400050 		.word	1342193672
 3079 00f0 98C00920 		.word	537510040
 3080 00f4 00000000 		.word	clkn
 3081 00f8 08400040 		.word	1073758216
 3082 00fc 00000000 		.word	.LANCHOR1
 3083 0100 00000000 		.word	active_rxbuf
 3084 0104 00000000 		.word	idle_rxbuf
 3085 0108 00000000 		.word	rx_tc
 3086 010c 0C400050 		.word	1342193676
 3087 0110 10400050 		.word	1342193680
 3088 0114 00000000 		.word	rx_err
 3089              		.cfi_endproc
 3090              	.LFE7:
 3092              		.section	.text.le_transmit,"ax",%progbits
 3093              		.align	1
 3094              		.global	le_transmit
 3095              		.thumb
 3096              		.thumb_func
 3098              	le_transmit:
 3099              	.LFB12:
1132:bluetooth_rxtx.c **** 	unsigned i, j;
 3100              		.loc 1 1132 0
 3101              		.cfi_startproc
 3102              		@ args = 4, pretend = 0, frame = 64
 3103              		@ frame_needed = 0, uses_anonymous_args = 0
 3104              	.LVL303:
 3105 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 3106              		.cfi_def_cfa_offset 36
 3107              		.cfi_offset 4, -36
 3108              		.cfi_offset 5, -32
 3109              		.cfi_offset 6, -28
 3110              		.cfi_offset 7, -24
 3111              		.cfi_offset 8, -20
 3112              		.cfi_offset 9, -16
 3113              		.cfi_offset 10, -12
 3114              		.cfi_offset 11, -8
 3115              		.cfi_offset 14, -4
 3116 0004 91B0     		sub	sp, sp, #68
 3117              		.cfi_def_cfa_offset 104
1132:bluetooth_rxtx.c **** 	unsigned i, j;
 3118              		.loc 1 1132 0
 3119 0006 BDF86870 		ldrh	r7, [sp, #104]
 3120              	.LVL304:
 3121 000a 0546     		mov	r5, r0
 3122 000c 8946     		mov	r9, r1
 3123 000e 9246     		mov	r10, r2
1142:bluetooth_rxtx.c **** 
 3124              		.loc 1 1142 0
 3125 0010 03F00F08 		and	r8, r3, #15
 3126              	.LVL305:
 3127 0014 0DF1FF30 		add	r0, sp, #-1
 3128              	.LVL306:
 3129 0018 0DF10301 		add	r1, sp, #3
 3130              	.LVL307:
 3131              	.L368:
ARM GAS  /tmp/ccwLngFB.s 			page 107


1148:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3132              		.loc 1 1148 0
 3133 001c 0022     		movs	r2, #0
1146:bluetooth_rxtx.c **** 		aa >>= 8;
 3134              		.loc 1 1146 0
 3135 001e EBB2     		uxtb	r3, r5
 3136              	.LVL308:
1148:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3137              		.loc 1 1148 0
 3138 0020 4270     		strb	r2, [r0, #1]
1147:bluetooth_rxtx.c **** 		txbuf[i] = 0;
 3139              		.loc 1 1147 0
 3140 0022 2D0A     		lsrs	r5, r5, #8
 3141              	.LVL309:
1148:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3142              		.loc 1 1148 0
 3143 0024 0724     		movs	r4, #7
 3144              	.LVL310:
 3145              	.L366:
1150:bluetooth_rxtx.c **** 			byte >>= 1;
 3146              		.loc 1 1150 0 discriminator 2
 3147 0026 03F00106 		and	r6, r3, #1
 3148 002a A640     		lsls	r6, r6, r4
1149:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3149              		.loc 1 1149 0 discriminator 2
 3150 002c 14F1FF34 		adds	r4, r4, #-1
 3151              	.LVL311:
1150:bluetooth_rxtx.c **** 			byte >>= 1;
 3152              		.loc 1 1150 0 discriminator 2
 3153 0030 46EA0202 		orr	r2, r6, r2
 3154 0034 D2B2     		uxtb	r2, r2
1151:bluetooth_rxtx.c **** 		}
 3155              		.loc 1 1151 0 discriminator 2
 3156 0036 4FEA5303 		lsr	r3, r3, #1
 3157              	.LVL312:
1149:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3158              		.loc 1 1149 0 discriminator 2
 3159 003a F4D2     		bcs	.L366
 3160 003c 00F8012F 		strb	r2, [r0, #1]!
 3161              	.LVL313:
1145:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 3162              		.loc 1 1145 0
 3163 0040 8842     		cmp	r0, r1
 3164 0042 EBD1     		bne	.L368
1156:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3165              		.loc 1 1156 0
 3166 0044 A7F16200 		sub	r0, r7, #98
 3167              	.LVL314:
 3168 0048 C0B2     		uxtb	r0, r0
 3169 004a FFF7FEFF 		bl	btle_channel_index
 3170              	.LVL315:
 3171 004e 534B     		ldr	r3, .L392
1157:bluetooth_rxtx.c **** 		byte = data[i];
 3172              		.loc 1 1157 0
 3173 0050 0024     		movs	r4, #0
1156:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3174              		.loc 1 1156 0
ARM GAS  /tmp/ccwLngFB.s 			page 108


 3175 0052 1E5C     		ldrb	r6, [r3, r0]	@ zero_extendqisi2
 3176              	.LVL316:
 3177              	.L369:
1157:bluetooth_rxtx.c **** 		byte = data[i];
 3178              		.loc 1 1157 0 discriminator 1
 3179 0054 4C45     		cmp	r4, r9
 3180 0056 22D2     		bcs	.L391
 3181 0058 0DF1000E 		add	lr, sp, #0
1158:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
 3182              		.loc 1 1158 0
 3183 005c 1AF80430 		ldrb	r3, [r10, r4]	@ zero_extendqisi2
 3184              	.LVL317:
 3185 0060 A644     		add	lr, lr, r4
 3186              	.LVL318:
 3187 0062 0720     		movs	r0, #7
 3188 0064 0022     		movs	r2, #0
 3189              	.LVL319:
 3190              	.L371:
1161:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3191              		.loc 1 1161 0 discriminator 2
 3192 0066 4D49     		ldr	r1, .L392
 3193 0068 03F0010C 		and	ip, r3, #1
 3194 006c 3144     		add	r1, r1, r6
 3195 006e 91F82810 		ldrb	r1, [r1, #40]	@ zero_extendqisi2
1162:bluetooth_rxtx.c **** 			//bit = (byte & 1);
 3196              		.loc 1 1162 0 discriminator 2
 3197 0072 0136     		adds	r6, r6, #1
 3198              	.LVL320:
1161:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3199              		.loc 1 1161 0 discriminator 2
 3200 0074 8CEA010C 		eor	ip, ip, r1
 3201              	.LVL321:
1162:bluetooth_rxtx.c **** 			//bit = (byte & 1);
 3202              		.loc 1 1162 0 discriminator 2
 3203 0078 7F21     		movs	r1, #127
 3204 007a B6FBF1FB 		udiv	fp, r6, r1
 3205 007e 01FB1B66 		mls	r6, r1, fp, r6
 3206              	.LVL322:
1165:bluetooth_rxtx.c **** 		}
 3207              		.loc 1 1165 0 discriminator 2
 3208 0082 0CFA00F1 		lsl	r1, ip, r0
1160:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3209              		.loc 1 1160 0 discriminator 2
 3210 0086 10F1FF30 		adds	r0, r0, #-1
 3211              	.LVL323:
1165:bluetooth_rxtx.c **** 		}
 3212              		.loc 1 1165 0 discriminator 2
 3213 008a 41EA0202 		orr	r2, r1, r2
1164:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
 3214              		.loc 1 1164 0 discriminator 2
 3215 008e 4FEA5303 		lsr	r3, r3, #1
 3216              	.LVL324:
1165:bluetooth_rxtx.c **** 		}
 3217              		.loc 1 1165 0 discriminator 2
 3218 0092 D2B2     		uxtb	r2, r2
 3219              	.LVL325:
1160:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
ARM GAS  /tmp/ccwLngFB.s 			page 109


 3220              		.loc 1 1160 0 discriminator 2
 3221 0094 E7D2     		bcs	.L371
 3222 0096 8EF80420 		strb	r2, [lr, #4]
1157:bluetooth_rxtx.c **** 		byte = data[i];
 3223              		.loc 1 1157 0
 3224 009a 0134     		adds	r4, r4, #1
 3225              	.LVL326:
 3226 009c DAE7     		b	.L369
 3227              	.LVL327:
 3228              	.L391:
1172:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3229              		.loc 1 1172 0
 3230 009e 0D20     		movs	r0, #13
 3231 00a0 47F6FF71 		movw	r1, #32767
 3232 00a4 FFF7FEFF 		bl	cc2400_set
 3233              	.LVL328:
1173:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 3234              		.loc 1 1173 0
 3235 00a8 1220     		movs	r0, #18
 3236 00aa 42F62231 		movw	r1, #11042
 3237 00ae FFF7FEFF 		bl	cc2400_set
 3238              	.LVL329:
1174:bluetooth_rxtx.c **** 
 3239              		.loc 1 1174 0
 3240 00b2 1420     		movs	r0, #20
 3241 00b4 41F24B31 		movw	r1, #4939
 3242 00b8 FFF7FEFF 		bl	cc2400_set
 3243              	.LVL330:
1176:bluetooth_rxtx.c **** 	// 0 00 01 1 001 00 0 00 0 1
 3244              		.loc 1 1176 0
 3245 00bc 2020     		movs	r0, #32
 3246 00be 40F60141 		movw	r1, #3073
 3247 00c2 FFF7FEFF 		bl	cc2400_set
 3248              	.LVL331:
1184:bluetooth_rxtx.c **** 	// JWHUR cc2400 data sheet about power control
 3249              		.loc 1 1184 0
 3250 00c6 0220     		movs	r0, #2
 3251 00c8 3946     		mov	r1, r7
 3252 00ca FFF7FEFF 		bl	cc2400_set
 3253              	.LVL332:
1195:bluetooth_rxtx.c **** 	//cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3254              		.loc 1 1195 0
 3255 00ce 0520     		movs	r0, #5
 3256 00d0 4146     		mov	r1, r8
 3257 00d2 FFF7FEFF 		bl	cc2400_set
 3258              	.LVL333:
1197:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
 3259              		.loc 1 1197 0
 3260 00d6 0320     		movs	r0, #3
 3261 00d8 4021     		movs	r1, #64
 3262 00da FFF7FEFF 		bl	cc2400_set
 3263              	.LVL334:
1198:bluetooth_rxtx.c **** 
 3264              		.loc 1 1198 0
 3265 00de 1421     		movs	r1, #20
 3266 00e0 2320     		movs	r0, #35
 3267 00e2 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccwLngFB.s 			page 110


 3268              	.LVL335:
1201:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
 3269              		.loc 1 1201 0
 3270 00e6 EA07     		lsls	r2, r5, #31
1202:bluetooth_rxtx.c **** 	else
 3271              		.loc 1 1202 0
 3272 00e8 4CBF     		ite	mi
 3273 00ea 4AF6AA21 		movwmi	r1, #43690
1204:bluetooth_rxtx.c **** 
 3274              		.loc 1 1204 0
 3275 00ee 45F25551 		movwpl	r1, #21845
1202:bluetooth_rxtx.c **** 	else
 3276              		.loc 1 1202 0
 3277 00f2 2D20     		movs	r0, #45
1204:bluetooth_rxtx.c **** 
 3278              		.loc 1 1204 0
 3279 00f4 FFF7FEFF 		bl	cc2400_set
 3280              	.LVL336:
1207:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3281              		.loc 1 1207 0
 3282 00f8 0820     		movs	r0, #8
 3283 00fa FFF7FEFF 		bl	cc2400_get
 3284              	.LVL337:
1208:bluetooth_rxtx.c **** 
 3285              		.loc 1 1208 0
 3286 00fe C0F30801 		ubfx	r1, r0, #0, #9
1169:bluetooth_rxtx.c **** 
 3287              		.loc 1 1169 0
 3288 0102 09F10409 		add	r9, r9, #4
1207:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3289              		.loc 1 1207 0
 3290 0106 0446     		mov	r4, r0
 3291              	.LVL338:
1208:bluetooth_rxtx.c **** 
 3292              		.loc 1 1208 0
 3293 0108 41F49C41 		orr	r1, r1, #19968
 3294 010c 0820     		movs	r0, #8
1169:bluetooth_rxtx.c **** 
 3295              		.loc 1 1169 0
 3296 010e 5FFA89F9 		uxtb	r9, r9
 3297              	.LVL339:
1208:bluetooth_rxtx.c **** 
 3298              		.loc 1 1208 0
 3299 0112 FFF7FEFF 		bl	cc2400_set
 3300              	.LVL340:
 3301              	.L376:
1210:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3302              		.loc 1 1210 0 discriminator 1
 3303 0116 FFF7FEFF 		bl	cc2400_status
 3304              	.LVL341:
 3305 011a 4306     		lsls	r3, r0, #25
 3306 011c FBD5     		bpl	.L376
1211:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3307              		.loc 1 1211 0
 3308 011e 6120     		movs	r0, #97
 3309 0120 FFF7FEFF 		bl	cc2400_strobe
 3310              	.LVL342:
ARM GAS  /tmp/ccwLngFB.s 			page 111


 3311              	.L378:
1212:bluetooth_rxtx.c **** 	TXLED_SET;
 3312              		.loc 1 1212 0 discriminator 1
 3313 0124 FFF7FEFF 		bl	cc2400_status
 3314              	.LVL343:
 3315 0128 4707     		lsls	r7, r0, #29
 3316 012a FBD5     		bpl	.L378
1213:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3317              		.loc 1 1213 0
 3318 012c 1C4B     		ldr	r3, .L392+4
 3319 012e 4FF48072 		mov	r2, #256
 3320 0132 1A60     		str	r2, [r3]
1215:bluetooth_rxtx.c **** #endif
 3321              		.loc 1 1215 0
 3322 0134 8022     		movs	r2, #128
 3323 0136 1A62     		str	r2, [r3, #32]
 3324              	.L380:
1217:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3325              		.loc 1 1217 0 discriminator 1
 3326 0138 0E20     		movs	r0, #14
 3327 013a FFF7FEFF 		bl	cc2400_get
 3328              	.LVL344:
 3329 013e 00F01F00 		and	r0, r0, #31
 3330 0142 0F28     		cmp	r0, #15
 3331 0144 F8D1     		bne	.L380
1218:bluetooth_rxtx.c **** 
 3332              		.loc 1 1218 0
 3333 0146 6320     		movs	r0, #99
 3334 0148 FFF7FEFF 		bl	cc2400_strobe
 3335              	.LVL345:
 3336              	.L382:
1231:bluetooth_rxtx.c **** 	if (len > 46) len = 46;
 3337              		.loc 1 1231 0 discriminator 1
 3338 014c 154B     		ldr	r3, .L392+8
 3339 014e 1B68     		ldr	r3, [r3]
 3340 0150 5E07     		lsls	r6, r3, #29
 3341 0152 FBD4     		bmi	.L382
 3342              	.LVL346:
1233:bluetooth_rxtx.c **** 
 3343              		.loc 1 1233 0
 3344 0154 B9F12E0F 		cmp	r9, #46
 3345 0158 34BF     		ite	cc
 3346 015a 4846     		movcc	r0, r9
 3347 015c 2E20     		movcs	r0, #46
 3348 015e 6946     		mov	r1, sp
 3349 0160 FFF7FEFF 		bl	cc2400_fifo_write
 3350              	.LVL347:
 3351              	.L384:
1235:bluetooth_rxtx.c **** 	TXLED_CLR;
 3352              		.loc 1 1235 0 discriminator 1
 3353 0164 0E20     		movs	r0, #14
 3354 0166 FFF7FEFF 		bl	cc2400_get
 3355              	.LVL348:
 3356 016a 00F01F00 		and	r0, r0, #31
 3357 016e 0F28     		cmp	r0, #15
 3358 0170 F8D1     		bne	.L384
1236:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 112


 3359              		.loc 1 1236 0
 3360 0172 0D4B     		ldr	r3, .L392+12
 3361 0174 4FF48072 		mov	r2, #256
 3362 0178 1A60     		str	r2, [r3]
1238:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 3363              		.loc 1 1238 0
 3364 017a 6420     		movs	r0, #100
 3365 017c FFF7FEFF 		bl	cc2400_strobe
 3366              	.LVL349:
 3367              	.L386:
1239:bluetooth_rxtx.c **** 
 3368              		.loc 1 1239 0 discriminator 1
 3369 0180 FFF7FEFF 		bl	cc2400_status
 3370              	.LVL350:
 3371 0184 4507     		lsls	r5, r0, #29
 3372 0186 FBD4     		bmi	.L386
1242:bluetooth_rxtx.c **** #endif
 3373              		.loc 1 1242 0
 3374 0188 084B     		ldr	r3, .L392+16
 3375 018a 8022     		movs	r2, #128
 3376 018c 1A60     		str	r2, [r3]
1246:bluetooth_rxtx.c **** }
 3377              		.loc 1 1246 0
 3378 018e 0820     		movs	r0, #8
 3379 0190 2146     		mov	r1, r4
 3380 0192 FFF7FEFF 		bl	cc2400_set
 3381              	.LVL351:
1247:bluetooth_rxtx.c **** 
 3382              		.loc 1 1247 0
 3383 0196 11B0     		add	sp, sp, #68
 3384              		@ sp needed
 3385 0198 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 3386              	.LVL352:
 3387              	.L393:
 3388              		.align	2
 3389              	.L392:
 3390 019c 00000000 		.word	.LANCHOR2
 3391 01a0 38C00920 		.word	537509944
 3392 01a4 54C00920 		.word	537509972
 3393 01a8 3CC00920 		.word	537509948
 3394 01ac 5CC00920 		.word	537509980
 3395              		.cfi_endproc
 3396              	.LFE12:
 3398              		.section	.text.le_jam,"ax",%progbits
 3399              		.align	1
 3400              		.global	le_jam
 3401              		.thumb
 3402              		.thumb_func
 3404              	le_jam:
 3405              	.LFB13:
1249:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 3406              		.loc 1 1249 0
 3407              		.cfi_startproc
 3408              		@ args = 0, pretend = 0, frame = 0
 3409              		@ frame_needed = 0, uses_anonymous_args = 0
 3410 0000 08B5     		push	{r3, lr}
 3411              		.cfi_def_cfa_offset 8
ARM GAS  /tmp/ccwLngFB.s 			page 113


 3412              		.cfi_offset 3, -8
 3413              		.cfi_offset 14, -4
1251:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3414              		.loc 1 1251 0
 3415 0002 0D20     		movs	r0, #13
 3416 0004 47F6FF71 		movw	r1, #32767
 3417 0008 FFF7FEFF 		bl	cc2400_set
 3418              	.LVL353:
1252:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
 3419              		.loc 1 1252 0
 3420 000c 1220     		movs	r0, #18
 3421 000e 42F62231 		movw	r1, #11042
 3422 0012 FFF7FEFF 		bl	cc2400_set
 3423              	.LVL354:
1253:bluetooth_rxtx.c **** 
 3424              		.loc 1 1253 0
 3425 0016 1420     		movs	r0, #20
 3426 0018 42F24B31 		movw	r1, #9035
 3427 001c FFF7FEFF 		bl	cc2400_set
 3428              	.LVL355:
1255:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3429              		.loc 1 1255 0
 3430 0020 2020     		movs	r0, #32
 3431 0022 40F60141 		movw	r1, #3073
 3432 0026 FFF7FEFF 		bl	cc2400_set
 3433              	.LVL356:
1264:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3434              		.loc 1 1264 0
 3435 002a 0520     		movs	r0, #5
 3436 002c 0B21     		movs	r1, #11
 3437 002e FFF7FEFF 		bl	cc2400_set
 3438              	.LVL357:
1265:bluetooth_rxtx.c **** 
 3439              		.loc 1 1265 0
 3440 0032 0320     		movs	r0, #3
 3441 0034 4021     		movs	r1, #64
 3442 0036 FFF7FEFF 		bl	cc2400_set
 3443              	.LVL358:
 3444              	.L396:
1267:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3445              		.loc 1 1267 0 discriminator 1
 3446 003a FFF7FEFF 		bl	cc2400_status
 3447              	.LVL359:
 3448 003e 4006     		lsls	r0, r0, #25
 3449 0040 FBD5     		bpl	.L396
1268:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3450              		.loc 1 1268 0
 3451 0042 6120     		movs	r0, #97
 3452 0044 FFF7FEFF 		bl	cc2400_strobe
 3453              	.LVL360:
 3454              	.L398:
1269:bluetooth_rxtx.c **** 	TXLED_SET;
 3455              		.loc 1 1269 0 discriminator 1
 3456 0048 FFF7FEFF 		bl	cc2400_status
 3457              	.LVL361:
 3458 004c 4107     		lsls	r1, r0, #29
 3459 004e FBD5     		bpl	.L398
ARM GAS  /tmp/ccwLngFB.s 			page 114


1270:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3460              		.loc 1 1270 0
 3461 0050 084B     		ldr	r3, .L401
 3462 0052 4FF48072 		mov	r2, #256
 3463 0056 1A60     		str	r2, [r3]
1272:bluetooth_rxtx.c **** #endif
 3464              		.loc 1 1272 0
 3465 0058 8022     		movs	r2, #128
 3466 005a 1A62     		str	r2, [r3, #32]
 3467              	.L400:
1274:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3468              		.loc 1 1274 0 discriminator 1
 3469 005c 0E20     		movs	r0, #14
 3470 005e FFF7FEFF 		bl	cc2400_get
 3471              	.LVL362:
 3472 0062 00F01F00 		and	r0, r0, #31
 3473 0066 0F28     		cmp	r0, #15
 3474 0068 F8D1     		bne	.L400
1275:bluetooth_rxtx.c **** #endif
 3475              		.loc 1 1275 0
 3476 006a 6320     		movs	r0, #99
1277:bluetooth_rxtx.c **** 
 3477              		.loc 1 1277 0
 3478 006c BDE80840 		pop	{r3, lr}
1275:bluetooth_rxtx.c **** #endif
 3479              		.loc 1 1275 0
 3480 0070 FFF7FEBF 		b	cc2400_strobe
 3481              	.LVL363:
 3482              	.L402:
 3483              		.align	2
 3484              	.L401:
 3485 0074 38C00920 		.word	537509944
 3486              		.cfi_endproc
 3487              	.LFE13:
 3489              		.section	.text.hop,"ax",%progbits
 3490              		.align	1
 3491              		.global	hop
 3492              		.thumb
 3493              		.thumb_func
 3495              	hop:
 3496              	.LFB14:
1282:bluetooth_rxtx.c **** 	do_hop = 0;
 3497              		.loc 1 1282 0
 3498              		.cfi_startproc
 3499              		@ args = 0, pretend = 0, frame = 0
 3500              		@ frame_needed = 0, uses_anonymous_args = 0
 3501 0000 38B5     		push	{r3, r4, r5, lr}
 3502              		.cfi_def_cfa_offset 16
 3503              		.cfi_offset 3, -16
 3504              		.cfi_offset 4, -12
 3505              		.cfi_offset 5, -8
 3506              		.cfi_offset 14, -4
1283:bluetooth_rxtx.c **** 	last_hop = clkn;
 3507              		.loc 1 1283 0
 3508 0002 5F4C     		ldr	r4, .L443
 3509 0004 0023     		movs	r3, #0
 3510 0006 E372     		strb	r3, [r4, #11]
ARM GAS  /tmp/ccwLngFB.s 			page 115


1284:bluetooth_rxtx.c **** 
 3511              		.loc 1 1284 0
 3512 0008 5E4B     		ldr	r3, .L443+4
 3513 000a 5F4A     		ldr	r2, .L443+8
 3514 000c 1968     		ldr	r1, [r3]
 3515 000e 1160     		str	r1, [r2]
1287:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
 3516              		.loc 1 1287 0
 3517 0010 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3518 0012 4AB9     		cbnz	r2, .L404
1288:bluetooth_rxtx.c **** 			return;
 3519              		.loc 1 1288 0
 3520 0014 0220     		movs	r0, #2
 3521 0016 FFF7FEFF 		bl	cc2400_get
 3522              	.LVL364:
 3523 001a 5C4B     		ldr	r3, .L443+12
 3524 001c 1B88     		ldrh	r3, [r3]
 3525 001e 9BB2     		uxth	r3, r3
 3526 0020 013B     		subs	r3, r3, #1
 3527 0022 9842     		cmp	r0, r3
 3528 0024 7FD1     		bne	.L406
 3529 0026 38BD     		pop	{r3, r4, r5, pc}
 3530              	.L404:
1294:bluetooth_rxtx.c **** 		do {
 3531              		.loc 1 1294 0
 3532 0028 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3533 002a 012A     		cmp	r2, #1
 3534 002c 31D1     		bne	.L407
1299:bluetooth_rxtx.c **** 	}
 3535              		.loc 1 1299 0
 3536 002e 584B     		ldr	r3, .L443+16
 3537 0030 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3538 0032 584B     		ldr	r3, .L443+20
 3539 0034 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 3540              	.L411:
1296:bluetooth_rxtx.c **** 			if (channel > 2480)
 3541              		.loc 1 1296 0
 3542 0036 554B     		ldr	r3, .L443+12
 3543 0038 1A88     		ldrh	r2, [r3]
 3544 003a 92B2     		uxth	r2, r2
 3545 003c 2032     		adds	r2, r2, #32
 3546 003e 92B2     		uxth	r2, r2
 3547 0040 1A80     		strh	r2, [r3]	@ movhi
1297:bluetooth_rxtx.c **** 				channel -= 79;
 3548              		.loc 1 1297 0
 3549 0042 1A88     		ldrh	r2, [r3]
 3550 0044 92B2     		uxth	r2, r2
 3551 0046 B2F51B6F 		cmp	r2, #2480
 3552 004a 04D9     		bls	.L408
1298:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
 3553              		.loc 1 1298 0
 3554 004c 1A88     		ldrh	r2, [r3]
 3555 004e 92B2     		uxth	r2, r2
 3556 0050 4F3A     		subs	r2, r2, #79
 3557 0052 92B2     		uxth	r2, r2
 3558 0054 1A80     		strh	r2, [r3]	@ movhi
 3559              	.L408:
ARM GAS  /tmp/ccwLngFB.s 			page 116


1299:bluetooth_rxtx.c **** 	}
 3560              		.loc 1 1299 0
 3561 0056 0029     		cmp	r1, #0
 3562 0058 65D0     		beq	.L406
1299:bluetooth_rxtx.c **** 	}
 3563              		.loc 1 1299 0 is_stmt 0 discriminator 1
 3564 005a 0028     		cmp	r0, #0
 3565 005c 63D0     		beq	.L406
 3566 005e 1A88     		ldrh	r2, [r3]
 3567 0060 1D88     		ldrh	r5, [r3]
 3568 0062 92B2     		uxth	r2, r2
 3569 0064 A2F66213 		subw	r3, r2, #2402
 3570 0068 0822     		movs	r2, #8
 3571 006a 93FBF2F3 		sdiv	r3, r3, r2
 3572 006e 4A4A     		ldr	r2, .L443+24
 3573 0070 ADB2     		uxth	r5, r5
 3574 0072 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3575 0074 494B     		ldr	r3, .L443+28
 3576 0076 A5F66215 		subw	r5, r5, #2402
 3577 007a 2B40     		ands	r3, r3, r5
 3578 007c 002B     		cmp	r3, #0
 3579 007e 03DA     		bge	.L410
 3580 0080 013B     		subs	r3, r3, #1
 3581 0082 63F00703 		orn	r3, r3, #7
 3582 0086 0133     		adds	r3, r3, #1
 3583              	.L410:
 3584 0088 42FA03F3 		asr	r3, r2, r3
 3585 008c DD07     		lsls	r5, r3, #31
 3586 008e D2D5     		bpl	.L411
 3587 0090 49E0     		b	.L406
 3588              	.L407:
1305:bluetooth_rxtx.c **** 		do {
 3589              		.loc 1 1305 0 is_stmt 1
 3590 0092 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3591 0094 052A     		cmp	r2, #5
 3592 0096 2DD1     		bne	.L412
1310:bluetooth_rxtx.c **** 	}
 3593              		.loc 1 1310 0
 3594 0098 3D4B     		ldr	r3, .L443+16
 3595 009a 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3596              	.L415:
1307:bluetooth_rxtx.c **** 			if (channel > 2480)
 3597              		.loc 1 1307 0
 3598 009c 3B4B     		ldr	r3, .L443+12
 3599 009e 1A88     		ldrh	r2, [r3]
 3600 00a0 92B2     		uxth	r2, r2
 3601 00a2 2032     		adds	r2, r2, #32
 3602 00a4 92B2     		uxth	r2, r2
 3603 00a6 1A80     		strh	r2, [r3]	@ movhi
1308:bluetooth_rxtx.c **** 				channel -= 79;
 3604              		.loc 1 1308 0
 3605 00a8 1A88     		ldrh	r2, [r3]
 3606 00aa 92B2     		uxth	r2, r2
 3607 00ac B2F51B6F 		cmp	r2, #2480
 3608 00b0 04D9     		bls	.L413
1309:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
 3609              		.loc 1 1309 0
ARM GAS  /tmp/ccwLngFB.s 			page 117


 3610 00b2 1A88     		ldrh	r2, [r3]
 3611 00b4 92B2     		uxth	r2, r2
 3612 00b6 4F3A     		subs	r2, r2, #79
 3613 00b8 92B2     		uxth	r2, r2
 3614 00ba 1A80     		strh	r2, [r3]	@ movhi
 3615              	.L413:
1310:bluetooth_rxtx.c **** 	}
 3616              		.loc 1 1310 0
 3617 00bc 4F29     		cmp	r1, #79
 3618 00be 32D0     		beq	.L406
1310:bluetooth_rxtx.c **** 	}
 3619              		.loc 1 1310 0 is_stmt 0 discriminator 1
 3620 00c0 1A88     		ldrh	r2, [r3]
 3621 00c2 1888     		ldrh	r0, [r3]
 3622 00c4 92B2     		uxth	r2, r2
 3623 00c6 A2F66213 		subw	r3, r2, #2402
 3624 00ca 0822     		movs	r2, #8
 3625 00cc 93FBF2F3 		sdiv	r3, r3, r2
 3626 00d0 314A     		ldr	r2, .L443+24
 3627 00d2 80B2     		uxth	r0, r0
 3628 00d4 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3629 00d6 314B     		ldr	r3, .L443+28
 3630 00d8 A0F66210 		subw	r0, r0, #2402
 3631 00dc 0340     		ands	r3, r3, r0
 3632 00de 002B     		cmp	r3, #0
 3633 00e0 03DA     		bge	.L414
 3634 00e2 013B     		subs	r3, r3, #1
 3635 00e4 63F00703 		orn	r3, r3, #7
 3636 00e8 0133     		adds	r3, r3, #1
 3637              	.L414:
 3638 00ea 42FA03F3 		asr	r3, r2, r3
 3639 00ee DA07     		lsls	r2, r3, #31
 3640 00f0 D4D4     		bmi	.L415
 3641 00f2 18E0     		b	.L406
 3642              	.L412:
1313:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
 3643              		.loc 1 1313 0 is_stmt 1
 3644 00f4 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3645 00f6 022A     		cmp	r2, #2
 3646 00f8 05D1     		bne	.L416
1314:bluetooth_rxtx.c **** 	}
 3647              		.loc 1 1314 0
 3648 00fa 1868     		ldr	r0, [r3]
 3649 00fc FFF7FEFF 		bl	next_hop
 3650              	.LVL365:
 3651 0100 224B     		ldr	r3, .L443+12
 3652 0102 1880     		strh	r0, [r3]	@ movhi
 3653 0104 0FE0     		b	.L406
 3654              	.L416:
1317:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
 3655              		.loc 1 1317 0
 3656 0106 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3657 0108 032B     		cmp	r3, #3
 3658 010a 05D1     		bne	.L417
1318:bluetooth_rxtx.c **** 	}
 3659              		.loc 1 1318 0
 3660 010c 1F4D     		ldr	r5, .L443+12
ARM GAS  /tmp/ccwLngFB.s 			page 118


 3661 010e 281D     		adds	r0, r5, #4
 3662 0110 FFF7FEFF 		bl	btle_next_hop
 3663              	.LVL366:
 3664 0114 2880     		strh	r0, [r5]	@ movhi
 3665 0116 06E0     		b	.L406
 3666              	.L417:
1321:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
 3667              		.loc 1 1321 0
 3668 0118 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3669 011a 042B     		cmp	r3, #4
 3670 011c 03D1     		bne	.L406
1322:bluetooth_rxtx.c **** 	}
 3671              		.loc 1 1322 0
 3672 011e A289     		ldrh	r2, [r4, #12]
 3673 0120 1A4B     		ldr	r3, .L443+12
 3674 0122 92B2     		uxth	r2, r2
 3675 0124 1A80     		strh	r2, [r3]	@ movhi
 3676              	.L406:
1325:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 3677              		.loc 1 1325 0
 3678 0126 6420     		movs	r0, #100
 3679 0128 FFF7FEFF 		bl	cc2400_strobe
 3680              	.LVL367:
 3681              	.L419:
1326:bluetooth_rxtx.c **** 
 3682              		.loc 1 1326 0 discriminator 1
 3683 012c FFF7FEFF 		bl	cc2400_status
 3684              	.LVL368:
 3685 0130 4307     		lsls	r3, r0, #29
 3686 0132 FBD4     		bmi	.L419
 3687 0134 154D     		ldr	r5, .L443+12
1329:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3688              		.loc 1 1329 0
 3689 0136 607C     		ldrb	r0, [r4, #17]	@ zero_extendqisi2
1330:bluetooth_rxtx.c **** 	else
 3690              		.loc 1 1330 0
 3691 0138 2988     		ldrh	r1, [r5]
1329:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3692              		.loc 1 1329 0
 3693 013a C0B2     		uxtb	r0, r0
 3694 013c 0228     		cmp	r0, #2
1330:bluetooth_rxtx.c **** 	else
 3695              		.loc 1 1330 0
 3696 013e 89B2     		uxth	r1, r1
1332:bluetooth_rxtx.c **** 
 3697              		.loc 1 1332 0
 3698 0140 1EBF     		ittt	ne
 3699 0142 01F1FF31 		addne	r1, r1, #-1
 3700 0146 0220     		movne	r0, #2
 3701 0148 89B2     		uxthne	r1, r1
 3702 014a FFF7FEFF 		bl	cc2400_set
 3703              	.LVL369:
1335:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 3704              		.loc 1 1335 0
 3705 014e A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3706 0150 1BB1     		cbz	r3, .L422
1336:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/ccwLngFB.s 			page 119


 3707              		.loc 1 1336 0
 3708 0152 2888     		ldrh	r0, [r5]
 3709 0154 80B2     		uxth	r0, r0
 3710 0156 FFF7FEFF 		bl	cs_threshold_calc_and_set
 3711              	.LVL370:
 3712              	.L422:
1340:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3713              		.loc 1 1340 0
 3714 015a 6120     		movs	r0, #97
 3715 015c FFF7FEFF 		bl	cc2400_strobe
 3716              	.LVL371:
 3717              	.L424:
1341:bluetooth_rxtx.c **** 
 3718              		.loc 1 1341 0 discriminator 1
 3719 0160 FFF7FEFF 		bl	cc2400_status
 3720              	.LVL372:
 3721 0164 4507     		lsls	r5, r0, #29
 3722 0166 FBD5     		bpl	.L424
1343:bluetooth_rxtx.c **** 
 3723              		.loc 1 1343 0
 3724 0168 0123     		movs	r3, #1
 3725 016a 2374     		strb	r3, [r4, #16]
1345:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 3726              		.loc 1 1345 0
 3727 016c 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 3728 016e 022B     		cmp	r3, #2
1346:bluetooth_rxtx.c **** 	else
 3729              		.loc 1 1346 0
 3730 0170 0CBF     		ite	eq
 3731 0172 6320     		moveq	r0, #99
1348:bluetooth_rxtx.c **** }
 3732              		.loc 1 1348 0
 3733 0174 6220     		movne	r0, #98
1349:bluetooth_rxtx.c **** 
 3734              		.loc 1 1349 0
 3735 0176 BDE83840 		pop	{r3, r4, r5, lr}
1348:bluetooth_rxtx.c **** }
 3736              		.loc 1 1348 0
 3737 017a FFF7FEBF 		b	cc2400_strobe
 3738              	.LVL373:
 3739              	.L444:
 3740 017e 00BF     		.align	2
 3741              	.L443:
 3742 0180 00000000 		.word	.LANCHOR0
 3743 0184 00000000 		.word	clkn
 3744 0188 00000000 		.word	last_hop
 3745 018c 00000000 		.word	.LANCHOR1
 3746 0190 00000000 		.word	used_channels
 3747 0194 00000000 		.word	afh_enabled
 3748 0198 00000000 		.word	afh_map
 3749 019c 07000080 		.word	-2147483641
 3750              		.cfi_endproc
 3751              	.LFE14:
 3753              		.section	.text.bt_stream_rx,"ax",%progbits
 3754              		.align	1
 3755              		.global	bt_stream_rx
 3756              		.thumb
ARM GAS  /tmp/ccwLngFB.s 			page 120


 3757              		.thumb_func
 3759              	bt_stream_rx:
 3760              	.LFB15:
1353:bluetooth_rxtx.c **** 	int8_t rssi;
 3761              		.loc 1 1353 0
 3762              		.cfi_startproc
 3763              		@ args = 0, pretend = 0, frame = 0
 3764              		@ frame_needed = 0, uses_anonymous_args = 0
 3765 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 3766              		.cfi_def_cfa_offset 32
 3767              		.cfi_offset 3, -32
 3768              		.cfi_offset 4, -28
 3769              		.cfi_offset 5, -24
 3770              		.cfi_offset 6, -20
 3771              		.cfi_offset 7, -16
 3772              		.cfi_offset 8, -12
 3773              		.cfi_offset 9, -8
 3774              		.cfi_offset 14, -4
1357:bluetooth_rxtx.c **** 
 3775              		.loc 1 1357 0
 3776 0004 494B     		ldr	r3, .L479
 3777 0006 1022     		movs	r2, #16
 3778 0008 1A60     		str	r2, [r3]
1359:bluetooth_rxtx.c **** 	dio_ssp_init();
 3779              		.loc 1 1359 0
 3780 000a FFF7FEFF 		bl	queue_init
 3781              	.LVL374:
1360:bluetooth_rxtx.c **** 	dma_init();
 3782              		.loc 1 1360 0
 3783 000e FFF7FEFF 		bl	dio_ssp_init
 3784              	.LVL375:
1361:bluetooth_rxtx.c **** 	dio_ssp_start();
 3785              		.loc 1 1361 0
 3786 0012 FFF7FEFF 		bl	dma_init
 3787              	.LVL376:
1362:bluetooth_rxtx.c **** 
 3788              		.loc 1 1362 0
 3789 0016 FFF7FEFF 		bl	dio_ssp_start
 3790              	.LVL377:
1364:bluetooth_rxtx.c **** 
 3791              		.loc 1 1364 0
 3792 001a FFF7FEFF 		bl	cc2400_rx
 3793              	.LVL378:
1366:bluetooth_rxtx.c **** 
 3794              		.loc 1 1366 0
 3795 001e FFF7FEFF 		bl	cs_trigger_enable
 3796              	.LVL379:
 3797              	.L446:
1368:bluetooth_rxtx.c **** 	{
 3798              		.loc 1 1368 0 discriminator 1
 3799 0022 434C     		ldr	r4, .L479+4
 3800 0024 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3801 0026 A146     		mov	r9, r4
 3802 0028 012B     		cmp	r3, #1
 3803 002a 75D1     		bne	.L477
 3804              	.L458:
1371:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 121


 3805              		.loc 1 1371 0
 3806 002c 3F4B     		ldr	r3, .L479
 3807 002e 1022     		movs	r2, #16
 3808 0030 1A60     		str	r2, [r3]
1383:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 3809              		.loc 1 1383 0
 3810 0032 FFF7FEFF 		bl	rssi_reset
 3811              	.LVL380:
1384:bluetooth_rxtx.c **** 		while (!rx_tc) {
 3812              		.loc 1 1384 0
 3813 0036 8025     		movs	r5, #128
 3814              	.LVL381:
 3815              	.L447:
1385:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 3816              		.loc 1 1385 0 discriminator 1
 3817 0038 3E4F     		ldr	r7, .L479+8
 3818 003a 3F4E     		ldr	r6, .L479+12
 3819 003c 3B68     		ldr	r3, [r7]
 3820 003e DFF81881 		ldr	r8, .L479+44
 3821 0042 2BBB     		cbnz	r3, .L478
1386:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3822              		.loc 1 1386 0
 3823 0044 0620     		movs	r0, #6
 3824 0046 FFF7FEFF 		bl	cc2400_get
 3825              	.LVL382:
1387:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3826              		.loc 1 1387 0
 3827 004a 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
1386:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3828              		.loc 1 1386 0
 3829 004c C0F30720 		ubfx	r0, r0, #8, #8
 3830              	.LVL383:
1387:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3831              		.loc 1 1387 0
 3832 0050 63B1     		cbz	r3, .L448
1387:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3833              		.loc 1 1387 0 is_stmt 0 discriminator 1
 3834 0052 6BB2     		sxtb	r3, r5
 3835 0054 8033     		adds	r3, r3, #128
 3836 0056 09D1     		bne	.L448
1388:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 3837              		.loc 1 1388 0 is_stmt 1
 3838 0058 384B     		ldr	r3, .L479+16
 3839 005a 40B2     		sxtb	r0, r0
 3840              	.LVL384:
 3841 005c 93F90050 		ldrsb	r5, [r3]
 3842              	.LVL385:
 3843 0060 3635     		adds	r5, r5, #54
 3844 0062 A842     		cmp	r0, r5
 3845 0064 A8BF     		it	ge
 3846 0066 0546     		movge	r5, r0
 3847 0068 EDB2     		uxtb	r5, r5
1389:bluetooth_rxtx.c **** 			}
 3848              		.loc 1 1389 0
 3849 006a 2846     		mov	r0, r5
 3850              	.L448:
 3851              	.LVL386:
ARM GAS  /tmp/ccwLngFB.s 			page 122


1391:bluetooth_rxtx.c **** 
 3852              		.loc 1 1391 0
 3853 006c 40B2     		sxtb	r0, r0
 3854              	.LVL387:
 3855 006e FFF7FEFF 		bl	rssi_add
 3856              	.LVL388:
1393:bluetooth_rxtx.c **** 
 3857              		.loc 1 1393 0
 3858 0072 D8F80000 		ldr	r0, [r8]
 3859 0076 FFF7FEFF 		bl	handle_usb
 3860              	.LVL389:
1396:bluetooth_rxtx.c **** 				hop();
 3861              		.loc 1 1396 0
 3862 007a 99F80B30 		ldrb	r3, [r9, #11]	@ zero_extendqisi2
 3863 007e 13B1     		cbz	r3, .L449
1397:bluetooth_rxtx.c **** 			} else {
 3864              		.loc 1 1397 0
 3865 0080 FFF7FEFF 		bl	hop
 3866              	.LVL390:
 3867 0084 D8E7     		b	.L447
 3868              	.L449:
1399:bluetooth_rxtx.c **** 			}
 3869              		.loc 1 1399 0
 3870 0086 294B     		ldr	r3, .L479
 3871 0088 4FF48072 		mov	r2, #256
 3872 008c 1A60     		str	r2, [r3]
 3873 008e D3E7     		b	.L447
 3874              	.L478:
1405:bluetooth_rxtx.c **** 
 3875              		.loc 1 1405 0
 3876 0090 2B4B     		ldr	r3, .L479+20
 3877 0092 1022     		movs	r2, #16
1407:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3878              		.loc 1 1407 0
 3879 0094 2B4D     		ldr	r5, .L479+24
 3880              	.LVL391:
1405:bluetooth_rxtx.c **** 
 3881              		.loc 1 1405 0
 3882 0096 1A60     		str	r2, [r3]
1407:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3883              		.loc 1 1407 0
 3884 0098 2B68     		ldr	r3, [r5]
 3885 009a 1BB1     		cbz	r3, .L452
1408:bluetooth_rxtx.c **** 		}
 3886              		.loc 1 1408 0
 3887 009c 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3888 009e 43F00203 		orr	r3, r3, #2
 3889 00a2 6370     		strb	r3, [r4, #1]
 3890              	.L452:
1412:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 3891              		.loc 1 1412 0
 3892 00a4 3B68     		ldr	r3, [r7]
 3893 00a6 012B     		cmp	r3, #1
 3894 00a8 03D9     		bls	.L453
1413:bluetooth_rxtx.c **** 
 3895              		.loc 1 1413 0
 3896 00aa 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 123


 3897 00ac 43F00103 		orr	r3, r3, #1
 3898 00b0 6370     		strb	r3, [r4, #1]
 3899              	.L453:
1415:bluetooth_rxtx.c **** 			status |= DISCARD;
 3900              		.loc 1 1415 0
 3901 00b2 227C     		ldrb	r2, [r4, #16]	@ zero_extendqisi2
 3902 00b4 1E4B     		ldr	r3, .L479+4
 3903 00b6 2AB1     		cbz	r2, .L454
1416:bluetooth_rxtx.c **** 			dma_discard = 0;
 3904              		.loc 1 1416 0
 3905 00b8 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 3906 00ba 42F02002 		orr	r2, r2, #32
 3907 00be 5A70     		strb	r2, [r3, #1]
1417:bluetooth_rxtx.c **** 		}
 3908              		.loc 1 1417 0
 3909 00c0 0022     		movs	r2, #0
 3910 00c2 1A74     		strb	r2, [r3, #16]
 3911              	.L454:
1420:bluetooth_rxtx.c **** 
 3912              		.loc 1 1420 0
 3913 00c4 204B     		ldr	r3, .L479+28
 3914 00c6 1888     		ldrh	r0, [r3]
 3915 00c8 80B2     		uxth	r0, r0
 3916 00ca FFF7FEFF 		bl	rssi_iir_update
 3917              	.LVL392:
1426:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3918              		.loc 1 1426 0
 3919 00ce 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 3920 00d0 13B9     		cbnz	r3, .L455
1426:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3921              		.loc 1 1426 0 is_stmt 0 discriminator 1
 3922 00d2 1E4B     		ldr	r3, .L479+32
 3923 00d4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3924 00d6 2BB1     		cbz	r3, .L456
 3925              	.L455:
1427:bluetooth_rxtx.c **** 			cs_trigger = 0;
 3926              		.loc 1 1427 0 is_stmt 1
 3927 00d8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3928 00da 43F00803 		orr	r3, r3, #8
 3929 00de 6370     		strb	r3, [r4, #1]
1428:bluetooth_rxtx.c **** 		}
 3930              		.loc 1 1428 0
 3931 00e0 0023     		movs	r3, #0
 3932 00e2 3370     		strb	r3, [r6]
 3933              	.L456:
1431:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 3934              		.loc 1 1431 0
 3935 00e4 154B     		ldr	r3, .L479+16
 3936 00e6 93F90020 		ldrsb	r2, [r3]
 3937 00ea 194B     		ldr	r3, .L479+36
 3938 00ec 3532     		adds	r2, r2, #53
 3939 00ee 93F90030 		ldrsb	r3, [r3]
 3940 00f2 9A42     		cmp	r2, r3
 3941 00f4 03DA     		bge	.L457
1432:bluetooth_rxtx.c **** 		}
 3942              		.loc 1 1432 0
 3943 00f6 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 124


 3944 00f8 43F01003 		orr	r3, r3, #16
 3945 00fc 6370     		strb	r3, [r4, #1]
 3946              	.L457:
1435:bluetooth_rxtx.c **** 
 3947              		.loc 1 1435 0
 3948 00fe 154B     		ldr	r3, .L479+40
 3949 0100 0020     		movs	r0, #0
 3950 0102 1968     		ldr	r1, [r3]
 3951 0104 FFF7FEFF 		bl	enqueue
 3952              	.LVL393:
1437:bluetooth_rxtx.c **** 		rx_tc = 0;
 3953              		.loc 1 1437 0
 3954 0108 D8F80000 		ldr	r0, [r8]
 3955 010c FFF7FEFF 		bl	handle_usb
 3956              	.LVL394:
1438:bluetooth_rxtx.c **** 		rx_err = 0;
 3957              		.loc 1 1438 0
 3958 0110 0023     		movs	r3, #0
 3959 0112 3B60     		str	r3, [r7]
1439:bluetooth_rxtx.c **** 	}
 3960              		.loc 1 1439 0
 3961 0114 2B60     		str	r3, [r5]
 3962 0116 84E7     		b	.L446
 3963              	.L477:
1368:bluetooth_rxtx.c **** 	{
 3964              		.loc 1 1368 0 discriminator 2
 3965 0118 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3966 011a 082B     		cmp	r3, #8
 3967 011c 86D0     		beq	.L458
1446:bluetooth_rxtx.c **** 	cs_trigger_disable();
 3968              		.loc 1 1446 0
 3969 011e FFF7FEFF 		bl	dio_ssp_stop
 3970              	.LVL395:
1448:bluetooth_rxtx.c **** 
 3971              		.loc 1 1448 0
 3972 0122 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1447:bluetooth_rxtx.c **** }
 3973              		.loc 1 1447 0
 3974 0126 FFF7FEBF 		b	cs_trigger_disable
 3975              	.LVL396:
 3976              	.L480:
 3977 012a 00BF     		.align	2
 3978              	.L479:
 3979 012c 3CC00920 		.word	537509948
 3980 0130 00000000 		.word	.LANCHOR0
 3981 0134 00000000 		.word	rx_tc
 3982 0138 00000000 		.word	cs_trigger
 3983 013c 00000000 		.word	cs_threshold_cur
 3984 0140 38C00920 		.word	537509944
 3985 0144 00000000 		.word	rx_err
 3986 0148 00000000 		.word	.LANCHOR1
 3987 014c 00000000 		.word	cs_no_squelch
 3988 0150 00000000 		.word	rssi_max
 3989 0154 00000000 		.word	idle_rxbuf
 3990 0158 00000000 		.word	clkn
 3991              		.cfi_endproc
 3992              	.LFE15:
ARM GAS  /tmp/ccwLngFB.s 			page 125


 3994              		.section	.text.br_transmit,"ax",%progbits
 3995              		.align	1
 3996              		.global	br_transmit
 3997              		.thumb
 3998              		.thumb_func
 4000              	br_transmit:
 4001              	.LFB18:
1480:bluetooth_rxtx.c **** 	uint16_t gio_save;
 4002              		.loc 1 1480 0
 4003              		.cfi_startproc
 4004              		@ args = 0, pretend = 0, frame = 16
 4005              		@ frame_needed = 0, uses_anonymous_args = 0
 4006 0000 2DE9FF41 		push	{r0, r1, r2, r3, r4, r5, r6, r7, r8, lr}
 4007              		.cfi_def_cfa_offset 40
 4008              		.cfi_offset 0, -40
 4009              		.cfi_offset 1, -36
 4010              		.cfi_offset 2, -32
 4011              		.cfi_offset 3, -28
 4012              		.cfi_offset 4, -24
 4013              		.cfi_offset 5, -20
 4014              		.cfi_offset 6, -16
 4015              		.cfi_offset 7, -12
 4016              		.cfi_offset 8, -8
 4017              		.cfi_offset 14, -4
 4018              	.LVL397:
1485:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4019              		.loc 1 1485 0
 4020 0004 954B     		ldr	r3, .L517
 4021 0006 0122     		movs	r2, #1
 4022 0008 D3E90245 		ldrd	r4, [r3, #8]
 4023 000c 0023     		movs	r3, #0
 4024 000e 2240     		ands	r2, r2, r4
 4025 0010 2B40     		ands	r3, r3, r5
 4026 0012 52EA0301 		orrs	r1, r2, r3
1486:bluetooth_rxtx.c **** 
 4027              		.loc 1 1486 0
 4028 0016 4FF00007 		mov	r7, #0
1485:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4029              		.loc 1 1485 0
 4030 001a 45F25553 		movw	r3, #21845
1486:bluetooth_rxtx.c **** 
 4031              		.loc 1 1486 0
 4032 001e 4FEAD576 		lsr	r6, r5, #31
1485:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4033              		.loc 1 1485 0
 4034 0022 4AF6AA28 		movw	r8, #43690
 4035 0026 18BF     		it	ne
 4036 0028 9846     		movne	r8, r3
 4037              	.LVL398:
1489:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 4038              		.loc 1 1489 0
 4039 002a E0B2     		uxtb	r0, r4
1486:bluetooth_rxtx.c **** 
 4040              		.loc 1 1486 0
 4041 002c 002F     		cmp	r7, #0
 4042 002e 08BF     		it eq
 4043 0030 012E     		cmpeq	r6, #1
ARM GAS  /tmp/ccwLngFB.s 			page 126


 4044 0032 14BF     		ite	ne
 4045 0034 5526     		movne	r6, #85
 4046 0036 AA26     		moveq	r6, #170
 4047              	.LVL399:
1489:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 4048              		.loc 1 1489 0
 4049 0038 FFF7FEFF 		bl	reverse8
 4050              	.LVL400:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4051              		.loc 1 1488 0
 4052 003c 8DF80000 		strb	r0, [sp]
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
 4053              		.loc 1 1490 0
 4054 0040 C4F30720 		ubfx	r0, r4, #8, #8
 4055 0044 FFF7FEFF 		bl	reverse8
 4056              	.LVL401:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4057              		.loc 1 1488 0
 4058 0048 8DF80100 		strb	r0, [sp, #1]
1491:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
 4059              		.loc 1 1491 0
 4060 004c C4F30740 		ubfx	r0, r4, #16, #8
 4061 0050 FFF7FEFF 		bl	reverse8
 4062              	.LVL402:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4063              		.loc 1 1488 0
 4064 0054 8DF80200 		strb	r0, [sp, #2]
1492:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
 4065              		.loc 1 1492 0
 4066 0058 200E     		lsrs	r0, r4, #24
 4067 005a FFF7FEFF 		bl	reverse8
 4068              	.LVL403:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4069              		.loc 1 1488 0
 4070 005e 8DF80300 		strb	r0, [sp, #3]
1493:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
 4071              		.loc 1 1493 0
 4072 0062 E8B2     		uxtb	r0, r5
 4073 0064 FFF7FEFF 		bl	reverse8
 4074              	.LVL404:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4075              		.loc 1 1488 0
 4076 0068 8DF80400 		strb	r0, [sp, #4]
1494:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
 4077              		.loc 1 1494 0
 4078 006c C5F30720 		ubfx	r0, r5, #8, #8
 4079 0070 FFF7FEFF 		bl	reverse8
 4080              	.LVL405:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4081              		.loc 1 1488 0
 4082 0074 8DF80500 		strb	r0, [sp, #5]
1495:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
 4083              		.loc 1 1495 0
 4084 0078 C5F30740 		ubfx	r0, r5, #16, #8
 4085 007c FFF7FEFF 		bl	reverse8
 4086              	.LVL406:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
ARM GAS  /tmp/ccwLngFB.s 			page 127


 4087              		.loc 1 1488 0
 4088 0080 8DF80600 		strb	r0, [sp, #6]
1496:bluetooth_rxtx.c **** 		reverse8(trailer),
 4089              		.loc 1 1496 0
 4090 0084 280E     		lsrs	r0, r5, #24
 4091 0086 FFF7FEFF 		bl	reverse8
 4092              	.LVL407:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4093              		.loc 1 1488 0
 4094 008a 8DF80700 		strb	r0, [sp, #7]
1497:bluetooth_rxtx.c **** 		reverse8(0x77),
 4095              		.loc 1 1497 0
 4096 008e 3046     		mov	r0, r6
 4097 0090 FFF7FEFF 		bl	reverse8
 4098              	.LVL408:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4099              		.loc 1 1488 0
 4100 0094 8DF80800 		strb	r0, [sp, #8]
1498:bluetooth_rxtx.c **** 		reverse8(0x66),
 4101              		.loc 1 1498 0
 4102 0098 7720     		movs	r0, #119
 4103 009a FFF7FEFF 		bl	reverse8
 4104              	.LVL409:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4105              		.loc 1 1488 0
 4106 009e 8DF80900 		strb	r0, [sp, #9]
1499:bluetooth_rxtx.c **** 		reverse8(0x55),
 4107              		.loc 1 1499 0
 4108 00a2 6620     		movs	r0, #102
 4109 00a4 FFF7FEFF 		bl	reverse8
 4110              	.LVL410:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4111              		.loc 1 1488 0
 4112 00a8 8DF80A00 		strb	r0, [sp, #10]
1500:bluetooth_rxtx.c **** 		reverse8(0x44),
 4113              		.loc 1 1500 0
 4114 00ac 5520     		movs	r0, #85
 4115 00ae FFF7FEFF 		bl	reverse8
 4116              	.LVL411:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4117              		.loc 1 1488 0
 4118 00b2 8DF80B00 		strb	r0, [sp, #11]
1501:bluetooth_rxtx.c **** 		reverse8(0x33),
 4119              		.loc 1 1501 0
 4120 00b6 4420     		movs	r0, #68
 4121 00b8 FFF7FEFF 		bl	reverse8
 4122              	.LVL412:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4123              		.loc 1 1488 0
 4124 00bc 8DF80C00 		strb	r0, [sp, #12]
1502:bluetooth_rxtx.c **** 		reverse8(0x22),
 4125              		.loc 1 1502 0
 4126 00c0 3320     		movs	r0, #51
 4127 00c2 FFF7FEFF 		bl	reverse8
 4128              	.LVL413:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4129              		.loc 1 1488 0
ARM GAS  /tmp/ccwLngFB.s 			page 128


 4130 00c6 8DF80D00 		strb	r0, [sp, #13]
1503:bluetooth_rxtx.c **** 		reverse8(0x11)
 4131              		.loc 1 1503 0
 4132 00ca 2220     		movs	r0, #34
 4133 00cc FFF7FEFF 		bl	reverse8
 4134              	.LVL414:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4135              		.loc 1 1488 0
 4136 00d0 8DF80E00 		strb	r0, [sp, #14]
1504:bluetooth_rxtx.c **** 	};
 4137              		.loc 1 1504 0
 4138 00d4 1120     		movs	r0, #17
 4139 00d6 FFF7FEFF 		bl	reverse8
 4140              	.LVL415:
 4141              	.LBB33:
 4142              	.LBB34:
1464:bluetooth_rxtx.c **** 
 4143              		.loc 1 1464 0
 4144 00da 3C46     		mov	r4, r7
 4145              	.LBE34:
 4146              	.LBE33:
1488:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4147              		.loc 1 1488 0
 4148 00dc 8DF80F00 		strb	r0, [sp, #15]
 4149              	.LVL416:
 4150              	.LBB37:
 4151              	.LBB36:
 4152              	.LBB35:
1466:bluetooth_rxtx.c **** 	{
 4153              		.loc 1 1466 0
 4154 00e0 3B46     		mov	r3, r7
 4155              	.LVL417:
 4156              	.L485:
1468:bluetooth_rxtx.c **** 	}
 4157              		.loc 1 1468 0
 4158 00e2 48FA03F2 		asr	r2, r8, r3
 4159 00e6 C3F10F01 		rsb	r1, r3, #15
 4160 00ea 02F00102 		and	r2, r2, #1
 4161 00ee 8A40     		lsls	r2, r2, r1
1466:bluetooth_rxtx.c **** 	{
 4162              		.loc 1 1466 0
 4163 00f0 0133     		adds	r3, r3, #1
 4164              	.LVL418:
1468:bluetooth_rxtx.c **** 	}
 4165              		.loc 1 1468 0
 4166 00f2 1443     		orrs	r4, r4, r2
 4167              	.LVL419:
1466:bluetooth_rxtx.c **** 	{
 4168              		.loc 1 1466 0
 4169 00f4 102B     		cmp	r3, #16
1468:bluetooth_rxtx.c **** 	}
 4170              		.loc 1 1468 0
 4171 00f6 A4B2     		uxth	r4, r4
 4172              	.LVL420:
1466:bluetooth_rxtx.c **** 	{
 4173              		.loc 1 1466 0
 4174 00f8 F3D1     		bne	.L485
ARM GAS  /tmp/ccwLngFB.s 			page 129


 4175              	.LVL421:
 4176              	.LBE35:
 4177              	.LBE36:
 4178              	.LBE37:
 4179              	.LBB38:
 4180              	.LBB39:
1081:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 4181              		.loc 1 1081 0
 4182 00fa 0D20     		movs	r0, #13
 4183 00fc 47F6FF71 		movw	r1, #32767
 4184 0100 FFF7FEFF 		bl	cc2400_set
 4185              	.LVL422:
1082:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 4186              		.loc 1 1082 0
 4187 0104 1220     		movs	r0, #18
 4188 0106 42F62231 		movw	r1, #11042
 4189 010a FFF7FEFF 		bl	cc2400_set
 4190              	.LVL423:
1083:bluetooth_rxtx.c **** 
 4191              		.loc 1 1083 0
 4192 010e 1420     		movs	r0, #20
 4193 0110 41F24B31 		movw	r1, #4939
 4194 0114 FFF7FEFF 		bl	cc2400_set
 4195              	.LVL424:
1085:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 4196              		.loc 1 1085 0
 4197 0118 2020     		movs	r0, #32
 4198 011a 40F60141 		movw	r1, #3073
 4199 011e FFF7FEFF 		bl	cc2400_set
 4200              	.LVL425:
1093:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 4201              		.loc 1 1093 0
 4202 0122 2146     		mov	r1, r4
 4203 0124 2C20     		movs	r0, #44
 4204 0126 FFF7FEFF 		bl	cc2400_set
 4205              	.LVL426:
1094:bluetooth_rxtx.c **** 
 4206              		.loc 1 1094 0
 4207 012a 2D20     		movs	r0, #45
 4208 012c 0021     		movs	r1, #0
 4209 012e FFF7FEFF 		bl	cc2400_set
 4210              	.LVL427:
1096:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4211              		.loc 1 1096 0
 4212 0132 4B4B     		ldr	r3, .L517+4
 4213 0134 0220     		movs	r0, #2
 4214 0136 1988     		ldrh	r1, [r3]
1099:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4215              		.loc 1 1099 0
 4216 0138 4A4C     		ldr	r4, .L517+8
 4217              	.LVL428:
1096:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4218              		.loc 1 1096 0
 4219 013a 89B2     		uxth	r1, r1
 4220 013c FFF7FEFF 		bl	cc2400_set
 4221              	.LVL429:
1097:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 130


 4222              		.loc 1 1097 0
 4223 0140 0520     		movs	r0, #5
 4224 0142 0B21     		movs	r1, #11
 4225 0144 FFF7FEFF 		bl	cc2400_set
 4226              	.LVL430:
1099:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4227              		.loc 1 1099 0
 4228 0148 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4229 014a 13B9     		cbnz	r3, .L486
1100:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 4230              		.loc 1 1100 0
 4231 014c 0320     		movs	r0, #3
 4232 014e 2921     		movs	r1, #41
 4233 0150 04E0     		b	.L515
 4234              	.L486:
1101:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 4235              		.loc 1 1101 0
 4236 0152 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4237 0154 012B     		cmp	r3, #1
 4238 0156 1DD1     		bne	.L488
1102:bluetooth_rxtx.c **** 	} else {
 4239              		.loc 1 1102 0
 4240 0158 0320     		movs	r0, #3
 4241 015a 4021     		movs	r1, #64
 4242              	.L515:
 4243 015c FFF7FEFF 		bl	cc2400_set
 4244              	.LVL431:
1108:bluetooth_rxtx.c **** 
 4245              		.loc 1 1108 0
 4246 0160 FFF7FEFF 		bl	clkn_start
 4247              	.LVL432:
 4248              	.L490:
1110:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 4249              		.loc 1 1110 0
 4250 0164 FFF7FEFF 		bl	cc2400_status
 4251              	.LVL433:
 4252 0168 4506     		lsls	r5, r0, #25
 4253 016a FBD5     		bpl	.L490
1111:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 4254              		.loc 1 1111 0
 4255 016c 6120     		movs	r0, #97
 4256 016e FFF7FEFF 		bl	cc2400_strobe
 4257              	.LVL434:
 4258              	.L492:
1112:bluetooth_rxtx.c **** 
 4259              		.loc 1 1112 0
 4260 0172 FFF7FEFF 		bl	cc2400_status
 4261              	.LVL435:
 4262 0176 4007     		lsls	r0, r0, #29
 4263 0178 FBD5     		bpl	.L492
1115:bluetooth_rxtx.c **** #endif
 4264              		.loc 1 1115 0
 4265 017a 3B4B     		ldr	r3, .L517+12
 4266 017c 8022     		movs	r2, #128
 4267 017e 1A60     		str	r2, [r3]
 4268              	.L494:
1118:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
ARM GAS  /tmp/ccwLngFB.s 			page 131


 4269              		.loc 1 1118 0
 4270 0180 0E20     		movs	r0, #14
 4271 0182 FFF7FEFF 		bl	cc2400_get
 4272              	.LVL436:
 4273 0186 00F01F00 		and	r0, r0, #31
 4274 018a 0F28     		cmp	r0, #15
 4275 018c F8D1     		bne	.L494
1119:bluetooth_rxtx.c **** 
 4276              		.loc 1 1119 0
 4277 018e 6320     		movs	r0, #99
 4278 0190 FFF7FEFF 		bl	cc2400_strobe
 4279              	.LVL437:
 4280              	.L488:
 4281              	.LBE39:
 4282              	.LBE38:
1509:bluetooth_rxtx.c **** 
 4283              		.loc 1 1509 0 discriminator 3
 4284 0194 1421     		movs	r1, #20
 4285 0196 2320     		movs	r0, #35
 4286 0198 FFF7FEFF 		bl	cc2400_set
 4287              	.LVL438:
1512:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4288              		.loc 1 1512 0 discriminator 3
 4289 019c 0820     		movs	r0, #8
 4290 019e FFF7FEFF 		bl	cc2400_get
 4291              	.LVL439:
1513:bluetooth_rxtx.c **** 
 4292              		.loc 1 1513 0 discriminator 3
 4293 01a2 C0F30801 		ubfx	r1, r0, #0, #9
1512:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4294              		.loc 1 1512 0 discriminator 3
 4295 01a6 0546     		mov	r5, r0
 4296              	.LVL440:
1513:bluetooth_rxtx.c **** 
 4297              		.loc 1 1513 0 discriminator 3
 4298 01a8 41F49C41 		orr	r1, r1, #19968
 4299 01ac 0820     		movs	r0, #8
 4300              	.LVL441:
 4301 01ae FFF7FEFF 		bl	cc2400_set
 4302              	.LVL442:
1483:bluetooth_rxtx.c **** 
 4303              		.loc 1 1483 0 discriminator 3
 4304 01b2 0026     		movs	r6, #0
 4305              	.LVL443:
 4306              	.L495:
1515:bluetooth_rxtx.c **** 	{
 4307              		.loc 1 1515 0 discriminator 1
 4308 01b4 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4309 01b6 022B     		cmp	r3, #2
 4310 01b8 45D1     		bne	.L509
1518:bluetooth_rxtx.c **** 
 4311              		.loc 1 1518 0
 4312 01ba 7608     		lsrs	r6, r6, #1
 4313              	.LVL444:
 4314              	.L497:
1518:bluetooth_rxtx.c **** 
 4315              		.loc 1 1518 0 is_stmt 0 discriminator 1
ARM GAS  /tmp/ccwLngFB.s 			page 132


 4316 01bc 2B4F     		ldr	r7, .L517+16
 4317 01be 3B68     		ldr	r3, [r7]
 4318 01c0 B6EB530F 		cmp	r6, r3, lsr #1
 4319 01c4 05D1     		bne	.L516
 4320              	.L498:
1521:bluetooth_rxtx.c **** 				hop();
 4321              		.loc 1 1521 0 is_stmt 1
 4322 01c6 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4323 01c8 002B     		cmp	r3, #0
 4324 01ca F7D0     		beq	.L497
1522:bluetooth_rxtx.c **** 			}
 4325              		.loc 1 1522 0
 4326 01cc FFF7FEFF 		bl	hop
 4327              	.LVL445:
 4328 01d0 F4E7     		b	.L497
 4329              	.L516:
1518:bluetooth_rxtx.c **** 
 4330              		.loc 1 1518 0 discriminator 2
 4331 01d2 274B     		ldr	r3, .L517+20
 4332 01d4 1A68     		ldr	r2, [r3]
 4333 01d6 40F6C903 		movw	r3, #2249
 4334 01da 9A42     		cmp	r2, r3
 4335 01dc F3D9     		bls	.L498
1528:bluetooth_rxtx.c **** 
 4336              		.loc 1 1528 0
 4337 01de 254B     		ldr	r3, .L517+24
 4338 01e0 4FF48072 		mov	r2, #256
1526:bluetooth_rxtx.c **** 
 4339              		.loc 1 1526 0
 4340 01e4 3E68     		ldr	r6, [r7]
 4341              	.LVL446:
1530:bluetooth_rxtx.c **** 
 4342              		.loc 1 1530 0
 4343 01e6 1020     		movs	r0, #16
1528:bluetooth_rxtx.c **** 
 4344              		.loc 1 1528 0
 4345 01e8 1A60     		str	r2, [r3]
1530:bluetooth_rxtx.c **** 
 4346              		.loc 1 1530 0
 4347 01ea 6946     		mov	r1, sp
 4348 01ec FFF7FEFF 		bl	cc2400_fifo_write
 4349              	.LVL447:
 4350              	.L500:
1532:bluetooth_rxtx.c **** 		TXLED_CLR;
 4351              		.loc 1 1532 0 discriminator 1
 4352 01f0 0E20     		movs	r0, #14
 4353 01f2 FFF7FEFF 		bl	cc2400_get
 4354              	.LVL448:
 4355 01f6 00F01F00 		and	r0, r0, #31
 4356 01fa 0F28     		cmp	r0, #15
 4357 01fc F8D1     		bne	.L500
1533:bluetooth_rxtx.c **** 
 4358              		.loc 1 1533 0
 4359 01fe 1E4B     		ldr	r3, .L517+28
 4360 0200 4FF48072 		mov	r2, #256
 4361 0204 1A60     		str	r2, [r3]
1535:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
ARM GAS  /tmp/ccwLngFB.s 			page 133


 4362              		.loc 1 1535 0
 4363 0206 6420     		movs	r0, #100
 4364 0208 FFF7FEFF 		bl	cc2400_strobe
 4365              	.LVL449:
 4366              	.L502:
1536:bluetooth_rxtx.c **** 
 4367              		.loc 1 1536 0 discriminator 1
 4368 020c FFF7FEFF 		bl	cc2400_status
 4369              	.LVL450:
 4370 0210 4107     		lsls	r1, r0, #29
 4371 0212 FBD4     		bmi	.L502
 4372              	.L504:
1538:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 4373              		.loc 1 1538 0
 4374 0214 FFF7FEFF 		bl	cc2400_status
 4375              	.LVL451:
 4376 0218 4206     		lsls	r2, r0, #25
 4377 021a FBD5     		bpl	.L504
1539:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 4378              		.loc 1 1539 0
 4379 021c 6120     		movs	r0, #97
 4380 021e FFF7FEFF 		bl	cc2400_strobe
 4381              	.LVL452:
 4382              	.L506:
1540:bluetooth_rxtx.c **** 
 4383              		.loc 1 1540 0 discriminator 1
 4384 0222 FFF7FEFF 		bl	cc2400_status
 4385              	.LVL453:
 4386 0226 4307     		lsls	r3, r0, #29
 4387 0228 FBD5     		bpl	.L506
 4388              	.L508:
1542:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 4389              		.loc 1 1542 0
 4390 022a 0E20     		movs	r0, #14
 4391 022c FFF7FEFF 		bl	cc2400_get
 4392              	.LVL454:
 4393 0230 00F01F00 		and	r0, r0, #31
 4394 0234 0F28     		cmp	r0, #15
 4395 0236 F8D1     		bne	.L508
1543:bluetooth_rxtx.c **** 
 4396              		.loc 1 1543 0
 4397 0238 6320     		movs	r0, #99
 4398 023a FFF7FEFF 		bl	cc2400_strobe
 4399              	.LVL455:
1545:bluetooth_rxtx.c **** 	}
 4400              		.loc 1 1545 0
 4401 023e 3868     		ldr	r0, [r7]
 4402 0240 FFF7FEFF 		bl	handle_usb
 4403              	.LVL456:
 4404 0244 B6E7     		b	.L495
 4405              	.L509:
1549:bluetooth_rxtx.c **** #endif
 4406              		.loc 1 1549 0
 4407 0246 0D4B     		ldr	r3, .L517+32
 4408 0248 8022     		movs	r2, #128
 4409 024a 1A60     		str	r2, [r3]
1553:bluetooth_rxtx.c **** }
ARM GAS  /tmp/ccwLngFB.s 			page 134


 4410              		.loc 1 1553 0
 4411 024c 0820     		movs	r0, #8
 4412 024e 2946     		mov	r1, r5
 4413 0250 FFF7FEFF 		bl	cc2400_set
 4414              	.LVL457:
1554:bluetooth_rxtx.c **** 
 4415              		.loc 1 1554 0
 4416 0254 04B0     		add	sp, sp, #16
 4417              		@ sp needed
 4418 0256 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 4419              	.LVL458:
 4420              	.L518:
 4421 025a 00BF     		.align	2
 4422              	.L517:
 4423 025c 00000000 		.word	target
 4424 0260 00000000 		.word	.LANCHOR1
 4425 0264 00000000 		.word	.LANCHOR0
 4426 0268 58C00920 		.word	537509976
 4427 026c 00000000 		.word	clkn
 4428 0270 08400040 		.word	1073758216
 4429 0274 38C00920 		.word	537509944
 4430 0278 3CC00920 		.word	537509948
 4431 027c 5CC00920 		.word	537509980
 4432              		.cfi_endproc
 4433              	.LFE18:
 4435              		.section	.text.reset_le,"ax",%progbits
 4436              		.align	1
 4437              		.global	reset_le
 4438              		.thumb
 4439              		.thumb_func
 4441              	reset_le:
 4442              	.LFB20:
1567:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
 4443              		.loc 1 1567 0
 4444              		.cfi_startproc
 4445              		@ args = 0, pretend = 0, frame = 0
 4446              		@ frame_needed = 0, uses_anonymous_args = 0
 4447 0000 08B5     		push	{r3, lr}
 4448              		.cfi_def_cfa_offset 8
 4449              		.cfi_offset 3, -8
 4450              		.cfi_offset 14, -4
1568:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
 4451              		.loc 1 1568 0
 4452 0002 0F48     		ldr	r0, .L520
 4453 0004 FFF7FEFF 		bl	le_set_access_address
 4454              	.LVL459:
1569:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
 4455              		.loc 1 1569 0
 4456 0008 0E4B     		ldr	r3, .L520+4
 4457 000a 0F4A     		ldr	r2, .L520+8
 4458 000c DA60     		str	r2, [r3, #12]
1570:bluetooth_rxtx.c **** 	//JWHUR crc verify on
 4459              		.loc 1 1570 0
 4460 000e 0F4A     		ldr	r2, .L520+12
 4461 0010 1A61     		str	r2, [r3, #16]
1572:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4462              		.loc 1 1572 0
ARM GAS  /tmp/ccwLngFB.s 			page 135


 4463 0012 0122     		movs	r2, #1
 4464 0014 5A61     		str	r2, [r3, #20]
1573:bluetooth_rxtx.c **** 
 4465              		.loc 1 1573 0
 4466 0016 0022     		movs	r2, #0
1581:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4467              		.loc 1 1581 0
 4468 0018 1A84     		strh	r2, [r3, #32]	@ movhi
1573:bluetooth_rxtx.c **** 
 4469              		.loc 1 1573 0
 4470 001a 5A64     		str	r2, [r3, #68]
1584:bluetooth_rxtx.c **** 
 4471              		.loc 1 1584 0
 4472 001c 9A84     		strh	r2, [r3, #36]	@ movhi
1575:bluetooth_rxtx.c **** 
 4473              		.loc 1 1575 0
 4474 001e 1A76     		strb	r2, [r3, #24]
1577:bluetooth_rxtx.c **** 	le.channel_increment = 0;
 4475              		.loc 1 1577 0
 4476 0020 5A76     		strb	r2, [r3, #25]
1578:bluetooth_rxtx.c **** 
 4477              		.loc 1 1578 0
 4478 0022 9A76     		strb	r2, [r3, #26]
1580:bluetooth_rxtx.c **** 	le.interval_timer = 0;
 4479              		.loc 1 1580 0
 4480 0024 DA61     		str	r2, [r3, #28]
1582:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4481              		.loc 1 1582 0
 4482 0026 5A84     		strh	r2, [r3, #34]	@ movhi
1586:bluetooth_rxtx.c **** 	le.win_offset = 0;
 4483              		.loc 1 1586 0
 4484 0028 83F82620 		strb	r2, [r3, #38]
1587:bluetooth_rxtx.c **** 
 4485              		.loc 1 1587 0
 4486 002c 1A85     		strh	r2, [r3, #40]	@ movhi
1589:bluetooth_rxtx.c **** 	le.update_instant = 0;
 4487              		.loc 1 1589 0
 4488 002e DA62     		str	r2, [r3, #44]
1590:bluetooth_rxtx.c **** 	le.interval_update = 0;
 4489              		.loc 1 1590 0
 4490 0030 1A86     		strh	r2, [r3, #48]	@ movhi
1591:bluetooth_rxtx.c **** 	le.win_size_update = 0;
 4491              		.loc 1 1591 0
 4492 0032 5A86     		strh	r2, [r3, #50]	@ movhi
1592:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
 4493              		.loc 1 1592 0
 4494 0034 83F83420 		strb	r2, [r3, #52]
1593:bluetooth_rxtx.c **** 
 4495              		.loc 1 1593 0
 4496 0038 DA86     		strh	r2, [r3, #54]	@ movhi
1595:bluetooth_rxtx.c **** }
 4497              		.loc 1 1595 0
 4498 003a 054B     		ldr	r3, .L520+16
 4499 003c DA72     		strb	r2, [r3, #11]
 4500 003e 08BD     		pop	{r3, pc}
 4501              	.L521:
 4502              		.align	2
ARM GAS  /tmp/ccwLngFB.s 			page 136


 4503              	.L520:
 4504 0040 D6BE898E 		.word	-1903575338
 4505 0044 00000000 		.word	.LANCHOR1
 4506 0048 55555500 		.word	5592405
 4507 004c AAAAAA00 		.word	11184810
 4508 0050 00000000 		.word	.LANCHOR0
 4509              		.cfi_endproc
 4510              	.LFE20:
 4512              		.section	.text.reset_le_promisc,"ax",%progbits
 4513              		.align	1
 4514              		.global	reset_le_promisc
 4515              		.thumb
 4516              		.thumb_func
 4518              	reset_le_promisc:
 4519              	.LFB21:
1599:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
 4520              		.loc 1 1599 0
 4521              		.cfi_startproc
 4522              		@ args = 0, pretend = 0, frame = 0
 4523              		@ frame_needed = 0, uses_anonymous_args = 0
 4524 0000 10B5     		push	{r4, lr}
 4525              		.cfi_def_cfa_offset 8
 4526              		.cfi_offset 4, -8
 4527              		.cfi_offset 14, -4
1600:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
 4528              		.loc 1 1600 0
 4529 0002 064C     		ldr	r4, .L523
 4530 0004 0021     		movs	r1, #0
 4531 0006 2046     		mov	r0, r4
 4532 0008 4FF48472 		mov	r2, #264
 4533 000c FFF7FEFF 		bl	memset
 4534              	.LVL460:
1601:bluetooth_rxtx.c **** }
 4535              		.loc 1 1601 0
 4536 0010 4FF0FF33 		mov	r3, #-1
 4537 0014 C4F80031 		str	r3, [r4, #256]
 4538 0018 10BD     		pop	{r4, pc}
 4539              	.L524:
 4540 001a 00BF     		.align	2
 4541              	.L523:
 4542 001c 00000000 		.word	le_promisc
 4543              		.cfi_endproc
 4544              	.LFE21:
 4546              		.section	.text.bt_generic_le,"ax",%progbits
 4547              		.align	1
 4548              		.global	bt_generic_le
 4549              		.thumb
 4550              		.thumb_func
 4552              	bt_generic_le:
 4553              	.LFB22:
1606:bluetooth_rxtx.c **** 	u8 hold;
 4554              		.loc 1 1606 0
 4555              		.cfi_startproc
 4556              		@ args = 0, pretend = 0, frame = 0
 4557              		@ frame_needed = 0, uses_anonymous_args = 0
 4558              	.LVL461:
 4559 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
ARM GAS  /tmp/ccwLngFB.s 			page 137


 4560              		.cfi_def_cfa_offset 32
 4561              		.cfi_offset 3, -32
 4562              		.cfi_offset 4, -28
 4563              		.cfi_offset 5, -24
 4564              		.cfi_offset 6, -20
 4565              		.cfi_offset 7, -16
 4566              		.cfi_offset 8, -12
 4567              		.cfi_offset 9, -8
 4568              		.cfi_offset 14, -4
1611:bluetooth_rxtx.c **** 	mode = active_mode;
 4569              		.loc 1 1611 0
 4570 0004 694C     		ldr	r4, .L570
 4571 0006 0123     		movs	r3, #1
1606:bluetooth_rxtx.c **** 	u8 hold;
 4572              		.loc 1 1606 0
 4573 0008 8046     		mov	r8, r0
1611:bluetooth_rxtx.c **** 	mode = active_mode;
 4574              		.loc 1 1611 0
 4575 000a 2370     		strb	r3, [r4]
1612:bluetooth_rxtx.c **** 
 4576              		.loc 1 1612 0
 4577 000c 6074     		strb	r0, [r4, #17]
1614:bluetooth_rxtx.c **** 
 4578              		.loc 1 1614 0
 4579 000e FFF7FEFF 		bl	reset_le
 4580              	.LVL462:
1617:bluetooth_rxtx.c **** 
 4581              		.loc 1 1617 0
 4582 0012 674B     		ldr	r3, .L570+4
 4583 0014 4FF08072 		mov	r2, #16777216
 4584 0018 1A60     		str	r2, [r3]
1619:bluetooth_rxtx.c **** 
 4585              		.loc 1 1619 0
 4586 001a 664B     		ldr	r3, .L570+8
 4587 001c 1022     		movs	r2, #16
 4588 001e 1A60     		str	r2, [r3]
1621:bluetooth_rxtx.c **** 	dio_ssp_init();
 4589              		.loc 1 1621 0
 4590 0020 FFF7FEFF 		bl	queue_init
 4591              	.LVL463:
1622:bluetooth_rxtx.c **** 	dma_init();
 4592              		.loc 1 1622 0
 4593 0024 FFF7FEFF 		bl	dio_ssp_init
 4594              	.LVL464:
1623:bluetooth_rxtx.c **** 	dio_ssp_start();
 4595              		.loc 1 1623 0
 4596 0028 FFF7FEFF 		bl	dma_init
 4597              	.LVL465:
1624:bluetooth_rxtx.c **** 	cc2400_rx();
 4598              		.loc 1 1624 0
 4599 002c FFF7FEFF 		bl	dio_ssp_start
 4600              	.LVL466:
1625:bluetooth_rxtx.c **** 
 4601              		.loc 1 1625 0
 4602 0030 FFF7FEFF 		bl	cc2400_rx
 4603              	.LVL467:
1627:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 138


 4604              		.loc 1 1627 0
 4605 0034 FFF7FEFF 		bl	cs_trigger_enable
 4606              	.LVL468:
1629:bluetooth_rxtx.c **** 
 4607              		.loc 1 1629 0
 4608 0038 0025     		movs	r5, #0
 4609              	.LVL469:
 4610              	.L526:
1631:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4611              		.loc 1 1631 0 discriminator 1
 4612 003a A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4613 003c 4345     		cmp	r3, r8
 4614 003e 40F0A380 		bne	.L550
 4615              	.LBB40:
1632:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4616              		.loc 1 1632 0
 4617 0042 5A4B     		ldr	r3, .L570
 4618 0044 DB89     		ldrh	r3, [r3, #14]
 4619 0046 9BB2     		uxth	r3, r3
 4620 0048 D3B1     		cbz	r3, .L527
1633:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4621              		.loc 1 1633 0
 4622 004a 6420     		movs	r0, #100
 4623 004c FFF7FEFF 		bl	cc2400_strobe
 4624              	.LVL470:
 4625              	.L529:
1634:bluetooth_rxtx.c **** 
 4626              		.loc 1 1634 0 discriminator 1
 4627 0050 FFF7FEFF 		bl	cc2400_status
 4628              	.LVL471:
 4629 0054 4707     		lsls	r7, r0, #29
 4630 0056 FBD4     		bmi	.L529
1637:bluetooth_rxtx.c **** 
 4631              		.loc 1 1637 0
 4632 0058 574B     		ldr	r3, .L570+12
 4633 005a 0220     		movs	r0, #2
 4634 005c 1988     		ldrh	r1, [r3]
 4635 005e 89B2     		uxth	r1, r1
 4636 0060 0139     		subs	r1, r1, #1
 4637 0062 89B2     		uxth	r1, r1
 4638 0064 FFF7FEFF 		bl	cc2400_set
 4639              	.LVL472:
1640:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4640              		.loc 1 1640 0
 4641 0068 6120     		movs	r0, #97
 4642 006a FFF7FEFF 		bl	cc2400_strobe
 4643              	.LVL473:
 4644              	.L531:
1641:bluetooth_rxtx.c **** 
 4645              		.loc 1 1641 0 discriminator 1
 4646 006e FFF7FEFF 		bl	cc2400_status
 4647              	.LVL474:
 4648 0072 4607     		lsls	r6, r0, #29
 4649 0074 FBD5     		bpl	.L531
1644:bluetooth_rxtx.c **** 
 4650              		.loc 1 1644 0
 4651 0076 6220     		movs	r0, #98
ARM GAS  /tmp/ccwLngFB.s 			page 139


 4652 0078 FFF7FEFF 		bl	cc2400_strobe
 4653              	.LVL475:
1646:bluetooth_rxtx.c **** 		}
 4654              		.loc 1 1646 0
 4655 007c 0023     		movs	r3, #0
 4656 007e E381     		strh	r3, [r4, #14]	@ movhi
 4657              	.L527:
1649:bluetooth_rxtx.c **** 			hop();
 4658              		.loc 1 1649 0
 4659 0080 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4660 0082 4C4E     		ldr	r6, .L570+8
 4661 0084 13B1     		cbz	r3, .L532
1650:bluetooth_rxtx.c **** 		} else {
 4662              		.loc 1 1650 0
 4663 0086 FFF7FEFF 		bl	hop
 4664              	.LVL476:
 4665 008a 02E0     		b	.L533
 4666              	.L532:
1652:bluetooth_rxtx.c **** 		}
 4667              		.loc 1 1652 0
 4668 008c 4FF48073 		mov	r3, #256
 4669 0090 3360     		str	r3, [r6]
 4670              	.L533:
1655:bluetooth_rxtx.c **** 
 4671              		.loc 1 1655 0
 4672 0092 1023     		movs	r3, #16
 4673 0094 3360     		str	r3, [r6]
1658:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 4674              		.loc 1 1658 0
 4675 0096 FFF7FEFF 		bl	rssi_reset
 4676              	.LVL477:
1659:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
 4677              		.loc 1 1659 0
 4678 009a 8027     		movs	r7, #128
 4679              	.LVL478:
 4680              	.L534:
1660:bluetooth_rxtx.c **** 		{
 4681              		.loc 1 1660 0 discriminator 1
 4682 009c 474B     		ldr	r3, .L570+16
 4683 009e 484E     		ldr	r6, .L570+20
 4684 00a0 1A68     		ldr	r2, [r3]
 4685 00a2 9946     		mov	r9, r3
 4686 00a4 D2B9     		cbnz	r2, .L536
1660:bluetooth_rxtx.c **** 		{
 4687              		.loc 1 1660 0 is_stmt 0 discriminator 2
 4688 00a6 3368     		ldr	r3, [r6]
 4689 00a8 C3B9     		cbnz	r3, .L536
1662:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4690              		.loc 1 1662 0 is_stmt 1
 4691 00aa 0620     		movs	r0, #6
 4692 00ac FFF7FEFF 		bl	cc2400_get
 4693              	.LVL479:
1663:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4694              		.loc 1 1663 0
 4695 00b0 444B     		ldr	r3, .L570+24
1662:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4696              		.loc 1 1662 0
ARM GAS  /tmp/ccwLngFB.s 			page 140


 4697 00b2 C0F30720 		ubfx	r0, r0, #8, #8
 4698              	.LVL480:
1663:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4699              		.loc 1 1663 0
 4700 00b6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4701 00b8 63B1     		cbz	r3, .L535
1663:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4702              		.loc 1 1663 0 is_stmt 0 discriminator 1
 4703 00ba 7BB2     		sxtb	r3, r7
 4704 00bc 8033     		adds	r3, r3, #128
 4705 00be 09D1     		bne	.L535
1664:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 4706              		.loc 1 1664 0 is_stmt 1
 4707 00c0 414B     		ldr	r3, .L570+28
 4708 00c2 40B2     		sxtb	r0, r0
 4709              	.LVL481:
 4710 00c4 93F90070 		ldrsb	r7, [r3]
 4711              	.LVL482:
 4712 00c8 3637     		adds	r7, r7, #54
 4713 00ca B842     		cmp	r0, r7
 4714 00cc A8BF     		it	ge
 4715 00ce 0746     		movge	r7, r0
 4716 00d0 FFB2     		uxtb	r7, r7
1665:bluetooth_rxtx.c **** 			}
 4717              		.loc 1 1665 0
 4718 00d2 3846     		mov	r0, r7
 4719              	.L535:
 4720              	.LVL483:
1667:bluetooth_rxtx.c **** 		}
 4721              		.loc 1 1667 0
 4722 00d4 40B2     		sxtb	r0, r0
 4723              	.LVL484:
 4724 00d6 FFF7FEFF 		bl	rssi_add
 4725              	.LVL485:
 4726 00da DFE7     		b	.L534
 4727              	.L536:
1670:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4728              		.loc 1 1670 0
 4729 00dc 3368     		ldr	r3, [r6]
 4730 00de 1BB1     		cbz	r3, .L538
1671:bluetooth_rxtx.c **** 		}
 4731              		.loc 1 1671 0
 4732 00e0 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4733 00e2 43F00203 		orr	r3, r3, #2
 4734 00e6 6370     		strb	r3, [r4, #1]
 4735              	.L538:
1675:bluetooth_rxtx.c **** 			goto rx_continue;
 4736              		.loc 1 1675 0
 4737 00e8 D9F80030 		ldr	r3, [r9]
 4738 00ec 002B     		cmp	r3, #0
 4739 00ee 57D0     		beq	.L539
1679:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 4740              		.loc 1 1679 0
 4741 00f0 324B     		ldr	r3, .L570+16
 4742 00f2 1B68     		ldr	r3, [r3]
 4743 00f4 012B     		cmp	r3, #1
 4744 00f6 03D9     		bls	.L540
ARM GAS  /tmp/ccwLngFB.s 			page 141


1680:bluetooth_rxtx.c **** 
 4745              		.loc 1 1680 0
 4746 00f8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4747 00fa 43F00103 		orr	r3, r3, #1
 4748 00fe 6370     		strb	r3, [r4, #1]
 4749              	.L540:
1682:bluetooth_rxtx.c **** 
 4750              		.loc 1 1682 0
 4751 0100 2D4B     		ldr	r3, .L570+12
 4752 0102 1888     		ldrh	r0, [r3]
 4753 0104 80B2     		uxth	r0, r0
 4754 0106 FFF7FEFF 		bl	rssi_iir_update
 4755              	.LVL486:
1688:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4756              		.loc 1 1688 0
 4757 010a 2E4B     		ldr	r3, .L570+24
 4758 010c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 4759 010e 12B9     		cbnz	r2, .L541
1688:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4760              		.loc 1 1688 0 is_stmt 0 discriminator 1
 4761 0110 2E4A     		ldr	r2, .L570+32
 4762 0112 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 4763 0114 32B1     		cbz	r2, .L542
 4764              	.L541:
1689:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4765              		.loc 1 1689 0 is_stmt 1
 4766 0116 6278     		ldrb	r2, [r4, #1]	@ zero_extendqisi2
1690:bluetooth_rxtx.c **** 			cs_trigger = 0;
 4767              		.loc 1 1690 0
 4768 0118 0225     		movs	r5, #2
 4769              	.LVL487:
1689:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4770              		.loc 1 1689 0
 4771 011a 42F00802 		orr	r2, r2, #8
 4772 011e 6270     		strb	r2, [r4, #1]
 4773              	.LVL488:
1691:bluetooth_rxtx.c **** 		}
 4774              		.loc 1 1691 0
 4775 0120 0022     		movs	r2, #0
 4776 0122 1A70     		strb	r2, [r3]
 4777              	.LVL489:
 4778              	.L542:
1694:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 4779              		.loc 1 1694 0
 4780 0124 284B     		ldr	r3, .L570+28
 4781 0126 93F90020 		ldrsb	r2, [r3]
 4782 012a 294B     		ldr	r3, .L570+36
 4783 012c 3532     		adds	r2, r2, #53
 4784 012e 93F90030 		ldrsb	r3, [r3]
 4785 0132 9A42     		cmp	r2, r3
 4786 0134 05DA     		bge	.L543
1695:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4787              		.loc 1 1695 0
 4788 0136 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
1696:bluetooth_rxtx.c **** 		}
 4789              		.loc 1 1696 0
 4790 0138 0225     		movs	r5, #2
ARM GAS  /tmp/ccwLngFB.s 			page 142


 4791              	.LVL490:
1695:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4792              		.loc 1 1695 0
 4793 013a 43F01003 		orr	r3, r3, #16
 4794 013e 6370     		strb	r3, [r4, #1]
 4795              	.LVL491:
 4796 0140 00E0     		b	.L544
 4797              	.LVL492:
 4798              	.L543:
1700:bluetooth_rxtx.c **** 			goto rx_continue;
 4799              		.loc 1 1700 0
 4800 0142 6DB3     		cbz	r5, .L539
 4801              	.LVL493:
 4802              	.L544:
1706:bluetooth_rxtx.c **** 
 4803              		.loc 1 1706 0
 4804 0144 2348     		ldr	r0, .L570+40
1703:bluetooth_rxtx.c **** 
 4805              		.loc 1 1703 0
 4806 0146 013D     		subs	r5, r5, #1
 4807              	.LVL494:
1706:bluetooth_rxtx.c **** 
 4808              		.loc 1 1706 0
 4809 0148 00F5C871 		add	r1, r0, #400
 4810 014c 4FF4C872 		mov	r2, #400
 4811 0150 FFF7FEFF 		bl	memcpy
 4812              	.LVL495:
1703:bluetooth_rxtx.c **** 
 4813              		.loc 1 1703 0
 4814 0154 EDB2     		uxtb	r5, r5
 4815              	.LVL496:
1709:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4816              		.loc 1 1709 0
 4817 0156 0023     		movs	r3, #0
 4818              	.LVL497:
 4819              	.L545:
 4820 0158 1F48     		ldr	r0, .L570+44
1696:bluetooth_rxtx.c **** 		}
 4821              		.loc 1 1696 0 discriminator 1
 4822 015a 0022     		movs	r2, #0
 4823 015c 00EBC300 		add	r0, r0, r3, lsl #3
 4824              	.LVL498:
 4825              	.L548:
1712:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4826              		.loc 1 1712 0 discriminator 2
 4827 0160 1E49     		ldr	r1, .L570+48
 4828 0162 0F68     		ldr	r7, [r1]
 4829 0164 FF5C     		ldrb	r7, [r7, r3]	@ zero_extendqisi2
1713:bluetooth_rxtx.c **** 			}
 4830              		.loc 1 1713 0 discriminator 2
 4831 0166 0968     		ldr	r1, [r1]
1712:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4832              		.loc 1 1712 0 discriminator 2
 4833 0168 FF09     		lsrs	r7, r7, #7
 4834 016a 8754     		strb	r7, [r0, r2]
1713:bluetooth_rxtx.c **** 			}
 4835              		.loc 1 1713 0 discriminator 2
ARM GAS  /tmp/ccwLngFB.s 			page 143


 4836 016c CF5C     		ldrb	r7, [r1, r3]	@ zero_extendqisi2
1711:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4837              		.loc 1 1711 0 discriminator 2
 4838 016e 0132     		adds	r2, r2, #1
 4839              	.LVL499:
1713:bluetooth_rxtx.c **** 			}
 4840              		.loc 1 1713 0 discriminator 2
 4841 0170 7F00     		lsls	r7, r7, #1
 4842 0172 FFB2     		uxtb	r7, r7
1711:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4843              		.loc 1 1711 0 discriminator 2
 4844 0174 082A     		cmp	r2, #8
1713:bluetooth_rxtx.c **** 			}
 4845              		.loc 1 1713 0 discriminator 2
 4846 0176 CF54     		strb	r7, [r1, r3]
1711:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4847              		.loc 1 1711 0 discriminator 2
 4848 0178 F2D1     		bne	.L548
1709:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4849              		.loc 1 1709 0
 4850 017a 0133     		adds	r3, r3, #1
 4851              	.LVL500:
 4852 017c 322B     		cmp	r3, #50
 4853 017e EBD1     		bne	.L545
1717:bluetooth_rxtx.c **** 		if (!ret) break;
 4854              		.loc 1 1717 0
 4855 0180 E36A     		ldr	r3, [r4, #44]
 4856              	.LVL501:
 4857 0182 1448     		ldr	r0, .L570+40
 4858 0184 9847     		blx	r3
 4859              	.LVL502:
1718:bluetooth_rxtx.c **** 
 4860              		.loc 1 1718 0
 4861 0186 58B9     		cbnz	r0, .L539
 4862              	.LVL503:
 4863              	.L550:
 4864              	.LBE40:
1726:bluetooth_rxtx.c **** 
 4865              		.loc 1 1726 0
 4866 0188 154B     		ldr	r3, .L570+52
 4867 018a 4FF08072 		mov	r2, #16777216
 4868 018e 1A60     		str	r2, [r3]
1729:bluetooth_rxtx.c **** 	dio_ssp_stop();
 4869              		.loc 1 1729 0
 4870 0190 FFF7FEFF 		bl	cc2400_idle
 4871              	.LVL504:
1730:bluetooth_rxtx.c **** 	cs_trigger_disable();
 4872              		.loc 1 1730 0
 4873 0194 FFF7FEFF 		bl	dio_ssp_stop
 4874              	.LVL505:
1732:bluetooth_rxtx.c **** 
 4875              		.loc 1 1732 0
 4876 0198 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1731:bluetooth_rxtx.c **** }
 4877              		.loc 1 1731 0
 4878 019c FFF7FEBF 		b	cs_trigger_disable
 4879              	.LVL506:
ARM GAS  /tmp/ccwLngFB.s 			page 144


 4880              	.L539:
 4881              	.LBB41:
1721:bluetooth_rxtx.c **** 		rx_err = 0;
 4882              		.loc 1 1721 0
 4883 01a0 0023     		movs	r3, #0
 4884 01a2 C9F80030 		str	r3, [r9]
1722:bluetooth_rxtx.c **** 	}
 4885              		.loc 1 1722 0
 4886 01a6 3360     		str	r3, [r6]
 4887 01a8 47E7     		b	.L526
 4888              	.L571:
 4889 01aa 00BF     		.align	2
 4890              	.L570:
 4891 01ac 00000000 		.word	.LANCHOR0
 4892 01b0 00E100E0 		.word	-536813312
 4893 01b4 3CC00920 		.word	537509948
 4894 01b8 00000000 		.word	.LANCHOR1
 4895 01bc 00000000 		.word	rx_tc
 4896 01c0 00000000 		.word	rx_err
 4897 01c4 00000000 		.word	cs_trigger
 4898 01c8 00000000 		.word	cs_threshold_cur
 4899 01cc 00000000 		.word	cs_no_squelch
 4900 01d0 00000000 		.word	rssi_max
 4901 01d4 00000000 		.word	unpacked
 4902 01d8 90010000 		.word	unpacked+400
 4903 01dc 00000000 		.word	idle_rxbuf
 4904 01e0 80E100E0 		.word	-536813184
 4905              	.LBE41:
 4906              		.cfi_endproc
 4907              	.LFE22:
 4909              		.section	.text.bt_le_sync,"ax",%progbits
 4910              		.align	1
 4911              		.global	bt_le_sync
 4912              		.thumb
 4913              		.thumb_func
 4915              	bt_le_sync:
 4916              	.LFB23:
1736:bluetooth_rxtx.c **** 	int i;
 4917              		.loc 1 1736 0
 4918              		.cfi_startproc
 4919              		@ args = 0, pretend = 0, frame = 64
 4920              		@ frame_needed = 0, uses_anonymous_args = 0
 4921              	.LVL507:
 4922 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4923              		.cfi_def_cfa_offset 36
 4924              		.cfi_offset 4, -36
 4925              		.cfi_offset 5, -32
 4926              		.cfi_offset 6, -28
 4927              		.cfi_offset 7, -24
 4928              		.cfi_offset 8, -20
 4929              		.cfi_offset 9, -16
 4930              		.cfi_offset 10, -12
 4931              		.cfi_offset 11, -8
 4932              		.cfi_offset 14, -4
 4933 0004 91B0     		sub	sp, sp, #68
 4934              		.cfi_def_cfa_offset 104
1742:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 1000 * 10000 / 3125; // millis -> clkn ticks
ARM GAS  /tmp/ccwLngFB.s 			page 145


 4935              		.loc 1 1742 0
 4936 0006 9E4F     		ldr	r7, .L634
1751:bluetooth_rxtx.c **** 	mode = active_mode;
 4937              		.loc 1 1751 0
 4938 0008 9E4D     		ldr	r5, .L634+4
1742:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 1000 * 10000 / 3125; // millis -> clkn ticks
 4939              		.loc 1 1742 0
 4940 000a 3B68     		ldr	r3, [r7]
 4941              	.LVL508:
1754:bluetooth_rxtx.c **** 
 4942              		.loc 1 1754 0
 4943 000c 9E4C     		ldr	r4, .L634+8
1742:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 1000 * 10000 / 3125; // millis -> clkn ticks
 4944              		.loc 1 1742 0
 4945 000e 23F07F4A 		bic	r10, r3, #-16777216
 4946              	.LVL509:
1751:bluetooth_rxtx.c **** 	mode = active_mode;
 4947              		.loc 1 1751 0
 4948 0012 0123     		movs	r3, #1
 4949 0014 2B70     		strb	r3, [r5]
1754:bluetooth_rxtx.c **** 
 4950              		.loc 1 1754 0
 4951 0016 2376     		strb	r3, [r4, #24]
1757:bluetooth_rxtx.c **** 
 4952              		.loc 1 1757 0
 4953 0018 9C4B     		ldr	r3, .L634+12
 4954 001a 4FF08072 		mov	r2, #16777216
1752:bluetooth_rxtx.c **** 
 4955              		.loc 1 1752 0
 4956 001e 6874     		strb	r0, [r5, #17]
1757:bluetooth_rxtx.c **** 
 4957              		.loc 1 1757 0
 4958 0020 1A60     		str	r2, [r3]
1759:bluetooth_rxtx.c **** 
 4959              		.loc 1 1759 0
 4960 0022 9B4B     		ldr	r3, .L634+16
 4961 0024 1022     		movs	r2, #16
 4962 0026 1A60     		str	r2, [r3]
1736:bluetooth_rxtx.c **** 	int i;
 4963              		.loc 1 1736 0
 4964 0028 0646     		mov	r6, r0
1761:bluetooth_rxtx.c **** 	dio_ssp_init();
 4965              		.loc 1 1761 0
 4966 002a FFF7FEFF 		bl	queue_init
 4967              	.LVL510:
1762:bluetooth_rxtx.c **** 	dma_init_le();
 4968              		.loc 1 1762 0
 4969 002e FFF7FEFF 		bl	dio_ssp_init
 4970              	.LVL511:
1763:bluetooth_rxtx.c **** 	dio_ssp_start();
 4971              		.loc 1 1763 0
 4972 0032 FFF7FEFF 		bl	dma_init_le
 4973              	.LVL512:
1764:bluetooth_rxtx.c **** 
 4974              		.loc 1 1764 0
 4975 0036 FFF7FEFF 		bl	dio_ssp_start
 4976              	.LVL513:
ARM GAS  /tmp/ccwLngFB.s 			page 146


1766:bluetooth_rxtx.c **** 
 4977              		.loc 1 1766 0
 4978 003a 6068     		ldr	r0, [r4, #4]
1743:bluetooth_rxtx.c **** 	int overflow = 0;
 4979              		.loc 1 1743 0
 4980 003c 0AF5486A 		add	r10, r10, #3200
 4981              	.LVL514:
1766:bluetooth_rxtx.c **** 
 4982              		.loc 1 1766 0
 4983 0040 FFF7FEFF 		bl	rbit
 4984              	.LVL515:
 4985 0044 FFF7FEFF 		bl	cc2400_rx_sync
 4986              	.LVL516:
 4987              	.L573:
1768:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4988              		.loc 1 1768 0 discriminator 1
 4989 0048 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 4990 004a B342     		cmp	r3, r6
 4991 004c 40F0BA81 		bne	.L612
 4992              	.LBB42:
1769:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4993              		.loc 1 1769 0
 4994 0050 8C4B     		ldr	r3, .L634+4
 4995 0052 DB89     		ldrh	r3, [r3, #14]
 4996 0054 9BB2     		uxth	r3, r3
 4997 0056 CBB1     		cbz	r3, .L574
1770:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4998              		.loc 1 1770 0
 4999 0058 6420     		movs	r0, #100
 5000 005a FFF7FEFF 		bl	cc2400_strobe
 5001              	.LVL517:
 5002              	.L576:
1771:bluetooth_rxtx.c **** 
 5003              		.loc 1 1771 0 discriminator 1
 5004 005e FFF7FEFF 		bl	cc2400_status
 5005              	.LVL518:
 5006 0062 4207     		lsls	r2, r0, #29
 5007 0064 FBD4     		bmi	.L576
1774:bluetooth_rxtx.c **** 
 5008              		.loc 1 1774 0
 5009 0066 2188     		ldrh	r1, [r4]
 5010 0068 0220     		movs	r0, #2
 5011 006a 89B2     		uxth	r1, r1
 5012 006c 0139     		subs	r1, r1, #1
 5013 006e 89B2     		uxth	r1, r1
 5014 0070 FFF7FEFF 		bl	cc2400_set
 5015              	.LVL519:
1777:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 5016              		.loc 1 1777 0
 5017 0074 6120     		movs	r0, #97
 5018 0076 FFF7FEFF 		bl	cc2400_strobe
 5019              	.LVL520:
 5020              	.L578:
1778:bluetooth_rxtx.c **** 
 5021              		.loc 1 1778 0 discriminator 1
 5022 007a FFF7FEFF 		bl	cc2400_status
 5023              	.LVL521:
ARM GAS  /tmp/ccwLngFB.s 			page 147


 5024 007e 4307     		lsls	r3, r0, #29
 5025 0080 FBD5     		bpl	.L578
1781:bluetooth_rxtx.c **** 
 5026              		.loc 1 1781 0
 5027 0082 6220     		movs	r0, #98
 5028 0084 FFF7FEFF 		bl	cc2400_strobe
 5029              	.LVL522:
1783:bluetooth_rxtx.c **** 		}
 5030              		.loc 1 1783 0
 5031 0088 0023     		movs	r3, #0
 5032 008a EB81     		strh	r3, [r5, #14]	@ movhi
 5033              	.L574:
1786:bluetooth_rxtx.c **** 
 5034              		.loc 1 1786 0
 5035 008c 804B     		ldr	r3, .L634+16
 5036 008e 1022     		movs	r2, #16
 5037 0090 1A60     		str	r2, [r3]
1789:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)	;
 5038              		.loc 1 1789 0
 5039 0092 FFF7FEFF 		bl	rssi_reset
 5040              	.LVL523:
 5041              	.L580:
1790:bluetooth_rxtx.c **** 
 5042              		.loc 1 1790 0 discriminator 1
 5043 0096 7F4B     		ldr	r3, .L634+20
 5044 0098 1A68     		ldr	r2, [r3]
 5045 009a 9846     		mov	r8, r3
 5046 009c 42B9     		cbnz	r2, .L579
1790:bluetooth_rxtx.c **** 
 5047              		.loc 1 1790 0 is_stmt 0 discriminator 2
 5048 009e 7E4B     		ldr	r3, .L634+24
 5049 00a0 1B68     		ldr	r3, [r3]
 5050 00a2 2BB9     		cbnz	r3, .L579
1790:bluetooth_rxtx.c **** 
 5051              		.loc 1 1790 0 discriminator 1
 5052 00a4 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5053 00a6 1BB9     		cbnz	r3, .L579
 5054 00a8 764B     		ldr	r3, .L634+4
 5055 00aa 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 5056 00ac B342     		cmp	r3, r6
 5057 00ae F2D0     		beq	.L580
 5058              	.L579:
1792:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5059              		.loc 1 1792 0 is_stmt 1
 5060 00b0 0620     		movs	r0, #6
 5061 00b2 FFF7FEFF 		bl	cc2400_get
 5062              	.LVL524:
1793:bluetooth_rxtx.c **** 
 5063              		.loc 1 1793 0
 5064 00b6 794B     		ldr	r3, .L634+28
1792:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5065              		.loc 1 1792 0
 5066 00b8 C0F30720 		ubfx	r0, r0, #8, #8
 5067              	.LVL525:
1795:bluetooth_rxtx.c **** 			goto cleanup;
 5068              		.loc 1 1795 0
 5069 00bc AA7C     		ldrb	r2, [r5, #18]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 148


1793:bluetooth_rxtx.c **** 
 5070              		.loc 1 1793 0
 5071 00be 1870     		strb	r0, [r3]
 5072 00c0 774B     		ldr	r3, .L634+32
1795:bluetooth_rxtx.c **** 			goto cleanup;
 5073              		.loc 1 1795 0
 5074 00c2 B242     		cmp	r2, r6
1793:bluetooth_rxtx.c **** 
 5075              		.loc 1 1793 0
 5076 00c4 1870     		strb	r0, [r3]
1795:bluetooth_rxtx.c **** 			goto cleanup;
 5077              		.loc 1 1795 0
 5078 00c6 6F4B     		ldr	r3, .L634+4
 5079 00c8 40F07C81 		bne	.L612
1799:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 5080              		.loc 1 1799 0
 5081 00cc 724A     		ldr	r2, .L634+24
 5082 00ce 1168     		ldr	r1, [r2]
 5083 00d0 9346     		mov	fp, r2
 5084 00d2 19B1     		cbz	r1, .L582
1800:bluetooth_rxtx.c **** 		}
 5085              		.loc 1 1800 0
 5086 00d4 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 5087 00d6 42F00202 		orr	r2, r2, #2
 5088 00da 5A70     		strb	r2, [r3, #1]
 5089              	.L582:
1803:bluetooth_rxtx.c **** 			goto rx_flush;
 5090              		.loc 1 1803 0
 5091 00dc EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5092 00de 03F0FF01 		and	r1, r3, #255
 5093 00e2 43B1     		cbz	r3, .L583
 5094              	.LVL526:
 5095              	.L587:
 5096              	.LDL1:
1885:bluetooth_rxtx.c **** 
 5097              		.loc 1 1885 0
 5098 00e4 6120     		movs	r0, #97
 5099 00e6 FFF7FEFF 		bl	cc2400_strobe
 5100              	.LVL527:
1888:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5101              		.loc 1 1888 0
 5102 00ea 6E4B     		ldr	r3, .L634+36
 5103 00ec 1A68     		ldr	r2, [r3]
 5104 00ee 22F00102 		bic	r2, r2, #1
 5105 00f2 1A60     		str	r2, [r3]
1889:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5106              		.loc 1 1889 0
 5107 00f4 BCE0     		b	.L584
 5108              	.LVL528:
 5109              	.L583:
1807:bluetooth_rxtx.c **** 			continue;
 5110              		.loc 1 1807 0
 5111 00f6 D8F80030 		ldr	r3, [r8]
 5112 00fa 002B     		cmp	r3, #0
 5113 00fc A4D0     		beq	.L573
1813:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
 5114              		.loc 1 1813 0
ARM GAS  /tmp/ccwLngFB.s 			page 149


 5115 00fe 3422     		movs	r2, #52
 5116 0100 03A8     		add	r0, sp, #12
 5117              	.LVL529:
 5118 0102 FFF7FEFF 		bl	memset
 5119              	.LVL530:
1817:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5120              		.loc 1 1817 0
 5121 0106 2088     		ldrh	r0, [r4]
1815:bluetooth_rxtx.c **** 
 5122              		.loc 1 1815 0
 5123 0108 6368     		ldr	r3, [r4, #4]
1817:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5124              		.loc 1 1817 0
 5125 010a 80B2     		uxth	r0, r0
 5126 010c 6238     		subs	r0, r0, #98
 5127 010e C0B2     		uxtb	r0, r0
1815:bluetooth_rxtx.c **** 
 5128              		.loc 1 1815 0
 5129 0110 0393     		str	r3, [sp, #12]
1817:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5130              		.loc 1 1817 0
 5131 0112 FFF7FEFF 		bl	btle_channel_index
 5132              	.LVL531:
 5133 0116 4FF03008 		mov	r8, #48
 5134 011a 08FB00F8 		mul	r8, r8, r0
 5135 011e DFF8A891 		ldr	r9, .L634+72
 5136 0122 09EB0803 		add	r3, r9, r8
 5137 0126 0193     		str	r3, [sp, #4]
 5138              	.LVL532:
 5139              	.LBB43:
1819:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5140              		.loc 1 1819 0
 5141 0128 5F4B     		ldr	r3, .L634+40
 5142              	.LVL533:
 5143 012a 93F800E0 		ldrb	lr, [r3]	@ zero_extendqisi2
1820:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5144              		.loc 1 1820 0
 5145 012e 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
1821:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5146              		.loc 1 1821 0
 5147 0130 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
1820:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5148              		.loc 1 1820 0
 5149 0132 1204     		lsls	r2, r2, #16
1822:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5150              		.loc 1 1822 0
 5151 0134 D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 5152              	.LVL534:
1820:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5153              		.loc 1 1820 0
 5154 0136 42EA0E62 		orr	r2, r2, lr, lsl #24
1821:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5155              		.loc 1 1821 0
 5156 013a 0A43     		orrs	r2, r2, r1
1823:bluetooth_rxtx.c **** 		}
 5157              		.loc 1 1823 0
 5158 013c 42EA0020 		orr	r0, r2, r0, lsl #8
ARM GAS  /tmp/ccwLngFB.s 			page 150


 5159 0140 0093     		str	r3, [sp]
 5160 0142 FFF7FEFF 		bl	rbit
 5161              	.LVL535:
 5162 0146 59F80820 		ldr	r2, [r9, r8]
 5163              	.LBE43:
1827:bluetooth_rxtx.c **** 			goto rx_flush;
 5164              		.loc 1 1827 0
 5165 014a 009B     		ldr	r3, [sp]
 5166              	.LBB44:
1823:bluetooth_rxtx.c **** 		}
 5167              		.loc 1 1823 0
 5168 014c 5040     		eors	r0, r0, r2
 5169              	.LBE44:
1826:bluetooth_rxtx.c **** 		if (len > 39)
 5170              		.loc 1 1826 0
 5171 014e C0F30529 		ubfx	r9, r0, #8, #6
 5172 0152 09F10208 		add	r8, r9, #2
1827:bluetooth_rxtx.c **** 			goto rx_flush;
 5173              		.loc 1 1827 0
 5174 0156 B8F1270F 		cmp	r8, #39
 5175              	.LBB45:
1823:bluetooth_rxtx.c **** 		}
 5176              		.loc 1 1823 0
 5177 015a 0490     		str	r0, [sp, #16]
 5178              	.LVL536:
 5179              	.LBE45:
1827:bluetooth_rxtx.c **** 			goto rx_flush;
 5180              		.loc 1 1827 0
 5181 015c C2D8     		bhi	.L587
1832:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 5182              		.loc 1 1832 0
 5183 015e 09F10809 		add	r9, r9, #8
 5184 0162 4FEA9902 		lsr	r2, r9, #2
 5185              	.LVL537:
1833:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
 5186              		.loc 1 1833 0
 5187 0166 0B2A     		cmp	r2, #11
 5188 0168 0DD0     		beq	.L591
1834:bluetooth_rxtx.c **** 				;
 5189              		.loc 1 1834 0
 5190 016a 03EB8203 		add	r3, r3, r2, lsl #2
 5191              	.LVL538:
 5192              	.L590:
 5193 016e 4F4A     		ldr	r2, .L634+44
 5194 0170 1268     		ldr	r2, [r2]
 5195 0172 9A42     		cmp	r2, r3
 5196 0174 0BD2     		bcs	.L589
1834:bluetooth_rxtx.c **** 				;
 5197              		.loc 1 1834 0 is_stmt 0 discriminator 2
 5198 0176 DBF80010 		ldr	r1, [fp]
 5199 017a 0029     		cmp	r1, #0
 5200 017c F7D0     		beq	.L590
 5201 017e 06E0     		b	.L589
 5202              	.LVL539:
 5203              	.L632:
1837:bluetooth_rxtx.c **** 				;
 5204              		.loc 1 1837 0 is_stmt 1 discriminator 2
ARM GAS  /tmp/ccwLngFB.s 			page 151


 5205 0180 DBF80030 		ldr	r3, [fp]
 5206 0184 1BB9     		cbnz	r3, .L589
 5207              	.L591:
1837:bluetooth_rxtx.c **** 				;
 5208              		.loc 1 1837 0 is_stmt 0
 5209 0186 4A4B     		ldr	r3, .L634+48
 5210 0188 1B68     		ldr	r3, [r3]
 5211 018a D807     		lsls	r0, r3, #31
 5212 018c F8D4     		bmi	.L632
 5213              	.LVL540:
 5214              	.L589:
1840:bluetooth_rxtx.c **** 
 5215              		.loc 1 1840 0 is_stmt 1
 5216 018e 454B     		ldr	r3, .L634+36
1843:bluetooth_rxtx.c **** 
 5217              		.loc 1 1843 0
 5218 0190 6120     		movs	r0, #97
1840:bluetooth_rxtx.c **** 
 5219              		.loc 1 1840 0
 5220 0192 1A68     		ldr	r2, [r3]
1846:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5221              		.loc 1 1846 0
 5222 0194 4FF0040B 		mov	fp, #4
1840:bluetooth_rxtx.c **** 
 5223              		.loc 1 1840 0
 5224 0198 22F00102 		bic	r2, r2, #1
 5225 019c 1A60     		str	r2, [r3]
1843:bluetooth_rxtx.c **** 
 5226              		.loc 1 1843 0
 5227 019e FFF7FEFF 		bl	cc2400_strobe
 5228              	.LVL541:
 5229              	.L593:
 5230              	.LBB46:
1847:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5231              		.loc 1 1847 0 discriminator 2
 5232 01a2 414A     		ldr	r2, .L634+40
 5233 01a4 0BF10100 		add	r0, fp, #1
 5234 01a8 12F80B10 		ldrb	r1, [r2, fp]	@ zero_extendqisi2
 5235 01ac 0BF1030C 		add	ip, fp, #3
1848:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5236              		.loc 1 1848 0 discriminator 2
 5237 01b0 12F800E0 		ldrb	lr, [r2, r0]	@ zero_extendqisi2
 5238 01b4 0BF10200 		add	r0, fp, #2
1849:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5239              		.loc 1 1849 0 discriminator 2
 5240 01b8 105C     		ldrb	r0, [r2, r0]	@ zero_extendqisi2
1850:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5241              		.loc 1 1850 0 discriminator 2
 5242 01ba 12F80CC0 		ldrb	ip, [r2, ip]	@ zero_extendqisi2
 5243              	.LVL542:
1851:bluetooth_rxtx.c **** 		}
 5244              		.loc 1 1851 0 discriminator 2
 5245 01be 4FEAAB02 		asr	r2, fp, #2
1848:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5246              		.loc 1 1848 0 discriminator 2
 5247 01c2 4CEA0161 		orr	r1, ip, r1, lsl #24
 5248              	.LVL543:
ARM GAS  /tmp/ccwLngFB.s 			page 152


1849:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5249              		.loc 1 1849 0 discriminator 2
 5250 01c6 41EA0E41 		orr	r1, r1, lr, lsl #16
1851:bluetooth_rxtx.c **** 		}
 5251              		.loc 1 1851 0 discriminator 2
 5252 01ca 41EA0020 		orr	r0, r1, r0, lsl #8
 5253 01ce 0092     		str	r2, [sp]
 5254 01d0 FFF7FEFF 		bl	rbit
 5255              	.LVL544:
 5256 01d4 009A     		ldr	r2, [sp]
 5257 01d6 10AB     		add	r3, sp, #64
 5258 01d8 03EB8201 		add	r1, r3, r2, lsl #2
 5259 01dc 019B     		ldr	r3, [sp, #4]
 5260              	.LBE46:
1846:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5261              		.loc 1 1846 0 discriminator 2
 5262 01de 0BF1040B 		add	fp, fp, #4
 5263              	.LVL545:
 5264              	.LBB47:
1851:bluetooth_rxtx.c **** 		}
 5265              		.loc 1 1851 0 discriminator 2
 5266 01e2 53F82220 		ldr	r2, [r3, r2, lsl #2]
 5267              	.LBE47:
1846:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5268              		.loc 1 1846 0 discriminator 2
 5269 01e6 BBF12C0F 		cmp	fp, #44
 5270              	.LBB48:
1851:bluetooth_rxtx.c **** 		}
 5271              		.loc 1 1851 0 discriminator 2
 5272 01ea 82EA0000 		eor	r0, r2, r0
 5273 01ee 41F8300C 		str	r0, [r1, #-48]
 5274              	.LBE48:
1846:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5275              		.loc 1 1846 0 discriminator 2
 5276 01f2 D6D1     		bne	.L593
1854:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 5277              		.loc 1 1854 0
 5278 01f4 6369     		ldr	r3, [r4, #20]
 5279 01f6 13BB     		cbnz	r3, .L594
 5280              	.L595:
1864:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5281              		.loc 1 1864 0
 5282 01f8 2E4B     		ldr	r3, .L634+52
 5283 01fa 1022     		movs	r2, #16
 5284 01fc 1A60     		str	r2, [r3]
1865:bluetooth_rxtx.c **** 
 5285              		.loc 1 1865 0
 5286 01fe 03A8     		add	r0, sp, #12
 5287              	.LVL546:
 5288 0200 AB69     		ldr	r3, [r5, #24]
 5289 0202 9847     		blx	r3
 5290              	.LVL547:
1868:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 5291              		.loc 1 1868 0
 5292 0204 2C4B     		ldr	r3, .L634+56
 5293 0206 4FF08078 		mov	r8, #16777216
 5294              	.LVL548:
ARM GAS  /tmp/ccwLngFB.s 			page 153


 5295 020a C3F80080 		str	r8, [r3]
1869:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5296              		.loc 1 1869 0
 5297 020e 03A9     		add	r1, sp, #12
 5298              	.LVL549:
 5299 0210 0120     		movs	r0, #1
 5300 0212 FFF7FEFF 		bl	enqueue
 5301              	.LVL550:
1870:bluetooth_rxtx.c **** 
 5302              		.loc 1 1870 0
 5303 0216 1D4B     		ldr	r3, .L634+12
1872:bluetooth_rxtx.c **** 	
 5304              		.loc 1 1872 0
 5305 0218 284A     		ldr	r2, .L634+60
1870:bluetooth_rxtx.c **** 
 5306              		.loc 1 1870 0
 5307 021a C3F80080 		str	r8, [r3]
1872:bluetooth_rxtx.c **** 	
 5308              		.loc 1 1872 0
 5309 021e 3B68     		ldr	r3, [r7]
 5310 0220 1268     		ldr	r2, [r2]
 5311 0222 C3F31303 		ubfx	r3, r3, #0, #20
 5312 0226 40F63541 		movw	r1, #3125
 5313 022a 01FB0323 		mla	r3, r1, r3, r2
 5314 022e 6364     		str	r3, [r4, #68]
1876:bluetooth_rxtx.c **** 				goto cleanup;
 5315              		.loc 1 1876 0
 5316 0230 3B68     		ldr	r3, [r7]
 5317 0232 23F07F43 		bic	r3, r3, #-16777216
 5318 0236 5345     		cmp	r3, r10
 5319 0238 7FF654AF 		bls	.L587
 5320 023c C2E0     		b	.L612
 5321              	.LVL551:
 5322              	.L594:
 5323              	.LBB49:
1855:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 5324              		.loc 1 1855 0
 5325 023e 124B     		ldr	r3, .L634+8
 5326 0240 04A9     		add	r1, sp, #16
 5327 0242 1869     		ldr	r0, [r3, #16]
 5328 0244 4246     		mov	r2, r8
 5329 0246 FFF7FEFF 		bl	btle_crcgen_lut
 5330              	.LVL552:
1856:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5331              		.loc 1 1856 0
 5332 024a 10AB     		add	r3, sp, #64
 5333 024c 4B44     		add	r3, r3, r9
 5334 024e 13F8342C 		ldrb	r2, [r3, #-52]	@ zero_extendqisi2
1857:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5335              		.loc 1 1857 0
 5336 0252 10AB     		add	r3, sp, #64
 5337 0254 4344     		add	r3, r3, r8
 5338 0256 13F82F1C 		ldrb	r1, [r3, #-47]	@ zero_extendqisi2
 5339 025a 0902     		lsls	r1, r1, #8
 5340 025c 41EA0241 		orr	r1, r1, r2, lsl #16
1858:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
 5341              		.loc 1 1858 0
ARM GAS  /tmp/ccwLngFB.s 			page 154


 5342 0260 13F8302C 		ldrb	r2, [r3, #-48]	@ zero_extendqisi2
 5343 0264 41EA0203 		orr	r3, r1, r2
1859:bluetooth_rxtx.c **** 				goto rx_flush;
 5344              		.loc 1 1859 0
 5345 0268 9842     		cmp	r0, r3
 5346 026a 7FF43BAF 		bne	.L587
 5347 026e C3E7     		b	.L595
 5348              	.LVL553:
 5349              	.L584:
 5350              	.LBE49:
1889:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5351              		.loc 1 1889 0 discriminator 1
 5352 0270 134B     		ldr	r3, .L634+64
 5353 0272 1B68     		ldr	r3, [r3]
 5354 0274 5907     		lsls	r1, r3, #29
 5355 0276 29D5     		bpl	.L633
 5356              	.LBB50:
1890:bluetooth_rxtx.c **** 		}
 5357              		.loc 1 1890 0
 5358 0278 124B     		ldr	r3, .L634+68
 5359 027a 1B68     		ldr	r3, [r3]
 5360 027c F8E7     		b	.L584
 5361              	.L635:
 5362 027e 00BF     		.align	2
 5363              	.L634:
 5364 0280 00000000 		.word	clkn
 5365 0284 00000000 		.word	.LANCHOR0
 5366 0288 00000000 		.word	.LANCHOR1
 5367 028c 00E100E0 		.word	-536813312
 5368 0290 3CC00920 		.word	537509948
 5369 0294 00000000 		.word	rx_tc
 5370 0298 00000000 		.word	rx_err
 5371 029c 00000000 		.word	rssi_max
 5372 02a0 00000000 		.word	rssi_min
 5373 02a4 24000340 		.word	1073938468
 5374 02a8 00000000 		.word	rxbuf1
 5375 02ac 04410050 		.word	1342193924
 5376 02b0 10410050 		.word	1342193936
 5377 02b4 38C00920 		.word	537509944
 5378 02b8 80E100E0 		.word	-536813184
 5379 02bc 08400040 		.word	1073758216
 5380 02c0 0C000340 		.word	1073938444
 5381 02c4 08000340 		.word	1073938440
 5382 02c8 F0000000 		.word	.LANCHOR2+240
 5383              	.L633:
 5384              	.LBE50:
1894:bluetooth_rxtx.c **** 		if (now < le.last_packet)
 5385              		.loc 1 1894 0
 5386 02cc 444A     		ldr	r2, .L636
 5387 02ce 3B68     		ldr	r3, [r7]
 5388 02d0 1268     		ldr	r2, [r2]
 5389 02d2 40F63541 		movw	r1, #3125
 5390 02d6 C3F31303 		ubfx	r3, r3, #0, #20
 5391 02da 01FB0323 		mla	r3, r1, r3, r2
 5392              	.LVL554:
1895:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5393              		.loc 1 1895 0
ARM GAS  /tmp/ccwLngFB.s 			page 155


 5394 02de 626C     		ldr	r2, [r4, #68]
1898:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5395              		.loc 1 1898 0
 5396 02e0 217E     		ldrb	r1, [r4, #24]	@ zero_extendqisi2
1895:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5397              		.loc 1 1895 0
 5398 02e2 9342     		cmp	r3, r2
1898:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5399              		.loc 1 1898 0
 5400 02e4 A1F10201 		sub	r1, r1, #2
1896:bluetooth_rxtx.c **** 		if  ( // timeout
 5401              		.loc 1 1896 0
 5402 02e8 38BF     		it	cc
 5403 02ea 03F14343 		addcc	r3, r3, #-1023410176
 5404              	.LVL555:
1897:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5405              		.loc 1 1897 0
 5406 02ee C9B2     		uxtb	r1, r1
1896:bluetooth_rxtx.c **** 		if  ( // timeout
 5407              		.loc 1 1896 0
 5408 02f0 38BF     		it	cc
 5409 02f2 03F5A003 		addcc	r3, r3, #5242880
 5410              	.LVL556:
1897:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5411              		.loc 1 1897 0
 5412 02f6 0129     		cmp	r1, #1
 5413 02f8 03D8     		bhi	.L598
1899:bluetooth_rxtx.c **** 			// jam finished
 5414              		.loc 1 1899 0
 5415 02fa 3A49     		ldr	r1, .L636+4
 5416 02fc 9B1A     		subs	r3, r3, r2
 5417              	.LVL557:
 5418 02fe 8B42     		cmp	r3, r1
 5419 0300 02D8     		bhi	.L599
 5420              	.L598:
1901:bluetooth_rxtx.c **** 			)
 5421              		.loc 1 1901 0
 5422 0302 EB69     		ldr	r3, [r5, #28]
 5423 0304 012B     		cmp	r3, #1
 5424 0306 27D1     		bne	.L600
 5425              	.L599:
1904:bluetooth_rxtx.c **** 			le_jam_count = 0;
 5426              		.loc 1 1904 0
 5427 0308 FFF7FEFF 		bl	reset_le
 5428              	.LVL558:
1906:bluetooth_rxtx.c **** 
 5429              		.loc 1 1906 0
 5430 030c 3649     		ldr	r1, .L636+8
1905:bluetooth_rxtx.c **** 			TXLED_CLR;
 5431              		.loc 1 1905 0
 5432 030e 0023     		movs	r3, #0
1906:bluetooth_rxtx.c **** 
 5433              		.loc 1 1906 0
 5434 0310 4FF48070 		mov	r0, #256
1905:bluetooth_rxtx.c **** 			TXLED_CLR;
 5435              		.loc 1 1905 0
 5436 0314 EB61     		str	r3, [r5, #28]
ARM GAS  /tmp/ccwLngFB.s 			page 156


1906:bluetooth_rxtx.c **** 
 5437              		.loc 1 1906 0
 5438 0316 0860     		str	r0, [r1]
1908:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5439              		.loc 1 1908 0
 5440 0318 E97C     		ldrb	r1, [r5, #19]	@ zero_extendqisi2
1905:bluetooth_rxtx.c **** 			TXLED_CLR;
 5441              		.loc 1 1905 0
 5442 031a 344A     		ldr	r2, .L636+12
1908:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5443              		.loc 1 1908 0
 5444 031c 0129     		cmp	r1, #1
 5445 031e 02D1     		bne	.L601
1909:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 5446              		.loc 1 1909 0
 5447 0320 D374     		strb	r3, [r2, #19]
1910:bluetooth_rxtx.c **** 				goto cleanup;
 5448              		.loc 1 1910 0
 5449 0322 9374     		strb	r3, [r2, #18]
1911:bluetooth_rxtx.c **** 			}
 5450              		.loc 1 1911 0
 5451 0324 4EE0     		b	.L612
 5452              	.L601:
1915:bluetooth_rxtx.c **** 				goto cleanup;
 5453              		.loc 1 1915 0
 5454 0326 0A2E     		cmp	r6, #10
 5455 0328 4CD0     		beq	.L612
1918:bluetooth_rxtx.c **** 
 5456              		.loc 1 1918 0
 5457 032a 0123     		movs	r3, #1
1920:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5458              		.loc 1 1920 0
 5459 032c 6420     		movs	r0, #100
1918:bluetooth_rxtx.c **** 
 5460              		.loc 1 1918 0
 5461 032e 2376     		strb	r3, [r4, #24]
1920:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5462              		.loc 1 1920 0
 5463 0330 FFF7FEFF 		bl	cc2400_strobe
 5464              	.LVL559:
 5465              	.L604:
1921:bluetooth_rxtx.c **** 
 5466              		.loc 1 1921 0 discriminator 1
 5467 0334 FFF7FEFF 		bl	cc2400_status
 5468              	.LVL560:
 5469 0338 4207     		lsls	r2, r0, #29
 5470 033a FBD4     		bmi	.L604
1924:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5471              		.loc 1 1924 0
 5472 033c B4F84A30 		ldrh	r3, [r4, #74]
 5473 0340 9BB2     		uxth	r3, r3
 5474 0342 23B1     		cbz	r3, .L614
1924:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5475              		.loc 1 1924 0 is_stmt 0 discriminator 1
 5476 0344 2A4B     		ldr	r3, .L636+16
 5477 0346 B3F84A30 		ldrh	r3, [r3, #74]
 5478 034a 9BB2     		uxth	r3, r3
ARM GAS  /tmp/ccwLngFB.s 			page 157


 5479 034c 01E0     		b	.L605
 5480              	.L614:
1924:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5481              		.loc 1 1924 0
 5482 034e 40F66213 		movw	r3, #2402
 5483              	.L605:
1924:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5484              		.loc 1 1924 0 discriminator 3
 5485 0352 2380     		strh	r3, [r4]	@ movhi
1925:bluetooth_rxtx.c **** 		}
 5486              		.loc 1 1925 0 is_stmt 1 discriminator 3
 5487 0354 0123     		movs	r3, #1
 5488 0356 2B63     		str	r3, [r5, #48]
 5489              	.L600:
1928:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 5490              		.loc 1 1928 0
 5491 0358 2C20     		movs	r0, #44
 5492 035a 6189     		ldrh	r1, [r4, #10]
 5493 035c FFF7FEFF 		bl	cc2400_set
 5494              	.LVL561:
1929:bluetooth_rxtx.c **** 
 5495              		.loc 1 1929 0
 5496 0360 2D20     		movs	r0, #45
 5497 0362 2189     		ldrh	r1, [r4, #8]
 5498 0364 FFF7FEFF 		bl	cc2400_set
 5499              	.LVL562:
1931:bluetooth_rxtx.c **** 			hop();
 5500              		.loc 1 1931 0
 5501 0368 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5502 036a 0BB1     		cbz	r3, .L606
1932:bluetooth_rxtx.c **** 
 5503              		.loc 1 1932 0
 5504 036c FFF7FEFF 		bl	hop
 5505              	.LVL563:
 5506              	.L606:
1935:bluetooth_rxtx.c **** 			le_jam();
 5507              		.loc 1 1935 0
 5508 0370 EB69     		ldr	r3, [r5, #28]
 5509 0372 DFF87880 		ldr	r8, .L636+12
 5510 0376 002B     		cmp	r3, #0
 5511 0378 07DD     		ble	.L607
1936:bluetooth_rxtx.c **** 			--le_jam_count;
 5512              		.loc 1 1936 0
 5513 037a FFF7FEFF 		bl	le_jam
 5514              	.LVL564:
1937:bluetooth_rxtx.c **** 		} else {
 5515              		.loc 1 1937 0
 5516 037e D8F81C30 		ldr	r3, [r8, #28]
 5517 0382 013B     		subs	r3, r3, #1
 5518 0384 C8F81C30 		str	r3, [r8, #28]
 5519 0388 16E0     		b	.L608
 5520              	.L607:
1940:bluetooth_rxtx.c **** 			dio_ssp_start();
 5521              		.loc 1 1940 0
 5522 038a FFF7FEFF 		bl	dma_init_le
 5523              	.LVL565:
1941:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccwLngFB.s 			page 158


 5524              		.loc 1 1941 0
 5525 038e FFF7FEFF 		bl	dio_ssp_start
 5526              	.LVL566:
1943:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 5527              		.loc 1 1943 0
 5528 0392 D8F83030 		ldr	r3, [r8, #48]
 5529 0396 43B1     		cbz	r3, .L611
1944:bluetooth_rxtx.c **** 				restart_jamming = 0;
 5530              		.loc 1 1944 0
 5531 0398 6068     		ldr	r0, [r4, #4]
 5532 039a FFF7FEFF 		bl	rbit
 5533              	.LVL567:
 5534 039e FFF7FEFF 		bl	cc2400_rx_sync
 5535              	.LVL568:
1945:bluetooth_rxtx.c **** 			} else {
 5536              		.loc 1 1945 0
 5537 03a2 0023     		movs	r3, #0
 5538 03a4 C8F83030 		str	r3, [r8, #48]
 5539 03a8 06E0     		b	.L608
 5540              	.L611:
1948:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 5541              		.loc 1 1948 0
 5542 03aa FFF7FEFF 		bl	cc2400_status
 5543              	.LVL569:
 5544 03ae 4307     		lsls	r3, r0, #29
 5545 03b0 FBD5     		bpl	.L611
1949:bluetooth_rxtx.c **** 			}
 5546              		.loc 1 1949 0
 5547 03b2 6220     		movs	r0, #98
 5548 03b4 FFF7FEFF 		bl	cc2400_strobe
 5549              	.LVL570:
 5550              	.L608:
1953:bluetooth_rxtx.c **** 		rx_err = 0;
 5551              		.loc 1 1953 0 discriminator 1
 5552 03b8 0E4A     		ldr	r2, .L636+20
 5553 03ba 0023     		movs	r3, #0
 5554 03bc 1360     		str	r3, [r2]
1954:bluetooth_rxtx.c **** 	}
 5555              		.loc 1 1954 0 discriminator 1
 5556 03be 0E4A     		ldr	r2, .L636+24
 5557 03c0 1360     		str	r3, [r2]
 5558 03c2 41E6     		b	.L573
 5559              	.L612:
 5560              	.LBE42:
1960:bluetooth_rxtx.c **** 
 5561              		.loc 1 1960 0
 5562 03c4 0D4B     		ldr	r3, .L636+28
 5563 03c6 4FF08072 		mov	r2, #16777216
 5564 03ca 1A60     		str	r2, [r3]
1963:bluetooth_rxtx.c **** 	dio_ssp_stop();
 5565              		.loc 1 1963 0
 5566 03cc FFF7FEFF 		bl	cc2400_idle
 5567              	.LVL571:
1964:bluetooth_rxtx.c **** 	cs_trigger_disable();
 5568              		.loc 1 1964 0
 5569 03d0 FFF7FEFF 		bl	dio_ssp_stop
 5570              	.LVL572:
ARM GAS  /tmp/ccwLngFB.s 			page 159


1965:bluetooth_rxtx.c **** }
 5571              		.loc 1 1965 0
 5572 03d4 FFF7FEFF 		bl	cs_trigger_disable
 5573              	.LVL573:
1966:bluetooth_rxtx.c **** 
 5574              		.loc 1 1966 0
 5575 03d8 11B0     		add	sp, sp, #68
 5576              		@ sp needed
 5577 03da BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5578              	.LVL574:
 5579              	.L637:
 5580 03de 00BF     		.align	2
 5581              	.L636:
 5582 03e0 08400040 		.word	1073758216
 5583 03e4 80F0FA02 		.word	50000000
 5584 03e8 3CC00920 		.word	537509948
 5585 03ec 00000000 		.word	.LANCHOR0
 5586 03f0 00000000 		.word	.LANCHOR1
 5587 03f4 00000000 		.word	rx_tc
 5588 03f8 00000000 		.word	rx_err
 5589 03fc 80E100E0 		.word	-536813184
 5590              		.cfi_endproc
 5591              	.LFE23:
 5593              		.section	.text.bt_le_sync_cfo,"ax",%progbits
 5594              		.align	1
 5595              		.global	bt_le_sync_cfo
 5596              		.thumb
 5597              		.thumb_func
 5599              	bt_le_sync_cfo:
 5600              	.LFB24:
1970:bluetooth_rxtx.c **** 	int i;
 5601              		.loc 1 1970 0
 5602              		.cfi_startproc
 5603              		@ args = 0, pretend = 0, frame = 112
 5604              		@ frame_needed = 0, uses_anonymous_args = 0
 5605              	.LVL575:
 5606 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 5607              		.cfi_def_cfa_offset 36
 5608              		.cfi_offset 4, -36
 5609              		.cfi_offset 5, -32
 5610              		.cfi_offset 6, -28
 5611              		.cfi_offset 7, -24
 5612              		.cfi_offset 8, -20
 5613              		.cfi_offset 9, -16
 5614              		.cfi_offset 10, -12
 5615              		.cfi_offset 11, -8
 5616              		.cfi_offset 14, -4
 5617 0004 9DB0     		sub	sp, sp, #116
 5618              		.cfi_def_cfa_offset 152
1974:bluetooth_rxtx.c **** 
 5619              		.loc 1 1974 0
 5620 0006 0021     		movs	r1, #0
1970:bluetooth_rxtx.c **** 	int i;
 5621              		.loc 1 1970 0
 5622 0008 0746     		mov	r7, r0
1974:bluetooth_rxtx.c **** 
 5623              		.loc 1 1974 0
ARM GAS  /tmp/ccwLngFB.s 			page 160


 5624 000a 3222     		movs	r2, #50
1976:bluetooth_rxtx.c **** 	mode = active_mode;
 5625              		.loc 1 1976 0
 5626 000c A84D     		ldr	r5, .L702
1979:bluetooth_rxtx.c **** 
 5627              		.loc 1 1979 0
 5628 000e A94C     		ldr	r4, .L702+4
1974:bluetooth_rxtx.c **** 
 5629              		.loc 1 1974 0
 5630 0010 02A8     		add	r0, sp, #8
 5631              	.LVL576:
 5632 0012 FFF7FEFF 		bl	memset
 5633              	.LVL577:
1976:bluetooth_rxtx.c **** 	mode = active_mode;
 5634              		.loc 1 1976 0
 5635 0016 0123     		movs	r3, #1
 5636 0018 2B70     		strb	r3, [r5]
1979:bluetooth_rxtx.c **** 
 5637              		.loc 1 1979 0
 5638 001a 2376     		strb	r3, [r4, #24]
1981:bluetooth_rxtx.c **** 	RXLED_CLR;
 5639              		.loc 1 1981 0
 5640 001c A64B     		ldr	r3, .L702+8
 5641 001e 4FF08072 		mov	r2, #16777216
1977:bluetooth_rxtx.c **** 
 5642              		.loc 1 1977 0
 5643 0022 6F74     		strb	r7, [r5, #17]
1981:bluetooth_rxtx.c **** 	RXLED_CLR;
 5644              		.loc 1 1981 0
 5645 0024 1A60     		str	r2, [r3]
1982:bluetooth_rxtx.c **** 	queue_init();
 5646              		.loc 1 1982 0
 5647 0026 A54B     		ldr	r3, .L702+12
 5648 0028 1022     		movs	r2, #16
 5649 002a 1A60     		str	r2, [r3]
1983:bluetooth_rxtx.c **** 	dio_ssp_init();
 5650              		.loc 1 1983 0
 5651 002c FFF7FEFF 		bl	queue_init
 5652              	.LVL578:
1984:bluetooth_rxtx.c **** 	dma_init_le();
 5653              		.loc 1 1984 0
 5654 0030 FFF7FEFF 		bl	dio_ssp_init
 5655              	.LVL579:
1985:bluetooth_rxtx.c **** 	dio_ssp_start();
 5656              		.loc 1 1985 0
 5657 0034 FFF7FEFF 		bl	dma_init_le
 5658              	.LVL580:
1986:bluetooth_rxtx.c **** 
 5659              		.loc 1 1986 0
 5660 0038 FFF7FEFF 		bl	dio_ssp_start
 5661              	.LVL581:
1988:bluetooth_rxtx.c **** 
 5662              		.loc 1 1988 0
 5663 003c 6068     		ldr	r0, [r4, #4]
 5664 003e FFF7FEFF 		bl	rbit
 5665              	.LVL582:
 5666 0042 FFF7FEFF 		bl	cc2400_rx_sync
ARM GAS  /tmp/ccwLngFB.s 			page 161


 5667              	.LVL583:
 5668              	.L639:
1990:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 5669              		.loc 1 1990 0 discriminator 1
 5670 0046 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 5671 0048 BB42     		cmp	r3, r7
 5672 004a 40F0CD81 		bne	.L682
 5673              	.LBB51:
1991:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 5674              		.loc 1 1991 0
 5675 004e 984B     		ldr	r3, .L702
 5676 0050 DB89     		ldrh	r3, [r3, #14]
 5677 0052 9BB2     		uxth	r3, r3
 5678 0054 CBB1     		cbz	r3, .L640
1992:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5679              		.loc 1 1992 0
 5680 0056 6420     		movs	r0, #100
 5681 0058 FFF7FEFF 		bl	cc2400_strobe
 5682              	.LVL584:
 5683              	.L642:
1993:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
 5684              		.loc 1 1993 0 discriminator 1
 5685 005c FFF7FEFF 		bl	cc2400_status
 5686              	.LVL585:
 5687 0060 4107     		lsls	r1, r0, #29
 5688 0062 FBD4     		bmi	.L642
1994:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 5689              		.loc 1 1994 0
 5690 0064 2188     		ldrh	r1, [r4]
 5691 0066 0220     		movs	r0, #2
 5692 0068 89B2     		uxth	r1, r1
 5693 006a 0139     		subs	r1, r1, #1
 5694 006c 89B2     		uxth	r1, r1
 5695 006e FFF7FEFF 		bl	cc2400_set
 5696              	.LVL586:
1995:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 5697              		.loc 1 1995 0
 5698 0072 6120     		movs	r0, #97
 5699 0074 FFF7FEFF 		bl	cc2400_strobe
 5700              	.LVL587:
 5701              	.L644:
1996:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 5702              		.loc 1 1996 0 discriminator 1
 5703 0078 FFF7FEFF 		bl	cc2400_status
 5704              	.LVL588:
 5705 007c 4207     		lsls	r2, r0, #29
 5706 007e FBD5     		bpl	.L644
1997:bluetooth_rxtx.c **** 			requested_channel = 0;
 5707              		.loc 1 1997 0
 5708 0080 6220     		movs	r0, #98
 5709 0082 FFF7FEFF 		bl	cc2400_strobe
 5710              	.LVL589:
1998:bluetooth_rxtx.c **** 		}
 5711              		.loc 1 1998 0
 5712 0086 0023     		movs	r3, #0
 5713 0088 EB81     		strh	r3, [r5, #14]	@ movhi
 5714              	.L640:
ARM GAS  /tmp/ccwLngFB.s 			page 162


2000:bluetooth_rxtx.c **** 		rssi_reset();
 5715              		.loc 1 2000 0
 5716 008a 8C4B     		ldr	r3, .L702+12
 5717 008c 1022     		movs	r2, #16
 5718 008e 1A60     		str	r2, [r3]
2001:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode) ;
 5719              		.loc 1 2001 0
 5720 0090 FFF7FEFF 		bl	rssi_reset
 5721              	.LVL590:
 5722              	.L646:
2002:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 5723              		.loc 1 2002 0 discriminator 1
 5724 0094 8A4B     		ldr	r3, .L702+16
 5725 0096 1A68     		ldr	r2, [r3]
 5726 0098 9946     		mov	r9, r3
 5727 009a 42B9     		cbnz	r2, .L645
2002:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 5728              		.loc 1 2002 0 is_stmt 0 discriminator 2
 5729 009c 894B     		ldr	r3, .L702+20
 5730 009e 1B68     		ldr	r3, [r3]
 5731 00a0 2BB9     		cbnz	r3, .L645
2002:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 5732              		.loc 1 2002 0 discriminator 1
 5733 00a2 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5734 00a4 1BB9     		cbnz	r3, .L645
 5735 00a6 824B     		ldr	r3, .L702
 5736 00a8 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 5737 00aa BB42     		cmp	r3, r7
 5738 00ac F2D0     		beq	.L646
 5739              	.L645:
2003:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5740              		.loc 1 2003 0 is_stmt 1
 5741 00ae 0620     		movs	r0, #6
 5742 00b0 FFF7FEFF 		bl	cc2400_get
 5743              	.LVL591:
2004:bluetooth_rxtx.c **** 
 5744              		.loc 1 2004 0
 5745 00b4 844B     		ldr	r3, .L702+24
2003:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5746              		.loc 1 2003 0
 5747 00b6 C0F30720 		ubfx	r0, r0, #8, #8
 5748              	.LVL592:
2006:bluetooth_rxtx.c **** 			goto cleanup;
 5749              		.loc 1 2006 0
 5750 00ba AA7C     		ldrb	r2, [r5, #18]	@ zero_extendqisi2
2004:bluetooth_rxtx.c **** 
 5751              		.loc 1 2004 0
 5752 00bc 1870     		strb	r0, [r3]
 5753 00be 834B     		ldr	r3, .L702+28
2006:bluetooth_rxtx.c **** 			goto cleanup;
 5754              		.loc 1 2006 0
 5755 00c0 BA42     		cmp	r2, r7
2004:bluetooth_rxtx.c **** 
 5756              		.loc 1 2004 0
 5757 00c2 1870     		strb	r0, [r3]
2006:bluetooth_rxtx.c **** 			goto cleanup;
 5758              		.loc 1 2006 0
ARM GAS  /tmp/ccwLngFB.s 			page 163


 5759 00c4 7A4B     		ldr	r3, .L702
 5760 00c6 40F08F81 		bne	.L682
2009:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 5761              		.loc 1 2009 0
 5762 00ca 7E4E     		ldr	r6, .L702+20
 5763 00cc 3268     		ldr	r2, [r6]
 5764 00ce 1AB1     		cbz	r2, .L648
2010:bluetooth_rxtx.c **** 		}
 5765              		.loc 1 2010 0
 5766 00d0 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 5767 00d2 42F00202 		orr	r2, r2, #2
 5768 00d6 5A70     		strb	r2, [r3, #1]
 5769              	.L648:
2012:bluetooth_rxtx.c **** 			goto rx_flush;
 5770              		.loc 1 2012 0
 5771 00d8 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5772 00da 03F0FF08 		and	r8, r3, #255
 5773 00de 002B     		cmp	r3, #0
 5774 00e0 40F0D680 		bne	.L650
2014:bluetooth_rxtx.c **** 			continue;
 5775              		.loc 1 2014 0
 5776 00e4 D9F80030 		ldr	r3, [r9]
 5777 00e8 002B     		cmp	r3, #0
 5778 00ea ACD0     		beq	.L639
2017:bluetooth_rxtx.c **** 		uint32_t whiten_packet[48/4+1] = {0, };
 5779              		.loc 1 2017 0
 5780 00ec 0FA8     		add	r0, sp, #60
 5781              	.LVL593:
 5782 00ee 4146     		mov	r1, r8
 5783 00f0 3422     		movs	r2, #52
 5784 00f2 FFF7FEFF 		bl	memset
 5785              	.LVL594:
 5786              	.L654:
2023:bluetooth_rxtx.c **** 		}
 5787              		.loc 1 2023 0 discriminator 2
 5788 00f6 0720     		movs	r0, #7
 5789 00f8 FFF7FEFF 		bl	cc2400_get_rev
 5790              	.LVL595:
 5791 00fc 02AB     		add	r3, sp, #8
 5792 00fe 03F80800 		strb	r0, [r3, r8]
2022:bluetooth_rxtx.c **** 			cfo_buf[i] = cc2400_get_rev(FREQEST);
 5793              		.loc 1 2022 0 discriminator 2
 5794 0102 08F10108 		add	r8, r8, #1
 5795              	.LVL596:
 5796 0106 B8F1320F 		cmp	r8, #50
 5797 010a F4D1     		bne	.L654
2028:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 5798              		.loc 1 2028 0
 5799 010c 2088     		ldrh	r0, [r4]
2026:bluetooth_rxtx.c **** 		
 5800              		.loc 1 2026 0
 5801 010e 6368     		ldr	r3, [r4, #4]
2028:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 5802              		.loc 1 2028 0
 5803 0110 80B2     		uxth	r0, r0
 5804 0112 6238     		subs	r0, r0, #98
 5805 0114 C0B2     		uxtb	r0, r0
ARM GAS  /tmp/ccwLngFB.s 			page 164


2026:bluetooth_rxtx.c **** 		
 5806              		.loc 1 2026 0
 5807 0116 0F93     		str	r3, [sp, #60]
2028:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 5808              		.loc 1 2028 0
 5809 0118 FFF7FEFF 		bl	btle_channel_index
 5810              	.LVL597:
 5811              	.LBB52:
2030:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5812              		.loc 1 2030 0
 5813 011c DFF8C0B1 		ldr	fp, .L702+48
 5814              	.LBE52:
2028:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 5815              		.loc 1 2028 0
 5816 0120 4FF0300A 		mov	r10, #48
 5817              	.LBB53:
2030:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5818              		.loc 1 2030 0
 5819 0124 9BF800E0 		ldrb	lr, [fp]	@ zero_extendqisi2
2031:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5820              		.loc 1 2031 0
 5821 0128 9BF80180 		ldrb	r8, [fp, #1]	@ zero_extendqisi2
 5822              	.LVL598:
 5823              	.LBE53:
2028:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 5824              		.loc 1 2028 0
 5825 012c 0AFB00FA 		mul	r10, r10, r0
 5826              	.LBB54:
2032:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5827              		.loc 1 2032 0
 5828 0130 9BF80210 		ldrb	r1, [fp, #2]	@ zero_extendqisi2
2031:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5829              		.loc 1 2031 0
 5830 0134 4FEA0848 		lsl	r8, r8, #16
2033:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5831              		.loc 1 2033 0
 5832 0138 9BF80300 		ldrb	r0, [fp, #3]	@ zero_extendqisi2
2031:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5833              		.loc 1 2031 0
 5834 013c 48EA0E68 		orr	r8, r8, lr, lsl #24
 5835              	.LBE54:
2028:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 5836              		.loc 1 2028 0
 5837 0140 634A     		ldr	r2, .L702+32
 5838              	.LBB55:
2032:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5839              		.loc 1 2032 0
 5840 0142 48EA0008 		orr	r8, r8, r0
2033:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5841              		.loc 1 2033 0
 5842 0146 48EA0128 		orr	r8, r8, r1, lsl #8
 5843              	.LBE55:
2028:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 5844              		.loc 1 2028 0
 5845 014a 02EB0A03 		add	r3, r2, r10
 5846              	.LBB56:
2034:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
ARM GAS  /tmp/ccwLngFB.s 			page 165


 5847              		.loc 1 2034 0
 5848 014e 4046     		mov	r0, r8
 5849              	.LBE56:
2028:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 5850              		.loc 1 2028 0
 5851 0150 0193     		str	r3, [sp, #4]
 5852              	.LVL599:
 5853              	.LBB57:
2034:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
 5854              		.loc 1 2034 0
 5855 0152 0092     		str	r2, [sp]
 5856 0154 FFF7FEFF 		bl	rbit
 5857              	.LVL600:
 5858 0158 009A     		ldr	r2, [sp]
 5859 015a 52F80A20 		ldr	r2, [r2, r10]
 5860 015e 5040     		eors	r0, r0, r2
 5861 0160 1090     		str	r0, [sp, #64]
2035:bluetooth_rxtx.c **** 		}
 5862              		.loc 1 2035 0
 5863 0162 4046     		mov	r0, r8
 5864 0164 FFF7FEFF 		bl	rbit
 5865              	.LVL601:
 5866              	.LBE57:
2038:bluetooth_rxtx.c **** 		cfo_buf[DMA_SIZE - 1] = p[5];
 5867              		.loc 1 2038 0
 5868 0168 9DF84120 		ldrb	r2, [sp, #65]	@ zero_extendqisi2
 5869 016c 02F03F0A 		and	r10, r2, #63
 5870 0170 0AF10208 		add	r8, r10, #2
 5871              	.LVL602:
2041:bluetooth_rxtx.c **** 			goto rx_flush;
 5872              		.loc 1 2041 0
 5873 0174 B8F1270F 		cmp	r8, #39
2039:bluetooth_rxtx.c **** 
 5874              		.loc 1 2039 0
 5875 0178 8DF83920 		strb	r2, [sp, #57]
2041:bluetooth_rxtx.c **** 			goto rx_flush;
 5876              		.loc 1 2041 0
 5877 017c 00F28880 		bhi	.L650
2044:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 5878              		.loc 1 2044 0
 5879 0180 0AF1080A 		add	r10, r10, #8
 5880 0184 4FEA9A02 		lsr	r2, r10, #2
 5881              	.LVL603:
2045:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0) ;
 5882              		.loc 1 2045 0
 5883 0188 0B2A     		cmp	r2, #11
 5884 018a 0BD0     		beq	.L659
2046:bluetooth_rxtx.c **** 		} else { while (DMACC0Config & DMACCxConfig_E && rx_err == 0) ;
 5885              		.loc 1 2046 0
 5886 018c 0BEB8203 		add	r3, fp, r2, lsl #2
 5887              	.LVL604:
 5888              	.L658:
 5889 0190 504A     		ldr	r2, .L702+36
 5890 0192 1268     		ldr	r2, [r2]
 5891 0194 9A42     		cmp	r2, r3
 5892 0196 09D2     		bcs	.L657
2046:bluetooth_rxtx.c **** 		} else { while (DMACC0Config & DMACCxConfig_E && rx_err == 0) ;
ARM GAS  /tmp/ccwLngFB.s 			page 166


 5893              		.loc 1 2046 0 is_stmt 0 discriminator 2
 5894 0198 3168     		ldr	r1, [r6]
 5895 019a 0029     		cmp	r1, #0
 5896 019c F8D0     		beq	.L658
 5897 019e 05E0     		b	.L657
 5898              	.LVL605:
 5899              	.L699:
2047:bluetooth_rxtx.c **** 		}
 5900              		.loc 1 2047 0 is_stmt 1 discriminator 2
 5901 01a0 3368     		ldr	r3, [r6]
 5902 01a2 1BB9     		cbnz	r3, .L657
 5903              	.L659:
2047:bluetooth_rxtx.c **** 		}
 5904              		.loc 1 2047 0 is_stmt 0
 5905 01a4 4C4B     		ldr	r3, .L702+40
 5906 01a6 1B68     		ldr	r3, [r3]
 5907 01a8 DB07     		lsls	r3, r3, #31
 5908 01aa F9D4     		bmi	.L699
 5909              	.LVL606:
 5910              	.L657:
2050:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 5911              		.loc 1 2050 0 is_stmt 1
 5912 01ac 4B4B     		ldr	r3, .L702+44
2051:bluetooth_rxtx.c **** 
 5913              		.loc 1 2051 0
 5914 01ae 6120     		movs	r0, #97
2050:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 5915              		.loc 1 2050 0
 5916 01b0 1A68     		ldr	r2, [r3]
2053:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5917              		.loc 1 2053 0
 5918 01b2 0426     		movs	r6, #4
2050:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 5919              		.loc 1 2050 0
 5920 01b4 22F00102 		bic	r2, r2, #1
 5921 01b8 1A60     		str	r2, [r3]
2051:bluetooth_rxtx.c **** 
 5922              		.loc 1 2051 0
 5923 01ba FFF7FEFF 		bl	cc2400_strobe
 5924              	.LVL607:
 5925              	.L661:
 5926              	.LBB58:
2054:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5927              		.loc 1 2054 0 discriminator 2
 5928 01be 484B     		ldr	r3, .L702+48
 5929 01c0 721C     		adds	r2, r6, #1
 5930 01c2 985D     		ldrb	r0, [r3, r6]	@ zero_extendqisi2
 5931 01c4 06F1030E 		add	lr, r6, #3
2055:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5932              		.loc 1 2055 0 discriminator 2
 5933 01c8 995C     		ldrb	r1, [r3, r2]	@ zero_extendqisi2
 5934 01ca B21C     		adds	r2, r6, #2
2056:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5935              		.loc 1 2056 0 discriminator 2
 5936 01cc 9A5C     		ldrb	r2, [r3, r2]	@ zero_extendqisi2
2057:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5937              		.loc 1 2057 0 discriminator 2
ARM GAS  /tmp/ccwLngFB.s 			page 167


 5938 01ce 13F80E30 		ldrb	r3, [r3, lr]	@ zero_extendqisi2
2055:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5939              		.loc 1 2055 0 discriminator 2
 5940 01d2 43EA0063 		orr	r3, r3, r0, lsl #24
2056:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5941              		.loc 1 2056 0 discriminator 2
 5942 01d6 43EA0143 		orr	r3, r3, r1, lsl #16
2057:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5943              		.loc 1 2057 0 discriminator 2
 5944 01da 43EA022B 		orr	fp, r3, r2, lsl #8
 5945              	.LVL608:
2058:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
 5946              		.loc 1 2058 0 discriminator 2
 5947 01de 5846     		mov	r0, fp
 5948 01e0 B210     		asrs	r2, r6, #2
 5949 01e2 0092     		str	r2, [sp]
 5950 01e4 FFF7FEFF 		bl	rbit
 5951              	.LVL609:
 5952 01e8 009A     		ldr	r2, [sp]
 5953 01ea 1CAB     		add	r3, sp, #112
 5954 01ec 03EB8201 		add	r1, r3, r2, lsl #2
 5955 01f0 019B     		ldr	r3, [sp, #4]
 5956              	.LBE58:
2053:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5957              		.loc 1 2053 0 discriminator 2
 5958 01f2 0436     		adds	r6, r6, #4
 5959              	.LVL610:
 5960              	.LBB59:
2058:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
 5961              		.loc 1 2058 0 discriminator 2
 5962 01f4 53F82220 		ldr	r2, [r3, r2, lsl #2]
 5963 01f8 5040     		eors	r0, r0, r2
 5964 01fa 41F8300C 		str	r0, [r1, #-48]
2059:bluetooth_rxtx.c **** 		}
 5965              		.loc 1 2059 0 discriminator 2
 5966 01fe 5846     		mov	r0, fp
 5967 0200 FFF7FEFF 		bl	rbit
 5968              	.LVL611:
 5969              	.LBE59:
2053:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5970              		.loc 1 2053 0 discriminator 2
 5971 0204 2C2E     		cmp	r6, #44
 5972 0206 DAD1     		bne	.L661
2062:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 5973              		.loc 1 2062 0
 5974 0208 6369     		ldr	r3, [r4, #20]
 5975 020a 73B9     		cbnz	r3, .L662
 5976              	.L665:
2071:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5977              		.loc 1 2071 0
 5978 020c 354B     		ldr	r3, .L702+52
 5979 020e 1022     		movs	r2, #16
 5980 0210 1A60     		str	r2, [r3]
2072:bluetooth_rxtx.c **** 
 5981              		.loc 1 2072 0
 5982 0212 0FA8     		add	r0, sp, #60
 5983              	.LVL612:
ARM GAS  /tmp/ccwLngFB.s 			page 168


 5984 0214 AB69     		ldr	r3, [r5, #24]
 5985 0216 9847     		blx	r3
 5986              	.LVL613:
2074:bluetooth_rxtx.c **** 		if (p[10] == 0x55 && p[11] == 0xec) {
 5987              		.loc 1 2074 0
 5988 0218 334B     		ldr	r3, .L702+56
 5989 021a 4FF08072 		mov	r2, #16777216
 5990 021e 1A60     		str	r2, [r3]
2075:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t *)packet);
 5991              		.loc 1 2075 0
 5992 0220 9DF84630 		ldrb	r3, [sp, #70]	@ zero_extendqisi2
 5993 0224 552B     		cmp	r3, #85
 5994 0226 24D1     		bne	.L664
 5995 0228 17E0     		b	.L700
 5996              	.L662:
 5997              	.LBB60:
2063:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 5998              		.loc 1 2063 0
 5999 022a 224B     		ldr	r3, .L702+4
 6000 022c 10A9     		add	r1, sp, #64
 6001 022e 1869     		ldr	r0, [r3, #16]
 6002 0230 4246     		mov	r2, r8
 6003 0232 FFF7FEFF 		bl	btle_crcgen_lut
 6004              	.LVL614:
2064:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 6005              		.loc 1 2064 0
 6006 0236 1CAB     		add	r3, sp, #112
 6007 0238 5344     		add	r3, r3, r10
 6008 023a 13F8342C 		ldrb	r2, [r3, #-52]	@ zero_extendqisi2
2065:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 6009              		.loc 1 2065 0
 6010 023e 1CAB     		add	r3, sp, #112
 6011 0240 4344     		add	r3, r3, r8
 6012 0242 13F82F1C 		ldrb	r1, [r3, #-47]	@ zero_extendqisi2
 6013 0246 0902     		lsls	r1, r1, #8
 6014 0248 41EA0241 		orr	r1, r1, r2, lsl #16
2066:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc)
 6015              		.loc 1 2066 0
 6016 024c 13F8302C 		ldrb	r2, [r3, #-48]	@ zero_extendqisi2
 6017 0250 41EA0203 		orr	r3, r1, r2
2067:bluetooth_rxtx.c **** 				goto rx_flush;
 6018              		.loc 1 2067 0
 6019 0254 9842     		cmp	r0, r3
 6020 0256 1BD1     		bne	.L650
 6021 0258 D8E7     		b	.L665
 6022              	.LVL615:
 6023              	.L700:
 6024              	.LBE60:
2075:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t *)packet);
 6025              		.loc 1 2075 0 discriminator 1
 6026 025a 9DF84730 		ldrb	r3, [sp, #71]	@ zero_extendqisi2
 6027 025e EC2B     		cmp	r3, #236
 6028 0260 07D1     		bne	.L664
2076:bluetooth_rxtx.c **** 			enqueue(CFO_TRACK, (uint8_t *)cfo_buf);
 6029              		.loc 1 2076 0
 6030 0262 0FA9     		add	r1, sp, #60
 6031              	.LVL616:
ARM GAS  /tmp/ccwLngFB.s 			page 169


 6032 0264 0120     		movs	r0, #1
 6033 0266 FFF7FEFF 		bl	enqueue
 6034              	.LVL617:
2077:bluetooth_rxtx.c **** 			//enqueue(MESSAGE, (uint8_t *)whiten_packet);
 6035              		.loc 1 2077 0
 6036 026a 0720     		movs	r0, #7
 6037 026c 02A9     		add	r1, sp, #8
 6038 026e FFF7FEFF 		bl	enqueue
 6039              	.LVL618:
 6040              	.L664:
2080:bluetooth_rxtx.c **** 
 6041              		.loc 1 2080 0
 6042 0272 114B     		ldr	r3, .L702+8
 6043 0274 4FF08072 		mov	r2, #16777216
 6044 0278 1A60     		str	r2, [r3]
2082:bluetooth_rxtx.c **** 
 6045              		.loc 1 2082 0
 6046 027a 1C4B     		ldr	r3, .L702+60
 6047 027c 1C4A     		ldr	r2, .L702+64
 6048 027e 1B68     		ldr	r3, [r3]
 6049 0280 1268     		ldr	r2, [r2]
 6050 0282 C3F31303 		ubfx	r3, r3, #0, #20
 6051 0286 40F63541 		movw	r1, #3125
 6052 028a 01FB0323 		mla	r3, r1, r3, r2
 6053 028e 6364     		str	r3, [r4, #68]
 6054              	.LVL619:
 6055              	.L650:
2085:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
 6056              		.loc 1 2085 0
 6057 0290 6120     		movs	r0, #97
 6058 0292 FFF7FEFF 		bl	cc2400_strobe
 6059              	.LVL620:
2086:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 6060              		.loc 1 2086 0
 6061 0296 114B     		ldr	r3, .L702+44
 6062 0298 1A68     		ldr	r2, [r3]
 6063 029a 22F00102 		bic	r2, r2, #1
 6064 029e 1A60     		str	r2, [r3]
 6065              	.L666:
2087:bluetooth_rxtx.c **** 			u8 tmp = (u8) DIO_SSP_DR;
 6066              		.loc 1 2087 0 discriminator 1
 6067 02a0 144B     		ldr	r3, .L702+68
 6068 02a2 1B68     		ldr	r3, [r3]
 6069 02a4 5E07     		lsls	r6, r3, #29
 6070 02a6 29D5     		bpl	.L701
 6071              	.LBB61:
2088:bluetooth_rxtx.c **** 		}
 6072              		.loc 1 2088 0
 6073 02a8 134B     		ldr	r3, .L702+72
 6074 02aa 1B68     		ldr	r3, [r3]
 6075 02ac F8E7     		b	.L666
 6076              	.L703:
 6077 02ae 00BF     		.align	2
 6078              	.L702:
 6079 02b0 00000000 		.word	.LANCHOR0
 6080 02b4 00000000 		.word	.LANCHOR1
 6081 02b8 00E100E0 		.word	-536813312
ARM GAS  /tmp/ccwLngFB.s 			page 170


 6082 02bc 3CC00920 		.word	537509948
 6083 02c0 00000000 		.word	rx_tc
 6084 02c4 00000000 		.word	rx_err
 6085 02c8 00000000 		.word	rssi_max
 6086 02cc 00000000 		.word	rssi_min
 6087 02d0 F0000000 		.word	.LANCHOR2+240
 6088 02d4 04410050 		.word	1342193924
 6089 02d8 10410050 		.word	1342193936
 6090 02dc 24000340 		.word	1073938468
 6091 02e0 00000000 		.word	rxbuf1
 6092 02e4 38C00920 		.word	537509944
 6093 02e8 80E100E0 		.word	-536813184
 6094 02ec 00000000 		.word	clkn
 6095 02f0 08400040 		.word	1073758216
 6096 02f4 0C000340 		.word	1073938444
 6097 02f8 08000340 		.word	1073938440
 6098              	.L701:
 6099              	.LBE61:
2090:bluetooth_rxtx.c **** 		if (now <le.last_packet)
 6100              		.loc 1 2090 0
 6101 02fc 414B     		ldr	r3, .L704
 6102 02fe 424A     		ldr	r2, .L704+4
 6103 0300 1B68     		ldr	r3, [r3]
 6104 0302 1268     		ldr	r2, [r2]
 6105 0304 40F63541 		movw	r1, #3125
 6106 0308 C3F31303 		ubfx	r3, r3, #0, #20
 6107 030c 01FB0323 		mla	r3, r1, r3, r2
 6108              	.LVL621:
2091:bluetooth_rxtx.c **** 			now += 3276800000;
 6109              		.loc 1 2091 0
 6110 0310 626C     		ldr	r2, [r4, #68]
2093:bluetooth_rxtx.c **** 			reset_le();
 6111              		.loc 1 2093 0
 6112 0312 217E     		ldrb	r1, [r4, #24]	@ zero_extendqisi2
2091:bluetooth_rxtx.c **** 			now += 3276800000;
 6113              		.loc 1 2091 0
 6114 0314 9342     		cmp	r3, r2
2093:bluetooth_rxtx.c **** 			reset_le();
 6115              		.loc 1 2093 0
 6116 0316 A1F10201 		sub	r1, r1, #2
2092:bluetooth_rxtx.c **** 		if ( ((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING) && (now - le.last_p
 6117              		.loc 1 2092 0
 6118 031a 38BF     		it	cc
 6119 031c 03F14343 		addcc	r3, r3, #-1023410176
 6120              	.LVL622:
2093:bluetooth_rxtx.c **** 			reset_le();
 6121              		.loc 1 2093 0
 6122 0320 C9B2     		uxtb	r1, r1
2092:bluetooth_rxtx.c **** 		if ( ((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING) && (now - le.last_p
 6123              		.loc 1 2092 0
 6124 0322 38BF     		it	cc
 6125 0324 03F5A003 		addcc	r3, r3, #5242880
 6126              	.LVL623:
2093:bluetooth_rxtx.c **** 			reset_le();
 6127              		.loc 1 2093 0
 6128 0328 0129     		cmp	r1, #1
 6129 032a 03D8     		bhi	.L669
ARM GAS  /tmp/ccwLngFB.s 			page 171


2093:bluetooth_rxtx.c **** 			reset_le();
 6130              		.loc 1 2093 0 is_stmt 0 discriminator 1
 6131 032c 3749     		ldr	r1, .L704+8
 6132 032e 9B1A     		subs	r3, r3, r2
 6133              	.LVL624:
 6134 0330 8B42     		cmp	r3, r1
 6135 0332 02D8     		bhi	.L670
 6136              	.L669:
2093:bluetooth_rxtx.c **** 			reset_le();
 6137              		.loc 1 2093 0 discriminator 2
 6138 0334 EB69     		ldr	r3, [r5, #28]
 6139 0336 012B     		cmp	r3, #1
 6140 0338 25D1     		bne	.L671
 6141              	.L670:
2094:bluetooth_rxtx.c **** 			le_jam_count = 0;
 6142              		.loc 1 2094 0 is_stmt 1
 6143 033a FFF7FEFF 		bl	reset_le
 6144              	.LVL625:
2096:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
 6145              		.loc 1 2096 0
 6146 033e 3449     		ldr	r1, .L704+12
2095:bluetooth_rxtx.c **** 			TXLED_CLR;
 6147              		.loc 1 2095 0
 6148 0340 0023     		movs	r3, #0
2096:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
 6149              		.loc 1 2096 0
 6150 0342 4FF48070 		mov	r0, #256
2095:bluetooth_rxtx.c **** 			TXLED_CLR;
 6151              		.loc 1 2095 0
 6152 0346 EB61     		str	r3, [r5, #28]
2096:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
 6153              		.loc 1 2096 0
 6154 0348 0860     		str	r0, [r1]
2097:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 6155              		.loc 1 2097 0
 6156 034a E97C     		ldrb	r1, [r5, #19]	@ zero_extendqisi2
2095:bluetooth_rxtx.c **** 			TXLED_CLR;
 6157              		.loc 1 2095 0
 6158 034c 314A     		ldr	r2, .L704+16
2097:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 6159              		.loc 1 2097 0
 6160 034e 0129     		cmp	r1, #1
 6161 0350 02D1     		bne	.L672
2098:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 6162              		.loc 1 2098 0
 6163 0352 D374     		strb	r3, [r2, #19]
2099:bluetooth_rxtx.c **** 				goto cleanup;
 6164              		.loc 1 2099 0
 6165 0354 9374     		strb	r3, [r2, #18]
2100:bluetooth_rxtx.c **** 			}
 6166              		.loc 1 2100 0
 6167 0356 47E0     		b	.L682
 6168              	.L672:
2102:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 6169              		.loc 1 2102 0
 6170 0358 0123     		movs	r3, #1
2103:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
ARM GAS  /tmp/ccwLngFB.s 			page 172


 6171              		.loc 1 2103 0
 6172 035a 6420     		movs	r0, #100
2102:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 6173              		.loc 1 2102 0
 6174 035c 2376     		strb	r3, [r4, #24]
2103:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 6175              		.loc 1 2103 0
 6176 035e FFF7FEFF 		bl	cc2400_strobe
 6177              	.LVL626:
 6178              	.L674:
2104:bluetooth_rxtx.c **** 
 6179              		.loc 1 2104 0 discriminator 1
 6180 0362 FFF7FEFF 		bl	cc2400_status
 6181              	.LVL627:
 6182 0366 4007     		lsls	r0, r0, #29
 6183 0368 FBD4     		bmi	.L674
2106:bluetooth_rxtx.c **** 			restart_jamming = 1;
 6184              		.loc 1 2106 0
 6185 036a B4F84A30 		ldrh	r3, [r4, #74]
 6186 036e 9BB2     		uxth	r3, r3
 6187 0370 23B1     		cbz	r3, .L684
2106:bluetooth_rxtx.c **** 			restart_jamming = 1;
 6188              		.loc 1 2106 0 is_stmt 0 discriminator 1
 6189 0372 294B     		ldr	r3, .L704+20
 6190 0374 B3F84A30 		ldrh	r3, [r3, #74]
 6191 0378 9BB2     		uxth	r3, r3
 6192 037a 01E0     		b	.L675
 6193              	.L684:
2106:bluetooth_rxtx.c **** 			restart_jamming = 1;
 6194              		.loc 1 2106 0
 6195 037c 40F66213 		movw	r3, #2402
 6196              	.L675:
2106:bluetooth_rxtx.c **** 			restart_jamming = 1;
 6197              		.loc 1 2106 0 discriminator 3
 6198 0380 2380     		strh	r3, [r4]	@ movhi
2107:bluetooth_rxtx.c **** 		}
 6199              		.loc 1 2107 0 is_stmt 1 discriminator 3
 6200 0382 0123     		movs	r3, #1
 6201 0384 6B63     		str	r3, [r5, #52]
 6202              	.L671:
2110:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 6203              		.loc 1 2110 0
 6204 0386 2C20     		movs	r0, #44
 6205 0388 6189     		ldrh	r1, [r4, #10]
 6206 038a FFF7FEFF 		bl	cc2400_set
 6207              	.LVL628:
2111:bluetooth_rxtx.c **** 
 6208              		.loc 1 2111 0
 6209 038e 2D20     		movs	r0, #45
 6210 0390 2189     		ldrh	r1, [r4, #8]
 6211 0392 FFF7FEFF 		bl	cc2400_set
 6212              	.LVL629:
2113:bluetooth_rxtx.c **** 			hop();
 6213              		.loc 1 2113 0
 6214 0396 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 6215 0398 0BB1     		cbz	r3, .L676
2114:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
ARM GAS  /tmp/ccwLngFB.s 			page 173


 6216              		.loc 1 2114 0
 6217 039a FFF7FEFF 		bl	hop
 6218              	.LVL630:
 6219              	.L676:
2115:bluetooth_rxtx.c **** 			le_jam();
 6220              		.loc 1 2115 0
 6221 039e EB69     		ldr	r3, [r5, #28]
 6222 03a0 1C4E     		ldr	r6, .L704+16
 6223 03a2 002B     		cmp	r3, #0
 6224 03a4 05DD     		ble	.L677
2116:bluetooth_rxtx.c **** 			--le_jam_count;
 6225              		.loc 1 2116 0
 6226 03a6 FFF7FEFF 		bl	le_jam
 6227              	.LVL631:
2117:bluetooth_rxtx.c **** 		} else {
 6228              		.loc 1 2117 0
 6229 03aa F369     		ldr	r3, [r6, #28]
 6230 03ac 013B     		subs	r3, r3, #1
 6231 03ae F361     		str	r3, [r6, #28]
 6232 03b0 14E0     		b	.L678
 6233              	.L677:
2119:bluetooth_rxtx.c **** 			dio_ssp_start();
 6234              		.loc 1 2119 0
 6235 03b2 FFF7FEFF 		bl	dma_init_le
 6236              	.LVL632:
2120:bluetooth_rxtx.c **** 
 6237              		.loc 1 2120 0
 6238 03b6 FFF7FEFF 		bl	dio_ssp_start
 6239              	.LVL633:
2122:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 6240              		.loc 1 2122 0
 6241 03ba 736B     		ldr	r3, [r6, #52]
 6242 03bc 3BB1     		cbz	r3, .L681
2123:bluetooth_rxtx.c **** 				restart_jamming = 0;
 6243              		.loc 1 2123 0
 6244 03be 6068     		ldr	r0, [r4, #4]
 6245 03c0 FFF7FEFF 		bl	rbit
 6246              	.LVL634:
 6247 03c4 FFF7FEFF 		bl	cc2400_rx_sync
 6248              	.LVL635:
2124:bluetooth_rxtx.c **** 			} else {
 6249              		.loc 1 2124 0
 6250 03c8 0023     		movs	r3, #0
 6251 03ca 7363     		str	r3, [r6, #52]
 6252 03cc 06E0     		b	.L678
 6253              	.L681:
2126:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 6254              		.loc 1 2126 0
 6255 03ce FFF7FEFF 		bl	cc2400_status
 6256              	.LVL636:
 6257 03d2 4107     		lsls	r1, r0, #29
 6258 03d4 FBD5     		bpl	.L681
2127:bluetooth_rxtx.c **** 			}
 6259              		.loc 1 2127 0
 6260 03d6 6220     		movs	r0, #98
 6261 03d8 FFF7FEFF 		bl	cc2400_strobe
 6262              	.LVL637:
ARM GAS  /tmp/ccwLngFB.s 			page 174


 6263              	.L678:
2131:bluetooth_rxtx.c **** 
 6264              		.loc 1 2131 0 discriminator 1
 6265 03dc 0F4A     		ldr	r2, .L704+24
2130:bluetooth_rxtx.c **** 		rx_err = 0;
 6266              		.loc 1 2130 0 discriminator 1
 6267 03de 0023     		movs	r3, #0
 6268 03e0 C9F80030 		str	r3, [r9]
2131:bluetooth_rxtx.c **** 
 6269              		.loc 1 2131 0 discriminator 1
 6270 03e4 1360     		str	r3, [r2]
 6271 03e6 2EE6     		b	.L639
 6272              	.L682:
 6273              	.LBE51:
2137:bluetooth_rxtx.c **** 	cc2400_idle();
 6274              		.loc 1 2137 0
 6275 03e8 0D4B     		ldr	r3, .L704+28
 6276 03ea 4FF08072 		mov	r2, #16777216
 6277 03ee 1A60     		str	r2, [r3]
2138:bluetooth_rxtx.c **** 	dio_ssp_stop ();
 6278              		.loc 1 2138 0
 6279 03f0 FFF7FEFF 		bl	cc2400_idle
 6280              	.LVL638:
2139:bluetooth_rxtx.c **** 	cs_trigger_disable();
 6281              		.loc 1 2139 0
 6282 03f4 FFF7FEFF 		bl	dio_ssp_stop
 6283              	.LVL639:
2140:bluetooth_rxtx.c **** }
 6284              		.loc 1 2140 0
 6285 03f8 FFF7FEFF 		bl	cs_trigger_disable
 6286              	.LVL640:
2141:bluetooth_rxtx.c **** 
 6287              		.loc 1 2141 0
 6288 03fc 1DB0     		add	sp, sp, #116
 6289              		@ sp needed
 6290 03fe BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 6291              	.L705:
 6292 0402 00BF     		.align	2
 6293              	.L704:
 6294 0404 00000000 		.word	clkn
 6295 0408 08400040 		.word	1073758216
 6296 040c 80F0FA02 		.word	50000000
 6297 0410 3CC00920 		.word	537509948
 6298 0414 00000000 		.word	.LANCHOR0
 6299 0418 00000000 		.word	.LANCHOR1
 6300 041c 00000000 		.word	rx_err
 6301 0420 80E100E0 		.word	-536813184
 6302              		.cfi_endproc
 6303              	.LFE24:
 6305              		.section	.text.bt_le_sync_rssi,"ax",%progbits
 6306              		.align	1
 6307              		.global	bt_le_sync_rssi
 6308              		.thumb
 6309              		.thumb_func
 6311              	bt_le_sync_rssi:
 6312              	.LFB25:
2145:bluetooth_rxtx.c **** 	int i;
ARM GAS  /tmp/ccwLngFB.s 			page 175


 6313              		.loc 1 2145 0
 6314              		.cfi_startproc
 6315              		@ args = 0, pretend = 0, frame = 312
 6316              		@ frame_needed = 0, uses_anonymous_args = 0
 6317              	.LVL641:
 6318 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 6319              		.cfi_def_cfa_offset 36
 6320              		.cfi_offset 4, -36
 6321              		.cfi_offset 5, -32
 6322              		.cfi_offset 6, -28
 6323              		.cfi_offset 7, -24
 6324              		.cfi_offset 8, -20
 6325              		.cfi_offset 9, -16
 6326              		.cfi_offset 10, -12
 6327              		.cfi_offset 11, -8
 6328              		.cfi_offset 14, -4
 6329 0004 CFB0     		sub	sp, sp, #316
 6330              		.cfi_def_cfa_offset 352
2152:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 100 * 10000 / 3125; // millis -> clkn ticks
 6331              		.loc 1 2152 0
 6332 0006 794D     		ldr	r5, .L727
2149:bluetooth_rxtx.c **** 
 6333              		.loc 1 2149 0
 6334 0008 0DF10408 		add	r8, sp, #4
 6335 000c 0021     		movs	r1, #0
2145:bluetooth_rxtx.c **** 	int i;
 6336              		.loc 1 2145 0
 6337 000e 0646     		mov	r6, r0
2149:bluetooth_rxtx.c **** 
 6338              		.loc 1 2149 0
 6339 0010 3222     		movs	r2, #50
 6340 0012 4046     		mov	r0, r8
 6341              	.LVL642:
 6342 0014 FFF7FEFF 		bl	memset
 6343              	.LVL643:
2152:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 100 * 10000 / 3125; // millis -> clkn ticks
 6344              		.loc 1 2152 0
 6345 0018 2B68     		ldr	r3, [r5]
 6346              	.LVL644:
2161:bluetooth_rxtx.c **** 	mode = active_mode;
 6347              		.loc 1 2161 0
 6348 001a 754F     		ldr	r7, .L727+4
2164:bluetooth_rxtx.c **** 
 6349              		.loc 1 2164 0
 6350 001c 754C     		ldr	r4, .L727+8
2152:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 100 * 10000 / 3125; // millis -> clkn ticks
 6351              		.loc 1 2152 0
 6352 001e 23F07F4A 		bic	r10, r3, #-16777216
 6353              	.LVL645:
2161:bluetooth_rxtx.c **** 	mode = active_mode;
 6354              		.loc 1 2161 0
 6355 0022 0123     		movs	r3, #1
 6356 0024 3B70     		strb	r3, [r7]
2164:bluetooth_rxtx.c **** 
 6357              		.loc 1 2164 0
 6358 0026 2376     		strb	r3, [r4, #24]
2166:bluetooth_rxtx.c **** 	RXLED_CLR;
ARM GAS  /tmp/ccwLngFB.s 			page 176


 6359              		.loc 1 2166 0
 6360 0028 734B     		ldr	r3, .L727+12
 6361 002a 4FF08072 		mov	r2, #16777216
2162:bluetooth_rxtx.c **** 
 6362              		.loc 1 2162 0
 6363 002e 7E74     		strb	r6, [r7, #17]
2166:bluetooth_rxtx.c **** 	RXLED_CLR;
 6364              		.loc 1 2166 0
 6365 0030 1A60     		str	r2, [r3]
2167:bluetooth_rxtx.c **** 	queue_init();
 6366              		.loc 1 2167 0
 6367 0032 724B     		ldr	r3, .L727+16
 6368 0034 1022     		movs	r2, #16
 6369 0036 1A60     		str	r2, [r3]
2168:bluetooth_rxtx.c **** 	dio_ssp_init();
 6370              		.loc 1 2168 0
 6371 0038 FFF7FEFF 		bl	queue_init
 6372              	.LVL646:
2169:bluetooth_rxtx.c **** 	dma_init_le();
 6373              		.loc 1 2169 0
 6374 003c FFF7FEFF 		bl	dio_ssp_init
 6375              	.LVL647:
2170:bluetooth_rxtx.c **** 	dio_ssp_start();
 6376              		.loc 1 2170 0
 6377 0040 FFF7FEFF 		bl	dma_init_le
 6378              	.LVL648:
2171:bluetooth_rxtx.c **** 
 6379              		.loc 1 2171 0
 6380 0044 FFF7FEFF 		bl	dio_ssp_start
 6381              	.LVL649:
2173:bluetooth_rxtx.c **** 
 6382              		.loc 1 2173 0
 6383 0048 6068     		ldr	r0, [r4, #4]
2153:bluetooth_rxtx.c **** 	int overflow = 0;
 6384              		.loc 1 2153 0
 6385 004a 0AF5A07A 		add	r10, r10, #320
 6386              	.LVL650:
2173:bluetooth_rxtx.c **** 
 6387              		.loc 1 2173 0
 6388 004e FFF7FEFF 		bl	rbit
 6389              	.LVL651:
 6390 0052 FFF7FEFF 		bl	cc2400_rx_sync
 6391              	.LVL652:
 6392              	.L707:
2175:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 6393              		.loc 1 2175 0 discriminator 1
 6394 0056 BB7C     		ldrb	r3, [r7, #18]	@ zero_extendqisi2
 6395 0058 B342     		cmp	r3, r6
 6396 005a 40F0B980 		bne	.L722
 6397              	.LBB62:
2176:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 6398              		.loc 1 2176 0
 6399 005e 644B     		ldr	r3, .L727+4
 6400 0060 DB89     		ldrh	r3, [r3, #14]
 6401 0062 9BB2     		uxth	r3, r3
 6402 0064 D3B1     		cbz	r3, .L708
2177:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
ARM GAS  /tmp/ccwLngFB.s 			page 177


 6403              		.loc 1 2177 0
 6404 0066 6420     		movs	r0, #100
 6405 0068 FFF7FEFF 		bl	cc2400_strobe
 6406              	.LVL653:
 6407              	.L710:
2178:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
 6408              		.loc 1 2178 0 discriminator 1
 6409 006c FFF7FEFF 		bl	cc2400_status
 6410              	.LVL654:
 6411 0070 4407     		lsls	r4, r0, #29
 6412 0072 FBD4     		bmi	.L710
2179:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 6413              		.loc 1 2179 0
 6414 0074 5F4B     		ldr	r3, .L727+8
 6415 0076 0220     		movs	r0, #2
 6416 0078 1988     		ldrh	r1, [r3]
 6417 007a 89B2     		uxth	r1, r1
 6418 007c 0139     		subs	r1, r1, #1
 6419 007e 89B2     		uxth	r1, r1
 6420 0080 FFF7FEFF 		bl	cc2400_set
 6421              	.LVL655:
2180:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 6422              		.loc 1 2180 0
 6423 0084 6120     		movs	r0, #97
 6424 0086 FFF7FEFF 		bl	cc2400_strobe
 6425              	.LVL656:
 6426              	.L712:
2181:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 6427              		.loc 1 2181 0 discriminator 1
 6428 008a FFF7FEFF 		bl	cc2400_status
 6429              	.LVL657:
 6430 008e 4007     		lsls	r0, r0, #29
 6431 0090 FBD5     		bpl	.L712
2182:bluetooth_rxtx.c **** 			requested_channel = 0;
 6432              		.loc 1 2182 0
 6433 0092 6220     		movs	r0, #98
 6434 0094 FFF7FEFF 		bl	cc2400_strobe
 6435              	.LVL658:
2183:bluetooth_rxtx.c **** 		}
 6436              		.loc 1 2183 0
 6437 0098 0023     		movs	r3, #0
 6438 009a FB81     		strh	r3, [r7, #14]	@ movhi
 6439              	.L708:
2185:bluetooth_rxtx.c **** 		
 6440              		.loc 1 2185 0
 6441 009c 574B     		ldr	r3, .L727+16
 6442 009e 1022     		movs	r2, #16
 6443 00a0 1A60     		str	r2, [r3]
2187:bluetooth_rxtx.c **** 			goto cleanup;
 6444              		.loc 1 2187 0
 6445 00a2 BB7C     		ldrb	r3, [r7, #18]	@ zero_extendqisi2
 6446 00a4 B342     		cmp	r3, r6
 6447 00a6 40F09380 		bne	.L722
2192:bluetooth_rxtx.c **** 		u32 time_buf2[16] = {0, };
 6448              		.loc 1 2192 0
 6449 00aa 0DF13809 		add	r9, sp, #56
 6450 00ae 0021     		movs	r1, #0
ARM GAS  /tmp/ccwLngFB.s 			page 178


 6451 00b0 4022     		movs	r2, #64
 6452 00b2 4846     		mov	r0, r9
 6453 00b4 FFF7FEFF 		bl	memset
 6454              	.LVL659:
2193:bluetooth_rxtx.c **** 		u32 time_buf3[16] = {0, };
 6455              		.loc 1 2193 0
 6456 00b8 0021     		movs	r1, #0
 6457 00ba 4022     		movs	r2, #64
 6458 00bc 1EA8     		add	r0, sp, #120
 6459 00be FFF7FEFF 		bl	memset
 6460              	.LVL660:
2194:bluetooth_rxtx.c **** 		u32 time_buf4[16] = {0, };
 6461              		.loc 1 2194 0
 6462 00c2 0021     		movs	r1, #0
 6463 00c4 4022     		movs	r2, #64
 6464 00c6 2EA8     		add	r0, sp, #184
 6465 00c8 FFF7FEFF 		bl	memset
 6466              	.LVL661:
2195:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; i++) {
 6467              		.loc 1 2195 0
 6468 00cc 3EA8     		add	r0, sp, #248
 6469 00ce 0021     		movs	r1, #0
 6470 00d0 4022     		movs	r2, #64
 6471 00d2 FFF7FEFF 		bl	memset
 6472              	.LVL662:
 6473 00d6 4FF0000B 		mov	fp, #0
2196:bluetooth_rxtx.c **** 			if (i<16) time_buf1[i] = CLK100NS;
 6474              		.loc 1 2196 0
 6475 00da 5C46     		mov	r4, fp
 6476              	.LVL663:
 6477              	.L721:
 6478              	.LBB63:
2197:bluetooth_rxtx.c **** 			if (15<i && i<32) time_buf2[i-16] = CLK100NS;
 6479              		.loc 1 2197 0
 6480 00dc 0F2C     		cmp	r4, #15
 6481 00de 0ADC     		bgt	.L714
2197:bluetooth_rxtx.c **** 			if (15<i && i<32) time_buf2[i-16] = CLK100NS;
 6482              		.loc 1 2197 0 is_stmt 0 discriminator 1
 6483 00e0 4749     		ldr	r1, .L727+20
 6484 00e2 2A68     		ldr	r2, [r5]
 6485 00e4 0968     		ldr	r1, [r1]
 6486 00e6 C2F31302 		ubfx	r2, r2, #0, #20
 6487 00ea 40F63540 		movw	r0, #3125
 6488 00ee 00FB0212 		mla	r2, r0, r2, r1
 6489 00f2 49F80B20 		str	r2, [r9, fp]
 6490              	.L714:
 6491 00f6 A4F11002 		sub	r2, r4, #16
2198:bluetooth_rxtx.c **** 			if (31<i && i<48) time_buf3[i-32] = CLK100NS;
 6492              		.loc 1 2198 0 is_stmt 1
 6493 00fa 0F2A     		cmp	r2, #15
 6494 00fc 0CD8     		bhi	.L715
2198:bluetooth_rxtx.c **** 			if (31<i && i<48) time_buf3[i-32] = CLK100NS;
 6495              		.loc 1 2198 0 is_stmt 0 discriminator 1
 6496 00fe 404A     		ldr	r2, .L727+20
 6497 0100 2968     		ldr	r1, [r5]
 6498 0102 1068     		ldr	r0, [r2]
 6499 0104 C1F31301 		ubfx	r1, r1, #0, #20
ARM GAS  /tmp/ccwLngFB.s 			page 179


 6500 0108 40F6354E 		movw	lr, #3125
 6501 010c 0EFB0101 		mla	r1, lr, r1, r0
 6502 0110 1EAA     		add	r2, sp, #120
 6503 0112 5A44     		add	r2, r2, fp
 6504 0114 42F8401C 		str	r1, [r2, #-64]
 6505              	.L715:
 6506 0118 A4F12002 		sub	r2, r4, #32
2199:bluetooth_rxtx.c **** 			if (47<i) time_buf4[i-48] = CLK100NS;
 6507              		.loc 1 2199 0 is_stmt 1
 6508 011c 0F2A     		cmp	r2, #15
 6509 011e 0DD8     		bhi	.L716
2199:bluetooth_rxtx.c **** 			if (47<i) time_buf4[i-48] = CLK100NS;
 6510              		.loc 1 2199 0 is_stmt 0 discriminator 1
 6511 0120 374A     		ldr	r2, .L727+20
 6512 0122 2968     		ldr	r1, [r5]
 6513 0124 1068     		ldr	r0, [r2]
 6514 0126 C1F31301 		ubfx	r1, r1, #0, #20
 6515 012a 40F6354E 		movw	lr, #3125
 6516 012e 0EFB0101 		mla	r1, lr, r1, r0
 6517 0132 2EAA     		add	r2, sp, #184
 6518 0134 5A44     		add	r2, r2, fp
 6519 0136 42F8801C 		str	r1, [r2, #-128]
 6520 013a 0EE0     		b	.L717
 6521              	.L716:
2200:bluetooth_rxtx.c **** 			rssi_buf[i] = (u8)(cc2400_get(RSSI) >> 8);
 6522              		.loc 1 2200 0 is_stmt 1
 6523 013c 2F2C     		cmp	r4, #47
 6524 013e 0CDD     		ble	.L717
2200:bluetooth_rxtx.c **** 			rssi_buf[i] = (u8)(cc2400_get(RSSI) >> 8);
 6525              		.loc 1 2200 0 is_stmt 0 discriminator 1
 6526 0140 2F4A     		ldr	r2, .L727+20
 6527 0142 2968     		ldr	r1, [r5]
 6528 0144 1068     		ldr	r0, [r2]
 6529 0146 C1F31301 		ubfx	r1, r1, #0, #20
 6530 014a 40F6354E 		movw	lr, #3125
 6531 014e 0EFB0101 		mla	r1, lr, r1, r0
 6532 0152 3EAA     		add	r2, sp, #248
 6533 0154 5A44     		add	r2, r2, fp
 6534 0156 42F8C01C 		str	r1, [r2, #-192]
 6535              	.L717:
2201:bluetooth_rxtx.c **** 			volatile u32 j = 598; while (--j); // empty for loop ~= 70ns, 598 empty while loop ~= 41.8us
 6536              		.loc 1 2201 0 is_stmt 1
 6537 015a 0620     		movs	r0, #6
 6538 015c FFF7FEFF 		bl	cc2400_get
 6539              	.LVL664:
2202:bluetooth_rxtx.c **** 		}
 6540              		.loc 1 2202 0
 6541 0160 40F25622 		movw	r2, #598
2201:bluetooth_rxtx.c **** 			volatile u32 j = 598; while (--j); // empty for loop ~= 70ns, 598 empty while loop ~= 41.8us
 6542              		.loc 1 2201 0
 6543 0164 000A     		lsrs	r0, r0, #8
 6544 0166 08F80400 		strb	r0, [r8, r4]
2202:bluetooth_rxtx.c **** 		}
 6545              		.loc 1 2202 0
 6546 016a 0092     		str	r2, [sp]
 6547              	.L719:
2202:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccwLngFB.s 			page 180


 6548              		.loc 1 2202 0 is_stmt 0 discriminator 1
 6549 016c 009A     		ldr	r2, [sp]
 6550 016e 013A     		subs	r2, r2, #1
 6551 0170 0092     		str	r2, [sp]
 6552 0172 002A     		cmp	r2, #0
 6553 0174 FAD1     		bne	.L719
 6554              	.LBE63:
2196:bluetooth_rxtx.c **** 			if (i<16) time_buf1[i] = CLK100NS;
 6555              		.loc 1 2196 0 is_stmt 1
 6556 0176 0134     		adds	r4, r4, #1
 6557              	.LVL665:
 6558 0178 322C     		cmp	r4, #50
 6559 017a 0BF1040B 		add	fp, fp, #4
 6560 017e ADD1     		bne	.L721
2205:bluetooth_rxtx.c **** 
 6561              		.loc 1 2205 0
 6562 0180 204B     		ldr	r3, .L727+24
 6563 0182 1022     		movs	r2, #16
 6564 0184 1A60     		str	r2, [r3]
2207:bluetooth_rxtx.c **** 		enqueue_with_ts(RSSI_TRACK, (uint8_t *)rssi_buf, CLK100NS);
 6565              		.loc 1 2207 0
 6566 0186 204B     		ldr	r3, .L727+28
 6567 0188 4FF08074 		mov	r4, #16777216
 6568              	.LVL666:
 6569 018c 1C60     		str	r4, [r3]
2208:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf1);
 6570              		.loc 1 2208 0
 6571 018e 1C4B     		ldr	r3, .L727+20
 6572 0190 2A68     		ldr	r2, [r5]
 6573 0192 1B68     		ldr	r3, [r3]
 6574 0194 40F6354E 		movw	lr, #3125
 6575 0198 C2F31302 		ubfx	r2, r2, #0, #20
 6576 019c 0EFB0232 		mla	r2, lr, r2, r3
 6577 01a0 4146     		mov	r1, r8
 6578 01a2 0820     		movs	r0, #8
 6579 01a4 FFF7FEFF 		bl	enqueue_with_ts
 6580              	.LVL667:
2209:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf2);
 6581              		.loc 1 2209 0
 6582 01a8 4846     		mov	r0, r9
 6583 01aa FFF7FEFF 		bl	enqueue_time
 6584              	.LVL668:
2210:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf3);
 6585              		.loc 1 2210 0
 6586 01ae 1EA8     		add	r0, sp, #120
 6587 01b0 FFF7FEFF 		bl	enqueue_time
 6588              	.LVL669:
2211:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf4);
 6589              		.loc 1 2211 0
 6590 01b4 2EA8     		add	r0, sp, #184
 6591 01b6 FFF7FEFF 		bl	enqueue_time
 6592              	.LVL670:
2212:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 6593              		.loc 1 2212 0
 6594 01ba 3EA8     		add	r0, sp, #248
 6595 01bc FFF7FEFF 		bl	enqueue_time
 6596              	.LVL671:
ARM GAS  /tmp/ccwLngFB.s 			page 181


2213:bluetooth_rxtx.c **** 		
 6597              		.loc 1 2213 0
 6598 01c0 0D4B     		ldr	r3, .L727+12
 6599 01c2 1C60     		str	r4, [r3]
2216:bluetooth_rxtx.c **** 				goto cleanup;
 6600              		.loc 1 2216 0
 6601 01c4 2B68     		ldr	r3, [r5]
 6602 01c6 23F07F43 		bic	r3, r3, #-16777216
 6603 01ca 5345     		cmp	r3, r10
 6604 01cc 7FF643AF 		bls	.L707
 6605              	.L722:
 6606              	.LBE62:
2225:bluetooth_rxtx.c **** 	cc2400_idle();
 6607              		.loc 1 2225 0
 6608 01d0 0D4B     		ldr	r3, .L727+28
 6609 01d2 4FF08072 		mov	r2, #16777216
 6610 01d6 1A60     		str	r2, [r3]
2226:bluetooth_rxtx.c **** 	dio_ssp_stop ();
 6611              		.loc 1 2226 0
 6612 01d8 FFF7FEFF 		bl	cc2400_idle
 6613              	.LVL672:
2227:bluetooth_rxtx.c **** 	cs_trigger_disable();
 6614              		.loc 1 2227 0
 6615 01dc FFF7FEFF 		bl	dio_ssp_stop
 6616              	.LVL673:
2228:bluetooth_rxtx.c **** }
 6617              		.loc 1 2228 0
 6618 01e0 FFF7FEFF 		bl	cs_trigger_disable
 6619              	.LVL674:
2229:bluetooth_rxtx.c **** 
 6620              		.loc 1 2229 0
 6621 01e4 4FB0     		add	sp, sp, #316
 6622              		@ sp needed
 6623 01e6 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 6624              	.LVL675:
 6625              	.L728:
 6626 01ea 00BF     		.align	2
 6627              	.L727:
 6628 01ec 00000000 		.word	clkn
 6629 01f0 00000000 		.word	.LANCHOR0
 6630 01f4 00000000 		.word	.LANCHOR1
 6631 01f8 00E100E0 		.word	-536813312
 6632 01fc 3CC00920 		.word	537509948
 6633 0200 08400040 		.word	1073758216
 6634 0204 38C00920 		.word	537509944
 6635 0208 80E100E0 		.word	-536813184
 6636              		.cfi_endproc
 6637              	.LFE25:
 6639              		.section	.text.bt_follow_le,"ax",%progbits
 6640              		.align	1
 6641              		.global	bt_follow_le
 6642              		.thumb
 6643              		.thumb_func
 6645              	bt_follow_le:
 6646              	.LFB28:
2392:bluetooth_rxtx.c **** 		}
2393:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/ccwLngFB.s 			page 182


2394:bluetooth_rxtx.c **** }
2395:bluetooth_rxtx.c **** 
2396:bluetooth_rxtx.c **** void bt_follow_le() {
 6647              		.loc 1 2396 0
 6648              		.cfi_startproc
 6649              		@ args = 0, pretend = 0, frame = 0
 6650              		@ frame_needed = 0, uses_anonymous_args = 0
 6651 0000 10B5     		push	{r4, lr}
 6652              		.cfi_def_cfa_offset 8
 6653              		.cfi_offset 4, -8
 6654              		.cfi_offset 14, -4
2397:bluetooth_rxtx.c **** 	reset_le();
 6655              		.loc 1 2397 0
 6656 0002 FFF7FEFF 		bl	reset_le
 6657              	.LVL676:
2398:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 6658              		.loc 1 2398 0
 6659 0006 044C     		ldr	r4, .L730
 6660 0008 044B     		ldr	r3, .L730+4
2399:bluetooth_rxtx.c **** 	bt_le_sync(MODE_BT_FOLLOW_LE);
 6661              		.loc 1 2399 0
 6662 000a 0920     		movs	r0, #9
2398:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 6663              		.loc 1 2398 0
 6664 000c A361     		str	r3, [r4, #24]
 6665              		.loc 1 2399 0
 6666 000e FFF7FEFF 		bl	bt_le_sync
 6667              	.LVL677:
2400:bluetooth_rxtx.c **** 
2401:bluetooth_rxtx.c **** 	/* old non-sync mode
2402:bluetooth_rxtx.c **** 	data_cb = cb_follow_le;
2403:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
2404:bluetooth_rxtx.c **** 	bt_generic_le(MODE_BT_FOLLOW_LE);
2405:bluetooth_rxtx.c **** 	*/
2406:bluetooth_rxtx.c **** 
2407:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 6668              		.loc 1 2407 0
 6669 0012 0023     		movs	r3, #0
 6670 0014 6374     		strb	r3, [r4, #17]
 6671 0016 10BD     		pop	{r4, pc}
 6672              	.L731:
 6673              		.align	2
 6674              	.L730:
 6675 0018 00000000 		.word	.LANCHOR0
 6676 001c 00000000 		.word	connection_follow_cb
 6677              		.cfi_endproc
 6678              	.LFE28:
 6680              		.section	.text.bt_tracking_le,"ax",%progbits
 6681              		.align	1
 6682              		.global	bt_tracking_le
 6683              		.thumb
 6684              		.thumb_func
 6686              	bt_tracking_le:
 6687              	.LFB29:
2408:bluetooth_rxtx.c **** }
2409:bluetooth_rxtx.c **** 
2410:bluetooth_rxtx.c **** //JWHUR rssi estimation tracking
ARM GAS  /tmp/ccwLngFB.s 			page 183


2411:bluetooth_rxtx.c **** void bt_tracking_le(uint8_t tracking_mode) {
 6688              		.loc 1 2411 0
 6689              		.cfi_startproc
 6690              		@ args = 0, pretend = 0, frame = 0
 6691              		@ frame_needed = 0, uses_anonymous_args = 0
 6692              	.LVL678:
 6693 0000 38B5     		push	{r3, r4, r5, lr}
 6694              		.cfi_def_cfa_offset 16
 6695              		.cfi_offset 3, -16
 6696              		.cfi_offset 4, -12
 6697              		.cfi_offset 5, -8
 6698              		.cfi_offset 14, -4
 6699              		.loc 1 2411 0
 6700 0002 0446     		mov	r4, r0
2412:bluetooth_rxtx.c **** 	reset_le();
 6701              		.loc 1 2412 0
 6702 0004 FFF7FEFF 		bl	reset_le
 6703              	.LVL679:
2413:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 6704              		.loc 1 2413 0
 6705 0008 084B     		ldr	r3, .L735
 6706 000a 094A     		ldr	r2, .L735+4
2414:bluetooth_rxtx.c **** 	if (tracking_mode == MODE_BT_CFO_LE) bt_le_sync_cfo(MODE_BT_CFO_LE);
 6707              		.loc 1 2414 0
 6708 000c 192C     		cmp	r4, #25
2413:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 6709              		.loc 1 2413 0
 6710 000e 9A61     		str	r2, [r3, #24]
 6711 0010 1D46     		mov	r5, r3
 6712              		.loc 1 2414 0
 6713 0012 03D1     		bne	.L733
 6714              		.loc 1 2414 0 is_stmt 0 discriminator 1
 6715 0014 2046     		mov	r0, r4
 6716 0016 FFF7FEFF 		bl	bt_le_sync_cfo
 6717              	.LVL680:
 6718 001a 04E0     		b	.L734
 6719              	.L733:
2415:bluetooth_rxtx.c **** 	if (tracking_mode == MODE_BT_RSSI_LE) bt_le_sync_rssi(MODE_BT_RSSI_LE);
 6720              		.loc 1 2415 0 is_stmt 1
 6721 001c 1A2C     		cmp	r4, #26
 6722 001e 02D1     		bne	.L734
 6723              		.loc 1 2415 0 is_stmt 0 discriminator 1
 6724 0020 2046     		mov	r0, r4
 6725 0022 FFF7FEFF 		bl	bt_le_sync_rssi
 6726              	.LVL681:
 6727              	.L734:
2416:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 6728              		.loc 1 2416 0 is_stmt 1
 6729 0026 0023     		movs	r3, #0
 6730 0028 6B74     		strb	r3, [r5, #17]
 6731 002a 38BD     		pop	{r3, r4, r5, pc}
 6732              	.L736:
 6733              		.align	2
 6734              	.L735:
 6735 002c 00000000 		.word	.LANCHOR0
 6736 0030 00000000 		.word	connection_follow_cb
 6737              		.cfi_endproc
ARM GAS  /tmp/ccwLngFB.s 			page 184


 6738              	.LFE29:
 6740              		.section	.text.le_promisc_state,"ax",%progbits
 6741              		.align	1
 6742              		.global	le_promisc_state
 6743              		.thumb
 6744              		.thumb_func
 6746              	le_promisc_state:
 6747              	.LFB30:
2417:bluetooth_rxtx.c **** }
2418:bluetooth_rxtx.c **** 
2419:bluetooth_rxtx.c **** // issue state change message
2420:bluetooth_rxtx.c **** void le_promisc_state(u8 type, void *data, unsigned len) {
 6748              		.loc 1 2420 0
 6749              		.cfi_startproc
 6750              		@ args = 0, pretend = 0, frame = 56
 6751              		@ frame_needed = 0, uses_anonymous_args = 0
 6752              	.LVL682:
 6753 0000 70B5     		push	{r4, r5, r6, lr}
 6754              		.cfi_def_cfa_offset 16
 6755              		.cfi_offset 4, -16
 6756              		.cfi_offset 5, -12
 6757              		.cfi_offset 6, -8
 6758              		.cfi_offset 14, -4
 6759 0002 8EB0     		sub	sp, sp, #56
 6760              		.cfi_def_cfa_offset 72
 6761              		.loc 1 2420 0
 6762 0004 0646     		mov	r6, r0
 6763 0006 0D46     		mov	r5, r1
 6764 0008 1446     		mov	r4, r2
2421:bluetooth_rxtx.c **** 	u8 buf[50] = { 0, };
 6765              		.loc 1 2421 0
 6766 000a 01A8     		add	r0, sp, #4
 6767              	.LVL683:
 6768 000c 0021     		movs	r1, #0
 6769              	.LVL684:
 6770 000e 3222     		movs	r2, #50
 6771              	.LVL685:
 6772 0010 FFF7FEFF 		bl	memset
 6773              	.LVL686:
2422:bluetooth_rxtx.c **** 	if (len > 49)
2423:bluetooth_rxtx.c **** 		len = 49;
2424:bluetooth_rxtx.c **** 
2425:bluetooth_rxtx.c **** 	buf[0] = type;
2426:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 6774              		.loc 1 2426 0
 6775 0014 2946     		mov	r1, r5
 6776 0016 312C     		cmp	r4, #49
 6777 0018 34BF     		ite	cc
 6778 001a 2246     		movcc	r2, r4
 6779 001c 3122     		movcs	r2, #49
 6780              	.LVL687:
 6781 001e 0DF10500 		add	r0, sp, #5
2425:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 6782              		.loc 1 2425 0
 6783 0022 8DF80460 		strb	r6, [sp, #4]
 6784              		.loc 1 2426 0
 6785 0026 FFF7FEFF 		bl	memcpy
ARM GAS  /tmp/ccwLngFB.s 			page 185


 6786              	.LVL688:
2427:bluetooth_rxtx.c **** 	enqueue(LE_PROMISC, (uint8_t*)buf);
 6787              		.loc 1 2427 0
 6788 002a 01A9     		add	r1, sp, #4
 6789 002c 0520     		movs	r0, #5
 6790 002e FFF7FEFF 		bl	enqueue
 6791              	.LVL689:
2428:bluetooth_rxtx.c **** }
 6792              		.loc 1 2428 0
 6793 0032 0EB0     		add	sp, sp, #56
 6794              		@ sp needed
 6795 0034 70BD     		pop	{r4, r5, r6, pc}
 6796              		.cfi_endproc
 6797              	.LFE30:
 6799              		.section	.text.promisc_recover_hop_increment,"ax",%progbits
 6800              		.align	1
 6801              		.global	promisc_recover_hop_increment
 6802              		.thumb
 6803              		.thumb_func
 6805              	promisc_recover_hop_increment:
 6806              	.LFB31:
2429:bluetooth_rxtx.c **** 
2430:bluetooth_rxtx.c **** // divide, rounding to the nearest integer: round up at 0.5.
2431:bluetooth_rxtx.c **** #define DIVIDE_ROUND(N, D) ((N) + (D)/2) / (D)
2432:bluetooth_rxtx.c **** 
2433:bluetooth_rxtx.c **** void promisc_recover_hop_increment(u8 *packet) {
 6807              		.loc 1 2433 0
 6808              		.cfi_startproc
 6809              		@ args = 0, pretend = 0, frame = 0
 6810              		@ frame_needed = 0, uses_anonymous_args = 0
 6811              	.LVL690:
 6812 0000 38B5     		push	{r3, r4, r5, lr}
 6813              		.cfi_def_cfa_offset 16
 6814              		.cfi_offset 3, -16
 6815              		.cfi_offset 4, -12
 6816              		.cfi_offset 5, -8
 6817              		.cfi_offset 14, -4
2434:bluetooth_rxtx.c **** 	static u32 first_ts = 0;
2435:bluetooth_rxtx.c **** 	if (channel == 2404) {
 6818              		.loc 1 2435 0
 6819 0002 314A     		ldr	r2, .L747
 6820 0004 40F66413 		movw	r3, #2404
 6821 0008 1188     		ldrh	r1, [r2]
 6822 000a 304C     		ldr	r4, .L747+4
 6823 000c 89B2     		uxth	r1, r1
 6824 000e 9942     		cmp	r1, r3
 6825 0010 0DD1     		bne	.L739
2436:bluetooth_rxtx.c **** 		first_ts = CLK100NS;
 6826              		.loc 1 2436 0
 6827 0012 2F4B     		ldr	r3, .L747+8
 6828 0014 2F4A     		ldr	r2, .L747+12
 6829 0016 1B68     		ldr	r3, [r3]
 6830 0018 1268     		ldr	r2, [r2]
 6831 001a C3F31303 		ubfx	r3, r3, #0, #20
 6832 001e 40F63541 		movw	r1, #3125
 6833 0022 01FB0323 		mla	r3, r1, r3, r2
 6834 0026 A363     		str	r3, [r4, #56]
ARM GAS  /tmp/ccwLngFB.s 			page 186


2437:bluetooth_rxtx.c **** 		hop_direct_channel = 2406;
 6835              		.loc 1 2437 0
 6836 0028 40F66613 		movw	r3, #2406
 6837 002c 48E0     		b	.L741
 6838              	.L739:
2438:bluetooth_rxtx.c **** 		do_hop = 1;
2439:bluetooth_rxtx.c **** 	} else if (channel == 2406) {
 6839              		.loc 1 2439 0
 6840 002e 1088     		ldrh	r0, [r2]
 6841              	.LVL691:
 6842 0030 40F66611 		movw	r1, #2406
 6843 0034 80B2     		uxth	r0, r0
 6844 0036 8842     		cmp	r0, r1
 6845 0038 42D1     		bne	.L741
 6846              	.LVL692:
 6847              	.LBB68:
 6848              	.LBB69:
 6849              	.LBB70:
2440:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 6850              		.loc 1 2440 0
 6851 003a 254B     		ldr	r3, .L747+8
 6852 003c 2549     		ldr	r1, .L747+12
 6853 003e 1B68     		ldr	r3, [r3]
 6854 0040 0968     		ldr	r1, [r1]
 6855 0042 40F63540 		movw	r0, #3125
 6856 0046 C3F31303 		ubfx	r3, r3, #0, #20
 6857 004a 00FB0313 		mla	r3, r0, r3, r1
 6858              	.LVL693:
2441:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 6859              		.loc 1 2441 0
 6860 004e A06B     		ldr	r0, [r4, #56]
2442:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
2443:bluetooth_rxtx.c **** 		// Number of channels hopped between previous and current timestamp.
2444:bluetooth_rxtx.c **** 		u32 channels_hopped = DIVIDE_ROUND(second_ts - first_ts,
 6861              		.loc 1 2444 0
 6862 0050 528C     		ldrh	r2, [r2, #34]
2441:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 6863              		.loc 1 2441 0
 6864 0052 8342     		cmp	r3, r0
2442:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
 6865              		.loc 1 2442 0
 6866 0054 3CBF     		itt	cc
 6867 0056 03F14343 		addcc	r3, r3, #-1023410176
 6868              	.LVL694:
 6869 005a 03F5A003 		addcc	r3, r3, #5242880
 6870              	.LVL695:
 6871              		.loc 1 2444 0
 6872 005e 1B1A     		subs	r3, r3, r0
 6873              	.LVL696:
 6874 0060 43F2D405 		movw	r5, #12500
 6875 0064 41F66A00 		movw	r0, #6250
 6876 0068 00FB0233 		mla	r3, r0, r2, r3
 6877 006c 5543     		muls	r5, r2, r5
 6878 006e B3FBF5F3 		udiv	r3, r3, r5
 6879              	.LVL697:
2445:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
2446:bluetooth_rxtx.c **** 		if (channels_hopped < 37) {
ARM GAS  /tmp/ccwLngFB.s 			page 187


 6880              		.loc 1 2446 0
 6881 0072 242B     		cmp	r3, #36
2444:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
 6882              		.loc 1 2444 0
 6883 0074 1449     		ldr	r1, .L747
 6884              		.loc 1 2446 0
 6885 0076 21D8     		bhi	.L743
2447:bluetooth_rxtx.c **** 			// Get the hop increment based on the number of channels hopped.
2448:bluetooth_rxtx.c **** 			le.channel_increment = hop_interval_lut[channels_hopped];
 6886              		.loc 1 2448 0
 6887 0078 1748     		ldr	r0, .L747+16
2449:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 6888              		.loc 1 2449 0
 6889 007a 5208     		lsrs	r2, r2, #1
2448:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 6890              		.loc 1 2448 0
 6891 007c 0344     		add	r3, r3, r0
 6892              	.LVL698:
 6893 007e 93F87008 		ldrb	r0, [r3, #2160]	@ zero_extendqisi2
 6894              		.loc 1 2449 0
 6895 0082 0A84     		strh	r2, [r1, #32]	@ movhi
2448:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 6896              		.loc 1 2448 0
 6897 0084 8876     		strb	r0, [r1, #26]
2450:bluetooth_rxtx.c **** 			le.conn_count = 0;
2451:bluetooth_rxtx.c **** 			le.conn_epoch = 0;
2452:bluetooth_rxtx.c **** 			do_hop = 0;
2453:bluetooth_rxtx.c **** 			// Move on to regular connection following.
2454:bluetooth_rxtx.c **** 			le.channel_idx = (1 + le.channel_increment) % 37;
 6898              		.loc 1 2454 0
 6899 0086 2522     		movs	r2, #37
 6900 0088 0130     		adds	r0, r0, #1
 6901 008a 90FBF2F5 		sdiv	r5, r0, r2
 6902 008e 02FB1502 		mls	r2, r2, r5, r0
2450:bluetooth_rxtx.c **** 			le.conn_count = 0;
 6903              		.loc 1 2450 0
 6904 0092 0023     		movs	r3, #0
 6905              	.LVL699:
 6906 0094 8B84     		strh	r3, [r1, #36]	@ movhi
2451:bluetooth_rxtx.c **** 			do_hop = 0;
 6907              		.loc 1 2451 0
 6908 0096 CB61     		str	r3, [r1, #28]
2452:bluetooth_rxtx.c **** 			// Move on to regular connection following.
 6909              		.loc 1 2452 0
 6910 0098 E372     		strb	r3, [r4, #11]
2455:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 6911              		.loc 1 2455 0
 6912 009a 0320     		movs	r0, #3
2456:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 6913              		.loc 1 2456 0
 6914 009c 4B61     		str	r3, [r1, #20]
2457:bluetooth_rxtx.c **** 			hop_mode = HOP_BTLE;
2458:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 6915              		.loc 1 2458 0
 6916 009e 0F4B     		ldr	r3, .L747+20
2454:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 6917              		.loc 1 2454 0
ARM GAS  /tmp/ccwLngFB.s 			page 188


 6918 00a0 4A76     		strb	r2, [r1, #25]
2455:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 6919              		.loc 1 2455 0
 6920 00a2 0876     		strb	r0, [r1, #24]
2459:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 6921              		.loc 1 2459 0
 6922 00a4 0122     		movs	r2, #1
 6923 00a6 1A31     		adds	r1, r1, #26
2458:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 6924              		.loc 1 2458 0
 6925 00a8 A361     		str	r3, [r4, #24]
2457:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 6926              		.loc 1 2457 0
 6927 00aa A072     		strb	r0, [r4, #10]
 6928              		.loc 1 2459 0
 6929 00ac FFF7FEFF 		bl	le_promisc_state
 6930              	.LVL700:
2460:bluetooth_rxtx.c **** 
2461:bluetooth_rxtx.c **** 			if (jam_mode != JAM_NONE)
 6931              		.loc 1 2461 0
 6932 00b0 E37C     		ldrb	r3, [r4, #19]	@ zero_extendqisi2
 6933 00b2 43B1     		cbz	r3, .L738
2462:bluetooth_rxtx.c **** 				le_jam_count = JAM_COUNT_DEFAULT;
 6934              		.loc 1 2462 0
 6935 00b4 054B     		ldr	r3, .L747+4
 6936 00b6 2822     		movs	r2, #40
 6937 00b8 DA61     		str	r2, [r3, #28]
 6938 00ba 38BD     		pop	{r3, r4, r5, pc}
 6939              	.LVL701:
 6940              	.L743:
2463:bluetooth_rxtx.c **** 
2464:bluetooth_rxtx.c **** 			return;
2465:bluetooth_rxtx.c **** 		}
2466:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 6941              		.loc 1 2466 0
 6942 00bc 40F66413 		movw	r3, #2404
 6943              	.LVL702:
 6944              	.L741:
 6945              	.LBE70:
 6946              	.LBE69:
 6947              	.LBE68:
2467:bluetooth_rxtx.c **** 		do_hop = 1;
2468:bluetooth_rxtx.c **** 	}
2469:bluetooth_rxtx.c **** 	else {
2470:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 6948              		.loc 1 2470 0
 6949 00c0 A381     		strh	r3, [r4, #12]	@ movhi
2471:bluetooth_rxtx.c **** 		do_hop = 1;
 6950              		.loc 1 2471 0
 6951 00c2 0123     		movs	r3, #1
 6952 00c4 E372     		strb	r3, [r4, #11]
 6953              	.L738:
 6954 00c6 38BD     		pop	{r3, r4, r5, pc}
 6955              	.L748:
 6956              		.align	2
 6957              	.L747:
 6958 00c8 00000000 		.word	.LANCHOR1
ARM GAS  /tmp/ccwLngFB.s 			page 189


 6959 00cc 00000000 		.word	.LANCHOR0
 6960 00d0 00000000 		.word	clkn
 6961 00d4 08400040 		.word	1073758216
 6962 00d8 00000000 		.word	.LANCHOR2
 6963 00dc 00000000 		.word	connection_follow_cb
 6964              		.cfi_endproc
 6965              	.LFE31:
 6967              		.section	.text.promisc_recover_hop_interval,"ax",%progbits
 6968              		.align	1
 6969              		.global	promisc_recover_hop_interval
 6970              		.thumb
 6971              		.thumb_func
 6973              	promisc_recover_hop_interval:
 6974              	.LFB32:
2472:bluetooth_rxtx.c **** 	}
2473:bluetooth_rxtx.c **** }
2474:bluetooth_rxtx.c **** 
2475:bluetooth_rxtx.c **** void promisc_recover_hop_interval(u8 *packet) {
 6975              		.loc 1 2475 0
 6976              		.cfi_startproc
 6977              		@ args = 0, pretend = 0, frame = 0
 6978              		@ frame_needed = 0, uses_anonymous_args = 0
 6979              	.LVL703:
 6980 0000 38B5     		push	{r3, r4, r5, lr}
 6981              		.cfi_def_cfa_offset 16
 6982              		.cfi_offset 3, -16
 6983              		.cfi_offset 4, -12
 6984              		.cfi_offset 5, -8
 6985              		.cfi_offset 14, -4
2476:bluetooth_rxtx.c **** 	static u32 prev_clk = 0;
2477:bluetooth_rxtx.c **** 
2478:bluetooth_rxtx.c **** 	u32 cur_clk = CLK100NS;
 6986              		.loc 1 2478 0
 6987 0002 254B     		ldr	r3, .L755
 6988 0004 40F63542 		movw	r2, #3125
 6989 0008 1C68     		ldr	r4, [r3]
 6990 000a 244B     		ldr	r3, .L755+4
 6991 000c C4F31304 		ubfx	r4, r4, #0, #20
 6992 0010 1B68     		ldr	r3, [r3]
2479:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 6993              		.loc 1 2479 0
 6994 0012 234D     		ldr	r5, .L755+8
2478:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 6995              		.loc 1 2478 0
 6996 0014 02FB0434 		mla	r4, r2, r4, r3
 6997              	.LVL704:
 6998              		.loc 1 2479 0
 6999 0018 EB6B     		ldr	r3, [r5, #60]
 7000 001a 9C42     		cmp	r4, r3
 7001 001c 05D2     		bcs	.L750
2480:bluetooth_rxtx.c **** 		cur_clk += 3267800000; // handle rollover
 7002              		.loc 1 2480 0
 7003 001e 04F14344 		add	r4, r4, #-1023410176
 7004              	.LVL705:
 7005 0022 A4F56514 		sub	r4, r4, #3751936
 7006              	.LVL706:
 7007 0026 A4F5A254 		sub	r4, r4, #5184
ARM GAS  /tmp/ccwLngFB.s 			page 190


 7008              	.LVL707:
 7009              	.L750:
2481:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
 7010              		.loc 1 2481 0
 7011 002a E31A     		subs	r3, r4, r3
 7012              	.LVL708:
2482:bluetooth_rxtx.c **** 	u16 obsv_hop_interval; // observed hop interval
2483:bluetooth_rxtx.c **** 
2484:bluetooth_rxtx.c **** 	// probably consecutive data packets on the same channel
2485:bluetooth_rxtx.c **** 	if (clk_diff < 2 * LE_BASECLK)
 7013              		.loc 1 2485 0
 7014 002c 46F2A712 		movw	r2, #24999
 7015 0030 9342     		cmp	r3, r2
 7016 0032 30D9     		bls	.L749
2486:bluetooth_rxtx.c **** 		return;
2487:bluetooth_rxtx.c **** 
2488:bluetooth_rxtx.c **** 	if (clk_diff < le_promisc.smallest_hop_interval)
 7017              		.loc 1 2488 0
 7018 0034 1B4A     		ldr	r2, .L755+12
 7019 0036 D2F80011 		ldr	r1, [r2, #256]
 7020 003a 8B42     		cmp	r3, r1
2489:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
 7021              		.loc 1 2489 0
 7022 003c 38BF     		it	cc
 7023 003e C2F80031 		strcc	r3, [r2, #256]
2490:bluetooth_rxtx.c **** 
2491:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(le_promisc.smallest_hop_interval, 37 * LE_BASECLK);
 7024              		.loc 1 2491 0
 7025 0042 D2F80021 		ldr	r2, [r2, #256]
 7026 0046 1849     		ldr	r1, .L755+16
 7027 0048 02F56132 		add	r2, r2, #230400
 7028 004c 02F25232 		addw	r2, r2, #850
 7029 0050 B2FBF1F2 		udiv	r2, r2, r1
2492:bluetooth_rxtx.c **** 
2493:bluetooth_rxtx.c **** 	if (le.conn_interval == obsv_hop_interval) {
 7030              		.loc 1 2493 0
 7031 0054 1549     		ldr	r1, .L755+20
2491:bluetooth_rxtx.c **** 
 7032              		.loc 1 2491 0
 7033 0056 92B2     		uxth	r2, r2
 7034              	.LVL709:
 7035              		.loc 1 2493 0
 7036 0058 488C     		ldrh	r0, [r1, #34]
 7037              	.LVL710:
2491:bluetooth_rxtx.c **** 
 7038              		.loc 1 2491 0
 7039 005a 124B     		ldr	r3, .L755+12
 7040              	.LVL711:
 7041              		.loc 1 2493 0
 7042 005c 9042     		cmp	r0, r2
 7043 005e 15D1     		bne	.L753
2494:bluetooth_rxtx.c **** 		// 5 consecutive hop intervals: consider it legit and move on
2495:bluetooth_rxtx.c **** 		++le_promisc.consec_intervals;
 7044              		.loc 1 2495 0
 7045 0060 D3F80421 		ldr	r2, [r3, #260]
 7046              	.LVL712:
 7047 0064 0132     		adds	r2, r2, #1
ARM GAS  /tmp/ccwLngFB.s 			page 191


2496:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 7048              		.loc 1 2496 0
 7049 0066 052A     		cmp	r2, #5
2495:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 7050              		.loc 1 2495 0
 7051 0068 C3F80421 		str	r2, [r3, #260]
 7052              		.loc 1 2496 0
 7053 006c 12D1     		bne	.L754
2497:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 7054              		.loc 1 2497 0
 7055 006e 104B     		ldr	r3, .L755+24
2498:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
2499:bluetooth_rxtx.c **** 			hop_mode = HOP_DIRECT;
2500:bluetooth_rxtx.c **** 			do_hop = 1;
2501:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 7056              		.loc 1 2501 0
 7057 0070 0220     		movs	r0, #2
2497:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 7058              		.loc 1 2497 0
 7059 0072 AB61     		str	r3, [r5, #24]
2498:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
 7060              		.loc 1 2498 0
 7061 0074 40F66413 		movw	r3, #2404
 7062 0078 AB81     		strh	r3, [r5, #12]	@ movhi
2499:bluetooth_rxtx.c **** 			do_hop = 1;
 7063              		.loc 1 2499 0
 7064 007a 0423     		movs	r3, #4
 7065 007c AB72     		strb	r3, [r5, #10]
 7066              		.loc 1 2501 0
 7067 007e 2231     		adds	r1, r1, #34
2500:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 7068              		.loc 1 2500 0
 7069 0080 0123     		movs	r3, #1
 7070              		.loc 1 2501 0
 7071 0082 0246     		mov	r2, r0
2500:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 7072              		.loc 1 2500 0
 7073 0084 EB72     		strb	r3, [r5, #11]
 7074              		.loc 1 2501 0
 7075 0086 FFF7FEFF 		bl	le_promisc_state
 7076              	.LVL713:
 7077 008a 03E0     		b	.L754
 7078              	.LVL714:
 7079              	.L753:
2502:bluetooth_rxtx.c **** 		}
2503:bluetooth_rxtx.c **** 	} else {
2504:bluetooth_rxtx.c **** 		le.conn_interval = obsv_hop_interval;
 7080              		.loc 1 2504 0
 7081 008c 4A84     		strh	r2, [r1, #34]	@ movhi
2505:bluetooth_rxtx.c **** 		le_promisc.consec_intervals = 0;
 7082              		.loc 1 2505 0
 7083 008e 0022     		movs	r2, #0
 7084              	.LVL715:
 7085 0090 C3F80421 		str	r2, [r3, #260]
 7086              	.LVL716:
 7087              	.L754:
2506:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/ccwLngFB.s 			page 192


2507:bluetooth_rxtx.c **** 
2508:bluetooth_rxtx.c **** 	prev_clk = cur_clk;
 7088              		.loc 1 2508 0
 7089 0094 EC63     		str	r4, [r5, #60]
 7090              	.L749:
 7091 0096 38BD     		pop	{r3, r4, r5, pc}
 7092              	.LVL717:
 7093              	.L756:
 7094              		.align	2
 7095              	.L755:
 7096 0098 00000000 		.word	clkn
 7097 009c 08400040 		.word	1073758216
 7098 00a0 00000000 		.word	.LANCHOR0
 7099 00a4 00000000 		.word	le_promisc
 7100 00a8 A40E0700 		.word	462500
 7101 00ac 00000000 		.word	.LANCHOR1
 7102 00b0 00000000 		.word	promisc_recover_hop_increment
 7103              		.cfi_endproc
 7104              	.LFE32:
 7106              		.section	.text.promisc_follow_cb,"ax",%progbits
 7107              		.align	1
 7108              		.global	promisc_follow_cb
 7109              		.thumb
 7110              		.thumb_func
 7112              	promisc_follow_cb:
 7113              	.LFB33:
2509:bluetooth_rxtx.c **** }
2510:bluetooth_rxtx.c **** 
2511:bluetooth_rxtx.c **** void promisc_follow_cb(u8 *packet) {
 7114              		.loc 1 2511 0
 7115              		.cfi_startproc
 7116              		@ args = 0, pretend = 0, frame = 0
 7117              		@ frame_needed = 0, uses_anonymous_args = 0
 7118              	.LVL718:
 7119 0000 38B5     		push	{r3, r4, r5, lr}
 7120              		.cfi_def_cfa_offset 16
 7121              		.cfi_offset 3, -16
 7122              		.cfi_offset 4, -12
 7123              		.cfi_offset 5, -8
 7124              		.cfi_offset 14, -4
2512:bluetooth_rxtx.c **** 	int i;
2513:bluetooth_rxtx.c **** 
2514:bluetooth_rxtx.c **** 	// get the CRCInit
2515:bluetooth_rxtx.c **** 	if (!le.crc_verify && packet[4] == 0x01 && packet[5] == 0x00) {
 7125              		.loc 1 2515 0
 7126 0002 184C     		ldr	r4, .L762
2511:bluetooth_rxtx.c **** 	int i;
 7127              		.loc 1 2511 0
 7128 0004 0146     		mov	r1, r0
 7129              		.loc 1 2515 0
 7130 0006 6369     		ldr	r3, [r4, #20]
 7131 0008 53BB     		cbnz	r3, .L757
 7132              		.loc 1 2515 0 is_stmt 0 discriminator 1
 7133 000a 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 7134 000c 012B     		cmp	r3, #1
 7135 000e 27D1     		bne	.L757
 7136 0010 4579     		ldrb	r5, [r0, #5]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 193


 7137 0012 2DBB     		cbnz	r5, .L757
 7138              	.LVL719:
 7139              	.LBB74:
 7140              	.LBB75:
 7141              	.LBB76:
2516:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 7142              		.loc 1 2516 0 is_stmt 1
 7143 0014 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 7144 0016 C079     		ldrb	r0, [r0, #7]	@ zero_extendqisi2
 7145              	.LVL720:
2517:bluetooth_rxtx.c **** 
2518:bluetooth_rxtx.c **** 		le.crc_init = btle_reverse_crc(crc, packet + 4, 2);
 7146              		.loc 1 2518 0
 7147 0018 0222     		movs	r2, #2
2516:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 7148              		.loc 1 2516 0
 7149 001a 0002     		lsls	r0, r0, #8
 7150 001c 40EA0340 		orr	r0, r0, r3, lsl #16
 7151 0020 8B79     		ldrb	r3, [r1, #6]	@ zero_extendqisi2
 7152              		.loc 1 2518 0
 7153 0022 0431     		adds	r1, r1, #4
 7154              	.LVL721:
 7155 0024 1843     		orrs	r0, r0, r3
 7156 0026 FFF7FEFF 		bl	btle_reverse_crc
 7157              	.LVL722:
 7158 002a 2A46     		mov	r2, r5
 7159 002c E060     		str	r0, [r4, #12]
 7160              	.LVL723:
2519:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
2520:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 7161              		.loc 1 2520 0
 7162 002e 2B46     		mov	r3, r5
 7163              	.LVL724:
 7164              	.L760:
2521:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 7165              		.loc 1 2521 0
 7166 0030 20FA03F1 		lsr	r1, r0, r3
 7167 0034 C3F11705 		rsb	r5, r3, #23
 7168 0038 01F00101 		and	r1, r1, #1
 7169 003c A940     		lsls	r1, r1, r5
2520:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 7170              		.loc 1 2520 0
 7171 003e 0133     		adds	r3, r3, #1
 7172              	.LVL725:
 7173 0040 182B     		cmp	r3, #24
 7174              		.loc 1 2521 0
 7175 0042 42EA0102 		orr	r2, r2, r1
2520:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 7176              		.loc 1 2520 0
 7177 0046 F3D1     		bne	.L760
 7178 0048 2261     		str	r2, [r4, #16]
2522:bluetooth_rxtx.c **** 
2523:bluetooth_rxtx.c **** 		le.crc_verify = 1;
2524:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 7179              		.loc 1 2524 0
 7180 004a 074B     		ldr	r3, .L762+4
 7181              	.LVL726:
ARM GAS  /tmp/ccwLngFB.s 			page 194


 7182 004c 074A     		ldr	r2, .L762+8
2523:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 7183              		.loc 1 2523 0
 7184 004e 0120     		movs	r0, #1
 7185              		.loc 1 2524 0
 7186 0050 9A61     		str	r2, [r3, #24]
2523:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 7187              		.loc 1 2523 0
 7188 0052 6061     		str	r0, [r4, #20]
2525:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 7189              		.loc 1 2525 0
 7190 0054 0649     		ldr	r1, .L762+12
 7191 0056 0322     		movs	r2, #3
 7192              	.LBE76:
 7193              	.LBE75:
 7194              	.LBE74:
2526:bluetooth_rxtx.c **** 	}
2527:bluetooth_rxtx.c **** }
 7195              		.loc 1 2527 0
 7196 0058 BDE83840 		pop	{r3, r4, r5, lr}
 7197              	.LBB79:
 7198              	.LBB78:
 7199              	.LBB77:
2525:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 7200              		.loc 1 2525 0
 7201 005c FFF7FEBF 		b	le_promisc_state
 7202              	.LVL727:
 7203              	.L757:
 7204 0060 38BD     		pop	{r3, r4, r5, pc}
 7205              	.L763:
 7206 0062 00BF     		.align	2
 7207              	.L762:
 7208 0064 00000000 		.word	.LANCHOR1
 7209 0068 00000000 		.word	.LANCHOR0
 7210 006c 00000000 		.word	promisc_recover_hop_interval
 7211 0070 0C000000 		.word	.LANCHOR1+12
 7212              	.LBE77:
 7213              	.LBE78:
 7214              	.LBE79:
 7215              		.cfi_endproc
 7216              	.LFE33:
 7218              		.section	.text.see_aa,"ax",%progbits
 7219              		.align	1
 7220              		.global	see_aa
 7221              		.thumb
 7222              		.thumb_func
 7224              	see_aa:
 7225              	.LFB34:
2528:bluetooth_rxtx.c **** 
2529:bluetooth_rxtx.c **** // called when we see an AA, add it to the list
2530:bluetooth_rxtx.c **** void see_aa(u32 aa) {
 7226              		.loc 1 2530 0
 7227              		.cfi_startproc
 7228              		@ args = 0, pretend = 0, frame = 0
 7229              		@ frame_needed = 0, uses_anonymous_args = 0
 7230              	.LVL728:
 7231 0000 30B5     		push	{r4, r5, lr}
ARM GAS  /tmp/ccwLngFB.s 			page 195


 7232              		.cfi_def_cfa_offset 12
 7233              		.cfi_offset 4, -12
 7234              		.cfi_offset 5, -8
 7235              		.cfi_offset 14, -4
 7236              	.LVL729:
2531:bluetooth_rxtx.c **** 	int i, max = -1, killme = -1;
2532:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
 7237              		.loc 1 2532 0
 7238 0002 0022     		movs	r2, #0
 7239              	.LVL730:
 7240              	.L768:
2533:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 7241              		.loc 1 2533 0
 7242 0004 144D     		ldr	r5, .L777
 7243 0006 55F83210 		ldr	r1, [r5, r2, lsl #3]
 7244 000a 05EBC203 		add	r3, r5, r2, lsl #3
 7245 000e 8142     		cmp	r1, r0
 7246 0010 02D1     		bne	.L765
2534:bluetooth_rxtx.c **** 			++le_promisc.active_aa[i].count;
 7247              		.loc 1 2534 0
 7248 0012 5A68     		ldr	r2, [r3, #4]
 7249              	.LVL731:
 7250 0014 0132     		adds	r2, r2, #1
 7251 0016 1CE0     		b	.L776
 7252              	.LVL732:
 7253              	.L765:
2532:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 7254              		.loc 1 2532 0
 7255 0018 0132     		adds	r2, r2, #1
 7256              	.LVL733:
 7257 001a 202A     		cmp	r2, #32
 7258 001c F2D1     		bne	.L768
 7259 001e 4FF0FF33 		mov	r3, #-1
 7260 0022 1946     		mov	r1, r3
 7261 0024 0022     		movs	r2, #0
 7262              	.LVL734:
 7263              	.L771:
 7264 0026 05EBC204 		add	r4, r5, r2, lsl #3
2535:bluetooth_rxtx.c **** 			return;
2536:bluetooth_rxtx.c **** 		}
2537:bluetooth_rxtx.c **** 
2538:bluetooth_rxtx.c **** 	// evict someone
2539:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
2540:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 7265              		.loc 1 2540 0
 7266 002a 6468     		ldr	r4, [r4, #4]
 7267 002c 8C42     		cmp	r4, r1
 7268 002e 05DB     		blt	.L772
 7269              		.loc 1 2540 0 is_stmt 0 discriminator 1
 7270 0030 0029     		cmp	r1, #0
 7271 0032 A8BF     		it	ge
 7272 0034 0C46     		movge	r4, r1
 7273 0036 B8BF     		it	lt
 7274 0038 1346     		movlt	r3, r2
 7275              	.LVL735:
 7276 003a 00E0     		b	.L769
 7277              	.LVL736:
ARM GAS  /tmp/ccwLngFB.s 			page 196


 7278              	.L772:
 7279 003c 1346     		mov	r3, r2
 7280              	.LVL737:
 7281              	.L769:
2539:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 7282              		.loc 1 2539 0 is_stmt 1
 7283 003e 0132     		adds	r2, r2, #1
 7284              	.LVL738:
 7285 0040 202A     		cmp	r2, #32
 7286 0042 01D0     		beq	.L770
 7287 0044 2146     		mov	r1, r4
 7288 0046 EEE7     		b	.L771
 7289              	.L770:
2541:bluetooth_rxtx.c **** 			killme = i;
2542:bluetooth_rxtx.c **** 			max = le_promisc.active_aa[i].count;
2543:bluetooth_rxtx.c **** 		}
2544:bluetooth_rxtx.c **** 
2545:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].aa = aa;
 7290              		.loc 1 2545 0
 7291 0048 45F83300 		str	r0, [r5, r3, lsl #3]
2546:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 7292              		.loc 1 2546 0
 7293 004c 0122     		movs	r2, #1
 7294              	.LVL739:
 7295 004e 05EBC303 		add	r3, r5, r3, lsl #3
 7296              	.LVL740:
 7297              	.L776:
 7298 0052 5A60     		str	r2, [r3, #4]
 7299 0054 30BD     		pop	{r4, r5, pc}
 7300              	.L778:
 7301 0056 00BF     		.align	2
 7302              	.L777:
 7303 0058 00000000 		.word	le_promisc
 7304              		.cfi_endproc
 7305              	.LFE34:
 7307              		.section	.text.cb_le_promisc,"ax",%progbits
 7308              		.align	1
 7309              		.global	cb_le_promisc
 7310              		.thumb
 7311              		.thumb_func
 7313              	cb_le_promisc:
 7314              	.LFB35:
2547:bluetooth_rxtx.c **** }
2548:bluetooth_rxtx.c **** 
2549:bluetooth_rxtx.c **** /* le promiscuous mode */
2550:bluetooth_rxtx.c **** int cb_le_promisc(char *unpacked) {
 7315              		.loc 1 2550 0
 7316              		.cfi_startproc
 7317              		@ args = 0, pretend = 0, frame = 80
 7318              		@ frame_needed = 0, uses_anonymous_args = 0
 7319              	.LVL741:
 7320 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 7321              		.cfi_def_cfa_offset 28
 7322              		.cfi_offset 4, -28
 7323              		.cfi_offset 5, -24
 7324              		.cfi_offset 6, -20
 7325              		.cfi_offset 7, -16
ARM GAS  /tmp/ccwLngFB.s 			page 197


 7326              		.cfi_offset 8, -12
 7327              		.cfi_offset 9, -8
 7328              		.cfi_offset 14, -4
 7329 0004 95B0     		sub	sp, sp, #84
 7330              		.cfi_def_cfa_offset 112
2551:bluetooth_rxtx.c **** 	int i, j, k;
2552:bluetooth_rxtx.c **** 	int idx;
2553:bluetooth_rxtx.c **** 
2554:bluetooth_rxtx.c **** 	// empty data PDU: 01 00
2555:bluetooth_rxtx.c **** 	char desired[4][16] = {
 7331              		.loc 1 2555 0
 7332 0006 0021     		movs	r1, #0
2550:bluetooth_rxtx.c **** 	int i, j, k;
 7333              		.loc 1 2550 0
 7334 0008 8046     		mov	r8, r0
 7335              		.loc 1 2555 0
 7336 000a 4022     		movs	r2, #64
 7337 000c 04A8     		add	r0, sp, #16
 7338              	.LVL742:
 7339 000e FFF7FEFF 		bl	memset
 7340              	.LVL743:
 7341 0012 0123     		movs	r3, #1
 7342 0014 8DF81030 		strb	r3, [sp, #16]
 7343 0018 8DF82030 		strb	r3, [sp, #32]
 7344 001c 8DF82330 		strb	r3, [sp, #35]
 7345 0020 8DF83030 		strb	r3, [sp, #48]
 7346 0024 8DF83230 		strb	r3, [sp, #50]
 7347 0028 8DF84030 		strb	r3, [sp, #64]
 7348 002c 8DF84230 		strb	r3, [sp, #66]
 7349 0030 8DF84330 		strb	r3, [sp, #67]
 7350              	.LVL744:
 7351 0034 14AD     		add	r5, sp, #80
 7352 0036 04AC     		add	r4, sp, #16
 7353              	.LVL745:
 7354              	.L783:
2556:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
2557:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2558:bluetooth_rxtx.c **** 		{ 1, 0, 0, 1, 0, 0, 0, 0,
2559:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2560:bluetooth_rxtx.c **** 		{ 1, 0, 1, 0, 0, 0, 0, 0,
2561:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2562:bluetooth_rxtx.c **** 		{ 1, 0, 1, 1, 0, 0, 0, 0,
2563:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2564:bluetooth_rxtx.c **** 	};
2565:bluetooth_rxtx.c **** 
2566:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
2567:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 7355              		.loc 1 2567 0
 7356 0038 504E     		ldr	r6, .L815
 7357 003a 514F     		ldr	r7, .L815+4
 7358 003c 3088     		ldrh	r0, [r6]
 7359 003e 80B2     		uxth	r0, r0
 7360 0040 6238     		subs	r0, r0, #98
 7361 0042 C0B2     		uxtb	r0, r0
 7362 0044 FFF7FEFF 		bl	btle_channel_index
 7363              	.LVL746:
 7364 0048 3A5C     		ldrb	r2, [r7, r0]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 198


 7365              	.LVL747:
2568:bluetooth_rxtx.c **** 
2569:bluetooth_rxtx.c **** 		// whiten the desired data
2570:bluetooth_rxtx.c **** 		for (j = 0; j < (int)sizeof(desired[i]); ++j) {
 7366              		.loc 1 2570 0
 7367 004a 0023     		movs	r3, #0
 7368              	.LVL748:
 7369              	.L781:
2571:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7370              		.loc 1 2571 0 discriminator 2
 7371 004c B918     		adds	r1, r7, r2
 7372 004e E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 7373 0050 91F82810 		ldrb	r1, [r1, #40]	@ zero_extendqisi2
2572:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 7374              		.loc 1 2572 0 discriminator 2
 7375 0054 0132     		adds	r2, r2, #1
 7376              	.LVL749:
2571:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7377              		.loc 1 2571 0 discriminator 2
 7378 0056 4140     		eors	r1, r1, r0
 7379 0058 E154     		strb	r1, [r4, r3]
 7380              		.loc 1 2572 0 discriminator 2
 7381 005a 7F21     		movs	r1, #127
2570:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7382              		.loc 1 2570 0 discriminator 2
 7383 005c 0133     		adds	r3, r3, #1
 7384              	.LVL750:
 7385              		.loc 1 2572 0 discriminator 2
 7386 005e B2FBF1F0 		udiv	r0, r2, r1
2570:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7387              		.loc 1 2570 0 discriminator 2
 7388 0062 102B     		cmp	r3, #16
 7389              		.loc 1 2572 0 discriminator 2
 7390 0064 01FB1022 		mls	r2, r1, r0, r2
 7391              	.LVL751:
2570:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7392              		.loc 1 2570 0 discriminator 2
 7393 0068 F0D1     		bne	.L781
 7394 006a 1034     		adds	r4, r4, #16
2566:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 7395              		.loc 1 2566 0
 7396 006c AC42     		cmp	r4, r5
 7397 006e E3D1     		bne	.L783
 7398 0070 08F12005 		add	r5, r8, #32
 7399 0074 08F53C78 		add	r8, r8, #752
 7400              	.LVL752:
 7401              	.L799:
 7402              	.LBB80:
2573:bluetooth_rxtx.c **** 		}
2574:bluetooth_rxtx.c **** 	}
2575:bluetooth_rxtx.c **** 
2576:bluetooth_rxtx.c **** 	// then look for that bitsream in our receive buffer
2577:bluetooth_rxtx.c **** 	for (i = 32; i < (DMA_SIZE*8*2 - 32 - 16); i++) {
2578:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 7403              		.loc 1 2578 0
 7404 0078 424B     		ldr	r3, .L815+8
 7405 007a 6C46     		mov	r4, sp
ARM GAS  /tmp/ccwLngFB.s 			page 199


 7406 007c 0FCB     		ldmia	r3, {r0, r1, r2, r3}
 7407 007e 8DE80F00 		stmia	sp, {r0, r1, r2, r3}
 7408              	.LVL753:
 7409 0082 0022     		movs	r2, #0
 7410              	.LVL754:
 7411              	.L784:
 7412 0084 04AB     		add	r3, sp, #16
 7413 0086 03EB8201 		add	r1, r3, r2, lsl #2
 7414              	.LBE80:
2570:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7415              		.loc 1 2570 0 discriminator 1
 7416 008a 0023     		movs	r3, #0
 7417              	.LVL755:
 7418              	.L789:
 7419              	.LBB85:
2579:bluetooth_rxtx.c **** 		int matching = -1;
2580:bluetooth_rxtx.c **** 
2581:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2582:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
2583:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 7420              		.loc 1 2583 0
 7421 008c 15F803C0 		ldrb	ip, [r5, r3]	@ zero_extendqisi2
 7422 0090 C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
 7423 0092 8445     		cmp	ip, r0
 7424 0094 02D0     		beq	.L785
2584:bluetooth_rxtx.c **** 					ok[j] = 0;
 7425              		.loc 1 2584 0
 7426 0096 0023     		movs	r3, #0
 7427              	.LVL756:
 7428 0098 A350     		str	r3, [r4, r2]
2585:bluetooth_rxtx.c **** 					break;
 7429              		.loc 1 2585 0
 7430 009a 02E0     		b	.L786
 7431              	.LVL757:
 7432              	.L785:
2582:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 7433              		.loc 1 2582 0
 7434 009c 0133     		adds	r3, r3, #1
 7435              	.LVL758:
 7436 009e 102B     		cmp	r3, #16
 7437 00a0 F4D1     		bne	.L789
 7438              	.LVL759:
 7439              	.L786:
 7440 00a2 0432     		adds	r2, r2, #4
2581:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 7441              		.loc 1 2581 0
 7442 00a4 102A     		cmp	r2, #16
 7443 00a6 EDD1     		bne	.L784
 7444 00a8 0023     		movs	r3, #0
 7445              	.L792:
2586:bluetooth_rxtx.c **** 				}
2587:bluetooth_rxtx.c **** 			}
2588:bluetooth_rxtx.c **** 		}
2589:bluetooth_rxtx.c **** 
2590:bluetooth_rxtx.c **** 		// see if any match
2591:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2592:bluetooth_rxtx.c **** 			if (ok[j]) {
ARM GAS  /tmp/ccwLngFB.s 			page 200


 7446              		.loc 1 2592 0
 7447 00aa E258     		ldr	r2, [r4, r3]
 7448 00ac 1AB9     		cbnz	r2, .L790
 7449 00ae 0433     		adds	r3, r3, #4
2591:bluetooth_rxtx.c **** 			if (ok[j]) {
 7450              		.loc 1 2591 0
 7451 00b0 102B     		cmp	r3, #16
 7452 00b2 FAD1     		bne	.L792
 7453 00b4 3EE0     		b	.L803
 7454              	.L790:
 7455              	.LVL760:
2593:bluetooth_rxtx.c **** 				matching = j;
2594:bluetooth_rxtx.c **** 				break;
2595:bluetooth_rxtx.c **** 			}
2596:bluetooth_rxtx.c **** 		}
2597:bluetooth_rxtx.c **** 
2598:bluetooth_rxtx.c **** 		// skip if no match
2599:bluetooth_rxtx.c **** 		if (matching < 0)
2600:bluetooth_rxtx.c **** 			continue;
2601:bluetooth_rxtx.c **** 
2602:bluetooth_rxtx.c **** 		// found a match! unwhiten it and send it home
2603:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 7456              		.loc 1 2603 0
 7457 00b6 3088     		ldrh	r0, [r6]
 7458 00b8 80B2     		uxth	r0, r0
 7459 00ba 6238     		subs	r0, r0, #98
 7460 00bc C0B2     		uxtb	r0, r0
 7461 00be FFF7FEFF 		bl	btle_channel_index
 7462              	.LVL761:
 7463 00c2 385C     		ldrb	r0, [r7, r0]	@ zero_extendqisi2
 7464              	.LVL762:
2604:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 7465              		.loc 1 2604 0
 7466 00c4 0023     		movs	r3, #0
 7467              	.LVL763:
 7468              	.L804:
2581:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 7469              		.loc 1 2581 0 discriminator 1
 7470 00c6 0021     		movs	r1, #0
 7471 00c8 05EBC30C 		add	ip, r5, r3, lsl #3
 7472 00cc 0A46     		mov	r2, r1
 7473              	.LVL764:
 7474              	.L797:
 7475 00ce 0CEB0204 		add	r4, ip, r2
 7476              	.LBB81:
 7477              	.LBB82:
2605:bluetooth_rxtx.c **** 			u8 byte = 0;
2606:bluetooth_rxtx.c **** 			for (k = 0; k < 8; k++) {
2607:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
2608:bluetooth_rxtx.c **** 				if (offset >= DMA_SIZE*8*2) break;
2609:bluetooth_rxtx.c **** 				int bit = unpacked[offset];
2610:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 7478              		.loc 1 2610 0
 7479 00d2 032B     		cmp	r3, #3
2609:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 7480              		.loc 1 2609 0
 7481 00d4 14F8204C 		ldrb	r4, [r4, #-32]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 201


 7482              	.LVL765:
 7483              		.loc 1 2610 0
 7484 00d8 0CDD     		ble	.L794
2611:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 7485              		.loc 1 2611 0
 7486 00da 07EB000E 		add	lr, r7, r0
 7487 00de 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
2612:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 7488              		.loc 1 2612 0
 7489 00e2 0130     		adds	r0, r0, #1
 7490              	.LVL766:
2611:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 7491              		.loc 1 2611 0
 7492 00e4 84EA0E04 		eor	r4, r4, lr
 7493              	.LVL767:
 7494              		.loc 1 2612 0
 7495 00e8 4FF07F0E 		mov	lr, #127
 7496 00ec B0FBFEF9 		udiv	r9, r0, lr
 7497 00f0 0EFB1900 		mls	r0, lr, r9, r0
 7498              	.LVL768:
 7499              	.L794:
2613:bluetooth_rxtx.c **** 				}
2614:bluetooth_rxtx.c **** 				byte |= bit << k;
 7500              		.loc 1 2614 0
 7501 00f4 9440     		lsls	r4, r4, r2
 7502              	.LVL769:
 7503              	.LBE82:
2606:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7504              		.loc 1 2606 0
 7505 00f6 0132     		adds	r2, r2, #1
 7506              	.LVL770:
 7507              	.LBB83:
 7508              		.loc 1 2614 0
 7509 00f8 2143     		orrs	r1, r1, r4
 7510              	.LVL771:
 7511              	.LBE83:
2606:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7512              		.loc 1 2606 0
 7513 00fa 082A     		cmp	r2, #8
 7514              	.LBB84:
 7515              		.loc 1 2614 0
 7516 00fc C9B2     		uxtb	r1, r1
 7517              	.LVL772:
 7518              	.LBE84:
2606:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7519              		.loc 1 2606 0
 7520 00fe E6D1     		bne	.L797
2615:bluetooth_rxtx.c **** 			}
2616:bluetooth_rxtx.c **** 			idle_rxbuf[j] = byte;
 7521              		.loc 1 2616 0
 7522 0100 214C     		ldr	r4, .L815+12
 7523 0102 2268     		ldr	r2, [r4]
 7524              	.LVL773:
 7525 0104 D154     		strb	r1, [r2, r3]
 7526              	.LBE81:
2604:bluetooth_rxtx.c **** 			u8 byte = 0;
 7527              		.loc 1 2604 0
ARM GAS  /tmp/ccwLngFB.s 			page 202


 7528 0106 0133     		adds	r3, r3, #1
 7529              	.LVL774:
 7530 0108 0A2B     		cmp	r3, #10
 7531 010a DCD1     		bne	.L804
2617:bluetooth_rxtx.c **** 		}
2618:bluetooth_rxtx.c **** 
2619:bluetooth_rxtx.c **** 		u32 aa = (idle_rxbuf[3] << 24) |
 7532              		.loc 1 2619 0
 7533 010c 2368     		ldr	r3, [r4]
 7534              	.LVL775:
 7535 010e D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 7536              	.LVL776:
2620:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 7537              		.loc 1 2620 0
 7538 0110 2368     		ldr	r3, [r4]
 7539 0112 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
2621:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 7540              		.loc 1 2621 0
 7541 0114 2268     		ldr	r2, [r4]
2620:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 7542              		.loc 1 2620 0
 7543 0116 1B04     		lsls	r3, r3, #16
 7544              		.loc 1 2621 0
 7545 0118 5078     		ldrb	r0, [r2, #1]	@ zero_extendqisi2
 7546              	.LVL777:
2622:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 7547              		.loc 1 2622 0
 7548 011a 2268     		ldr	r2, [r4]
2619:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 7549              		.loc 1 2619 0
 7550 011c 43EA0163 		orr	r3, r3, r1, lsl #24
 7551              		.loc 1 2622 0
 7552 0120 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 7553              	.LVL778:
2620:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 7554              		.loc 1 2620 0
 7555 0122 1343     		orrs	r3, r3, r2
2623:bluetooth_rxtx.c **** 		see_aa(aa);
 7556              		.loc 1 2623 0
 7557 0124 43EA0020 		orr	r0, r3, r0, lsl #8
 7558 0128 FFF7FEFF 		bl	see_aa
 7559              	.LVL779:
2624:bluetooth_rxtx.c **** 
2625:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 7560              		.loc 1 2625 0
 7561 012c 2168     		ldr	r1, [r4]
 7562 012e 0120     		movs	r0, #1
 7563 0130 FFF7FEFF 		bl	enqueue
 7564              	.LVL780:
 7565              	.L803:
 7566 0134 0135     		adds	r5, r5, #1
 7567              	.LVL781:
 7568              	.LBE85:
2577:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 7569              		.loc 1 2577 0
 7570 0136 4545     		cmp	r5, r8
 7571 0138 9ED1     		bne	.L799
ARM GAS  /tmp/ccwLngFB.s 			page 203


 7572 013a 0023     		movs	r3, #0
 7573              	.LVL782:
 7574              	.L802:
 7575 013c 134A     		ldr	r2, .L815+16
 7576 013e 02EBC301 		add	r1, r2, r3, lsl #3
2626:bluetooth_rxtx.c **** 
2627:bluetooth_rxtx.c **** 	}
2628:bluetooth_rxtx.c **** 
2629:bluetooth_rxtx.c **** 	// once we see an AA 5 times, start following it
2630:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i) {
2631:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 7577              		.loc 1 2631 0
 7578 0142 4968     		ldr	r1, [r1, #4]
 7579 0144 0329     		cmp	r1, #3
 7580 0146 11DD     		ble	.L800
2632:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
 7581              		.loc 1 2632 0
 7582 0148 52F83300 		ldr	r0, [r2, r3, lsl #3]
 7583 014c FFF7FEFF 		bl	le_set_access_address
 7584              	.LVL783:
2633:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 7585              		.loc 1 2633 0
 7586 0150 0F4B     		ldr	r3, .L815+20
 7587 0152 104A     		ldr	r2, .L815+24
2634:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
2635:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 7588              		.loc 1 2635 0
 7589 0154 0024     		movs	r4, #0
2633:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 7590              		.loc 1 2633 0
 7591 0156 DA62     		str	r2, [r3, #44]
2634:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 7592              		.loc 1 2634 0
 7593 0158 0F4A     		ldr	r2, .L815+28
2636:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 7594              		.loc 1 2636 0
 7595 015a 2046     		mov	r0, r4
2634:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 7596              		.loc 1 2634 0
 7597 015c 9A61     		str	r2, [r3, #24]
 7598              		.loc 1 2636 0
 7599 015e 0F49     		ldr	r1, .L815+32
 7600 0160 0422     		movs	r2, #4
2635:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 7601              		.loc 1 2635 0
 7602 0162 7461     		str	r4, [r6, #20]
 7603              		.loc 1 2636 0
 7604 0164 FFF7FEFF 		bl	le_promisc_state
 7605              	.LVL784:
2637:bluetooth_rxtx.c **** 			// quit using the old stuff and switch to sync mode
2638:bluetooth_rxtx.c **** 			return 0;
 7606              		.loc 1 2638 0
 7607 0168 2046     		mov	r0, r4
 7608 016a 03E0     		b	.L814
 7609              	.LVL785:
 7610              	.L800:
2630:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
ARM GAS  /tmp/ccwLngFB.s 			page 204


 7611              		.loc 1 2630 0
 7612 016c 0133     		adds	r3, r3, #1
 7613              	.LVL786:
 7614 016e 202B     		cmp	r3, #32
 7615 0170 E4D1     		bne	.L802
2639:bluetooth_rxtx.c **** 		}
2640:bluetooth_rxtx.c **** 	}
2641:bluetooth_rxtx.c **** 
2642:bluetooth_rxtx.c **** 	return 1;
 7616              		.loc 1 2642 0
 7617 0172 0120     		movs	r0, #1
 7618              	.LVL787:
 7619              	.L814:
2643:bluetooth_rxtx.c **** }
 7620              		.loc 1 2643 0
 7621 0174 15B0     		add	sp, sp, #84
 7622              		@ sp needed
 7623 0176 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 7624              	.LVL788:
 7625              	.L816:
 7626 017a 00BF     		.align	2
 7627              	.L815:
 7628 017c 00000000 		.word	.LANCHOR1
 7629 0180 00000000 		.word	.LANCHOR2
 7630 0184 98080000 		.word	.LANCHOR2+2200
 7631 0188 00000000 		.word	idle_rxbuf
 7632 018c 00000000 		.word	le_promisc
 7633 0190 00000000 		.word	.LANCHOR0
 7634 0194 00000000 		.word	cb_follow_le
 7635 0198 00000000 		.word	promisc_follow_cb
 7636 019c 04000000 		.word	.LANCHOR1+4
 7637              		.cfi_endproc
 7638              	.LFE35:
 7640              		.section	.text.bt_promisc_le,"ax",%progbits
 7641              		.align	1
 7642              		.global	bt_promisc_le
 7643              		.thumb
 7644              		.thumb_func
 7646              	bt_promisc_le:
 7647              	.LFB36:
2644:bluetooth_rxtx.c **** 
2645:bluetooth_rxtx.c **** void bt_promisc_le() {
 7648              		.loc 1 2645 0
 7649              		.cfi_startproc
 7650              		@ args = 0, pretend = 0, frame = 0
 7651              		@ frame_needed = 0, uses_anonymous_args = 0
 7652 0000 38B5     		push	{r3, r4, r5, lr}
 7653              		.cfi_def_cfa_offset 16
 7654              		.cfi_offset 3, -16
 7655              		.cfi_offset 4, -12
 7656              		.cfi_offset 5, -8
 7657              		.cfi_offset 14, -4
 7658              	.L818:
2646:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_PROMISC_LE) {
 7659              		.loc 1 2646 0 discriminator 1
 7660 0002 164D     		ldr	r5, .L827
 7661 0004 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 205


 7662 0006 0A2B     		cmp	r3, #10
 7663 0008 26D1     		bne	.L817
2647:bluetooth_rxtx.c **** 		reset_le_promisc();
2648:bluetooth_rxtx.c **** 
2649:bluetooth_rxtx.c **** 		// jump to a random data channel and turn up the squelch
2650:bluetooth_rxtx.c **** 		if ((channel & 1) == 1)
 7664              		.loc 1 2650 0
 7665 000a 154C     		ldr	r4, .L827+4
2647:bluetooth_rxtx.c **** 		reset_le_promisc();
 7666              		.loc 1 2647 0
 7667 000c FFF7FEFF 		bl	reset_le_promisc
 7668              	.LVL789:
 7669              		.loc 1 2650 0
 7670 0010 2388     		ldrh	r3, [r4]
 7671 0012 DB07     		lsls	r3, r3, #31
2651:bluetooth_rxtx.c **** 			channel = 2440;
 7672              		.loc 1 2651 0
 7673 0014 44BF     		itt	mi
 7674 0016 40F68813 		movwmi	r3, #2440
 7675 001a 2380     		strhmi	r3, [r4]	@ movhi
2652:bluetooth_rxtx.c **** 
2653:bluetooth_rxtx.c **** 		// if the PC hasn't given us AA, determine by listening
2654:bluetooth_rxtx.c **** 		if (!le.target_set) {
 7676              		.loc 1 2654 0
 7677 001c 236C     		ldr	r3, [r4, #64]
 7678 001e 4BB9     		cbnz	r3, .L820
2655:bluetooth_rxtx.c **** 			// cs_threshold_req = -80;
2656:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 7679              		.loc 1 2656 0
 7680 0020 0F4B     		ldr	r3, .L827+4
 7681 0022 1888     		ldrh	r0, [r3]
 7682 0024 80B2     		uxth	r0, r0
 7683 0026 FFF7FEFF 		bl	cs_threshold_calc_and_set
 7684              	.LVL790:
2657:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 7685              		.loc 1 2657 0
 7686 002a 0E4B     		ldr	r3, .L827+8
2658:bluetooth_rxtx.c **** 			bt_generic_le(MODE_BT_PROMISC_LE);
 7687              		.loc 1 2658 0
 7688 002c 0A20     		movs	r0, #10
2657:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 7689              		.loc 1 2657 0
 7690 002e EB62     		str	r3, [r5, #44]
 7691              		.loc 1 2658 0
 7692 0030 FFF7FEFF 		bl	bt_generic_le
 7693              	.LVL791:
 7694              	.L820:
2659:bluetooth_rxtx.c **** 		}
2660:bluetooth_rxtx.c **** 
2661:bluetooth_rxtx.c **** 		// could have got mode change in middle of above
2662:bluetooth_rxtx.c **** 		if (requested_mode != MODE_BT_PROMISC_LE)
 7695              		.loc 1 2662 0
 7696 0034 AD7C     		ldrb	r5, [r5, #18]	@ zero_extendqisi2
 7697 0036 EDB2     		uxtb	r5, r5
 7698 0038 0A2D     		cmp	r5, #10
 7699 003a 0DD1     		bne	.L817
2663:bluetooth_rxtx.c **** 			break;
ARM GAS  /tmp/ccwLngFB.s 			page 206


2664:bluetooth_rxtx.c **** 
2665:bluetooth_rxtx.c **** 		le_promisc_state(0, &le.access_address, 4);
 7700              		.loc 1 2665 0
 7701 003c 0020     		movs	r0, #0
 7702 003e 0A49     		ldr	r1, .L827+12
 7703 0040 0422     		movs	r2, #4
 7704 0042 FFF7FEFF 		bl	le_promisc_state
 7705              	.LVL792:
2666:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 7706              		.loc 1 2666 0
 7707 0046 094A     		ldr	r2, .L827+16
 7708 0048 044B     		ldr	r3, .L827
2667:bluetooth_rxtx.c **** 		le.crc_verify = 0;
2668:bluetooth_rxtx.c **** 		bt_le_sync(MODE_BT_PROMISC_LE);
 7709              		.loc 1 2668 0
 7710 004a 2846     		mov	r0, r5
2666:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 7711              		.loc 1 2666 0
 7712 004c 9A61     		str	r2, [r3, #24]
2667:bluetooth_rxtx.c **** 		le.crc_verify = 0;
 7713              		.loc 1 2667 0
 7714 004e 0023     		movs	r3, #0
 7715 0050 6361     		str	r3, [r4, #20]
 7716              		.loc 1 2668 0
 7717 0052 FFF7FEFF 		bl	bt_le_sync
 7718              	.LVL793:
 7719 0056 D4E7     		b	.L818
 7720              	.L817:
 7721 0058 38BD     		pop	{r3, r4, r5, pc}
 7722              	.L828:
 7723 005a 00BF     		.align	2
 7724              	.L827:
 7725 005c 00000000 		.word	.LANCHOR0
 7726 0060 00000000 		.word	.LANCHOR1
 7727 0064 00000000 		.word	cb_le_promisc
 7728 0068 04000000 		.word	.LANCHOR1+4
 7729 006c 00000000 		.word	promisc_follow_cb
 7730              		.cfi_endproc
 7731              	.LFE36:
 7733              		.section	.text.bt_slave_le,"ax",%progbits
 7734              		.align	1
 7735              		.global	bt_slave_le
 7736              		.thumb
 7737              		.thumb_func
 7739              	bt_slave_le:
 7740              	.LFB37:
2669:bluetooth_rxtx.c **** 	}
2670:bluetooth_rxtx.c **** }
2671:bluetooth_rxtx.c **** 
2672:bluetooth_rxtx.c **** void bt_slave_le(u16 tx_pwr) {
 7741              		.loc 1 2672 0
 7742              		.cfi_startproc
 7743              		@ args = 0, pretend = 0, frame = 48
 7744              		@ frame_needed = 0, uses_anonymous_args = 0
 7745              	.LVL794:
 7746 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 7747              		.cfi_def_cfa_offset 36
ARM GAS  /tmp/ccwLngFB.s 			page 207


 7748              		.cfi_offset 4, -36
 7749              		.cfi_offset 5, -32
 7750              		.cfi_offset 6, -28
 7751              		.cfi_offset 7, -24
 7752              		.cfi_offset 8, -20
 7753              		.cfi_offset 9, -16
 7754              		.cfi_offset 10, -12
 7755              		.cfi_offset 11, -8
 7756              		.cfi_offset 14, -4
 7757 0004 8FB0     		sub	sp, sp, #60
 7758              		.cfi_def_cfa_offset 96
 7759              	.LVL795:
2673:bluetooth_rxtx.c **** 	u32 calc_crc;
2674:bluetooth_rxtx.c **** 	int i, j;
2675:bluetooth_rxtx.c **** 	int num_adv_ind = 1;
2676:bluetooth_rxtx.c **** 	int fin_adv_len = 0;
2677:bluetooth_rxtx.c **** 	u8 **adv_ind;
2678:bluetooth_rxtx.c **** 	u8 adv_ind_len;
2679:bluetooth_rxtx.c **** 	u16 ch[] = {2402, 2426, 2480};
 7760              		.loc 1 2679 0
 7761 0006 9049     		ldr	r1, .L897
2672:bluetooth_rxtx.c **** 	u32 calc_crc;
 7762              		.loc 1 2672 0
 7763 0008 8246     		mov	r10, r0
 7764              		.loc 1 2679 0
 7765 000a 8B88     		ldrh	r3, [r1, #4]	@ unaligned
 7766 000c 0868     		ldr	r0, [r1]	@ unaligned
 7767              	.LVL796:
 7768 000e ADF82030 		strh	r3, [sp, #32]	@ unaligned
 7769 0012 0790     		str	r0, [sp, #28]	@ unaligned
2680:bluetooth_rxtx.c **** 
2681:bluetooth_rxtx.c **** 	u8 adv_overhead[20] = {0x42, 0x1d,	// adv_nonconn_ind, length 29 (0001 1101)
 7770              		.loc 1 2681 0
 7771 0014 8B1D     		adds	r3, r1, #6
 7772 0016 09AA     		add	r2, sp, #36
 7773 0018 01F11605 		add	r5, r1, #22
 7774              	.L830:
 7775 001c 1868     		ldr	r0, [r3]	@ unaligned
 7776 001e 5968     		ldr	r1, [r3, #4]	@ unaligned
 7777 0020 1446     		mov	r4, r2
 7778 0022 03C4     		stmia	r4!, {r0, r1}
 7779 0024 0833     		adds	r3, r3, #8
 7780 0026 AB42     		cmp	r3, r5
 7781 0028 2246     		mov	r2, r4
 7782 002a F7D1     		bne	.L830
 7783 002c 1868     		ldr	r0, [r3]	@ unaligned
2682:bluetooth_rxtx.c **** 						   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, // adv mac address
2683:bluetooth_rxtx.c **** 						   0x03, 0x03, 0xaa, 0xfe, // service advertised - len, type, eddystone UUID
2684:bluetooth_rxtx.c **** 						   0x12, 0x16, 0xaa, 0xfe, // len(3 + URL frame + Eddystone URL), type, eddystone UUID
2685:bluetooth_rxtx.c **** 						   0x10, 0x00, 0x02, // URL frame - frametype(URL), tx power, URL scheme prefix (0x02: http:/
2686:bluetooth_rxtx.c **** 						   0xaa }; // preamble 0xaa
2687:bluetooth_rxtx.c **** 
2688:bluetooth_rxtx.c **** 	for (i = 0; i < 6; i++)
2689:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 7784              		.loc 1 2689 0
 7785 002e 874A     		ldr	r2, .L897+4
2681:bluetooth_rxtx.c **** 						   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, // adv mac address
ARM GAS  /tmp/ccwLngFB.s 			page 208


 7786              		.loc 1 2681 0
 7787 0030 2060     		str	r0, [r4]	@ unaligned
 7788              	.LVL797:
 7789              		.loc 1 2689 0
 7790 0032 1468     		ldr	r4, [r2]
2688:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 7791              		.loc 1 2688 0
 7792 0034 0023     		movs	r3, #0
 7793 0036 9346     		mov	fp, r2
 7794              	.LVL798:
 7795              	.L832:
 7796              		.loc 1 2689 0 discriminator 2
 7797 0038 854A     		ldr	r2, .L897+8
 7798 003a E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 7799 003c 02F12401 		add	r1, r2, #36
 7800 0040 5854     		strb	r0, [r3, r1]
2688:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 7801              		.loc 1 2688 0 discriminator 2
 7802 0042 0133     		adds	r3, r3, #1
 7803              	.LVL799:
 7804 0044 062B     		cmp	r3, #6
 7805 0046 9046     		mov	r8, r2
 7806 0048 F6D1     		bne	.L832
2690:bluetooth_rxtx.c **** 
2691:bluetooth_rxtx.c **** 	// Standards said maximum advertising channel PDU length 39 bytes (adv payload 19 + 1 (preamble))
2692:bluetooth_rxtx.c **** 	// There's a probem, actual maximum length 34 bytes (adv payload 14 + 1 (preamble)) in ubertooth
2693:bluetooth_rxtx.c **** 	// Nexsus 5 smartphone can not receive BLE packet which has length over 31 bytes (adv payload 11 +
2694:bluetooth_rxtx.c **** 	fin_adv_len = (dlen-6) % 11;
 7807              		.loc 1 2694 0
 7808 004a 126A     		ldr	r2, [r2, #32]
 7809 004c 0B23     		movs	r3, #11
 7810              	.LVL800:
 7811 004e 971F     		subs	r7, r2, #6
 7812 0050 97FBF3F6 		sdiv	r6, r7, r3
2695:bluetooth_rxtx.c **** 	if (dlen > 11 + 6) {
 7813              		.loc 1 2695 0
 7814 0054 112A     		cmp	r2, #17
2694:bluetooth_rxtx.c **** 	if (dlen > 11 + 6) {
 7815              		.loc 1 2694 0
 7816 0056 03FB1677 		mls	r7, r3, r6, r7
 7817              	.LVL801:
 7818              		.loc 1 2695 0
 7819 005a 03DD     		ble	.L858
2696:bluetooth_rxtx.c **** 		num_adv_ind = (dlen-6)/11 + 1;
 7820              		.loc 1 2696 0
 7821 005c 721C     		adds	r2, r6, #1
 7822              	.LVL802:
2697:bluetooth_rxtx.c **** 		fin_adv_len = (dlen-6) % 11;
2698:bluetooth_rxtx.c **** 		if (fin_adv_len == 0) {
 7823              		.loc 1 2698 0
 7824 005e 1FB1     		cbz	r7, .L859
2696:bluetooth_rxtx.c **** 		num_adv_ind = (dlen-6)/11 + 1;
 7825              		.loc 1 2696 0
 7826 0060 1646     		mov	r6, r2
 7827 0062 02E0     		b	.L833
 7828              	.LVL803:
 7829              	.L858:
ARM GAS  /tmp/ccwLngFB.s 			page 209


2675:bluetooth_rxtx.c **** 	int fin_adv_len = 0;
 7830              		.loc 1 2675 0
 7831 0064 0126     		movs	r6, #1
 7832 0066 00E0     		b	.L833
 7833              	.LVL804:
 7834              	.L859:
2699:bluetooth_rxtx.c **** 			fin_adv_len = 11;
 7835              		.loc 1 2699 0
 7836 0068 1F46     		mov	r7, r3
 7837              	.LVL805:
 7838              	.L833:
2700:bluetooth_rxtx.c **** 			num_adv_ind = num_adv_ind - 1;}
2701:bluetooth_rxtx.c **** 	}
2702:bluetooth_rxtx.c **** 
2703:bluetooth_rxtx.c **** 	adv_ind = (u8**) malloc(sizeof(u8*)*num_adv_ind);
 7839              		.loc 1 2703 0
 7840 006a B500     		lsls	r5, r6, #2
 7841 006c 2846     		mov	r0, r5
 7842 006e FFF7FEFF 		bl	malloc
 7843              	.LVL806:
2704:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
 7844              		.loc 1 2704 0
 7845 0072 0023     		movs	r3, #0
2703:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
 7846              		.loc 1 2703 0
 7847 0074 0446     		mov	r4, r0
 7848              	.LVL807:
 7849              	.L834:
 7850              		.loc 1 2704 0 discriminator 1
 7851 0076 06F1FF39 		add	r9, r6, #-1
 7852 007a 4B45     		cmp	r3, r9
 7853 007c 08DA     		bge	.L893
2705:bluetooth_rxtx.c **** 		adv_ind[i] = (u8*) malloc(sizeof(u8)*31);
 7854              		.loc 1 2705 0 discriminator 2
 7855 007e 1F20     		movs	r0, #31
 7856 0080 0293     		str	r3, [sp, #8]
 7857 0082 FFF7FEFF 		bl	malloc
 7858              	.LVL808:
 7859 0086 029B     		ldr	r3, [sp, #8]
 7860 0088 44F82300 		str	r0, [r4, r3, lsl #2]
2704:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
 7861              		.loc 1 2704 0 discriminator 2
 7862 008c 0133     		adds	r3, r3, #1
 7863              	.LVL809:
 7864 008e F2E7     		b	.L834
 7865              	.L893:
2706:bluetooth_rxtx.c **** 	}
2707:bluetooth_rxtx.c **** 	adv_ind[num_adv_ind-1] = (u8*) malloc(sizeof(u8)*(fin_adv_len + 1 + 3 + 4 + 4 + 6 + 2 + 3));
 7866              		.loc 1 2707 0
 7867 0090 07F11700 		add	r0, r7, #23
 7868 0094 FFF7FEFF 		bl	malloc
 7869              	.LVL810:
 7870 0098 043D     		subs	r5, r5, #4
 7871 009a 6051     		str	r0, [r4, r5]
 7872              	.LVL811:
2708:bluetooth_rxtx.c **** 
2709:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind; i++) {
ARM GAS  /tmp/ccwLngFB.s 			page 210


 7873              		.loc 1 2709 0
 7874 009c 0025     		movs	r5, #0
 7875 009e 2B46     		mov	r3, r5
 7876              	.LVL812:
 7877              	.L836:
 7878              		.loc 1 2709 0 is_stmt 0 discriminator 1
 7879 00a0 B342     		cmp	r3, r6
 7880 00a2 6FDA     		bge	.L845
 7881              		.loc 1 2709 0
 7882 00a4 0022     		movs	r2, #0
 7883              	.L846:
 7884              	.LVL813:
2710:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
 7885              		.loc 1 2710 0 is_stmt 1 discriminator 2
 7886 00a6 0DF1240E 		add	lr, sp, #36
 7887 00aa 1EF80200 		ldrb	r0, [lr, r2]	@ zero_extendqisi2
 7888 00ae 6159     		ldr	r1, [r4, r5]
 7889 00b0 8854     		strb	r0, [r1, r2]
 7890 00b2 0132     		adds	r2, r2, #1
 7891              	.LVL814:
 7892 00b4 142A     		cmp	r2, #20
 7893 00b6 F6D1     		bne	.L846
 7894              		.loc 1 2710 0 is_stmt 0
 7895 00b8 0522     		movs	r2, #5
 7896              	.LVL815:
 7897              	.L839:
2711:bluetooth_rxtx.c **** 		for (j=0; j<6; j++) adv_ind[i][j+2] = slave_mac_address[5-j];
 7898              		.loc 1 2711 0 is_stmt 1 discriminator 2
 7899 00ba 6649     		ldr	r1, .L897+12
 7900 00bc C2F10700 		rsb	r0, r2, #7
 7901 00c0 12F801E0 		ldrb	lr, [r2, r1]	@ zero_extendqisi2
 7902 00c4 6159     		ldr	r1, [r4, r5]
 7903 00c6 12F1FF32 		adds	r2, r2, #-1
 7904              	.LVL816:
 7905 00ca 01F800E0 		strb	lr, [r1, r0]
 7906              	.LVL817:
 7907 00ce F4D2     		bcs	.L839
2712:bluetooth_rxtx.c **** 		adv_ind[i][17] = (u8) num_adv_ind;
 7908              		.loc 1 2712 0
 7909 00d0 6259     		ldr	r2, [r4, r5]
2713:bluetooth_rxtx.c **** 		adv_ind[i][19] = adv_overhead[19] + (u8) i;
 7910              		.loc 1 2713 0
 7911 00d2 9DF83710 		ldrb	r1, [sp, #55]	@ zero_extendqisi2
2712:bluetooth_rxtx.c **** 		adv_ind[i][17] = (u8) num_adv_ind;
 7912              		.loc 1 2712 0
 7913 00d6 5674     		strb	r6, [r2, #17]
 7914              		.loc 1 2713 0
 7915 00d8 6259     		ldr	r2, [r4, r5]
 7916 00da 1944     		add	r1, r1, r3
2714:bluetooth_rxtx.c **** 		if (i < num_adv_ind -1) {
 7917              		.loc 1 2714 0
 7918 00dc 4B45     		cmp	r3, r9
2713:bluetooth_rxtx.c **** 		adv_ind[i][19] = adv_overhead[19] + (u8) i;
 7919              		.loc 1 2713 0
 7920 00de D174     		strb	r1, [r2, #19]
 7921              		.loc 1 2714 0
 7922 00e0 12DA     		bge	.L840
ARM GAS  /tmp/ccwLngFB.s 			page 211


 7923 00e2 0B21     		movs	r1, #11
 7924 00e4 5943     		muls	r1, r3, r1
 7925 00e6 4FF0140C 		mov	ip, #20
 7926              	.L842:
 7927              	.LVL818:
2715:bluetooth_rxtx.c **** 			for (j=0; j<11; j++) adv_ind[i][j+20] = slave_mac_address_data[6+11*i+j];
 7928              		.loc 1 2715 0 discriminator 2
 7929 00ea DBF80020 		ldr	r2, [fp]
 7930 00ee 0A44     		add	r2, r2, r1
 7931 00f0 6244     		add	r2, r2, ip
 7932 00f2 12F80E0C 		ldrb	r0, [r2, #-14]	@ zero_extendqisi2
 7933 00f6 6259     		ldr	r2, [r4, r5]
 7934 00f8 02F80C00 		strb	r0, [r2, ip]
 7935              	.LVL819:
 7936 00fc 0CF1010C 		add	ip, ip, #1
 7937              	.LVL820:
 7938 0100 BCF11F0F 		cmp	ip, #31
 7939 0104 F1D1     		bne	.L842
 7940 0106 23E0     		b	.L841
 7941              	.LVL821:
 7942              	.L840:
 7943              	.LBB89:
2716:bluetooth_rxtx.c **** 			adv_ind_len = (u8) 31;
2717:bluetooth_rxtx.c **** 		} else {
2718:bluetooth_rxtx.c **** 			u8 tot_len = (u8)(fin_adv_len + 18);
 7944              		.loc 1 2718 0
 7945 0108 FAB2     		uxtb	r2, r7
 7946 010a 02F11201 		add	r1, r2, #18
 7947 010e 4FF00B0E 		mov	lr, #11
 7948 0112 C9B2     		uxtb	r1, r1
 7949 0114 0EFB03FE 		mul	lr, lr, r3
 7950 0118 0491     		str	r1, [sp, #16]
 7951              	.LVL822:
2719:bluetooth_rxtx.c **** 			u8 adv_len = (u8)(fin_adv_len + 7);
 7952              		.loc 1 2719 0
 7953 011a D11D     		adds	r1, r2, #7
 7954 011c C9B2     		uxtb	r1, r1
 7955 011e 0591     		str	r1, [sp, #20]
 7956              	.LVL823:
2720:bluetooth_rxtx.c **** 			for (j=0; j<fin_adv_len; j++) adv_ind[i][j+20] = slave_mac_address_data[6+11*i+j];
 7957              		.loc 1 2720 0
 7958 0120 0021     		movs	r1, #0
 7959              	.LVL824:
 7960              	.L843:
 7961              		.loc 1 2720 0 is_stmt 0 discriminator 1
 7962 0122 B942     		cmp	r1, r7
 7963 0124 0BDA     		bge	.L894
 7964              		.loc 1 2720 0 discriminator 2
 7965 0126 4948     		ldr	r0, .L897+4
 7966 0128 0068     		ldr	r0, [r0]
 7967 012a 7044     		add	r0, r0, lr
 7968 012c 0844     		add	r0, r0, r1
 7969 012e 90F806C0 		ldrb	ip, [r0, #6]	@ zero_extendqisi2
 7970 0132 6059     		ldr	r0, [r4, r5]
 7971 0134 0844     		add	r0, r0, r1
 7972 0136 80F814C0 		strb	ip, [r0, #20]
 7973 013a 0131     		adds	r1, r1, #1
ARM GAS  /tmp/ccwLngFB.s 			page 212


 7974              	.LVL825:
 7975 013c F1E7     		b	.L843
 7976              	.L894:
2721:bluetooth_rxtx.c **** 			adv_ind[i][1] = tot_len;
 7977              		.loc 1 2721 0 is_stmt 1
 7978 013e 6159     		ldr	r1, [r4, r5]
 7979              	.LVL826:
 7980 0140 0498     		ldr	r0, [sp, #16]
2722:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
2723:bluetooth_rxtx.c **** 			adv_ind_len = (u8) (fin_adv_len + 20);
 7981              		.loc 1 2723 0
 7982 0142 1432     		adds	r2, r2, #20
2721:bluetooth_rxtx.c **** 			adv_ind[i][1] = tot_len;
 7983              		.loc 1 2721 0
 7984 0144 4870     		strb	r0, [r1, #1]
2722:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
 7985              		.loc 1 2722 0
 7986 0146 6159     		ldr	r1, [r4, r5]
 7987 0148 0598     		ldr	r0, [sp, #20]
 7988              		.loc 1 2723 0
 7989 014a 5FFA82FC 		uxtb	ip, r2
 7990              	.LVL827:
2722:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
 7991              		.loc 1 2722 0
 7992 014e 0873     		strb	r0, [r1, #12]
 7993              	.LVL828:
 7994              	.L841:
 7995              	.LBE89:
2724:bluetooth_rxtx.c **** 		}
2725:bluetooth_rxtx.c **** 
2726:bluetooth_rxtx.c **** 		// To stabilize carrier frequency offset
2727:bluetooth_rxtx.c **** 		// bit is transmitted in reversed sequence, (ex, 1010 1010 -> transmitted 0101 0101)
2728:bluetooth_rxtx.c **** 		// sequence which is {0x55, } after whitening : (0101 0101 -> 1010 1010)
2729:bluetooth_rxtx.c **** 		// 0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 3
2730:bluetooth_rxtx.c **** 		// 27 78 fd 0b 97 0d cc 1a df 9b bb e2 3c dd 52 49 ec 43 01 7a 34 f9 99 72 10 32 a2 8e 61 91 56 d
2731:bluetooth_rxtx.c **** 		// sequence which is {0xaa, } after whitening : (1010 1010 -> 0101 0101)
2732:bluetooth_rxtx.c **** 		// d8 87 02 f4 68 f2 33 e5 20 64 44 1d c3 22 ad b6 13 bc fe 85 cb 06 66 8d ef cd 5d 71 9e 6e a9 2
2733:bluetooth_rxtx.c **** 		// sequence which is {0xab, } after whitening : (1010 1011 -> 1101 0101)
2734:bluetooth_rxtx.c **** 		// 58 07 82 74 e8 72 b3 65 a0 e4 c4 9d 43 a2 2d 36 93 3c 7e 05 4b 86 e6 0d 6f 4d dd f1 1e ee 29 a
2735:bluetooth_rxtx.c **** 		// sequence which is {0xd5, } after whitening : (1101 0101 -> 1010 1011)
2736:bluetooth_rxtx.c **** 		// 26 79 fc 0a 96 0c cd 1b de 9a ba e3 3d dc 53 48 ed 42 00 7b 35 f8 98 73 11 33 a3 8f 60 90 57 d
2737:bluetooth_rxtx.c **** 		/*
2738:bluetooth_rxtx.c **** 		adv_ind[i][8] = 0xdf;
2739:bluetooth_rxtx.c **** 		adv_ind[i][9] = 0x9b;
2740:bluetooth_rxtx.c **** 		adv_ind[i][10] = 0xbb;
2741:bluetooth_rxtx.c **** 		adv_ind[i][11] = 0xe2;
2742:bluetooth_rxtx.c **** 		adv_ind[i][12] = 0x3c;
2743:bluetooth_rxtx.c **** 		adv_ind[i][13] = 0xdd;
2744:bluetooth_rxtx.c **** 		adv_ind[i][14] = 0x52;
2745:bluetooth_rxtx.c **** 		adv_ind[i][15] = 0x49;
2746:bluetooth_rxtx.c **** 		adv_ind[i][16] = 0xec;
2747:bluetooth_rxtx.c **** 		adv_ind[i][17] = 0x43;
2748:bluetooth_rxtx.c **** 		adv_ind[i][18] = 0x00;
2749:bluetooth_rxtx.c **** 		adv_ind[i][19] = 0x7b;
2750:bluetooth_rxtx.c **** 		adv_ind[i][20] = 0x35;
2751:bluetooth_rxtx.c **** 		adv_ind[i][21] = 0xf8;
2752:bluetooth_rxtx.c **** 		adv_ind[i][22] = 0x98;
ARM GAS  /tmp/ccwLngFB.s 			page 213


2753:bluetooth_rxtx.c **** 		adv_ind[i][23] = 0x73;
2754:bluetooth_rxtx.c **** 		adv_ind[i][24] = 0x11;
2755:bluetooth_rxtx.c **** 		adv_ind[i][25] = 0x33;
2756:bluetooth_rxtx.c **** 		adv_ind[i][26] = 0xa3;
2757:bluetooth_rxtx.c **** 		adv_ind[i][27] = 0x8f;
2758:bluetooth_rxtx.c **** 		*/
2759:bluetooth_rxtx.c **** 		////////
2760:bluetooth_rxtx.c **** 		
2761:bluetooth_rxtx.c **** 		calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind[i], adv_ind_len);
 7996              		.loc 1 2761 0
 7997 0150 414A     		ldr	r2, .L897+16
 7998 0152 6159     		ldr	r1, [r4, r5]
 7999 0154 1069     		ldr	r0, [r2, #16]
 8000 0156 6246     		mov	r2, ip
 8001 0158 0293     		str	r3, [sp, #8]
 8002 015a CDF80CC0 		str	ip, [sp, #12]
 8003 015e FFF7FEFF 		bl	btle_calc_crc
 8004              	.LVL829:
2762:bluetooth_rxtx.c **** 		adv_ind_len = (int) adv_ind_len;
2763:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+0] = (calc_crc >> 0) & 0xff;
 8005              		.loc 1 2763 0
 8006 0162 6259     		ldr	r2, [r4, r5]
 8007 0164 DDF80CC0 		ldr	ip, [sp, #12]
2764:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 8008              		.loc 1 2764 0
 8009 0168 010A     		lsrs	r1, r0, #8
2763:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 8010              		.loc 1 2763 0
 8011 016a 02F80C00 		strb	r0, [r2, ip]
 8012              	.LVL830:
 8013              		.loc 1 2764 0
 8014 016e 6259     		ldr	r2, [r4, r5]
2765:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 8015              		.loc 1 2765 0
 8016 0170 000C     		lsrs	r0, r0, #16
 8017              	.LVL831:
2764:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 8018              		.loc 1 2764 0
 8019 0172 6244     		add	r2, r2, ip
 8020 0174 5170     		strb	r1, [r2, #1]
 8021              		.loc 1 2765 0
 8022 0176 6259     		ldr	r2, [r4, r5]
 8023 0178 0435     		adds	r5, r5, #4
 8024 017a 6244     		add	r2, r2, ip
 8025 017c 9070     		strb	r0, [r2, #2]
2709:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
 8026              		.loc 1 2709 0
 8027 017e 029B     		ldr	r3, [sp, #8]
 8028 0180 0133     		adds	r3, r3, #1
 8029              	.LVL832:
 8030 0182 8DE7     		b	.L836
 8031              	.L845:
2766:bluetooth_rxtx.c **** 	}
2767:bluetooth_rxtx.c **** 
2768:bluetooth_rxtx.c **** 	clkn_start();
 8032              		.loc 1 2768 0
 8033 0184 FFF7FEFF 		bl	clkn_start
ARM GAS  /tmp/ccwLngFB.s 			page 214


 8034              	.LVL833:
 8035              	.L847:
2769:bluetooth_rxtx.c **** 
2770:bluetooth_rxtx.c **** 	// spam advertising packets
2771:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_SLAVE_LE 
 8036              		.loc 1 2771 0 discriminator 1
 8037 0188 98F81220 		ldrb	r2, [r8, #18]	@ zero_extendqisi2
 8038 018c 304B     		ldr	r3, .L897+8
 8039 018e 0C2A     		cmp	r2, #12
 8040 0190 3FD1     		bne	.L895
 8041              	.L857:
2772:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P0
2773:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P1
2774:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P2
2775:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P3
2776:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P4
2777:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P5
2778:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P6
2779:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P7) {
2780:bluetooth_rxtx.c **** 		if (requested_mode != mode) break;
 8042              		.loc 1 2780 0
 8043 0192 98F81220 		ldrb	r2, [r8, #18]	@ zero_extendqisi2
 8044 0196 98F81130 		ldrb	r3, [r8, #17]	@ zero_extendqisi2
 8045 019a 9A42     		cmp	r2, r3
 8046 019c 51D1     		bne	.L829
2781:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 8047              		.loc 1 2781 0
 8048 019e 2F4B     		ldr	r3, .L897+20
 8049 01a0 4FF08072 		mov	r2, #16777216
 8050 01a4 1A60     		str	r2, [r3]
2782:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 8051              		.loc 1 2782 0
 8052 01a6 4FF08062 		mov	r2, #67108864
 8053 01aa 1A60     		str	r2, [r3]
 8054              	.LVL834:
 8055 01ac 4FF0000B 		mov	fp, #0
 8056              	.LVL835:
 8057              	.L849:
2709:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
 8058              		.loc 1 2709 0 discriminator 1
 8059 01b0 0025     		movs	r5, #0
 8060              	.L856:
 8061              	.LVL836:
2783:bluetooth_rxtx.c **** 		for(i=0; i<3; i++) {
2784:bluetooth_rxtx.c **** 			for(j=0; j<num_adv_ind; j++) {
 8062              		.loc 1 2784 0 discriminator 1
 8063 01b2 B542     		cmp	r5, r6
 8064 01b4 20DA     		bge	.L896
2785:bluetooth_rxtx.c **** 				if (j < num_adv_ind -1) {
 8065              		.loc 1 2785 0
 8066 01b6 4D45     		cmp	r5, r9
 8067 01b8 07AB     		add	r3, sp, #28
 8068 01ba 05DA     		bge	.L850
 8069              	.LVL837:
2786:bluetooth_rxtx.c **** 					adv_ind_len = (u8) (31 + 3);
2787:bluetooth_rxtx.c **** 					le_transmit(0x8e89bed7, adv_ind_len, adv_ind[j], tx_pwr, ch[i]);
 8070              		.loc 1 2787 0
ARM GAS  /tmp/ccwLngFB.s 			page 215


 8071 01bc 33F80B30 		ldrh	r3, [r3, fp]
 8072 01c0 2748     		ldr	r0, .L897+24
 8073 01c2 0093     		str	r3, [sp]
 8074 01c4 2221     		movs	r1, #34
 8075 01c6 06E0     		b	.L892
 8076              	.LVL838:
 8077              	.L850:
2788:bluetooth_rxtx.c **** 				} else {
2789:bluetooth_rxtx.c **** 					adv_ind_len = (u8) (fin_adv_len + 20 + 3);
2790:bluetooth_rxtx.c **** 					le_transmit(0x8e89bed7, adv_ind_len, adv_ind[j], tx_pwr, ch[i]);
 8078              		.loc 1 2790 0
 8079 01c8 33F80B30 		ldrh	r3, [r3, fp]
2789:bluetooth_rxtx.c **** 					le_transmit(0x8e89bed7, adv_ind_len, adv_ind[j], tx_pwr, ch[i]);
 8080              		.loc 1 2789 0
 8081 01cc 07F11701 		add	r1, r7, #23
 8082              		.loc 1 2790 0
 8083 01d0 2348     		ldr	r0, .L897+24
 8084 01d2 0093     		str	r3, [sp]
 8085 01d4 C9B2     		uxtb	r1, r1
 8086              	.LVL839:
 8087              	.L892:
 8088 01d6 54F82520 		ldr	r2, [r4, r5, lsl #2]
 8089 01da 5346     		mov	r3, r10
 8090 01dc FFF7FEFF 		bl	le_transmit
 8091              	.LVL840:
 8092              	.LBB90:
 8093              	.LBB91:
 849:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 8094              		.loc 1 849 0
 8095 01e0 204B     		ldr	r3, .L897+28
 8096 01e2 1A68     		ldr	r2, [r3]
 8097              	.LVL841:
 8098 01e4 22F07F42 		bic	r2, r2, #-16777216
 8099              	.LVL842:
 850:bluetooth_rxtx.c **** 
 8100              		.loc 1 850 0
 8101 01e8 2032     		adds	r2, r2, #32
 8102              	.LVL843:
 8103              	.L853:
 857:bluetooth_rxtx.c **** 	}
 8104              		.loc 1 857 0
 8105 01ea 1968     		ldr	r1, [r3]
 8106 01ec 21F07F41 		bic	r1, r1, #-16777216
 8107 01f0 9142     		cmp	r1, r2
 8108 01f2 FAD3     		bcc	.L853
 8109              	.LBE91:
 8110              	.LBE90:
2784:bluetooth_rxtx.c **** 				if (j < num_adv_ind -1) {
 8111              		.loc 1 2784 0
 8112 01f4 0135     		adds	r5, r5, #1
 8113              	.LVL844:
 8114 01f6 DCE7     		b	.L856
 8115              	.LVL845:
 8116              	.L896:
 8117 01f8 0BF1020B 		add	fp, fp, #2
2783:bluetooth_rxtx.c **** 			for(j=0; j<num_adv_ind; j++) {
 8118              		.loc 1 2783 0
ARM GAS  /tmp/ccwLngFB.s 			page 216


 8119 01fc BBF1060F 		cmp	fp, #6
 8120 0200 D6D1     		bne	.L849
2791:bluetooth_rxtx.c **** 				}
2792:bluetooth_rxtx.c **** 				msleep(10);
2793:bluetooth_rxtx.c **** 			}
2794:bluetooth_rxtx.c **** 			//msleep(5);
2795:bluetooth_rxtx.c **** 		}
2796:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 8121              		.loc 1 2796 0
 8122 0202 194B     		ldr	r3, .L897+32
 8123 0204 4FF08072 		mov	r2, #16777216
 8124 0208 1A60     		str	r2, [r3]
2797:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_DMA;
 8125              		.loc 1 2797 0
 8126 020a 4FF08062 		mov	r2, #67108864
 8127 020e 1A60     		str	r2, [r3]
 8128 0210 BAE7     		b	.L847
 8129              	.LVL846:
 8130              	.L895:
2772:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P1
 8131              		.loc 1 2772 0
 8132 0212 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 8133 0214 112A     		cmp	r2, #17
 8134 0216 BCD0     		beq	.L857
2773:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P2
 8135              		.loc 1 2773 0
 8136 0218 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 8137 021a 122A     		cmp	r2, #18
 8138 021c B9D0     		beq	.L857
2774:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P3
 8139              		.loc 1 2774 0
 8140 021e 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 8141 0220 132A     		cmp	r2, #19
 8142 0222 B6D0     		beq	.L857
2775:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P4
 8143              		.loc 1 2775 0
 8144 0224 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 8145 0226 142A     		cmp	r2, #20
 8146 0228 B3D0     		beq	.L857
2776:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P5
 8147              		.loc 1 2776 0
 8148 022a 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 8149 022c 152A     		cmp	r2, #21
 8150 022e B0D0     		beq	.L857
2777:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P6
 8151              		.loc 1 2777 0
 8152 0230 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 8153 0232 162A     		cmp	r2, #22
 8154 0234 ADD0     		beq	.L857
2778:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P7) {
 8155              		.loc 1 2778 0
 8156 0236 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 8157 0238 172A     		cmp	r2, #23
 8158 023a AAD0     		beq	.L857
2779:bluetooth_rxtx.c **** 		if (requested_mode != mode) break;
 8159              		.loc 1 2779 0
 8160 023c 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
ARM GAS  /tmp/ccwLngFB.s 			page 217


 8161 023e 182B     		cmp	r3, #24
 8162 0240 A7D0     		beq	.L857
 8163              	.L829:
2798:bluetooth_rxtx.c **** 		//msleep(1000);
2799:bluetooth_rxtx.c **** 	}
2800:bluetooth_rxtx.c **** }
 8164              		.loc 1 2800 0
 8165 0242 0FB0     		add	sp, sp, #60
 8166              		@ sp needed
 8167 0244 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 8168              	.LVL847:
 8169              	.L898:
 8170              		.align	2
 8171              	.L897:
 8172 0248 A8080000 		.word	.LANCHOR2+2216
 8173 024c 00000000 		.word	slave_mac_address_data
 8174 0250 00000000 		.word	.LANCHOR0
 8175 0254 24000000 		.word	.LANCHOR0+36
 8176 0258 00000000 		.word	.LANCHOR1
 8177 025c 80E100E0 		.word	-536813184
 8178 0260 D7BE898E 		.word	-1903575337
 8179 0264 00000000 		.word	clkn
 8180 0268 00E100E0 		.word	-536813312
 8181              		.cfi_endproc
 8182              	.LFE37:
 8184              		.section	.text.rx_generic_sync,"ax",%progbits
 8185              		.align	1
 8186              		.global	rx_generic_sync
 8187              		.thumb
 8188              		.thumb_func
 8190              	rx_generic_sync:
 8191              	.LFB38:
2801:bluetooth_rxtx.c **** 
2802:bluetooth_rxtx.c **** void rx_generic_sync(void) {
 8192              		.loc 1 2802 0
 8193              		.cfi_startproc
 8194              		@ args = 0, pretend = 0, frame = 40
 8195              		@ frame_needed = 0, uses_anonymous_args = 0
 8196 0000 00B5     		push	{lr}
 8197              		.cfi_def_cfa_offset 4
 8198              		.cfi_offset 14, -4
 8199 0002 8BB0     		sub	sp, sp, #44
 8200              		.cfi_def_cfa_offset 48
 8201              	.LVL848:
2803:bluetooth_rxtx.c **** 	u8 len = 32;
2804:bluetooth_rxtx.c **** 	u8 buf[len+4];
2805:bluetooth_rxtx.c **** 	u16 reg_val;
2806:bluetooth_rxtx.c **** 
2807:bluetooth_rxtx.c **** 	/* Put syncword at start of buffer
2808:bluetooth_rxtx.c **** 	 * DGS: fix this later, we don't know number of syncword bytes, etc
2809:bluetooth_rxtx.c **** 	 */
2810:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCH);
 8202              		.loc 1 2810 0
 8203 0004 2D20     		movs	r0, #45
 8204 0006 FFF7FEFF 		bl	cc2400_get
 8205              	.LVL849:
2811:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
ARM GAS  /tmp/ccwLngFB.s 			page 218


 8206              		.loc 1 2811 0
 8207 000a 030A     		lsrs	r3, r0, #8
2812:bluetooth_rxtx.c **** 	buf[1] = reg_val & 0xFF;
 8208              		.loc 1 2812 0
 8209 000c 8DF80500 		strb	r0, [sp, #5]
2813:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCL);
 8210              		.loc 1 2813 0
 8211 0010 2C20     		movs	r0, #44
 8212              	.LVL850:
2811:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 8213              		.loc 1 2811 0
 8214 0012 8DF80430 		strb	r3, [sp, #4]
 8215              		.loc 1 2813 0
 8216 0016 FFF7FEFF 		bl	cc2400_get
 8217              	.LVL851:
2814:bluetooth_rxtx.c **** 	buf[2] = (reg_val >> 8) & 0xFF;
 8218              		.loc 1 2814 0
 8219 001a 030A     		lsrs	r3, r0, #8
 8220 001c 8DF80630 		strb	r3, [sp, #6]
2815:bluetooth_rxtx.c **** 	buf[3] = reg_val & 0xFF;
 8221              		.loc 1 2815 0
 8222 0020 8DF80700 		strb	r0, [sp, #7]
2816:bluetooth_rxtx.c **** 
2817:bluetooth_rxtx.c **** 	queue_init();
 8223              		.loc 1 2817 0
 8224 0024 FFF7FEFF 		bl	queue_init
 8225              	.LVL852:
2818:bluetooth_rxtx.c **** 	clkn_start();
 8226              		.loc 1 2818 0
 8227 0028 FFF7FEFF 		bl	clkn_start
 8228              	.LVL853:
 8229              	.L901:
2819:bluetooth_rxtx.c **** 
2820:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8230              		.loc 1 2820 0 discriminator 1
 8231 002c FFF7FEFF 		bl	cc2400_status
 8232              	.LVL854:
 8233 0030 4006     		lsls	r0, r0, #25
 8234 0032 FBD5     		bpl	.L901
2821:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 8235              		.loc 1 2821 0
 8236 0034 6120     		movs	r0, #97
 8237 0036 FFF7FEFF 		bl	cc2400_strobe
 8238              	.LVL855:
 8239              	.L903:
2822:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 8240              		.loc 1 2822 0 discriminator 1
 8241 003a FFF7FEFF 		bl	cc2400_status
 8242              	.LVL856:
 8243 003e 4107     		lsls	r1, r0, #29
 8244 0040 FBD5     		bpl	.L903
2823:bluetooth_rxtx.c **** 	RXLED_SET;
 8245              		.loc 1 2823 0
 8246 0042 144B     		ldr	r3, .L909
 8247 0044 1022     		movs	r2, #16
 8248 0046 1A60     		str	r2, [r3]
2824:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
ARM GAS  /tmp/ccwLngFB.s 			page 219


2825:bluetooth_rxtx.c **** 		PAEN_SET;
 8249              		.loc 1 2825 0
 8250 0048 8022     		movs	r2, #128
 8251 004a 1A62     		str	r2, [r3, #32]
2826:bluetooth_rxtx.c **** 		HGM_SET;
 8252              		.loc 1 2826 0
 8253 004c 4FF48072 		mov	r2, #256
 8254 0050 1A62     		str	r2, [r3, #32]
 8255              	.L905:
2827:bluetooth_rxtx.c **** #endif
2828:bluetooth_rxtx.c **** 	while (1) {
2829:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 8256              		.loc 1 2829 0 discriminator 1
 8257 0052 0E20     		movs	r0, #14
 8258 0054 FFF7FEFF 		bl	cc2400_get
 8259              	.LVL857:
 8260 0058 00F01F00 		and	r0, r0, #31
 8261 005c 0F28     		cmp	r0, #15
 8262 005e F8D1     		bne	.L905
2830:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 8263              		.loc 1 2830 0
 8264 0060 6220     		movs	r0, #98
 8265 0062 FFF7FEFF 		bl	cc2400_strobe
 8266              	.LVL858:
2831:bluetooth_rxtx.c **** 		USRLED_CLR;
 8267              		.loc 1 2831 0
 8268 0066 0C4B     		ldr	r3, .L909+4
 8269 0068 0222     		movs	r2, #2
 8270 006a 1A60     		str	r2, [r3]
 8271              	.L907:
2832:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
 8272              		.loc 1 2832 0 discriminator 1
 8273 006c FFF7FEFF 		bl	cc2400_status
 8274              	.LVL859:
 8275 0070 C206     		lsls	r2, r0, #27
 8276 0072 FBD5     		bpl	.L907
2833:bluetooth_rxtx.c **** 		USRLED_SET;
 8277              		.loc 1 2833 0
 8278 0074 074B     		ldr	r3, .L909
 8279 0076 0222     		movs	r2, #2
 8280 0078 1A60     		str	r2, [r3]
2834:bluetooth_rxtx.c **** 
2835:bluetooth_rxtx.c **** 		cc2400_fifo_read(len, buf+4);
 8281              		.loc 1 2835 0
 8282 007a 02A9     		add	r1, sp, #8
 8283 007c 2020     		movs	r0, #32
 8284 007e FFF7FEFF 		bl	cc2400_fifo_read
 8285              	.LVL860:
2836:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
 8286              		.loc 1 2836 0
 8287 0082 01A9     		add	r1, sp, #4
 8288              	.LVL861:
 8289 0084 0020     		movs	r0, #0
 8290 0086 FFF7FEFF 		bl	enqueue
 8291              	.LVL862:
2837:bluetooth_rxtx.c **** 		handle_usb(clkn);
 8292              		.loc 1 2837 0
ARM GAS  /tmp/ccwLngFB.s 			page 220


 8293 008a 044B     		ldr	r3, .L909+8
 8294 008c 1868     		ldr	r0, [r3]
 8295 008e FFF7FEFF 		bl	handle_usb
 8296              	.LVL863:
2838:bluetooth_rxtx.c **** 	}
 8297              		.loc 1 2838 0
 8298 0092 DEE7     		b	.L905
 8299              	.L910:
 8300              		.align	2
 8301              	.L909:
 8302 0094 38C00920 		.word	537509944
 8303 0098 3CC00920 		.word	537509948
 8304 009c 00000000 		.word	clkn
 8305              		.cfi_endproc
 8306              	.LFE38:
 8308              		.section	.text.rx_generic,"ax",%progbits
 8309              		.align	1
 8310              		.global	rx_generic
 8311              		.thumb
 8312              		.thumb_func
 8314              	rx_generic:
 8315              	.LFB39:
2839:bluetooth_rxtx.c **** }
2840:bluetooth_rxtx.c **** 
2841:bluetooth_rxtx.c **** void rx_generic(void) {
 8316              		.loc 1 2841 0
 8317              		.cfi_startproc
 8318              		@ args = 0, pretend = 0, frame = 0
 8319              		@ frame_needed = 0, uses_anonymous_args = 0
 8320 0000 08B5     		push	{r3, lr}
 8321              		.cfi_def_cfa_offset 8
 8322              		.cfi_offset 3, -8
 8323              		.cfi_offset 14, -4
2842:bluetooth_rxtx.c **** 	// Check for packet mode
2843:bluetooth_rxtx.c **** 	if(cc2400_get(GRMDM) && 0x0400) {
 8324              		.loc 1 2843 0
 8325 0002 2020     		movs	r0, #32
 8326 0004 FFF7FEFF 		bl	cc2400_get
 8327              	.LVL864:
 8328 0008 08B1     		cbz	r0, .L912
2844:bluetooth_rxtx.c **** 		rx_generic_sync();
 8329              		.loc 1 2844 0
 8330 000a FFF7FEFF 		bl	rx_generic_sync
 8331              	.LVL865:
 8332              	.L912:
2845:bluetooth_rxtx.c **** 	} else {
2846:bluetooth_rxtx.c **** 		modulation = MOD_NONE;
 8333              		.loc 1 2846 0
 8334 000e 034B     		ldr	r3, .L913
 8335 0010 0322     		movs	r2, #3
 8336 0012 1A70     		strb	r2, [r3]
2847:bluetooth_rxtx.c **** 		bt_stream_rx();
2848:bluetooth_rxtx.c **** 	}
2849:bluetooth_rxtx.c **** }
 8337              		.loc 1 2849 0
 8338 0014 BDE80840 		pop	{r3, lr}
2847:bluetooth_rxtx.c **** 		bt_stream_rx();
ARM GAS  /tmp/ccwLngFB.s 			page 221


 8339              		.loc 1 2847 0
 8340 0018 FFF7FEBF 		b	bt_stream_rx
 8341              	.LVL866:
 8342              	.L914:
 8343              		.align	2
 8344              	.L913:
 8345 001c 00000000 		.word	.LANCHOR0
 8346              		.cfi_endproc
 8347              	.LFE39:
 8349              		.section	.text.tx_generic,"ax",%progbits
 8350              		.align	1
 8351              		.global	tx_generic
 8352              		.thumb
 8353              		.thumb_func
 8355              	tx_generic:
 8356              	.LFB40:
2850:bluetooth_rxtx.c **** 
2851:bluetooth_rxtx.c **** void tx_generic(void) {
 8357              		.loc 1 2851 0
 8358              		.cfi_startproc
 8359              		@ args = 0, pretend = 0, frame = 0
 8360              		@ frame_needed = 0, uses_anonymous_args = 0
 8361 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 8362              		.cfi_def_cfa_offset 24
 8363              		.cfi_offset 4, -24
 8364              		.cfi_offset 5, -20
 8365              		.cfi_offset 6, -16
 8366              		.cfi_offset 7, -12
 8367              		.cfi_offset 8, -8
 8368              		.cfi_offset 14, -4
2852:bluetooth_rxtx.c **** 	u16 synch, syncl;
2853:bluetooth_rxtx.c **** 	u8 prev_mode = mode;
 8369              		.loc 1 2853 0
 8370 0004 354D     		ldr	r5, .L926
2854:bluetooth_rxtx.c **** 
2855:bluetooth_rxtx.c **** 	mode = MODE_TX_GENERIC;
 8371              		.loc 1 2855 0
 8372 0006 1023     		movs	r3, #16
2856:bluetooth_rxtx.c **** 
2857:bluetooth_rxtx.c **** 	// Save existing syncword
2858:bluetooth_rxtx.c **** 	synch = cc2400_get(SYNCH);
 8373              		.loc 1 2858 0
 8374 0008 2D20     		movs	r0, #45
2853:bluetooth_rxtx.c **** 
 8375              		.loc 1 2853 0
 8376 000a 6E7C     		ldrb	r6, [r5, #17]	@ zero_extendqisi2
2855:bluetooth_rxtx.c **** 
 8377              		.loc 1 2855 0
 8378 000c 6B74     		strb	r3, [r5, #17]
 8379              		.loc 1 2858 0
 8380 000e FFF7FEFF 		bl	cc2400_get
 8381              	.LVL867:
 8382 0012 8046     		mov	r8, r0
2859:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 8383              		.loc 1 2859 0
 8384 0014 2C20     		movs	r0, #44
 8385 0016 FFF7FEFF 		bl	cc2400_get
ARM GAS  /tmp/ccwLngFB.s 			page 222


 8386              	.LVL868:
2860:bluetooth_rxtx.c **** 
2861:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, tx_pkt.synch);
 8387              		.loc 1 2861 0
 8388 001a 314C     		ldr	r4, .L926+4
2859:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 8389              		.loc 1 2859 0
 8390 001c 0746     		mov	r7, r0
 8391              		.loc 1 2861 0
 8392 001e 2188     		ldrh	r1, [r4]
 8393 0020 2D20     		movs	r0, #45
 8394 0022 FFF7FEFF 		bl	cc2400_set
 8395              	.LVL869:
2862:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, tx_pkt.syncl);
 8396              		.loc 1 2862 0
 8397 0026 2C20     		movs	r0, #44
 8398 0028 6188     		ldrh	r1, [r4, #2]
 8399 002a FFF7FEFF 		bl	cc2400_set
 8400              	.LVL870:
2863:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0057);
 8401              		.loc 1 2863 0
 8402 002e 0320     		movs	r0, #3
 8403 0030 5721     		movs	r1, #87
 8404 0032 FFF7FEFF 		bl	cc2400_set
 8405              	.LVL871:
2864:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);
 8406              		.loc 1 2864 0
 8407 0036 1420     		movs	r0, #20
 8408 0038 41F24B31 		movw	r1, #4939
 8409 003c FFF7FEFF 		bl	cc2400_set
 8410              	.LVL872:
2865:bluetooth_rxtx.c **** 	cc2400_set(GRMDM, 0x0f61);
 8411              		.loc 1 2865 0
 8412 0040 2020     		movs	r0, #32
 8413 0042 40F66171 		movw	r1, #3937
 8414 0046 FFF7FEFF 		bl	cc2400_set
 8415              	.LVL873:
2866:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, tx_pkt.channel);
 8416              		.loc 1 2866 0
 8417 004a 0220     		movs	r0, #2
 8418 004c A188     		ldrh	r1, [r4, #4]
 8419 004e FFF7FEFF 		bl	cc2400_set
 8420              	.LVL874:
2867:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pkt.pa_level);
 8421              		.loc 1 2867 0
 8422 0052 0520     		movs	r0, #5
 8423 0054 E179     		ldrb	r1, [r4, #7]	@ zero_extendqisi2
2853:bluetooth_rxtx.c **** 
 8424              		.loc 1 2853 0
 8425 0056 F6B2     		uxtb	r6, r6
 8426              	.LVL875:
 8427              		.loc 1 2867 0
 8428 0058 FFF7FEFF 		bl	cc2400_set
 8429              	.LVL876:
 8430              	.L917:
2868:bluetooth_rxtx.c **** 
2869:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
ARM GAS  /tmp/ccwLngFB.s 			page 223


 8431              		.loc 1 2869 0 discriminator 1
 8432 005c FFF7FEFF 		bl	cc2400_status
 8433              	.LVL877:
 8434 0060 4206     		lsls	r2, r0, #25
 8435 0062 FBD5     		bpl	.L917
2870:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 8436              		.loc 1 2870 0
 8437 0064 6120     		movs	r0, #97
 8438 0066 FFF7FEFF 		bl	cc2400_strobe
 8439              	.LVL878:
 8440              	.L919:
2871:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 8441              		.loc 1 2871 0 discriminator 1
 8442 006a FFF7FEFF 		bl	cc2400_status
 8443              	.LVL879:
 8444 006e 4307     		lsls	r3, r0, #29
 8445 0070 FBD5     		bpl	.L919
2872:bluetooth_rxtx.c **** 	TXLED_SET;
 8446              		.loc 1 2872 0
 8447 0072 1C4B     		ldr	r3, .L926+8
 8448 0074 4FF48072 		mov	r2, #256
 8449 0078 1A60     		str	r2, [r3]
2873:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2874:bluetooth_rxtx.c **** 		PAEN_SET;
 8450              		.loc 1 2874 0
 8451 007a 8022     		movs	r2, #128
 8452 007c 1A62     		str	r2, [r3, #32]
 8453              	.L921:
2875:bluetooth_rxtx.c **** #endif
2876:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 8454              		.loc 1 2876 0 discriminator 1
 8455 007e 0E20     		movs	r0, #14
 8456 0080 FFF7FEFF 		bl	cc2400_get
 8457              	.LVL880:
 8458 0084 00F01F00 		and	r0, r0, #31
 8459 0088 0F28     		cmp	r0, #15
 8460 008a F8D1     		bne	.L921
2877:bluetooth_rxtx.c **** 
2878:bluetooth_rxtx.c **** 	cc2400_fifo_write(tx_pkt.length, tx_pkt.data);
 8461              		.loc 1 2878 0
 8462 008c A079     		ldrb	r0, [r4, #6]	@ zero_extendqisi2
 8463 008e 1649     		ldr	r1, .L926+12
 8464 0090 FFF7FEFF 		bl	cc2400_fifo_write
 8465              	.LVL881:
2879:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 8466              		.loc 1 2879 0
 8467 0094 6320     		movs	r0, #99
 8468 0096 FFF7FEFF 		bl	cc2400_strobe
 8469              	.LVL882:
 8470              	.L923:
2880:bluetooth_rxtx.c **** 
2881:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 8471              		.loc 1 2881 0 discriminator 1
 8472 009a 0E20     		movs	r0, #14
 8473 009c FFF7FEFF 		bl	cc2400_get
 8474              	.LVL883:
 8475 00a0 00F01F00 		and	r0, r0, #31
ARM GAS  /tmp/ccwLngFB.s 			page 224


 8476 00a4 0F28     		cmp	r0, #15
 8477 00a6 F8D1     		bne	.L923
2882:bluetooth_rxtx.c **** 	TXLED_CLR;
 8478              		.loc 1 2882 0
 8479 00a8 104B     		ldr	r3, .L926+16
 8480 00aa 4FF48072 		mov	r2, #256
 8481 00ae 1A60     		str	r2, [r3]
2883:bluetooth_rxtx.c **** 
2884:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 8482              		.loc 1 2884 0
 8483 00b0 6420     		movs	r0, #100
 8484 00b2 FFF7FEFF 		bl	cc2400_strobe
 8485              	.LVL884:
 8486              	.L925:
2885:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 8487              		.loc 1 2885 0 discriminator 1
 8488 00b6 FFF7FEFF 		bl	cc2400_status
 8489              	.LVL885:
 8490 00ba 4407     		lsls	r4, r0, #29
 8491 00bc FBD4     		bmi	.L925
2886:bluetooth_rxtx.c **** 
2887:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2888:bluetooth_rxtx.c **** 	PAEN_CLR;
 8492              		.loc 1 2888 0
 8493 00be 0C4B     		ldr	r3, .L926+20
 8494 00c0 8022     		movs	r2, #128
 8495 00c2 1A60     		str	r2, [r3]
2889:bluetooth_rxtx.c **** #endif
2890:bluetooth_rxtx.c **** 
2891:bluetooth_rxtx.c **** 	// Restore state
2892:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, synch);
 8496              		.loc 1 2892 0
 8497 00c4 2D20     		movs	r0, #45
 8498 00c6 4146     		mov	r1, r8
 8499 00c8 FFF7FEFF 		bl	cc2400_set
 8500              	.LVL886:
2893:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, syncl);
 8501              		.loc 1 2893 0
 8502 00cc 2C20     		movs	r0, #44
 8503 00ce 3946     		mov	r1, r7
 8504 00d0 FFF7FEFF 		bl	cc2400_set
 8505              	.LVL887:
2894:bluetooth_rxtx.c **** 	requested_mode = prev_mode;
 8506              		.loc 1 2894 0
 8507 00d4 AE74     		strb	r6, [r5, #18]
 8508 00d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 8509              	.LVL888:
 8510              	.L927:
 8511 00da 00BF     		.align	2
 8512              	.L926:
 8513 00dc 00000000 		.word	.LANCHOR0
 8514 00e0 00000000 		.word	tx_pkt
 8515 00e4 38C00920 		.word	537509944
 8516 00e8 08000000 		.word	tx_pkt+8
 8517 00ec 3CC00920 		.word	537509948
 8518 00f0 5CC00920 		.word	537509980
 8519              		.cfi_endproc
ARM GAS  /tmp/ccwLngFB.s 			page 225


 8520              	.LFE40:
 8522              		.section	.text.specan,"ax",%progbits
 8523              		.align	1
 8524              		.global	specan
 8525              		.thumb
 8526              		.thumb_func
 8528              	specan:
 8529              	.LFB41:
2895:bluetooth_rxtx.c **** }
2896:bluetooth_rxtx.c **** 
2897:bluetooth_rxtx.c **** /* spectrum analysis */
2898:bluetooth_rxtx.c **** void specan()
2899:bluetooth_rxtx.c **** {
 8530              		.loc 1 2899 0
 8531              		.cfi_startproc
 8532              		@ args = 0, pretend = 0, frame = 56
 8533              		@ frame_needed = 0, uses_anonymous_args = 0
 8534 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 8535              		.cfi_def_cfa_offset 24
 8536              		.cfi_offset 4, -24
 8537              		.cfi_offset 5, -20
 8538              		.cfi_offset 6, -16
 8539              		.cfi_offset 7, -12
 8540              		.cfi_offset 8, -8
 8541              		.cfi_offset 14, -4
 8542 0004 8EB0     		sub	sp, sp, #56
 8543              		.cfi_def_cfa_offset 80
 8544              	.LVL889:
2900:bluetooth_rxtx.c **** 	u16 f;
2901:bluetooth_rxtx.c **** 	u8 i = 0;
2902:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
2903:bluetooth_rxtx.c **** 
2904:bluetooth_rxtx.c **** 	RXLED_SET;
 8545              		.loc 1 2904 0
 8546 0006 3D4B     		ldr	r3, .L945
 8547 0008 1022     		movs	r2, #16
 8548 000a 1A60     		str	r2, [r3]
2905:bluetooth_rxtx.c **** 
2906:bluetooth_rxtx.c **** 	queue_init();
 8549              		.loc 1 2906 0
 8550 000c FFF7FEFF 		bl	queue_init
 8551              	.LVL890:
2907:bluetooth_rxtx.c **** 	clkn_start();
 8552              		.loc 1 2907 0
 8553 0010 FFF7FEFF 		bl	clkn_start
 8554              	.LVL891:
2908:bluetooth_rxtx.c **** 
2909:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2910:bluetooth_rxtx.c **** 	PAEN_SET;
 8555              		.loc 1 2910 0
 8556 0014 3A4B     		ldr	r3, .L945+4
 8557 0016 8022     		movs	r2, #128
 8558 0018 1A60     		str	r2, [r3]
2911:bluetooth_rxtx.c **** 	//HGM_SET;
2912:bluetooth_rxtx.c **** #endif
2913:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 8559              		.loc 1 2913 0
ARM GAS  /tmp/ccwLngFB.s 			page 226


 8560 001a 1220     		movs	r0, #18
 8561 001c 42F62231 		movw	r1, #11042
 8562 0020 FFF7FEFF 		bl	cc2400_set
 8563              	.LVL892:
2914:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 8564              		.loc 1 2914 0
 8565 0024 1420     		movs	r0, #20
 8566 0026 41F24B31 		movw	r1, #4939
 8567 002a FFF7FEFF 		bl	cc2400_set
 8568              	.LVL893:
2915:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 8569              		.loc 1 2915 0
 8570 002e 2020     		movs	r0, #32
 8571 0030 40F20111 		movw	r1, #257
 8572 0034 FFF7FEFF 		bl	cc2400_set
 8573              	.LVL894:
2916:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 8574              		.loc 1 2916 0
 8575 0038 0320     		movs	r0, #3
 8576 003a 2921     		movs	r1, #41
 8577 003c FFF7FEFF 		bl	cc2400_set
 8578              	.LVL895:
 8579              	.L930:
2917:bluetooth_rxtx.c **** 	//FIXME maybe set RSSI.RSSI_FILT
2918:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8580              		.loc 1 2918 0 discriminator 1
 8581 0040 FFF7FEFF 		bl	cc2400_status
 8582              	.LVL896:
 8583 0044 4406     		lsls	r4, r0, #25
 8584 0046 FBD5     		bpl	.L930
 8585              	.L932:
2919:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 8586              		.loc 1 2919 0
 8587 0048 FFF7FEFF 		bl	cc2400_status
 8588              	.LVL897:
 8589 004c 00F00400 		and	r0, r0, #4
 8590 0050 00F0FF05 		and	r5, r0, #255
 8591 0054 0028     		cmp	r0, #0
 8592 0056 F7D1     		bne	.L932
 8593              	.LVL898:
 8594              	.L933:
2920:bluetooth_rxtx.c **** 
2921:bluetooth_rxtx.c **** 	while (requested_mode == MODE_SPECAN) {
 8595              		.loc 1 2921 0 discriminator 1
 8596 0058 2A4B     		ldr	r3, .L945+8
 8597 005a 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 8598 005c 042B     		cmp	r3, #4
 8599 005e 47D1     		bne	.L944
2922:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 8600              		.loc 1 2922 0
 8601 0060 294B     		ldr	r3, .L945+12
 8602 0062 B3F84C40 		ldrh	r4, [r3, #76]
 8603 0066 9846     		mov	r8, r3
 8604 0068 A4B2     		uxth	r4, r4
 8605              	.LVL899:
 8606              	.L934:
 8607              		.loc 1 2922 0 is_stmt 0 discriminator 1
ARM GAS  /tmp/ccwLngFB.s 			page 227


 8608 006a B8F84E30 		ldrh	r3, [r8, #78]
 8609 006e 9BB2     		uxth	r3, r3
 8610 0070 A342     		cmp	r3, r4
 8611 0072 F1DB     		blt	.L933
 8612 0074 611E     		subs	r1, r4, #1
 8613              	.LBB92:
2923:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 8614              		.loc 1 2923 0 is_stmt 1
 8615 0076 0220     		movs	r0, #2
 8616 0078 89B2     		uxth	r1, r1
 8617 007a FFF7FEFF 		bl	cc2400_set
 8618              	.LVL900:
2924:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 8619              		.loc 1 2924 0
 8620 007e 6120     		movs	r0, #97
 8621 0080 FFF7FEFF 		bl	cc2400_strobe
 8622              	.LVL901:
 8623              	.L936:
2925:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 8624              		.loc 1 2925 0 discriminator 1
 8625 0084 FFF7FEFF 		bl	cc2400_status
 8626              	.LVL902:
 8627 0088 4007     		lsls	r0, r0, #29
 8628 008a FBD5     		bpl	.L936
2926:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 8629              		.loc 1 2926 0
 8630 008c 6220     		movs	r0, #98
 8631 008e FFF7FEFF 		bl	cc2400_strobe
 8632              	.LVL903:
2927:bluetooth_rxtx.c **** 
2928:bluetooth_rxtx.c **** 			/* give the CC2400 time to acquire RSSI reading */
2929:bluetooth_rxtx.c **** 			volatile u32 j = 500; while (--j); //FIXME crude delay
 8633              		.loc 1 2929 0
 8634 0092 4FF4FA73 		mov	r3, #500
 8635 0096 0093     		str	r3, [sp]
 8636              	.L938:
 8637              		.loc 1 2929 0 is_stmt 0 discriminator 1
 8638 0098 009E     		ldr	r6, [sp]
 8639 009a 013E     		subs	r6, r6, #1
 8640 009c 0096     		str	r6, [sp]
 8641 009e 002E     		cmp	r6, #0
 8642 00a0 FAD1     		bne	.L938
2930:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 8643              		.loc 1 2930 0 is_stmt 1
 8644 00a2 0EAB     		add	r3, sp, #56
 8645 00a4 0327     		movs	r7, #3
 8646 00a6 07FB0537 		mla	r7, r7, r5, r3
2931:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
2932:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
 8647              		.loc 1 2932 0
 8648 00aa 0620     		movs	r0, #6
2930:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 8649              		.loc 1 2930 0
 8650 00ac 230A     		lsrs	r3, r4, #8
 8651 00ae 07F8343C 		strb	r3, [r7, #-52]
2931:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
 8652              		.loc 1 2931 0
ARM GAS  /tmp/ccwLngFB.s 			page 228


 8653 00b2 07F8334C 		strb	r4, [r7, #-51]
 8654              		.loc 1 2932 0
 8655 00b6 FFF7FEFF 		bl	cc2400_get
 8656              	.LVL904:
2933:bluetooth_rxtx.c **** 			i++;
 8657              		.loc 1 2933 0
 8658 00ba 0135     		adds	r5, r5, #1
 8659              	.LVL905:
 8660 00bc EDB2     		uxtb	r5, r5
 8661              	.LVL906:
2932:bluetooth_rxtx.c **** 			i++;
 8662              		.loc 1 2932 0
 8663 00be 000A     		lsrs	r0, r0, #8
2934:bluetooth_rxtx.c **** 			if (i == 16) {
 8664              		.loc 1 2934 0
 8665 00c0 102D     		cmp	r5, #16
2932:bluetooth_rxtx.c **** 			i++;
 8666              		.loc 1 2932 0
 8667 00c2 07F8320C 		strb	r0, [r7, #-50]
 8668              		.loc 1 2934 0
 8669 00c6 09D1     		bne	.L939
2935:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 8670              		.loc 1 2935 0
 8671 00c8 0420     		movs	r0, #4
 8672 00ca 0DEB0001 		add	r1, sp, r0
 8673 00ce FFF7FEFF 		bl	enqueue
 8674              	.LVL907:
2936:bluetooth_rxtx.c **** 				i = 0;
2937:bluetooth_rxtx.c **** 
2938:bluetooth_rxtx.c **** 				handle_usb(clkn);
 8675              		.loc 1 2938 0
 8676 00d2 0E4B     		ldr	r3, .L945+16
2936:bluetooth_rxtx.c **** 				i = 0;
 8677              		.loc 1 2936 0
 8678 00d4 3546     		mov	r5, r6
 8679              		.loc 1 2938 0
 8680 00d6 1868     		ldr	r0, [r3]
 8681 00d8 FFF7FEFF 		bl	handle_usb
 8682              	.LVL908:
 8683              	.L939:
2939:bluetooth_rxtx.c **** 			}
2940:bluetooth_rxtx.c **** 
2941:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 8684              		.loc 1 2941 0
 8685 00dc 6420     		movs	r0, #100
 8686 00de FFF7FEFF 		bl	cc2400_strobe
 8687              	.LVL909:
 8688              	.L941:
2942:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 8689              		.loc 1 2942 0 discriminator 1
 8690 00e2 FFF7FEFF 		bl	cc2400_status
 8691              	.LVL910:
 8692 00e6 4107     		lsls	r1, r0, #29
 8693 00e8 FBD4     		bmi	.L941
 8694              	.LBE92:
2922:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 8695              		.loc 1 2922 0
ARM GAS  /tmp/ccwLngFB.s 			page 229


 8696 00ea 0134     		adds	r4, r4, #1
 8697              	.LVL911:
 8698 00ec A4B2     		uxth	r4, r4
 8699              	.LVL912:
 8700 00ee BCE7     		b	.L934
 8701              	.LVL913:
 8702              	.L944:
2943:bluetooth_rxtx.c **** 		}
2944:bluetooth_rxtx.c **** 	}
2945:bluetooth_rxtx.c **** 	RXLED_CLR;
 8703              		.loc 1 2945 0
 8704 00f0 074B     		ldr	r3, .L945+20
 8705 00f2 1022     		movs	r2, #16
 8706 00f4 1A60     		str	r2, [r3]
2946:bluetooth_rxtx.c **** }
 8707              		.loc 1 2946 0
 8708 00f6 0EB0     		add	sp, sp, #56
 8709              		@ sp needed
 8710 00f8 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 8711              	.LVL914:
 8712              	.L946:
 8713              		.align	2
 8714              	.L945:
 8715 00fc 38C00920 		.word	537509944
 8716 0100 58C00920 		.word	537509976
 8717 0104 00000000 		.word	.LANCHOR0
 8718 0108 00000000 		.word	.LANCHOR1
 8719 010c 00000000 		.word	clkn
 8720 0110 3CC00920 		.word	537509948
 8721              		.cfi_endproc
 8722              	.LFE41:
 8724              		.section	.text.led_specan,"ax",%progbits
 8725              		.align	1
 8726              		.global	led_specan
 8727              		.thumb
 8728              		.thumb_func
 8730              	led_specan:
 8731              	.LFB42:
2947:bluetooth_rxtx.c **** 
2948:bluetooth_rxtx.c **** /* LED based spectrum analysis */
2949:bluetooth_rxtx.c **** void led_specan()
2950:bluetooth_rxtx.c **** {
 8732              		.loc 1 2950 0
 8733              		.cfi_startproc
 8734              		@ args = 0, pretend = 0, frame = 16
 8735              		@ frame_needed = 0, uses_anonymous_args = 0
 8736 0000 1FB5     		push	{r0, r1, r2, r3, r4, lr}
 8737              		.cfi_def_cfa_offset 24
 8738              		.cfi_offset 0, -24
 8739              		.cfi_offset 1, -20
 8740              		.cfi_offset 2, -16
 8741              		.cfi_offset 3, -12
 8742              		.cfi_offset 4, -8
 8743              		.cfi_offset 14, -4
 8744              	.LVL915:
2951:bluetooth_rxtx.c **** 	int8_t lvl;
2952:bluetooth_rxtx.c **** 	u8 i = 0;
ARM GAS  /tmp/ccwLngFB.s 			page 230


2953:bluetooth_rxtx.c **** 	u16 channels[3] = {2412, 2437, 2462};
 8745              		.loc 1 2953 0
 8746 0002 444B     		ldr	r3, .L974
2954:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
2955:bluetooth_rxtx.c **** 	//void (*clr[3]) = {TXLED_CLR, RXLED_CLR, USRLED_CLR};
2956:bluetooth_rxtx.c **** 
2957:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2958:bluetooth_rxtx.c **** 	PAEN_SET;
 8747              		.loc 1 2958 0
 8748 0004 8022     		movs	r2, #128
2953:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
 8749              		.loc 1 2953 0
 8750 0006 1868     		ldr	r0, [r3]	@ unaligned
 8751 0008 9B88     		ldrh	r3, [r3, #4]	@ unaligned
 8752 000a 0290     		str	r0, [sp, #8]	@ unaligned
 8753 000c ADF80C30 		strh	r3, [sp, #12]	@ unaligned
 8754              		.loc 1 2958 0
 8755 0010 414B     		ldr	r3, .L974+4
2959:bluetooth_rxtx.c **** 	//HGM_SET;
2960:bluetooth_rxtx.c **** #endif
2961:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 8756              		.loc 1 2961 0
 8757 0012 1220     		movs	r0, #18
2958:bluetooth_rxtx.c **** 	//HGM_SET;
 8758              		.loc 1 2958 0
 8759 0014 1A60     		str	r2, [r3]
 8760              		.loc 1 2961 0
 8761 0016 42F62231 		movw	r1, #11042
 8762 001a FFF7FEFF 		bl	cc2400_set
 8763              	.LVL916:
2962:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 8764              		.loc 1 2962 0
 8765 001e 1420     		movs	r0, #20
 8766 0020 41F24B31 		movw	r1, #4939
 8767 0024 FFF7FEFF 		bl	cc2400_set
 8768              	.LVL917:
2963:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 8769              		.loc 1 2963 0
 8770 0028 2020     		movs	r0, #32
 8771 002a 40F20111 		movw	r1, #257
 8772 002e FFF7FEFF 		bl	cc2400_set
 8773              	.LVL918:
2964:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 8774              		.loc 1 2964 0
 8775 0032 0320     		movs	r0, #3
 8776 0034 2921     		movs	r1, #41
 8777 0036 FFF7FEFF 		bl	cc2400_set
 8778              	.LVL919:
2965:bluetooth_rxtx.c **** 	cc2400_set(RSSI,    0x00F1); // RSSI Sample over 2 symbols
 8779              		.loc 1 2965 0
 8780 003a 0620     		movs	r0, #6
 8781 003c F121     		movs	r1, #241
 8782 003e FFF7FEFF 		bl	cc2400_set
 8783              	.LVL920:
 8784              	.L949:
2966:bluetooth_rxtx.c **** 
2967:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
ARM GAS  /tmp/ccwLngFB.s 			page 231


 8785              		.loc 1 2967 0 discriminator 1
 8786 0042 FFF7FEFF 		bl	cc2400_status
 8787              	.LVL921:
 8788 0046 4106     		lsls	r1, r0, #25
 8789 0048 FBD5     		bpl	.L949
 8790              	.L951:
2968:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 8791              		.loc 1 2968 0
 8792 004a FFF7FEFF 		bl	cc2400_status
 8793              	.LVL922:
 8794 004e 00F00400 		and	r0, r0, #4
 8795 0052 00F0FF04 		and	r4, r0, #255
 8796 0056 0028     		cmp	r0, #0
 8797 0058 F7D1     		bne	.L951
 8798              	.LVL923:
 8799              	.L952:
2969:bluetooth_rxtx.c **** 
2970:bluetooth_rxtx.c **** 	while (requested_mode == MODE_LED_SPECAN) {
 8800              		.loc 1 2970 0 discriminator 1
 8801 005a 304B     		ldr	r3, .L974+8
 8802 005c 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 8803 005e 072B     		cmp	r3, #7
 8804 0060 55D1     		bne	.L973
 8805              	.LBB93:
2971:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 8806              		.loc 1 2971 0
 8807 0062 04AA     		add	r2, sp, #16
 8808 0064 02EB4403 		add	r3, r2, r4, lsl #1
 8809 0068 33F8081C 		ldrh	r1, [r3, #-8]
 8810 006c 0220     		movs	r0, #2
 8811 006e 0139     		subs	r1, r1, #1
 8812 0070 89B2     		uxth	r1, r1
 8813 0072 FFF7FEFF 		bl	cc2400_set
 8814              	.LVL924:
2972:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 8815              		.loc 1 2972 0
 8816 0076 6120     		movs	r0, #97
 8817 0078 FFF7FEFF 		bl	cc2400_strobe
 8818              	.LVL925:
 8819              	.L954:
2973:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 8820              		.loc 1 2973 0 discriminator 1
 8821 007c FFF7FEFF 		bl	cc2400_status
 8822              	.LVL926:
 8823 0080 4207     		lsls	r2, r0, #29
 8824 0082 FBD5     		bpl	.L954
2974:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 8825              		.loc 1 2974 0
 8826 0084 6220     		movs	r0, #98
 8827 0086 FFF7FEFF 		bl	cc2400_strobe
 8828              	.LVL927:
2975:bluetooth_rxtx.c **** 
2976:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
2977:bluetooth_rxtx.c **** 		volatile u32 j = 500; while (--j); //FIXME crude delay
 8829              		.loc 1 2977 0
 8830 008a 4FF4FA73 		mov	r3, #500
 8831 008e 0193     		str	r3, [sp, #4]
ARM GAS  /tmp/ccwLngFB.s 			page 232


 8832              	.L956:
 8833              		.loc 1 2977 0 is_stmt 0 discriminator 1
 8834 0090 019B     		ldr	r3, [sp, #4]
 8835 0092 013B     		subs	r3, r3, #1
 8836 0094 0193     		str	r3, [sp, #4]
 8837 0096 002B     		cmp	r3, #0
 8838 0098 FAD1     		bne	.L956
2978:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
 8839              		.loc 1 2978 0 is_stmt 1
 8840 009a 0620     		movs	r0, #6
 8841 009c FFF7FEFF 		bl	cc2400_get
 8842              	.LVL928:
2979:bluetooth_rxtx.c **** 		if (lvl > rssi_threshold) {
 8843              		.loc 1 2979 0
 8844 00a0 1F4B     		ldr	r3, .L974+12
 8845 00a2 40F30720 		sbfx	r0, r0, #8, #8
 8846              	.LVL929:
 8847 00a6 93F85030 		ldrb	r3, [r3, #80]	@ zero_extendqisi2
 8848 00aa 5BB2     		sxtb	r3, r3
 8849 00ac 9842     		cmp	r0, r3
 8850 00ae 0CDD     		ble	.L957
2980:bluetooth_rxtx.c **** 			switch (i) {
 8851              		.loc 1 2980 0
 8852 00b0 012C     		cmp	r4, #1
 8853 00b2 07D0     		beq	.L959
 8854 00b4 03D3     		bcc	.L960
 8855 00b6 022C     		cmp	r4, #2
 8856 00b8 16D1     		bne	.L958
2981:bluetooth_rxtx.c **** 				case 0:
2982:bluetooth_rxtx.c **** 					TXLED_SET;
2983:bluetooth_rxtx.c **** 					break;
2984:bluetooth_rxtx.c **** 				case 1:
2985:bluetooth_rxtx.c **** 					RXLED_SET;
2986:bluetooth_rxtx.c **** 					break;
2987:bluetooth_rxtx.c **** 				case 2:
2988:bluetooth_rxtx.c **** 					USRLED_SET;
 8857              		.loc 1 2988 0
 8858 00ba 1A4B     		ldr	r3, .L974+16
 8859 00bc 13E0     		b	.L969
 8860              	.L960:
2982:bluetooth_rxtx.c **** 					break;
 8861              		.loc 1 2982 0
 8862 00be 4FF48072 		mov	r2, #256
 8863 00c2 00E0     		b	.L972
 8864              	.L959:
2985:bluetooth_rxtx.c **** 					break;
 8865              		.loc 1 2985 0
 8866 00c4 1022     		movs	r2, #16
 8867              	.L972:
 8868 00c6 174B     		ldr	r3, .L974+16
 8869 00c8 0BE0     		b	.L971
 8870              	.L957:
2989:bluetooth_rxtx.c **** 					break;
2990:bluetooth_rxtx.c **** 			}
2991:bluetooth_rxtx.c **** 		}
2992:bluetooth_rxtx.c **** 		else {
2993:bluetooth_rxtx.c **** 			switch (i) {
ARM GAS  /tmp/ccwLngFB.s 			page 233


 8871              		.loc 1 2993 0
 8872 00ca 012C     		cmp	r4, #1
 8873 00cc 07D0     		beq	.L962
 8874 00ce 03D3     		bcc	.L963
 8875 00d0 022C     		cmp	r4, #2
 8876 00d2 09D1     		bne	.L958
2994:bluetooth_rxtx.c **** 				case 0:
2995:bluetooth_rxtx.c **** 					TXLED_CLR;
2996:bluetooth_rxtx.c **** 					break;
2997:bluetooth_rxtx.c **** 				case 1:
2998:bluetooth_rxtx.c **** 					RXLED_CLR;
2999:bluetooth_rxtx.c **** 					break;
3000:bluetooth_rxtx.c **** 				case 2:
3001:bluetooth_rxtx.c **** 					USRLED_CLR;
 8877              		.loc 1 3001 0
 8878 00d4 144B     		ldr	r3, .L974+20
 8879 00d6 06E0     		b	.L969
 8880              	.L963:
2995:bluetooth_rxtx.c **** 					break;
 8881              		.loc 1 2995 0
 8882 00d8 4FF48072 		mov	r2, #256
 8883 00dc 00E0     		b	.L970
 8884              	.L962:
2998:bluetooth_rxtx.c **** 					break;
 8885              		.loc 1 2998 0
 8886 00de 1022     		movs	r2, #16
 8887              	.L970:
 8888 00e0 114B     		ldr	r3, .L974+20
 8889              	.L971:
 8890 00e2 1A60     		str	r2, [r3]
2999:bluetooth_rxtx.c **** 				case 2:
 8891              		.loc 1 2999 0
 8892 00e4 00E0     		b	.L958
 8893              	.L969:
 8894              		.loc 1 3001 0
 8895 00e6 1C60     		str	r4, [r3]
 8896              	.L958:
3002:bluetooth_rxtx.c **** 					break;
3003:bluetooth_rxtx.c **** 			}
3004:bluetooth_rxtx.c **** 		}
3005:bluetooth_rxtx.c **** 
3006:bluetooth_rxtx.c **** 		i = (i+1) % 3;
 8897              		.loc 1 3006 0
 8898 00e8 0323     		movs	r3, #3
 8899 00ea 0134     		adds	r4, r4, #1
 8900              	.LVL930:
 8901 00ec 94FBF3F2 		sdiv	r2, r4, r3
 8902 00f0 03FB1244 		mls	r4, r3, r2, r4
 8903              	.LVL931:
3007:bluetooth_rxtx.c **** 
3008:bluetooth_rxtx.c **** 		handle_usb(clkn);
 8904              		.loc 1 3008 0
 8905 00f4 0D4B     		ldr	r3, .L974+24
3006:bluetooth_rxtx.c **** 
 8906              		.loc 1 3006 0
 8907 00f6 E4B2     		uxtb	r4, r4
 8908              	.LVL932:
ARM GAS  /tmp/ccwLngFB.s 			page 234


 8909              		.loc 1 3008 0
 8910 00f8 1868     		ldr	r0, [r3]
 8911 00fa FFF7FEFF 		bl	handle_usb
 8912              	.LVL933:
3009:bluetooth_rxtx.c **** 
3010:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
 8913              		.loc 1 3010 0
 8914 00fe 6420     		movs	r0, #100
 8915 0100 FFF7FEFF 		bl	cc2400_strobe
 8916              	.LVL934:
 8917              	.L966:
3011:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 8918              		.loc 1 3011 0 discriminator 1
 8919 0104 FFF7FEFF 		bl	cc2400_status
 8920              	.LVL935:
 8921 0108 4307     		lsls	r3, r0, #29
 8922 010a FBD4     		bmi	.L966
 8923 010c A5E7     		b	.L952
 8924              	.L973:
 8925              	.LBE93:
3012:bluetooth_rxtx.c **** 	}
3013:bluetooth_rxtx.c **** }
 8926              		.loc 1 3013 0
 8927 010e 04B0     		add	sp, sp, #16
 8928              		@ sp needed
 8929 0110 10BD     		pop	{r4, pc}
 8930              	.LVL936:
 8931              	.L975:
 8932 0112 00BF     		.align	2
 8933              	.L974:
 8934 0114 C2080000 		.word	.LANCHOR2+2242
 8935 0118 58C00920 		.word	537509976
 8936 011c 00000000 		.word	.LANCHOR0
 8937 0120 00000000 		.word	.LANCHOR1
 8938 0124 38C00920 		.word	537509944
 8939 0128 3CC00920 		.word	537509948
 8940 012c 00000000 		.word	clkn
 8941              		.cfi_endproc
 8942              	.LFE42:
 8944              		.section	.text.startup.main,"ax",%progbits
 8945              		.align	1
 8946              		.global	main
 8947              		.thumb
 8948              		.thumb_func
 8950              	main:
 8951              	.LFB43:
3014:bluetooth_rxtx.c **** 
3015:bluetooth_rxtx.c **** int main()
3016:bluetooth_rxtx.c **** {
 8952              		.loc 1 3016 0
 8953              		.cfi_startproc
 8954              		@ args = 0, pretend = 0, frame = 0
 8955              		@ frame_needed = 0, uses_anonymous_args = 0
 8956 0000 10B5     		push	{r4, lr}
 8957              		.cfi_def_cfa_offset 8
 8958              		.cfi_offset 4, -8
 8959              		.cfi_offset 14, -4
ARM GAS  /tmp/ccwLngFB.s 			page 235


3017:bluetooth_rxtx.c **** 	ubertooth_init();
 8960              		.loc 1 3017 0
 8961 0002 FFF7FEFF 		bl	ubertooth_init
 8962              	.LVL937:
3018:bluetooth_rxtx.c **** 	clkn_init();
 8963              		.loc 1 3018 0
 8964 0006 FFF7FEFF 		bl	clkn_init
 8965              	.LVL938:
3019:bluetooth_rxtx.c **** 	ubertooth_usb_init(vendor_request_handler);
 8966              		.loc 1 3019 0
 8967 000a 5C48     		ldr	r0, .L1012
 8968 000c FFF7FEFF 		bl	ubertooth_usb_init
 8969              	.LVL939:
 8970              	.L1008:
3020:bluetooth_rxtx.c **** 	cc2400_idle();
 8971              		.loc 1 3020 0
 8972 0010 FFF7FEFF 		bl	cc2400_idle
 8973              	.LVL940:
 8974              	.L977:
3021:bluetooth_rxtx.c **** 
3022:bluetooth_rxtx.c **** 	while (1) {
3023:bluetooth_rxtx.c **** 		handle_usb(clkn);
 8975              		.loc 1 3023 0
 8976 0014 5A4B     		ldr	r3, .L1012+4
3024:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 8977              		.loc 1 3024 0
 8978 0016 5B4C     		ldr	r4, .L1012+8
3023:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 8979              		.loc 1 3023 0
 8980 0018 1868     		ldr	r0, [r3]
 8981 001a FFF7FEFF 		bl	handle_usb
 8982              	.LVL941:
 8983              		.loc 1 3024 0
 8984 001e A27C     		ldrb	r2, [r4, #18]	@ zero_extendqisi2
 8985 0020 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 8986 0022 9A42     		cmp	r2, r3
 8987 0024 F6D0     		beq	.L977
3025:bluetooth_rxtx.c **** 			switch (requested_mode) {
 8988              		.loc 1 3025 0
 8989 0026 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 8990 0028 1A2B     		cmp	r3, #26
 8991 002a F3D8     		bhi	.L977
 8992 002c 01A2     		adr	r2, .L980
 8993 002e 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 8994 0032 00BF     		.p2align 2
 8995              	.L980:
 8996 0034 11000000 		.word	.L1008+1
 8997 0038 B1000000 		.word	.L981+1
 8998 003c BB000000 		.word	.L982+1
 8999 0040 E5000000 		.word	.L983+1
 9000 0044 0F010000 		.word	.L984+1
 9001 0048 F3000000 		.word	.L985+1
 9002 004c 03010000 		.word	.L986+1
 9003 0050 15010000 		.word	.L987+1
 9004 0054 C5000000 		.word	.L988+1
 9005 0058 C9000000 		.word	.L989+1
 9006 005c DB000000 		.word	.L990+1
ARM GAS  /tmp/ccwLngFB.s 			page 236


 9007 0060 A1000000 		.word	.L991+1
 9008 0064 E1000000 		.word	.L992+1
 9009 0068 1B010000 		.word	.L993+1
 9010 006c AD000000 		.word	.L994+1
 9011 0070 27010000 		.word	.L995+1
 9012 0074 31010000 		.word	.L996+1
 9013 0078 37010000 		.word	.L997+1
 9014 007c 3F010000 		.word	.L998+1
 9015 0080 47010000 		.word	.L999+1
 9016 0084 4F010000 		.word	.L1000+1
 9017 0088 57010000 		.word	.L1001+1
 9018 008c 5F010000 		.word	.L1002+1
 9019 0090 67010000 		.word	.L1003+1
 9020 0094 6F010000 		.word	.L1004+1
 9021 0098 CF000000 		.word	.L1005+1
 9022 009c D3000000 		.word	.L1006+1
 9023              	.L991:
3026:bluetooth_rxtx.c **** 				case MODE_RESET:
3027:bluetooth_rxtx.c **** 					/* Allow time for the USB command to return correctly */
3028:bluetooth_rxtx.c **** 					wait(1);
 9024              		.loc 1 3028 0
 9025 00a0 0120     		movs	r0, #1
 9026 00a2 FFF7FEFF 		bl	wait
 9027              	.LVL942:
3029:bluetooth_rxtx.c **** 					reset();
 9028              		.loc 1 3029 0
 9029 00a6 FFF7FEFF 		bl	reset
 9030              	.LVL943:
3030:bluetooth_rxtx.c **** 					break;
 9031              		.loc 1 3030 0
 9032 00aa B3E7     		b	.L977
 9033              	.L994:
3031:bluetooth_rxtx.c **** 				case MODE_AFH:
3032:bluetooth_rxtx.c **** 					mode = MODE_AFH;
 9034              		.loc 1 3032 0
 9035 00ac 0E23     		movs	r3, #14
 9036 00ae 00E0     		b	.L1009
 9037              	.L981:
3033:bluetooth_rxtx.c **** 					bt_stream_rx();
3034:bluetooth_rxtx.c **** 					break;
3035:bluetooth_rxtx.c **** 				case MODE_RX_SYMBOLS:
3036:bluetooth_rxtx.c **** 					mode = MODE_RX_SYMBOLS;
 9038              		.loc 1 3036 0
 9039 00b0 0123     		movs	r3, #1
 9040              	.L1009:
 9041 00b2 6374     		strb	r3, [r4, #17]
3037:bluetooth_rxtx.c **** 					bt_stream_rx();
 9042              		.loc 1 3037 0
 9043 00b4 FFF7FEFF 		bl	bt_stream_rx
 9044              	.LVL944:
3038:bluetooth_rxtx.c **** 					break;
 9045              		.loc 1 3038 0
 9046 00b8 ACE7     		b	.L977
 9047              	.L982:
3039:bluetooth_rxtx.c **** 				case MODE_TX_SYMBOLS:
3040:bluetooth_rxtx.c **** 					mode = MODE_TX_SYMBOLS;
 9048              		.loc 1 3040 0
ARM GAS  /tmp/ccwLngFB.s 			page 237


 9049 00ba 0223     		movs	r3, #2
 9050 00bc 6374     		strb	r3, [r4, #17]
3041:bluetooth_rxtx.c **** 					br_transmit();
 9051              		.loc 1 3041 0
 9052 00be FFF7FEFF 		bl	br_transmit
 9053              	.LVL945:
3042:bluetooth_rxtx.c **** 					break;
 9054              		.loc 1 3042 0
 9055 00c2 A7E7     		b	.L977
 9056              	.L988:
3043:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW:
3044:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW;
 9057              		.loc 1 3044 0
 9058 00c4 0823     		movs	r3, #8
 9059 00c6 F4E7     		b	.L1009
 9060              	.L989:
3045:bluetooth_rxtx.c **** 					bt_stream_rx();
3046:bluetooth_rxtx.c **** 					break;
3047:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW_LE:
3048:bluetooth_rxtx.c **** 					bt_follow_le();
 9061              		.loc 1 3048 0
 9062 00c8 FFF7FEFF 		bl	bt_follow_le
 9063              	.LVL946:
3049:bluetooth_rxtx.c **** 					break;
 9064              		.loc 1 3049 0
 9065 00cc A2E7     		b	.L977
 9066              	.L1005:
3050:bluetooth_rxtx.c **** 				//JWHUR cfo estimation tracking
3051:bluetooth_rxtx.c **** 				case MODE_BT_CFO_LE:
3052:bluetooth_rxtx.c **** 					bt_tracking_le(MODE_BT_CFO_LE);
 9067              		.loc 1 3052 0
 9068 00ce 1920     		movs	r0, #25
 9069 00d0 00E0     		b	.L1010
 9070              	.L1006:
3053:bluetooth_rxtx.c **** 					break;
3054:bluetooth_rxtx.c **** 				case MODE_BT_RSSI_LE:
3055:bluetooth_rxtx.c **** 					bt_tracking_le(MODE_BT_RSSI_LE);
 9071              		.loc 1 3055 0
 9072 00d2 1A20     		movs	r0, #26
 9073              	.L1010:
 9074 00d4 FFF7FEFF 		bl	bt_tracking_le
 9075              	.LVL947:
3056:bluetooth_rxtx.c **** 					break;
 9076              		.loc 1 3056 0
 9077 00d8 9CE7     		b	.L977
 9078              	.L990:
3057:bluetooth_rxtx.c **** 				case MODE_BT_PROMISC_LE:
3058:bluetooth_rxtx.c **** 					bt_promisc_le();
 9079              		.loc 1 3058 0
 9080 00da FFF7FEFF 		bl	bt_promisc_le
 9081              	.LVL948:
3059:bluetooth_rxtx.c **** 					break;
 9082              		.loc 1 3059 0
 9083 00de 99E7     		b	.L977
 9084              	.L992:
3060:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE:
3061:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE;
ARM GAS  /tmp/ccwLngFB.s 			page 238


 9085              		.loc 1 3061 0
 9086 00e0 0C23     		movs	r3, #12
 9087 00e2 45E0     		b	.L1011
 9088              	.L983:
3062:bluetooth_rxtx.c **** 					bt_slave_le(0x000f);
3063:bluetooth_rxtx.c **** 					break;
3064:bluetooth_rxtx.c **** 				case MODE_TX_TEST:
3065:bluetooth_rxtx.c **** 					mode = MODE_TX_TEST;
 9089              		.loc 1 3065 0
 9090 00e4 0323     		movs	r3, #3
3066:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 9091              		.loc 1 3066 0
 9092 00e6 2748     		ldr	r0, .L1012+8
 9093 00e8 2749     		ldr	r1, .L1012+12
3065:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 9094              		.loc 1 3065 0
 9095 00ea 6374     		strb	r3, [r4, #17]
 9096              		.loc 1 3066 0
 9097 00ec FFF7FEFF 		bl	cc2400_txtest
 9098              	.LVL949:
3067:bluetooth_rxtx.c **** 					break;
 9099              		.loc 1 3067 0
 9100 00f0 90E7     		b	.L977
 9101              	.L985:
3068:bluetooth_rxtx.c **** 				case MODE_RANGE_TEST:
3069:bluetooth_rxtx.c **** 					mode = MODE_RANGE_TEST;
 9102              		.loc 1 3069 0
 9103 00f2 0523     		movs	r3, #5
3070:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 9104              		.loc 1 3070 0
 9105 00f4 2448     		ldr	r0, .L1012+12
3069:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 9106              		.loc 1 3069 0
 9107 00f6 6374     		strb	r3, [r4, #17]
 9108              		.loc 1 3070 0
 9109 00f8 FFF7FEFF 		bl	cc2400_rangetest
 9110              	.LVL950:
3071:bluetooth_rxtx.c **** 					requested_mode = MODE_IDLE;
 9111              		.loc 1 3071 0
 9112 00fc 0023     		movs	r3, #0
 9113 00fe A374     		strb	r3, [r4, #18]
3072:bluetooth_rxtx.c **** 					break;
 9114              		.loc 1 3072 0
 9115 0100 88E7     		b	.L977
 9116              	.L986:
3073:bluetooth_rxtx.c **** 				case MODE_REPEATER:
3074:bluetooth_rxtx.c **** 					mode = MODE_REPEATER;
 9117              		.loc 1 3074 0
 9118 0102 0623     		movs	r3, #6
3075:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 9119              		.loc 1 3075 0
 9120 0104 2048     		ldr	r0, .L1012+12
3074:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 9121              		.loc 1 3074 0
 9122 0106 6374     		strb	r3, [r4, #17]
 9123              		.loc 1 3075 0
 9124 0108 FFF7FEFF 		bl	cc2400_repeater
ARM GAS  /tmp/ccwLngFB.s 			page 239


 9125              	.LVL951:
3076:bluetooth_rxtx.c **** 					break;
 9126              		.loc 1 3076 0
 9127 010c 82E7     		b	.L977
 9128              	.L984:
3077:bluetooth_rxtx.c **** 				case MODE_SPECAN:
3078:bluetooth_rxtx.c **** 					specan();
 9129              		.loc 1 3078 0
 9130 010e FFF7FEFF 		bl	specan
 9131              	.LVL952:
3079:bluetooth_rxtx.c **** 					break;
 9132              		.loc 1 3079 0
 9133 0112 7FE7     		b	.L977
 9134              	.L987:
3080:bluetooth_rxtx.c **** 				case MODE_LED_SPECAN:
3081:bluetooth_rxtx.c **** 					led_specan();
 9135              		.loc 1 3081 0
 9136 0114 FFF7FEFF 		bl	led_specan
 9137              	.LVL953:
3082:bluetooth_rxtx.c **** 					break;
 9138              		.loc 1 3082 0
 9139 0118 7CE7     		b	.L977
 9140              	.L993:
3083:bluetooth_rxtx.c **** 				case MODE_EGO:
3084:bluetooth_rxtx.c **** 					mode = MODE_EGO;
 9141              		.loc 1 3084 0
 9142 011a 0D23     		movs	r3, #13
 9143 011c 6374     		strb	r3, [r4, #17]
3085:bluetooth_rxtx.c **** 					ego_main(ego_mode);
 9144              		.loc 1 3085 0
 9145 011e 207D     		ldrb	r0, [r4, #20]	@ zero_extendqisi2
 9146 0120 FFF7FEFF 		bl	ego_main
 9147              	.LVL954:
3086:bluetooth_rxtx.c **** 					break;
 9148              		.loc 1 3086 0
 9149 0124 76E7     		b	.L977
 9150              	.L995:
3087:bluetooth_rxtx.c **** 				case MODE_RX_GENERIC:
3088:bluetooth_rxtx.c **** 					mode = MODE_RX_GENERIC;
 9151              		.loc 1 3088 0
 9152 0126 0F23     		movs	r3, #15
 9153 0128 6374     		strb	r3, [r4, #17]
3089:bluetooth_rxtx.c **** 					rx_generic();
 9154              		.loc 1 3089 0
 9155 012a FFF7FEFF 		bl	rx_generic
 9156              	.LVL955:
3090:bluetooth_rxtx.c **** 					break;
 9157              		.loc 1 3090 0
 9158 012e 71E7     		b	.L977
 9159              	.L996:
3091:bluetooth_rxtx.c **** 				case MODE_TX_GENERIC:
3092:bluetooth_rxtx.c **** 					tx_generic();
 9160              		.loc 1 3092 0
 9161 0130 FFF7FEFF 		bl	tx_generic
 9162              	.LVL956:
3093:bluetooth_rxtx.c **** 					break;
 9163              		.loc 1 3093 0
ARM GAS  /tmp/ccwLngFB.s 			page 240


 9164 0134 6EE7     		b	.L977
 9165              	.L997:
3094:bluetooth_rxtx.c **** 				case MODE_IDLE:
3095:bluetooth_rxtx.c **** 					cc2400_idle();
3096:bluetooth_rxtx.c **** 					break;
3097:bluetooth_rxtx.c **** 				// JWHUR POWER CONTROL
3098:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P0:
3099:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P0;
 9166              		.loc 1 3099 0
 9167 0136 1123     		movs	r3, #17
 9168 0138 6374     		strb	r3, [r4, #17]
3100:bluetooth_rxtx.c **** 					bt_slave_le(0x0008);
 9169              		.loc 1 3100 0
 9170 013a 0820     		movs	r0, #8
 9171 013c 1AE0     		b	.L1007
 9172              	.L998:
3101:bluetooth_rxtx.c **** 					break;
3102:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P1:
3103:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P1;
 9173              		.loc 1 3103 0
 9174 013e 1223     		movs	r3, #18
 9175 0140 6374     		strb	r3, [r4, #17]
3104:bluetooth_rxtx.c **** 					bt_slave_le(0x0009);
 9176              		.loc 1 3104 0
 9177 0142 0920     		movs	r0, #9
 9178 0144 16E0     		b	.L1007
 9179              	.L999:
3105:bluetooth_rxtx.c **** 					break;
3106:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P2:
3107:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P2;
 9180              		.loc 1 3107 0
 9181 0146 1323     		movs	r3, #19
 9182 0148 6374     		strb	r3, [r4, #17]
3108:bluetooth_rxtx.c **** 					bt_slave_le(0x000a);
 9183              		.loc 1 3108 0
 9184 014a 0A20     		movs	r0, #10
 9185 014c 12E0     		b	.L1007
 9186              	.L1000:
3109:bluetooth_rxtx.c **** 					break;
3110:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P3:
3111:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P3;
 9187              		.loc 1 3111 0
 9188 014e 1423     		movs	r3, #20
 9189 0150 6374     		strb	r3, [r4, #17]
3112:bluetooth_rxtx.c **** 					bt_slave_le(0x000b);
 9190              		.loc 1 3112 0
 9191 0152 0B20     		movs	r0, #11
 9192 0154 0EE0     		b	.L1007
 9193              	.L1001:
3113:bluetooth_rxtx.c **** 					break;
3114:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P4:
3115:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P4;
 9194              		.loc 1 3115 0
 9195 0156 1523     		movs	r3, #21
 9196 0158 6374     		strb	r3, [r4, #17]
3116:bluetooth_rxtx.c **** 					bt_slave_le(0x000c);
 9197              		.loc 1 3116 0
ARM GAS  /tmp/ccwLngFB.s 			page 241


 9198 015a 0C20     		movs	r0, #12
 9199 015c 0AE0     		b	.L1007
 9200              	.L1002:
3117:bluetooth_rxtx.c **** 					break;
3118:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P5:
3119:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P5;
 9201              		.loc 1 3119 0
 9202 015e 1623     		movs	r3, #22
 9203 0160 6374     		strb	r3, [r4, #17]
3120:bluetooth_rxtx.c **** 					bt_slave_le(0x000d);
 9204              		.loc 1 3120 0
 9205 0162 0D20     		movs	r0, #13
 9206 0164 06E0     		b	.L1007
 9207              	.L1003:
3121:bluetooth_rxtx.c **** 					break;
3122:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P6:
3123:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P6;
 9208              		.loc 1 3123 0
 9209 0166 1723     		movs	r3, #23
 9210 0168 6374     		strb	r3, [r4, #17]
3124:bluetooth_rxtx.c **** 					bt_slave_le(0x000e);
 9211              		.loc 1 3124 0
 9212 016a 0E20     		movs	r0, #14
 9213 016c 02E0     		b	.L1007
 9214              	.L1004:
3125:bluetooth_rxtx.c **** 					break;
3126:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P7:
3127:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P7;
 9215              		.loc 1 3127 0
 9216 016e 1823     		movs	r3, #24
 9217              	.L1011:
 9218 0170 6374     		strb	r3, [r4, #17]
3128:bluetooth_rxtx.c **** 					bt_slave_le(0x000f);
 9219              		.loc 1 3128 0
 9220 0172 0F20     		movs	r0, #15
 9221              	.L1007:
 9222 0174 FFF7FEFF 		bl	bt_slave_le
 9223              	.LVL957:
3129:bluetooth_rxtx.c **** 					break;
 9224              		.loc 1 3129 0
 9225 0178 4CE7     		b	.L977
 9226              	.L1013:
 9227 017a 00BF     		.align	2
 9228              	.L1012:
 9229 017c 00000000 		.word	vendor_request_handler
 9230 0180 00000000 		.word	clkn
 9231 0184 00000000 		.word	.LANCHOR0
 9232 0188 00000000 		.word	.LANCHOR1
 9233              		.cfi_endproc
 9234              	.LFE43:
 9236              		.comm	unpacked,800,1
 9237              		.global	packet_cb
 9238              		.global	data_cb
 9239              		.global	le_jam_count
 9240              		.comm	le_promisc,264,4
 9241              		.global	le
 9242              		.global	slave_mac_address
ARM GAS  /tmp/ccwLngFB.s 			page 242


 9243              		.comm	slave_mac_address_data,4,4
 9244              		.global	dlen
 9245              		.comm	tx_pkt,58,2
 9246              		.global	rssi_threshold
 9247              		.global	high_freq
 9248              		.global	low_freq
 9249              		.global	modulation
 9250              		.global	ego_mode
 9251              		.global	jam_mode
 9252              		.global	requested_mode
 9253              		.global	mode
 9254              		.global	status
 9255              		.global	dma_discard
 9256              		.global	idle_buf_channel
 9257              		.global	idle_buf_clk100ns
 9258              		.global	idle_buf_clkn_high
 9259              		.global	le_adv_channel
 9260              		.global	requested_channel
 9261              		.global	hop_timeout
 9262              		.global	hop_direct_channel
 9263              		.global	channel
 9264              		.global	do_hop
 9265              		.global	hop_mode
 9266              		.global	compile_info
 9267              		.comm	rr,5,1
 9268              		.comm	used_channels,1,1
 9269              		.comm	afh_map,10,1
 9270              		.comm	afh_enabled,1,1
 9271              		.comm	syncword,8,8
 9272              		.comm	target,16,8
 9273              		.comm	clkn_next_drift_fix,4,4
 9274              		.comm	clkn_last_drift_fix,4,4
 9275              		.comm	clk_drift_correction,2,2
 9276              		.comm	clk_drift_ppm,2,2
 9277              		.comm	clk100ns_offset,2,2
 9278              		.comm	clkn_offset,4,4
 9279              		.comm	last_hop,4,4
 9280              		.comm	clkn,4,4
 9281              		.comm	rx_err,4,4
 9282              		.comm	rx_tc,4,4
 9283              		.comm	idle_rxbuf,4,4
 9284              		.comm	active_rxbuf,4,4
 9285              		.comm	rxbuf2,50,1
 9286              		.comm	rxbuf1,50,1
 9287              		.comm	cs_trigger,1,1
 9288              		.comm	cs_threshold_cur,1,1
 9289              		.comm	cs_threshold_req,1,1
 9290              		.comm	cs_no_squelch,1,1
 9291              		.comm	rssi_count,1,1
 9292              		.comm	rssi_min,1,1
 9293              		.comm	rssi_max,1,1
 9294              		.section	.rodata
 9295              		.align	2
 9296              		.set	.LANCHOR2,. + 0
 9299              	whitening_index:
 9300 0000 46       		.byte	70
 9301 0001 3E       		.byte	62
ARM GAS  /tmp/ccwLngFB.s 			page 243


 9302 0002 78       		.byte	120
 9303 0003 6F       		.byte	111
 9304 0004 4D       		.byte	77
 9305 0005 2E       		.byte	46
 9306 0006 0F       		.byte	15
 9307 0007 65       		.byte	101
 9308 0008 42       		.byte	66
 9309 0009 27       		.byte	39
 9310 000a 1F       		.byte	31
 9311 000b 1A       		.byte	26
 9312 000c 50       		.byte	80
 9313 000d 53       		.byte	83
 9314 000e 7D       		.byte	125
 9315 000f 59       		.byte	89
 9316 0010 0A       		.byte	10
 9317 0011 23       		.byte	35
 9318 0012 08       		.byte	8
 9319 0013 36       		.byte	54
 9320 0014 7A       		.byte	122
 9321 0015 11       		.byte	17
 9322 0016 21       		.byte	33
 9323 0017 00       		.byte	0
 9324 0018 3A       		.byte	58
 9325 0019 73       		.byte	115
 9326 001a 06       		.byte	6
 9327 001b 5E       		.byte	94
 9328 001c 56       		.byte	86
 9329 001d 31       		.byte	49
 9330 001e 34       		.byte	52
 9331 001f 14       		.byte	20
 9332 0020 28       		.byte	40
 9333 0021 1B       		.byte	27
 9334 0022 54       		.byte	84
 9335 0023 5A       		.byte	90
 9336 0024 3F       		.byte	63
 9337 0025 70       		.byte	112
 9338 0026 2F       		.byte	47
 9339 0027 66       		.byte	102
 9342              	whitening:
 9343 0028 01       		.byte	1
 9344 0029 01       		.byte	1
 9345 002a 01       		.byte	1
 9346 002b 01       		.byte	1
 9347 002c 00       		.byte	0
 9348 002d 01       		.byte	1
 9349 002e 00       		.byte	0
 9350 002f 01       		.byte	1
 9351 0030 00       		.byte	0
 9352 0031 01       		.byte	1
 9353 0032 00       		.byte	0
 9354 0033 00       		.byte	0
 9355 0034 00       		.byte	0
 9356 0035 00       		.byte	0
 9357 0036 01       		.byte	1
 9358 0037 00       		.byte	0
 9359 0038 01       		.byte	1
 9360 0039 01       		.byte	1
ARM GAS  /tmp/ccwLngFB.s 			page 244


 9361 003a 00       		.byte	0
 9362 003b 01       		.byte	1
 9363 003c 01       		.byte	1
 9364 003d 01       		.byte	1
 9365 003e 01       		.byte	1
 9366 003f 00       		.byte	0
 9367 0040 00       		.byte	0
 9368 0041 01       		.byte	1
 9369 0042 01       		.byte	1
 9370 0043 01       		.byte	1
 9371 0044 00       		.byte	0
 9372 0045 00       		.byte	0
 9373 0046 01       		.byte	1
 9374 0047 00       		.byte	0
 9375 0048 01       		.byte	1
 9376 0049 00       		.byte	0
 9377 004a 01       		.byte	1
 9378 004b 01       		.byte	1
 9379 004c 00       		.byte	0
 9380 004d 00       		.byte	0
 9381 004e 01       		.byte	1
 9382 004f 01       		.byte	1
 9383 0050 00       		.byte	0
 9384 0051 00       		.byte	0
 9385 0052 00       		.byte	0
 9386 0053 00       		.byte	0
 9387 0054 00       		.byte	0
 9388 0055 01       		.byte	1
 9389 0056 01       		.byte	1
 9390 0057 00       		.byte	0
 9391 0058 01       		.byte	1
 9392 0059 01       		.byte	1
 9393 005a 00       		.byte	0
 9394 005b 01       		.byte	1
 9395 005c 00       		.byte	0
 9396 005d 01       		.byte	1
 9397 005e 01       		.byte	1
 9398 005f 01       		.byte	1
 9399 0060 00       		.byte	0
 9400 0061 01       		.byte	1
 9401 0062 00       		.byte	0
 9402 0063 00       		.byte	0
 9403 0064 00       		.byte	0
 9404 0065 01       		.byte	1
 9405 0066 01       		.byte	1
 9406 0067 00       		.byte	0
 9407 0068 00       		.byte	0
 9408 0069 01       		.byte	1
 9409 006a 00       		.byte	0
 9410 006b 00       		.byte	0
 9411 006c 00       		.byte	0
 9412 006d 01       		.byte	1
 9413 006e 00       		.byte	0
 9414 006f 00       		.byte	0
 9415 0070 00       		.byte	0
 9416 0071 00       		.byte	0
 9417 0072 00       		.byte	0
ARM GAS  /tmp/ccwLngFB.s 			page 245


 9418 0073 00       		.byte	0
 9419 0074 01       		.byte	1
 9420 0075 00       		.byte	0
 9421 0076 00       		.byte	0
 9422 0077 01       		.byte	1
 9423 0078 00       		.byte	0
 9424 0079 00       		.byte	0
 9425 007a 01       		.byte	1
 9426 007b 01       		.byte	1
 9427 007c 00       		.byte	0
 9428 007d 01       		.byte	1
 9429 007e 00       		.byte	0
 9430 007f 00       		.byte	0
 9431 0080 01       		.byte	1
 9432 0081 01       		.byte	1
 9433 0082 01       		.byte	1
 9434 0083 01       		.byte	1
 9435 0084 00       		.byte	0
 9436 0085 01       		.byte	1
 9437 0086 01       		.byte	1
 9438 0087 01       		.byte	1
 9439 0088 00       		.byte	0
 9440 0089 00       		.byte	0
 9441 008a 00       		.byte	0
 9442 008b 00       		.byte	0
 9443 008c 01       		.byte	1
 9444 008d 01       		.byte	1
 9445 008e 01       		.byte	1
 9446 008f 01       		.byte	1
 9447 0090 01       		.byte	1
 9448 0091 01       		.byte	1
 9449 0092 01       		.byte	1
 9450 0093 00       		.byte	0
 9451 0094 00       		.byte	0
 9452 0095 00       		.byte	0
 9453 0096 01       		.byte	1
 9454 0097 01       		.byte	1
 9455 0098 01       		.byte	1
 9456 0099 00       		.byte	0
 9457 009a 01       		.byte	1
 9458 009b 01       		.byte	1
 9459 009c 00       		.byte	0
 9460 009d 00       		.byte	0
 9461 009e 00       		.byte	0
 9462 009f 01       		.byte	1
 9463 00a0 00       		.byte	0
 9464 00a1 01       		.byte	1
 9465 00a2 00       		.byte	0
 9466 00a3 00       		.byte	0
 9467 00a4 01       		.byte	1
 9468 00a5 00       		.byte	0
 9469 00a6 01       		.byte	1
 9472              	compile_info:
 9473 00a7 75626572 		.ascii	"ubertooth 2017-03-R2 (mwnl@mwnl-lenovo) 2018. 08. 1"
 9473      746F6F74 
 9473      68203230 
 9473      31372D30 
ARM GAS  /tmp/ccwLngFB.s 			page 246


 9473      332D5232 
 9474 00da 372E2028 		.ascii	"7. (\352\270\210) 14:14:37 KST\000"
 9474      EAB88829 
 9474      2031343A 
 9474      31343A33 
 9474      37204B53 
 9477              	whitening_word:
 9478 00f0 40B2BCC3 		.word	-1011043776
 9479 00f4 1F374A5F 		.word	1598699295
 9480 00f8 85F69C9A 		.word	-1700989307
 9481 00fc C1D6C544 		.word	1153816257
 9482 0100 2059DEE1 		.word	-505521888
 9483 0104 8F1BA5AF 		.word	-1348134001
 9484 0108 427B4ECD 		.word	-850494654
 9485 010c 60EB6222 		.word	576908128
 9486 0110 902CEFF0 		.word	-252760944
 9487 0114 C78DD257 		.word	1473416647
 9488 0118 A13DA766 		.word	1722236321
 9489 011c B0753111 		.word	288454064
 9490 0120 8940B2BC 		.word	-1129168759
 9491 0124 C31F374A 		.word	1245126595
 9492 0128 5F85F69C 		.word	-1661565601
 9493 012c 9AC1D6C5 		.word	-975781478
 9494 0130 442059DE 		.word	-564584380
 9495 0134 E18F1BA5 		.word	-1524920351
 9496 0138 AF427B4E 		.word	1316700847
 9497 013c CD60EB62 		.word	1659592909
 9498 0140 22902CEF 		.word	-282292190
 9499 0144 F0C78DD2 		.word	-762460176
 9500 0148 57A13DA7 		.word	-1489133225
 9501 014c 66B07531 		.word	829796454
 9502 0150 D257A13D 		.word	1033983954
 9503 0154 A766B075 		.word	1974494887
 9504 0158 31114896 		.word	-1773661903
 9505 015c 77F8E346 		.word	1189345399
 9506 0160 E9ABD09E 		.word	-1630491671
 9507 0164 5333D8BA 		.word	-1160236205
 9508 0168 980824CB 		.word	-886830952
 9509 016c 3BFC71A3 		.word	-1552810949
 9510 0170 F45568CF 		.word	-815245836
 9511 0174 A9196C5D 		.word	1567365545
 9512 0178 4C0492E5 		.word	-443415476
 9513 017c 1DFEB851 		.word	1371078173
 9514 0180 1BA5AF42 		.word	1118807323
 9515 0184 7B4ECD60 		.word	1624067707
 9516 0188 EB622290 		.word	-1876794645
 9517 018c 2CEFF0C7 		.word	-940511444
 9518 0190 8DD257A1 		.word	-1588079987
 9519 0194 3DA766B0 		.word	-1335449795
 9520 0198 75311148 		.word	1209086325
 9521 019c 9677F8E3 		.word	-470255722
 9522 01a0 46E9ABD0 		.word	-794039994
 9523 01a4 9E5333D8 		.word	-667724898
 9524 01a8 BA980824 		.word	604543162
 9525 01ac CB3BFC71 		.word	1912355787
 9526 01b0 6479873F 		.word	1065843044
 9527 01b4 6E94BE0A 		.word	180261998
ARM GAS  /tmp/ccwLngFB.s 			page 247


 9528 01b8 ED393583 		.word	-2093663763
 9529 01bc AD8B8940 		.word	1082756013
 9530 01c0 B2BCC31F 		.word	532921522
 9531 01c4 374A5F85 		.word	-2057352649
 9532 01c8 F69C9AC1 		.word	-1046831882
 9533 01cc D6C54420 		.word	541378006
 9534 01d0 59DEE18F 		.word	-1881022887
 9535 01d4 1BA5AF42 		.word	1118807323
 9536 01d8 7B4ECD60 		.word	1624067707
 9537 01dc EB622290 		.word	-1876794645
 9538 01e0 AD8B8940 		.word	1082756013
 9539 01e4 B2BCC31F 		.word	532921522
 9540 01e8 374A5F85 		.word	-2057352649
 9541 01ec F69C9AC1 		.word	-1046831882
 9542 01f0 D6C54420 		.word	541378006
 9543 01f4 59DEE18F 		.word	-1881022887
 9544 01f8 1BA5AF42 		.word	1118807323
 9545 01fc 7B4ECD60 		.word	1624067707
 9546 0200 EB622290 		.word	-1876794645
 9547 0204 2CEFF0C7 		.word	-940511444
 9548 0208 8DD257A1 		.word	-1588079987
 9549 020c 3DA766B0 		.word	-1335449795
 9550 0210 F69C9AC1 		.word	-1046831882
 9551 0214 D6C54420 		.word	541378006
 9552 0218 59DEE18F 		.word	-1881022887
 9553 021c 1BA5AF42 		.word	1118807323
 9554 0220 7B4ECD60 		.word	1624067707
 9555 0224 EB622290 		.word	-1876794645
 9556 0228 2CEFF0C7 		.word	-940511444
 9557 022c 8DD257A1 		.word	-1588079987
 9558 0230 3DA766B0 		.word	-1335449795
 9559 0234 75311148 		.word	1209086325
 9560 0238 9677F8E3 		.word	-470255722
 9561 023c 46E9ABD0 		.word	-794039994
 9562 0240 3F6E94BE 		.word	-1097568705
 9563 0244 0AED3935 		.word	892988682
 9564 0248 83AD8B89 		.word	-1987334781
 9565 024c 40B2BCC3 		.word	-1011043776
 9566 0250 1F374A5F 		.word	1598699295
 9567 0254 85F69C9A 		.word	-1700989307
 9568 0258 C1D6C544 		.word	1153816257
 9569 025c 2059DEE1 		.word	-505521888
 9570 0260 8F1BA5AF 		.word	-1348134001
 9571 0264 427B4ECD 		.word	-850494654
 9572 0268 60EB6222 		.word	576908128
 9573 026c 902CEFF0 		.word	-252760944
 9574 0270 0824CB3B 		.word	1003168776
 9575 0274 FC71A3F4 		.word	-190615044
 9576 0278 5568CFA9 		.word	-1446025131
 9577 027c 196C5D4C 		.word	1281190937
 9578 0280 0492E51D 		.word	501584388
 9579 0284 FEB851FA 		.word	-95307522
 9580 0288 2AB4E7D4 		.word	-723012566
 9581 028c 0CB62E26 		.word	640595468
 9582 0290 02C9F20E 		.word	250792194
 9583 0294 7FDC287D 		.word	2099829887
 9584 0298 15DA736A 		.word	1785977365
ARM GAS  /tmp/ccwLngFB.s 			page 248


 9585 029c 065B1713 		.word	320297734
 9586 02a0 C1D6C544 		.word	1153816257
 9587 02a4 2059DEE1 		.word	-505521888
 9588 02a8 8F1BA5AF 		.word	-1348134001
 9589 02ac 427B4ECD 		.word	-850494654
 9590 02b0 60EB6222 		.word	576908128
 9591 02b4 902CEFF0 		.word	-252760944
 9592 02b8 C78DD257 		.word	1473416647
 9593 02bc A13DA766 		.word	1722236321
 9594 02c0 B0753111 		.word	288454064
 9595 02c4 489677F8 		.word	-126380472
 9596 02c8 E346E9AB 		.word	-1410775325
 9597 02cc D09E5333 		.word	861118160
 9598 02d0 9AC1D6C5 		.word	-975781478
 9599 02d4 442059DE 		.word	-564584380
 9600 02d8 E18F1BA5 		.word	-1524920351
 9601 02dc AF427B4E 		.word	1316700847
 9602 02e0 CD60EB62 		.word	1659592909
 9603 02e4 22902CEF 		.word	-282292190
 9604 02e8 F0C78DD2 		.word	-762460176
 9605 02ec 57A13DA7 		.word	-1489133225
 9606 02f0 66B07531 		.word	829796454
 9607 02f4 11489677 		.word	2006337553
 9608 02f8 F8E346E9 		.word	-381230088
 9609 02fc ABD09E53 		.word	1402917035
 9610 0300 5333D8BA 		.word	-1160236205
 9611 0304 980824CB 		.word	-886830952
 9612 0308 3BFC71A3 		.word	-1552810949
 9613 030c F45568CF 		.word	-815245836
 9614 0310 A9196C5D 		.word	1567365545
 9615 0314 4C0492E5 		.word	-443415476
 9616 0318 1DFEB851 		.word	1371078173
 9617 031c FA2AB4E7 		.word	-407622918
 9618 0320 D40CB62E 		.word	783682772
 9619 0324 2602C9F2 		.word	-221707738
 9620 0328 0E7FDC28 		.word	685539086
 9621 032c 7D15DA73 		.word	1943672189
 9622 0330 2CEFF0C7 		.word	-940511444
 9623 0334 8DD257A1 		.word	-1588079987
 9624 0338 3DA766B0 		.word	-1335449795
 9625 033c 75311148 		.word	1209086325
 9626 0340 9677F8E3 		.word	-470255722
 9627 0344 46E9ABD0 		.word	-794039994
 9628 0348 9E5333D8 		.word	-667724898
 9629 034c BA980824 		.word	604543162
 9630 0350 CB3BFC71 		.word	1912355787
 9631 0354 A3F45568 		.word	1750463651
 9632 0358 CFA9196C 		.word	1813621199
 9633 035c 5D4C0492 		.word	-1845212067
 9634 0360 E51DFEB8 		.word	-1191305755
 9635 0364 51FA2AB4 		.word	-1272251823
 9636 0368 E7D40CB6 		.word	-1240673049
 9637 036c 2E2602C9 		.word	-922606034
 9638 0370 F20E7FDC 		.word	-595652878
 9639 0374 287D15DA 		.word	-636125912
 9640 0378 736A065B 		.word	1527147123
 9641 037c 17138164 		.word	1686180631
ARM GAS  /tmp/ccwLngFB.s 			page 249


 9642 0380 79873F6E 		.word	1849657209
 9643 0384 94BE0AED 		.word	-318062956
 9644 0388 393583AD 		.word	-1383910087
 9645 038c 8B8940B2 		.word	-1304393333
 9646 0390 BE0AED39 		.word	971836094
 9647 0394 3583AD8B 		.word	-1951562955
 9648 0398 8940B2BC 		.word	-1129168759
 9649 039c C31F374A 		.word	1245126595
 9650 03a0 5F85F69C 		.word	-1661565601
 9651 03a4 9AC1D6C5 		.word	-975781478
 9652 03a8 442059DE 		.word	-564584380
 9653 03ac E18F1BA5 		.word	-1524920351
 9654 03b0 AF427B4E 		.word	1316700847
 9655 03b4 CD60EB62 		.word	1659592909
 9656 03b8 22902CEF 		.word	-282292190
 9657 03bc F0C78DD2 		.word	-762460176
 9658 03c0 77F8E346 		.word	1189345399
 9659 03c4 E9ABD09E 		.word	-1630491671
 9660 03c8 5333D8BA 		.word	-1160236205
 9661 03cc 980824CB 		.word	-886830952
 9662 03d0 3BFC71A3 		.word	-1552810949
 9663 03d4 F45568CF 		.word	-815245836
 9664 03d8 A9196C5D 		.word	1567365545
 9665 03dc 4C0492E5 		.word	-443415476
 9666 03e0 1DFEB851 		.word	1371078173
 9667 03e4 FA2AB4E7 		.word	-407622918
 9668 03e8 D40CB62E 		.word	783682772
 9669 03ec 2602C9F2 		.word	-221707738
 9670 03f0 D09E5333 		.word	861118160
 9671 03f4 D8BA9808 		.word	144227032
 9672 03f8 24CB3BFC 		.word	-63190236
 9673 03fc 71A3F455 		.word	1442095985
 9674 0400 68CFA919 		.word	430559080
 9675 0404 6C5D4C04 		.word	72113516
 9676 0408 92E51DFE 		.word	-31595118
 9677 040c B851FA2A 		.word	721047992
 9678 0410 B4E7D40C 		.word	215279540
 9679 0414 B62E2602 		.word	36056758
 9680 0418 C9F20E7F 		.word	2131686089
 9681 041c DC287D15 		.word	360523996
 9682 0420 196C5D4C 		.word	1281190937
 9683 0424 0492E51D 		.word	501584388
 9684 0428 FEB851FA 		.word	-95307522
 9685 042c 2AB4E7D4 		.word	-723012566
 9686 0430 0CB62E26 		.word	640595468
 9687 0434 02C9F20E 		.word	250792194
 9688 0438 7FDC287D 		.word	2099829887
 9689 043c 15DA736A 		.word	1785977365
 9690 0440 065B1713 		.word	320297734
 9691 0444 81647987 		.word	-2022087551
 9692 0448 3F6E94BE 		.word	-1097568705
 9693 044c 0AED3935 		.word	892988682
 9694 0450 427B4ECD 		.word	-850494654
 9695 0454 60EB6222 		.word	576908128
 9696 0458 902CEFF0 		.word	-252760944
 9697 045c C78DD257 		.word	1473416647
 9698 0460 A13DA766 		.word	1722236321
ARM GAS  /tmp/ccwLngFB.s 			page 250


 9699 0464 B0753111 		.word	288454064
 9700 0468 489677F8 		.word	-126380472
 9701 046c E346E9AB 		.word	-1410775325
 9702 0470 D09E5333 		.word	861118160
 9703 0474 D8BA9808 		.word	144227032
 9704 0478 24CB3BFC 		.word	-63190236
 9705 047c 71A3F455 		.word	1442095985
 9706 0480 8B8940B2 		.word	-1304393333
 9707 0484 BCC31F37 		.word	924828604
 9708 0488 4A5F85F6 		.word	-159031478
 9709 048c 9C9AC1D6 		.word	-691955044
 9710 0490 C5442059 		.word	1495286981
 9711 0494 DEE18F1B 		.word	462414302
 9712 0498 A5AF427B 		.word	2067967909
 9713 049c 4ECD60EB 		.word	-345977522
 9714 04a0 6222902C 		.word	747643490
 9715 04a4 EFF0C78D 		.word	-1916276497
 9716 04a8 D257A13D 		.word	1033983954
 9717 04ac A766B075 		.word	1974494887
 9718 04b0 F45568CF 		.word	-815245836
 9719 04b4 A9196C5D 		.word	1567365545
 9720 04b8 4C0492E5 		.word	-443415476
 9721 04bc 1DFEB851 		.word	1371078173
 9722 04c0 FA2AB4E7 		.word	-407622918
 9723 04c4 D40CB62E 		.word	783682772
 9724 04c8 2602C9F2 		.word	-221707738
 9725 04cc 0E7FDC28 		.word	685539086
 9726 04d0 7D15DA73 		.word	1943672189
 9727 04d4 6A065B17 		.word	391841386
 9728 04d8 13816479 		.word	2036629779
 9729 04dc 873F6E94 		.word	-1804714105
 9730 04e0 3DA766B0 		.word	-1335449795
 9731 04e4 75311148 		.word	1209086325
 9732 04e8 9677F8E3 		.word	-470255722
 9733 04ec 46E9ABD0 		.word	-794039994
 9734 04f0 9E5333D8 		.word	-667724898
 9735 04f4 BA980824 		.word	604543162
 9736 04f8 CB3BFC71 		.word	1912355787
 9737 04fc A3F45568 		.word	1750463651
 9738 0500 CFA9196C 		.word	1813621199
 9739 0504 5D4C0492 		.word	-1845212067
 9740 0508 E51DFEB8 		.word	-1191305755
 9741 050c 51FA2AB4 		.word	-1272251823
 9742 0510 66B07531 		.word	829796454
 9743 0514 11489677 		.word	2006337553
 9744 0518 F8E346E9 		.word	-381230088
 9745 051c ABD09E53 		.word	1402917035
 9746 0520 33D8BA98 		.word	-1732585421
 9747 0524 0824CB3B 		.word	1003168776
 9748 0528 FC71A3F4 		.word	-190615044
 9749 052c 5568CFA9 		.word	-1446025131
 9750 0530 196C5D4C 		.word	1281190937
 9751 0534 0492E51D 		.word	501584388
 9752 0538 FEB851FA 		.word	-95307522
 9753 053c 2AB4E7D4 		.word	-723012566
 9754 0540 AF427B4E 		.word	1316700847
 9755 0544 CD60EB62 		.word	1659592909
ARM GAS  /tmp/ccwLngFB.s 			page 251


 9756 0548 22902CEF 		.word	-282292190
 9757 054c F0C78DD2 		.word	-762460176
 9758 0550 57A13DA7 		.word	-1489133225
 9759 0554 66B07531 		.word	829796454
 9760 0558 11489677 		.word	2006337553
 9761 055c F8E346E9 		.word	-381230088
 9762 0560 ABD09E53 		.word	1402917035
 9763 0564 33D8BA98 		.word	-1732585421
 9764 0568 0824CB3B 		.word	1003168776
 9765 056c FC71A3F4 		.word	-190615044
 9766 0570 980824CB 		.word	-886830952
 9767 0574 3BFC71A3 		.word	-1552810949
 9768 0578 F45568CF 		.word	-815245836
 9769 057c A9196C5D 		.word	1567365545
 9770 0580 4C0492E5 		.word	-443415476
 9771 0584 1DFEB851 		.word	1371078173
 9772 0588 FA2AB4E7 		.word	-407622918
 9773 058c D40CB62E 		.word	783682772
 9774 0590 2602C9F2 		.word	-221707738
 9775 0594 0E7FDC28 		.word	685539086
 9776 0598 7D15DA73 		.word	1943672189
 9777 059c 6A065B17 		.word	391841386
 9778 05a0 51FA2AB4 		.word	-1272251823
 9779 05a4 E7D40CB6 		.word	-1240673049
 9780 05a8 2E2602C9 		.word	-922606034
 9781 05ac F20E7FDC 		.word	-595652878
 9782 05b0 287D15DA 		.word	-636125912
 9783 05b4 736A065B 		.word	1527147123
 9784 05b8 17138164 		.word	1686180631
 9785 05bc 79873F6E 		.word	1849657209
 9786 05c0 94BE0AED 		.word	-318062956
 9787 05c4 393583AD 		.word	-1383910087
 9788 05c8 8B8940B2 		.word	-1304393333
 9789 05cc BCC31F37 		.word	924828604
 9790 05d0 0AED3935 		.word	892988682
 9791 05d4 83AD8B89 		.word	-1987334781
 9792 05d8 40B2BCC3 		.word	-1011043776
 9793 05dc 1F374A5F 		.word	1598699295
 9794 05e0 85F69C9A 		.word	-1700989307
 9795 05e4 C1D6C544 		.word	1153816257
 9796 05e8 2059DEE1 		.word	-505521888
 9797 05ec 8F1BA5AF 		.word	-1348134001
 9798 05f0 427B4ECD 		.word	-850494654
 9799 05f4 60EB6222 		.word	576908128
 9800 05f8 902CEFF0 		.word	-252760944
 9801 05fc C78DD257 		.word	1473416647
 9802 0600 C31F374A 		.word	1245126595
 9803 0604 5F85F69C 		.word	-1661565601
 9804 0608 9AC1D6C5 		.word	-975781478
 9805 060c 442059DE 		.word	-564584380
 9806 0610 E18F1BA5 		.word	-1524920351
 9807 0614 AF427B4E 		.word	1316700847
 9808 0618 CD60EB62 		.word	1659592909
 9809 061c 22902CEF 		.word	-282292190
 9810 0620 F0C78DD2 		.word	-762460176
 9811 0624 57A13DA7 		.word	-1489133225
 9812 0628 66B07531 		.word	829796454
ARM GAS  /tmp/ccwLngFB.s 			page 252


 9813 062c 11489677 		.word	2006337553
 9814 0630 BCC31F37 		.word	924828604
 9815 0634 4A5F85F6 		.word	-159031478
 9816 0638 9C9AC1D6 		.word	-691955044
 9817 063c C5442059 		.word	1495286981
 9818 0640 DEE18F1B 		.word	462414302
 9819 0644 A5AF427B 		.word	2067967909
 9820 0648 4ECD60EB 		.word	-345977522
 9821 064c 6222902C 		.word	747643490
 9822 0650 EFF0C78D 		.word	-1916276497
 9823 0654 D257A13D 		.word	1033983954
 9824 0658 A766B075 		.word	1974494887
 9825 065c 31114896 		.word	-1773661903
 9826 0660 75311148 		.word	1209086325
 9827 0664 9677F8E3 		.word	-470255722
 9828 0668 46E9ABD0 		.word	-794039994
 9829 066c 9E5333D8 		.word	-667724898
 9830 0670 BA980824 		.word	604543162
 9831 0674 CB3BFC71 		.word	1912355787
 9832 0678 A3F45568 		.word	1750463651
 9833 067c CFA9196C 		.word	1813621199
 9834 0680 5D4C0492 		.word	-1845212067
 9835 0684 E51DFEB8 		.word	-1191305755
 9836 0688 51FA2AB4 		.word	-1272251823
 9837 068c E7D40CB6 		.word	-1240673049
 9838 0690 2E2602C9 		.word	-922606034
 9839 0694 F20E7FDC 		.word	-595652878
 9840 0698 287D15DA 		.word	-636125912
 9841 069c 736A065B 		.word	1527147123
 9842 06a0 17138164 		.word	1686180631
 9843 06a4 79873F6E 		.word	1849657209
 9844 06a8 94BE0AED 		.word	-318062956
 9845 06ac 393583AD 		.word	-1383910087
 9846 06b0 8B8940B2 		.word	-1304393333
 9847 06b4 BCC31F37 		.word	924828604
 9848 06b8 4A5F85F6 		.word	-159031478
 9849 06bc 9C9AC1D6 		.word	-691955044
 9850 06c0 E7D40CB6 		.word	-1240673049
 9851 06c4 2E2602C9 		.word	-922606034
 9852 06c8 F20E7FDC 		.word	-595652878
 9853 06cc 287D15DA 		.word	-636125912
 9854 06d0 736A065B 		.word	1527147123
 9855 06d4 17138164 		.word	1686180631
 9856 06d8 79873F6E 		.word	1849657209
 9857 06dc 94BE0AED 		.word	-318062956
 9858 06e0 393583AD 		.word	-1383910087
 9859 06e4 8B8940B2 		.word	-1304393333
 9860 06e8 BCC31F37 		.word	924828604
 9861 06ec 4A5F85F6 		.word	-159031478
 9862 06f0 60EB6222 		.word	576908128
 9863 06f4 902CEFF0 		.word	-252760944
 9864 06f8 C78DD257 		.word	1473416647
 9865 06fc A13DA766 		.word	1722236321
 9866 0700 B0753111 		.word	288454064
 9867 0704 489677F8 		.word	-126380472
 9868 0708 E346E9AB 		.word	-1410775325
 9869 070c D09E5333 		.word	861118160
ARM GAS  /tmp/ccwLngFB.s 			page 253


 9870 0710 D8BA9808 		.word	144227032
 9871 0714 24CB3BFC 		.word	-63190236
 9872 0718 71A3F455 		.word	1442095985
 9873 071c 68CFA919 		.word	430559080
 9874 0720 A9196C5D 		.word	1567365545
 9875 0724 4C0492E5 		.word	-443415476
 9876 0728 1DFEB851 		.word	1371078173
 9877 072c FA2AB4E7 		.word	-407622918
 9878 0730 D40CB62E 		.word	783682772
 9879 0734 2602C9F2 		.word	-221707738
 9880 0738 0E7FDC28 		.word	685539086
 9881 073c 7D15DA73 		.word	1943672189
 9882 0740 6A065B17 		.word	391841386
 9883 0744 13816479 		.word	2036629779
 9884 0748 873F6E94 		.word	-1804714105
 9885 074c BE0AED39 		.word	971836094
 9886 0750 F20E7FDC 		.word	-595652878
 9887 0754 287D15DA 		.word	-636125912
 9888 0758 736A065B 		.word	1527147123
 9889 075c 17138164 		.word	1686180631
 9890 0760 79873F6E 		.word	1849657209
 9891 0764 94BE0AED 		.word	-318062956
 9892 0768 393583AD 		.word	-1383910087
 9893 076c 8B8940B2 		.word	-1304393333
 9894 0770 BCC31F37 		.word	924828604
 9895 0774 4A5F85F6 		.word	-159031478
 9896 0778 9C9AC1D6 		.word	-691955044
 9897 077c C5442059 		.word	1495286981
 9898 0780 3BFC71A3 		.word	-1552810949
 9899 0784 F45568CF 		.word	-815245836
 9900 0788 A9196C5D 		.word	1567365545
 9901 078c 4C0492E5 		.word	-443415476
 9902 0790 1DFEB851 		.word	1371078173
 9903 0794 FA2AB4E7 		.word	-407622918
 9904 0798 D40CB62E 		.word	783682772
 9905 079c 2602C9F2 		.word	-221707738
 9906 07a0 0E7FDC28 		.word	685539086
 9907 07a4 7D15DA73 		.word	1943672189
 9908 07a8 6A065B17 		.word	391841386
 9909 07ac 13816479 		.word	2036629779
 9910 07b0 442059DE 		.word	-564584380
 9911 07b4 E18F1BA5 		.word	-1524920351
 9912 07b8 AF427B4E 		.word	1316700847
 9913 07bc CD60EB62 		.word	1659592909
 9914 07c0 22902CEF 		.word	-282292190
 9915 07c4 F0C78DD2 		.word	-762460176
 9916 07c8 57A13DA7 		.word	-1489133225
 9917 07cc 66B07531 		.word	829796454
 9918 07d0 11489677 		.word	2006337553
 9919 07d4 F8E346E9 		.word	-381230088
 9920 07d8 ABD09E53 		.word	1402917035
 9921 07dc 33D8BA98 		.word	-1732585421
 9922 07e0 8DD257A1 		.word	-1588079987
 9923 07e4 3DA766B0 		.word	-1335449795
 9924 07e8 75311148 		.word	1209086325
 9925 07ec 9677F8E3 		.word	-470255722
 9926 07f0 46E9ABD0 		.word	-794039994
ARM GAS  /tmp/ccwLngFB.s 			page 254


 9927 07f4 9E5333D8 		.word	-667724898
 9928 07f8 BA980824 		.word	604543162
 9929 07fc CB3BFC71 		.word	1912355787
 9930 0800 A3F45568 		.word	1750463651
 9931 0804 CFA9196C 		.word	1813621199
 9932 0808 5D4C0492 		.word	-1845212067
 9933 080c E51DFEB8 		.word	-1191305755
 9934 0810 D6C54420 		.word	541378006
 9935 0814 59DEE18F 		.word	-1881022887
 9936 0818 1BA5AF42 		.word	1118807323
 9937 081c 7B4ECD60 		.word	1624067707
 9938 0820 EB622290 		.word	-1876794645
 9939 0824 2CEFF0C7 		.word	-940511444
 9940 0828 8DD257A1 		.word	-1588079987
 9941 082c 3DA766B0 		.word	-1335449795
 9942 0830 75311148 		.word	1209086325
 9943 0834 9677F8E3 		.word	-470255722
 9944 0838 46E9ABD0 		.word	-794039994
 9945 083c 9E5333D8 		.word	-667724898
 9946 0840 1F374A5F 		.word	1598699295
 9947 0844 85F69C9A 		.word	-1700989307
 9948 0848 C1D6C544 		.word	1153816257
 9949 084c 2059DEE1 		.word	-505521888
 9950 0850 8F1BA5AF 		.word	-1348134001
 9951 0854 427B4ECD 		.word	-850494654
 9952 0858 60EB6222 		.word	576908128
 9953 085c 902CEFF0 		.word	-252760944
 9954 0860 C78DD257 		.word	1473416647
 9955 0864 A13DA766 		.word	1722236321
 9956 0868 B0753111 		.word	288454064
 9957 086c 489677F8 		.word	-126380472
 9960              	hop_interval_lut:
 9961 0870 00       		.byte	0
 9962 0871 01       		.byte	1
 9963 0872 13       		.byte	19
 9964 0873 19       		.byte	25
 9965 0874 1C       		.byte	28
 9966 0875 0F       		.byte	15
 9967 0876 1F       		.byte	31
 9968 0877 10       		.byte	16
 9969 0878 0E       		.byte	14
 9970 0879 21       		.byte	33
 9971 087a 1A       		.byte	26
 9972 087b 1B       		.byte	27
 9973 087c 22       		.byte	34
 9974 087d 14       		.byte	20
 9975 087e 08       		.byte	8
 9976 087f 05       		.byte	5
 9977 0880 07       		.byte	7
 9978 0881 18       		.byte	24
 9979 0882 23       		.byte	35
 9980 0883 02       		.byte	2
 9981 0884 0D       		.byte	13
 9982 0885 1E       		.byte	30
 9983 0886 20       		.byte	32
 9984 0887 1D       		.byte	29
 9985 0888 11       		.byte	17
ARM GAS  /tmp/ccwLngFB.s 			page 255


 9986 0889 03       		.byte	3
 9987 088a 0A       		.byte	10
 9988 088b 0B       		.byte	11
 9989 088c 04       		.byte	4
 9990 088d 17       		.byte	23
 9991 088e 15       		.byte	21
 9992 088f 06       		.byte	6
 9993 0890 16       		.byte	22
 9994 0891 09       		.byte	9
 9995 0892 0C       		.byte	12
 9996 0893 12       		.byte	18
 9997 0894 24       		.byte	36
 9998 0895 000000   		.space	3
 9999              	.LC0:
 10000 0898 01000000 		.word	1
 10001 089c 01000000 		.word	1
 10002 08a0 01000000 		.word	1
 10003 08a4 01000000 		.word	1
 10004              	.LC1:
 10005 08a8 6209     		.short	2402
 10006 08aa 7A09     		.short	2426
 10007 08ac B009     		.short	2480
 10008              	.LC2:
 10009 08ae 42       		.byte	66
 10010 08af 1D       		.byte	29
 10011 08b0 FF       		.byte	-1
 10012 08b1 FF       		.byte	-1
 10013 08b2 FF       		.byte	-1
 10014 08b3 FF       		.byte	-1
 10015 08b4 FF       		.byte	-1
 10016 08b5 FF       		.byte	-1
 10017 08b6 03       		.byte	3
 10018 08b7 03       		.byte	3
 10019 08b8 AA       		.byte	-86
 10020 08b9 FE       		.byte	-2
 10021 08ba 12       		.byte	18
 10022 08bb 16       		.byte	22
 10023 08bc AA       		.byte	-86
 10024 08bd FE       		.byte	-2
 10025 08be 10       		.byte	16
 10026 08bf 00       		.byte	0
 10027 08c0 02       		.byte	2
 10028 08c1 AA       		.byte	-86
 10029              	.LC3:
 10030 08c2 6C09     		.short	2412
 10031 08c4 8509     		.short	2437
 10032 08c6 9E09     		.short	2462
 10033              		.section	.rodata.str1.1,"aMS",%progbits,1
 10034              	.LC4:
 10035 0000 32303137 		.ascii	"2017-03-R2\000"
 10035      2D30332D 
 10035      523200
 10036              		.data
 10037              		.align	2
 10038              		.set	.LANCHOR1,. + 0
 10041              	channel:
 10042 0000 8909     		.short	2441
ARM GAS  /tmp/ccwLngFB.s 			page 256


 10043 0002 0000     		.space	2
 10046              	le:
 10047 0004 D6BE898E 		.word	-1903575338
 10048 0008 7D6B     		.short	27517
 10049 000a 7191     		.short	-28303
 10050 000c 55555500 		.word	5592405
 10051 0010 AAAAAA00 		.word	11184810
 10052 0014 00000000 		.word	0
 10053 0018 00       		.byte	0
 10054 0019 000000   		.space	3
 10055 001c 00000000 		.word	0
 10056 0020 00000000 		.space	32
 10056      00000000 
 10056      00000000 
 10056      00000000 
 10056      00000000 
 10057 0040 00000000 		.word	0
 10058 0044 00000000 		.word	0
 10061              	hop_timeout:
 10062 0048 9E00     		.short	158
 10065              	le_adv_channel:
 10066 004a 6209     		.short	2402
 10069              	low_freq:
 10070 004c 6009     		.short	2400
 10073              	high_freq:
 10074 004e B309     		.short	2483
 10077              	rssi_threshold:
 10078 0050 E2       		.byte	-30
 10079 0051 000000   		.bss
 10080              		.align	2
 10081              		.set	.LANCHOR0,. + 0
 10084              	modulation:
 10085 0000 00       		.space	1
 10088              	status:
 10089 0001 00       		.space	1
 10092              	idle_buf_clkn_high:
 10093 0002 00       		.space	1
 10094 0003 00       		.space	1
 10097              	idle_buf_clk100ns:
 10098 0004 00000000 		.space	4
 10101              	idle_buf_channel:
 10102 0008 0000     		.space	2
 10105              	hop_mode:
 10106 000a 00       		.space	1
 10109              	do_hop:
 10110 000b 00       		.space	1
 10113              	hop_direct_channel:
 10114 000c 0000     		.space	2
 10117              	requested_channel:
 10118 000e 0000     		.space	2
 10121              	dma_discard:
 10122 0010 00       		.space	1
 10125              	mode:
 10126 0011 00       		.space	1
 10129              	requested_mode:
 10130 0012 00       		.space	1
 10133              	jam_mode:
ARM GAS  /tmp/ccwLngFB.s 			page 257


 10134 0013 00       		.space	1
 10137              	ego_mode:
 10138 0014 00       		.space	1
 10139 0015 000000   		.space	3
 10142              	packet_cb:
 10143 0018 00000000 		.space	4
 10146              	le_jam_count:
 10147 001c 00000000 		.space	4
 10150              	dlen:
 10151 0020 00000000 		.space	4
 10154              	slave_mac_address:
 10155 0024 00000000 		.space	6
 10155      0000
 10156 002a 0000     		.space	2
 10159              	data_cb:
 10160 002c 00000000 		.space	4
 10163              	restart_jamming.5217:
 10164 0030 00000000 		.space	4
 10167              	restart_jamming.5272:
 10168 0034 00000000 		.space	4
 10171              	first_ts.5408:
 10172 0038 00000000 		.space	4
 10175              	prev_clk.5414:
 10176 003c 00000000 		.space	4
 10177              		.text
 10178              	.Letext0:
 10179              		.file 2 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stddef.h"
 10180              		.file 3 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stdint-gcc.h"
 10181              		.file 4 "../../host/libubertooth/src/ubertooth_interface.h"
 10182              		.file 5 "../common/ubertooth.h"
 10183              		.file 6 "ubertooth_usb.h"
 10184              		.file 7 "bluetooth_le.h"
 10185              		.file 8 "ego.h"
 10186              		.file 9 "ubertooth_rssi.h"
 10187              		.file 10 "ubertooth_cs.h"
 10188              		.file 11 "ubertooth_dma.h"
 10189              		.file 12 "ubertooth_clock.h"
 10190              		.file 13 "bluetooth.h"
 10191              		.file 14 "cc2400_rangetest.h"
 10192              		.file 15 "/usr/include/newlib/string.h"
 10193              		.file 16 "/usr/include/newlib/stdlib.h"
ARM GAS  /tmp/ccwLngFB.s 			page 258


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_rxtx.c
     /tmp/ccwLngFB.s:19     .text.reverse8:0000000000000000 $t
     /tmp/ccwLngFB.s:23     .text.reverse8:0000000000000000 reverse8
     /tmp/ccwLngFB.s:72     .text.cc2400_rx:0000000000000000 $t
     /tmp/ccwLngFB.s:76     .text.cc2400_rx:0000000000000000 cc2400_rx
     /tmp/ccwLngFB.s:189    .text.cc2400_rx:0000000000000098 $d
     /tmp/ccwLngFB.s:196    .text.cc2400_rx_sync:0000000000000000 $t
     /tmp/ccwLngFB.s:200    .text.cc2400_rx_sync:0000000000000000 cc2400_rx_sync
     /tmp/ccwLngFB.s:330    .text.cc2400_rx_sync:00000000000000ac $d
     /tmp/ccwLngFB.s:337    .text.enqueue:0000000000000000 $t
     /tmp/ccwLngFB.s:341    .text.enqueue:0000000000000000 enqueue
     /tmp/ccwLngFB.s:451    .text.enqueue:0000000000000084 $d
                            *COM*:0000000000000004 clkn
                            *COM*:0000000000000001 rssi_min
                            *COM*:0000000000000001 rssi_max
                            *COM*:0000000000000001 rssi_count
     /tmp/ccwLngFB.s:461    .text.le_set_access_address:0000000000000000 $t
     /tmp/ccwLngFB.s:465    .text.le_set_access_address:0000000000000000 le_set_access_address
     /tmp/ccwLngFB.s:492    .text.le_set_access_address:0000000000000014 $d
     /tmp/ccwLngFB.s:497    .text.cc2400_idle:0000000000000000 $t
     /tmp/ccwLngFB.s:501    .text.cc2400_idle:0000000000000000 cc2400_idle
     /tmp/ccwLngFB.s:615    .text.cc2400_idle:000000000000009c $d
                            *COM*:0000000000000010 target
     /tmp/ccwLngFB.s:623    .text.cb_follow_le:0000000000000000 $t
     /tmp/ccwLngFB.s:628    .text.cb_follow_le:0000000000000000 cb_follow_le
     /tmp/ccwLngFB.s:842    .text.cb_follow_le:00000000000000ec $d
                            *COM*:0000000000000320 unpacked
                            *COM*:0000000000000004 idle_rxbuf
     /tmp/ccwLngFB.s:852    .text.connection_follow_cb:0000000000000000 $t
     /tmp/ccwLngFB.s:857    .text.connection_follow_cb:0000000000000000 connection_follow_cb
     /tmp/ccwLngFB.s:1128   .text.connection_follow_cb:0000000000000164 $d
     /tmp/ccwLngFB.s:1138   .text.vendor_request_handler:0000000000000000 $t
     /tmp/ccwLngFB.s:1142   .text.vendor_request_handler:0000000000000000 vendor_request_handler
     /tmp/ccwLngFB.s:1176   .text.vendor_request_handler:000000000000001a $d
     /tmp/ccwLngFB.s:1257   .text.vendor_request_handler:00000000000000ba $t
     /tmp/ccwLngFB.s:1543   .text.vendor_request_handler:0000000000000234 $d
                            *COM*:0000000000000005 rr
     /tmp/ccwLngFB.s:1556   .text.vendor_request_handler:0000000000000260 $t
     /tmp/ccwLngFB.s:2119   .text.vendor_request_handler:0000000000000540 $d
                            *COM*:0000000000000001 cs_threshold_req
                            *COM*:0000000000000004 clkn_offset
                            *COM*:0000000000000002 clk100ns_offset
                            *COM*:000000000000000a afh_map
                            *COM*:0000000000000001 used_channels
                            *COM*:0000000000000001 afh_enabled
                            *COM*:0000000000000002 clk_drift_ppm
                            *COM*:0000000000000004 clkn_next_drift_fix
                            *COM*:0000000000000002 clk_drift_correction
                            *COM*:0000000000000004 clkn_last_drift_fix
     /tmp/ccwLngFB.s:2138   .text.vendor_request_handler:0000000000000580 $t
     /tmp/ccwLngFB.s:2496   .text.vendor_request_handler:000000000000071c $d
                            *COM*:000000000000003a tx_pkt
                            *COM*:0000000000000004 slave_mac_address_data
     /tmp/ccwLngFB.s:2504   .text.enqueue_time:0000000000000000 $t
     /tmp/ccwLngFB.s:2508   .text.enqueue_time:0000000000000000 enqueue_time
     /tmp/ccwLngFB.s:2552   .text.enqueue_time:0000000000000024 $d
ARM GAS  /tmp/ccwLngFB.s 			page 259


     /tmp/ccwLngFB.s:2557   .text.enqueue_with_ts:0000000000000000 $t
     /tmp/ccwLngFB.s:2562   .text.enqueue_with_ts:0000000000000000 enqueue_with_ts
     /tmp/ccwLngFB.s:2638   .text.enqueue_with_ts:0000000000000050 $d
     /tmp/ccwLngFB.s:2644   .text.TIMER0_IRQHandler:0000000000000000 $t
     /tmp/ccwLngFB.s:2649   .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/ccwLngFB.s:2848   .text.TIMER0_IRQHandler:0000000000000110 $d
                            *COM*:0000000000000004 last_hop
     /tmp/ccwLngFB.s:2865   .text.EINT3_IRQHandler:0000000000000000 $t
     /tmp/ccwLngFB.s:2870   .text.EINT3_IRQHandler:0000000000000000 EINT3_IRQHandler
     /tmp/ccwLngFB.s:2901   .text.EINT3_IRQHandler:0000000000000024 $d
                            *COM*:0000000000000001 cs_trigger
     /tmp/ccwLngFB.s:2909   .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/ccwLngFB.s:2914   .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/ccwLngFB.s:3075   .text.DMA_IRQHandler:00000000000000e0 $d
                            *COM*:0000000000000004 active_rxbuf
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
     /tmp/ccwLngFB.s:3093   .text.le_transmit:0000000000000000 $t
     /tmp/ccwLngFB.s:3098   .text.le_transmit:0000000000000000 le_transmit
     /tmp/ccwLngFB.s:3390   .text.le_transmit:000000000000019c $d
     /tmp/ccwLngFB.s:3399   .text.le_jam:0000000000000000 $t
     /tmp/ccwLngFB.s:3404   .text.le_jam:0000000000000000 le_jam
     /tmp/ccwLngFB.s:3485   .text.le_jam:0000000000000074 $d
     /tmp/ccwLngFB.s:3490   .text.hop:0000000000000000 $t
     /tmp/ccwLngFB.s:3495   .text.hop:0000000000000000 hop
     /tmp/ccwLngFB.s:3742   .text.hop:0000000000000180 $d
     /tmp/ccwLngFB.s:3754   .text.bt_stream_rx:0000000000000000 $t
     /tmp/ccwLngFB.s:3759   .text.bt_stream_rx:0000000000000000 bt_stream_rx
     /tmp/ccwLngFB.s:3979   .text.bt_stream_rx:000000000000012c $d
                            *COM*:0000000000000001 cs_threshold_cur
                            *COM*:0000000000000001 cs_no_squelch
     /tmp/ccwLngFB.s:3995   .text.br_transmit:0000000000000000 $t
     /tmp/ccwLngFB.s:4000   .text.br_transmit:0000000000000000 br_transmit
     /tmp/ccwLngFB.s:4423   .text.br_transmit:000000000000025c $d
     /tmp/ccwLngFB.s:4436   .text.reset_le:0000000000000000 $t
     /tmp/ccwLngFB.s:4441   .text.reset_le:0000000000000000 reset_le
     /tmp/ccwLngFB.s:4504   .text.reset_le:0000000000000040 $d
     /tmp/ccwLngFB.s:4513   .text.reset_le_promisc:0000000000000000 $t
     /tmp/ccwLngFB.s:4518   .text.reset_le_promisc:0000000000000000 reset_le_promisc
     /tmp/ccwLngFB.s:4542   .text.reset_le_promisc:000000000000001c $d
                            *COM*:0000000000000108 le_promisc
     /tmp/ccwLngFB.s:4547   .text.bt_generic_le:0000000000000000 $t
     /tmp/ccwLngFB.s:4552   .text.bt_generic_le:0000000000000000 bt_generic_le
     /tmp/ccwLngFB.s:4891   .text.bt_generic_le:00000000000001ac $d
     /tmp/ccwLngFB.s:4910   .text.bt_le_sync:0000000000000000 $t
     /tmp/ccwLngFB.s:4915   .text.bt_le_sync:0000000000000000 bt_le_sync
     /tmp/ccwLngFB.s:5364   .text.bt_le_sync:0000000000000280 $d
                            *COM*:0000000000000032 rxbuf1
     /tmp/ccwLngFB.s:5386   .text.bt_le_sync:00000000000002cc $t
     /tmp/ccwLngFB.s:5582   .text.bt_le_sync:00000000000003e0 $d
     /tmp/ccwLngFB.s:5594   .text.bt_le_sync_cfo:0000000000000000 $t
     /tmp/ccwLngFB.s:5599   .text.bt_le_sync_cfo:0000000000000000 bt_le_sync_cfo
     /tmp/ccwLngFB.s:6079   .text.bt_le_sync_cfo:00000000000002b0 $d
     /tmp/ccwLngFB.s:6101   .text.bt_le_sync_cfo:00000000000002fc $t
     /tmp/ccwLngFB.s:6294   .text.bt_le_sync_cfo:0000000000000404 $d
     /tmp/ccwLngFB.s:6306   .text.bt_le_sync_rssi:0000000000000000 $t
     /tmp/ccwLngFB.s:6311   .text.bt_le_sync_rssi:0000000000000000 bt_le_sync_rssi
ARM GAS  /tmp/ccwLngFB.s 			page 260


     /tmp/ccwLngFB.s:6628   .text.bt_le_sync_rssi:00000000000001ec $d
     /tmp/ccwLngFB.s:6640   .text.bt_follow_le:0000000000000000 $t
     /tmp/ccwLngFB.s:6645   .text.bt_follow_le:0000000000000000 bt_follow_le
     /tmp/ccwLngFB.s:6675   .text.bt_follow_le:0000000000000018 $d
     /tmp/ccwLngFB.s:6681   .text.bt_tracking_le:0000000000000000 $t
     /tmp/ccwLngFB.s:6686   .text.bt_tracking_le:0000000000000000 bt_tracking_le
     /tmp/ccwLngFB.s:6735   .text.bt_tracking_le:000000000000002c $d
     /tmp/ccwLngFB.s:6741   .text.le_promisc_state:0000000000000000 $t
     /tmp/ccwLngFB.s:6746   .text.le_promisc_state:0000000000000000 le_promisc_state
     /tmp/ccwLngFB.s:6800   .text.promisc_recover_hop_increment:0000000000000000 $t
     /tmp/ccwLngFB.s:6805   .text.promisc_recover_hop_increment:0000000000000000 promisc_recover_hop_increment
     /tmp/ccwLngFB.s:6958   .text.promisc_recover_hop_increment:00000000000000c8 $d
     /tmp/ccwLngFB.s:6968   .text.promisc_recover_hop_interval:0000000000000000 $t
     /tmp/ccwLngFB.s:6973   .text.promisc_recover_hop_interval:0000000000000000 promisc_recover_hop_interval
     /tmp/ccwLngFB.s:7096   .text.promisc_recover_hop_interval:0000000000000098 $d
     /tmp/ccwLngFB.s:7107   .text.promisc_follow_cb:0000000000000000 $t
     /tmp/ccwLngFB.s:7112   .text.promisc_follow_cb:0000000000000000 promisc_follow_cb
     /tmp/ccwLngFB.s:7208   .text.promisc_follow_cb:0000000000000064 $d
     /tmp/ccwLngFB.s:7219   .text.see_aa:0000000000000000 $t
     /tmp/ccwLngFB.s:7224   .text.see_aa:0000000000000000 see_aa
     /tmp/ccwLngFB.s:7303   .text.see_aa:0000000000000058 $d
     /tmp/ccwLngFB.s:7308   .text.cb_le_promisc:0000000000000000 $t
     /tmp/ccwLngFB.s:7313   .text.cb_le_promisc:0000000000000000 cb_le_promisc
     /tmp/ccwLngFB.s:7628   .text.cb_le_promisc:000000000000017c $d
     /tmp/ccwLngFB.s:7641   .text.bt_promisc_le:0000000000000000 $t
     /tmp/ccwLngFB.s:7646   .text.bt_promisc_le:0000000000000000 bt_promisc_le
     /tmp/ccwLngFB.s:7725   .text.bt_promisc_le:000000000000005c $d
     /tmp/ccwLngFB.s:7734   .text.bt_slave_le:0000000000000000 $t
     /tmp/ccwLngFB.s:7739   .text.bt_slave_le:0000000000000000 bt_slave_le
     /tmp/ccwLngFB.s:8172   .text.bt_slave_le:0000000000000248 $d
     /tmp/ccwLngFB.s:8185   .text.rx_generic_sync:0000000000000000 $t
     /tmp/ccwLngFB.s:8190   .text.rx_generic_sync:0000000000000000 rx_generic_sync
     /tmp/ccwLngFB.s:8302   .text.rx_generic_sync:0000000000000094 $d
     /tmp/ccwLngFB.s:8309   .text.rx_generic:0000000000000000 $t
     /tmp/ccwLngFB.s:8314   .text.rx_generic:0000000000000000 rx_generic
     /tmp/ccwLngFB.s:8345   .text.rx_generic:000000000000001c $d
     /tmp/ccwLngFB.s:8350   .text.tx_generic:0000000000000000 $t
     /tmp/ccwLngFB.s:8355   .text.tx_generic:0000000000000000 tx_generic
     /tmp/ccwLngFB.s:8513   .text.tx_generic:00000000000000dc $d
     /tmp/ccwLngFB.s:8523   .text.specan:0000000000000000 $t
     /tmp/ccwLngFB.s:8528   .text.specan:0000000000000000 specan
     /tmp/ccwLngFB.s:8715   .text.specan:00000000000000fc $d
     /tmp/ccwLngFB.s:8725   .text.led_specan:0000000000000000 $t
     /tmp/ccwLngFB.s:8730   .text.led_specan:0000000000000000 led_specan
     /tmp/ccwLngFB.s:8934   .text.led_specan:0000000000000114 $d
     /tmp/ccwLngFB.s:8945   .text.startup.main:0000000000000000 $t
     /tmp/ccwLngFB.s:8950   .text.startup.main:0000000000000000 main
     /tmp/ccwLngFB.s:8996   .text.startup.main:0000000000000034 $d
     /tmp/ccwLngFB.s:9025   .text.startup.main:00000000000000a0 $t
     /tmp/ccwLngFB.s:9229   .text.startup.main:000000000000017c $d
     /tmp/ccwLngFB.s:10142  .bss:0000000000000018 packet_cb
     /tmp/ccwLngFB.s:10159  .bss:000000000000002c data_cb
     /tmp/ccwLngFB.s:10146  .bss:000000000000001c le_jam_count
     /tmp/ccwLngFB.s:10046  .data:0000000000000004 le
     /tmp/ccwLngFB.s:10154  .bss:0000000000000024 slave_mac_address
     /tmp/ccwLngFB.s:10150  .bss:0000000000000020 dlen
     /tmp/ccwLngFB.s:10077  .data:0000000000000050 rssi_threshold
ARM GAS  /tmp/ccwLngFB.s 			page 261


     /tmp/ccwLngFB.s:10073  .data:000000000000004e high_freq
     /tmp/ccwLngFB.s:10069  .data:000000000000004c low_freq
     /tmp/ccwLngFB.s:10084  .bss:0000000000000000 modulation
     /tmp/ccwLngFB.s:10137  .bss:0000000000000014 ego_mode
     /tmp/ccwLngFB.s:10133  .bss:0000000000000013 jam_mode
     /tmp/ccwLngFB.s:10129  .bss:0000000000000012 requested_mode
     /tmp/ccwLngFB.s:10125  .bss:0000000000000011 mode
     /tmp/ccwLngFB.s:10088  .bss:0000000000000001 status
     /tmp/ccwLngFB.s:10121  .bss:0000000000000010 dma_discard
     /tmp/ccwLngFB.s:10101  .bss:0000000000000008 idle_buf_channel
     /tmp/ccwLngFB.s:10097  .bss:0000000000000004 idle_buf_clk100ns
     /tmp/ccwLngFB.s:10092  .bss:0000000000000002 idle_buf_clkn_high
     /tmp/ccwLngFB.s:10065  .data:000000000000004a le_adv_channel
     /tmp/ccwLngFB.s:10117  .bss:000000000000000e requested_channel
     /tmp/ccwLngFB.s:10061  .data:0000000000000048 hop_timeout
     /tmp/ccwLngFB.s:10113  .bss:000000000000000c hop_direct_channel
     /tmp/ccwLngFB.s:10041  .data:0000000000000000 channel
     /tmp/ccwLngFB.s:10109  .bss:000000000000000b do_hop
     /tmp/ccwLngFB.s:10105  .bss:000000000000000a hop_mode
     /tmp/ccwLngFB.s:9472   .rodata:00000000000000a7 compile_info
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000032 rxbuf2
     /tmp/ccwLngFB.s:9295   .rodata:0000000000000000 $d
     /tmp/ccwLngFB.s:9299   .rodata:0000000000000000 whitening_index
     /tmp/ccwLngFB.s:9342   .rodata:0000000000000028 whitening
     /tmp/ccwLngFB.s:9477   .rodata:00000000000000f0 whitening_word
     /tmp/ccwLngFB.s:9960   .rodata:0000000000000870 hop_interval_lut
     /tmp/ccwLngFB.s:10037  .data:0000000000000000 $d
     /tmp/ccwLngFB.s:10080  .bss:0000000000000000 $d
     /tmp/ccwLngFB.s:10163  .bss:0000000000000030 restart_jamming.5217
     /tmp/ccwLngFB.s:10167  .bss:0000000000000034 restart_jamming.5272
     /tmp/ccwLngFB.s:10171  .bss:0000000000000038 first_ts.5408
     /tmp/ccwLngFB.s:10175  .bss:000000000000003c prev_clk.5414
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
cc2400_set
cs_threshold_calc_and_set
clkn_start
cc2400_status
cc2400_strobe
usb_enqueue
rssi_get_avg
memcpy
rbit
clkn_stop
dio_ssp_stop
cs_reset
rssi_reset
btle_channel_index
btle_crcgen_lut
memcmp
__aeabi_llsl
get_part_num
get_device_serial
cc2400_get
set_isp
ARM GAS  /tmp/ccwLngFB.s 			page 262


bootloader_ctrl
strlen
precalc
dequeue
queue_init
malloc
usb_enqueue_time
cc2400_fifo_write
next_hop
btle_next_hop
dio_ssp_init
dma_init
dio_ssp_start
cs_trigger_enable
rssi_add
handle_usb
rssi_iir_update
cs_trigger_disable
memset
dma_init_le
cc2400_get_rev
btle_reverse_crc
btle_calc_crc
cc2400_fifo_read
ubertooth_init
clkn_init
ubertooth_usb_init
wait
reset
cc2400_txtest
cc2400_rangetest
cc2400_repeater
ego_main
